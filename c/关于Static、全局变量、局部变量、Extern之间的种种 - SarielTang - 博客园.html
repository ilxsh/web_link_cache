<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="referrer" content="origin" />
    <title>关于Static、全局变量、局部变量、Extern之间的种种 - SarielTang - 博客园</title>
<meta property="og:description" content="static作用（修饰函数、局部变量、全局变量）在C语言中，static的字面意思很容易把我们导入歧途，其实它的作用有三条。（1）先来介绍它的第一条也是最重要的一条：隐藏。当我们同时编译多个文件时，所" />
    <link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=svlZeZMvc3He7PqOD4T7SOuQn0_kIfLBYiy3idqd35Y1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/CodingLife/bundle-CodingLife.css?v=g4Oce5UBaUn_FUwadcT09ICEg5NkULQGtUpNhTtrI8U1"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/CodingLife/bundle-CodingLife-mobile.css?v=nSeK_P8BAqpQ4UDLpcwd6yl-jVYCXnR833BwkQ30uqQ1"/>
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/SarielTang/rss"/>
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/SarielTang/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/SarielTang/wlwmanifest.xml"/>
    <script src="//common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script>var currentBlogId=227647;var currentBlogApp='SarielTang',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="/bundles/blog-common.js?v=OFBZTzkHKauV7mtIFLF9jlqrX-sesK9-mY9KjurLrq01" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>


<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="https://www.cnblogs.com/SarielTang/"><img id="blogLogo" src="/Skins/custom/images/logo.gif" alt="返回主页" /></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/SarielTang/">SarielTang</a></h1>
<h2>github帐号：https://github.com/SarielTang</h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/SarielTang/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/SarielTang">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/SarielTang/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="https://www.cnblogs.com/SarielTang/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 25&nbsp; </span>
<span id="stats_article_count">文章 - 0&nbsp; </span>
<span id="stats-comment_count">评论 - 0</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/SarielTang/p/4501456.html">关于Static、全局变量、局部变量、Extern之间的种种</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body">

<div><a target="_blank" id="cb_post_title_url" href="http://www.cnblogs.com/stoneJin/archive/2011/09/21/2183313.html" style="color:rgb(255,51,102)">static作用（修饰函数、局部变量、全局变量）</a></div>
<div id="cnblogs_post_body">
<p align="left">在C语言中，static的字面意思很容易把我们导入歧途，其实它的作用有三条。</p>
<p align="left">（1）先来介绍它的第一条也是最重要的一条：隐藏。</p>
<p align="left">当我们同时编译多个文件时，所有未加static前缀的全局变量和函数都具有全局可见性。为理解这句话，我举例来说明。我们要同时编译两个源文件，一个是a.c，另一个是main.c。</p>
<p align="left">下面是a.c的内容</p>
<div><span style="color:rgb(0,0,255)">char</span>&nbsp;a&nbsp;=&nbsp;'A';&nbsp;<span style="color:rgb(0,128,0)">//</span><span style="color:rgb(0,128,0)">&nbsp;global&nbsp;variable</span><span style="color:rgb(0,128,0)"><br>
</span><span style="color:rgb(0,0,255)">void</span>&nbsp;msg()&nbsp;<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Hello\n&quot;);&nbsp;<br>
}</div>
<p>&nbsp;下面是main.c的内容</p>
<div><span style="color:rgb(0,0,255)">int</span>&nbsp;main(<span style="color:rgb(0,0,255)">void</span>)<br>
{&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">extern</span>&nbsp;<span style="color:rgb(0,0,255)">char</span>&nbsp;a;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0)">//</span><span style="color:rgb(0,128,0)">&nbsp;extern&nbsp;variable&nbsp;must&nbsp;be&nbsp;declared&nbsp;before&nbsp;use</span><span style="color:rgb(0,128,0)"><br>
</span>&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%c&nbsp;&quot;,&nbsp;a);<br>
&nbsp;&nbsp;&nbsp;&nbsp;(<span style="color:rgb(0,0,255)">void</span>)msg();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">return</span>&nbsp;0;<br>
}</div>
<p>程序的运行结果是：</p>
<p align="left">A Hello</p>
<p align="left">你可能会问：为什么在a.c中定义的全局变量a和函数msg能在main.c中使用？前面说过，所有未加static前缀的全局变量和函数都具有全局可见性，其它的源文件也能访问。此例中，a是全局变量，msg是函数，并且都没有加static前缀，因此对于另外的源文件main.c是可见的。</p>
<p align="left">如果加了static，就会对其它源文件隐藏。例如在a和msg的定义前加上static，main.c就看不到它们了。利用这一特性可以在不同的文件中定义同名函数和同名变量，而不必担心命名冲突。Static可以用作函数和变量的前缀，对于函数来讲，static的作用仅限于隐藏，而对于变量，static还有下面两个作用。</p>
<p>（2）static的第二个作用是保持变量内容的持久。存储在静态数据区的变量会在程序刚开始运行时就完成初始化，也是唯一的一次初始化。共有两种变量存储在静态存储区：全局变量和static变量，只不过和全局变量比起来，static可以控制变量的可见范围，说到底static还是用来隐藏的。虽然这种用法不常见，但我还是举一个例子。</p>
<div><span style="color:rgb(0,0,255)">#include</span>&nbsp;&lt;stdio.h&gt;<br>
<br>
<span style="color:rgb(0,0,255)">int</span>&nbsp;fun(<span style="color:rgb(0,0,255)">void</span>){<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">static</span>&nbsp;<span style="color:rgb(0,0,255)">int</span>&nbsp;count&nbsp;=&nbsp;10;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0)">//</span><span style="color:rgb(0,128,0)">&nbsp;事实上此赋&#20540;语句从来没有执行过</span><span style="color:rgb(0,128,0)"><br>
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">return</span>&nbsp;count--;<br>
}<br>
<br>
<span style="color:rgb(0,0,255)">int</span>&nbsp;count&nbsp;=&nbsp;1;<br>
<br>
<span style="color:rgb(0,0,255)">int</span>&nbsp;main(<span style="color:rgb(0,0,255)">void</span>)<br>
{&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;global\t\tlocal&nbsp;static\n&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">for</span>(;&nbsp;count&nbsp;&lt;=&nbsp;10;&nbsp;&#43;&#43;count)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d\t\t%d\n&quot;,&nbsp;count,&nbsp;fun());&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">return</span>&nbsp;0;<br>
}</div>
<p>&nbsp;程序的运行结果是：</p>
<p align="left">global&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; local static</p>
<p align="left">1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10</p>
<p align="left">2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9</p>
<p align="left">3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8</p>
<p align="left">4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7</p>
<p align="left">5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6</p>
<p align="left">6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5</p>
<p align="left">7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4</p>
<p align="left">8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</p>
<p align="left">9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2</p>
<p align="left">10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1</p>
<p>（3）static的第三个作用是默认初始化为0。其实全局变量也具备这一属性，因为全局变量也存储在静态数据区。在静态数据区，内存中所有的字节默认&#20540;都是0x00，某些时候这一特点可以减少程序员的工作量。比如初始化一个稀疏矩阵，我们可以一个一个地把所有元素都置0，然后把不是0的几个元素赋&#20540;。如果定义成静态的，就省去了一开始置0的操作。再比如要把一个字符数组当字符串来用，但又觉得每次在字符数组末尾加’\0’太麻烦。如果把字符串定义成静态的，就省去了这个麻烦，因为那里本来就是’\0’。不妨做个小实验验证一下。</p>
<div><span style="color:rgb(0,0,255)">#include</span>&nbsp;&lt;stdio.h&gt;<br>
<br>
<span style="color:rgb(0,0,255)">int</span>&nbsp;a;<br>
<br>
<span style="color:rgb(0,0,255)">int</span>&nbsp;main(<span style="color:rgb(0,0,255)">void</span>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">int</span>&nbsp;i;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">static</span>&nbsp;<span style="color:rgb(0,0,255)">char</span>&nbsp;str[10];<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;integer:&nbsp;%d;&nbsp;&nbsp;string:&nbsp;(begin)%s(end)&quot;,&nbsp;a,&nbsp;str);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255)">return</span>&nbsp;0;<br>
}</div>
<p>程序的运行结果如下</p>
<p align="left">integer: 0;&nbsp;string: (begin)(end)</p>
<p align="left">最后对static的三条作用做一句话总结。首先static的最主要功能是隐藏，其次因为static变量存放在静态存储区，所以它具备持久性和默认&#20540;0。</p>
<p align="left">以上内容出自博客园Mr. Write之手，写的相当清晰易懂，存档方便复习。原文地址：<a target="_blank" href="http://www.cnblogs.com/dc10101/archive/2007/08/22/865556.html" style="color:rgb(255,51,102)">http://www.cnblogs.com/dc10101/archive/2007/08/22/865556.html</a></p>
<p align="left">下面是中兴通讯2012校招笔试题的一道问答题：</p>
<p align="left"><strong>1. static全局变量与普通的全局变量有什么区别 ?</strong></p>
<p><span size="3">　全局变量(外部变量)的说明之前再冠以static 就构成了静态的全局变量。</span></p>
<p><span style="color:red">　　全局变量本身就是静态存储方式， 静态全局变量当然也是静态存储方式</span>。&nbsp;这两者在存储方式上并无不同。</p>
<p><span size="3">　　这两者的区别在于非静态全局变量的作用域是整个源程序， 当一个源程序由多个源文件组成时，非静态的全局变量在各个源文件中都是有效的。 而静态全局变量则限制了其作用域， 即只在定义该变量的源文件内有效， 在同一源程序的其它源文件中不能使用它。由于静态全局变量的作用域局限于一个源文件内，只能为该源文件内的函数公用，因此可以避免在其它源文件中引起错误。</span>&nbsp;</p>
<p>static全局变量只初使化一次，防止在其他文件单元中被引用;&nbsp;　&nbsp;</p>
<p><span size="3"><strong>2.&nbsp; static局部变量和普通局部变量有什么区别 ？</strong></span></p>
<p>&nbsp;　　把局部变量改变为静态变量后是改变了它的存储方式即改变了它的<span style="color:red"><strong>生存期</strong></span>。把全局变量改变为静态变量后是改变了它的<span style="color:red"><strong>作用域</strong></span>，限制了它的使用范围。&nbsp;&nbsp;</p>
<p>　　static局部变量只被初始化一次，下一次依据上一次结果&#20540;；&nbsp;　&nbsp;</p>
<p><span size="3"><strong>3.&nbsp; static函数与普通函数有什么区别？</strong></span></p>
<p><span size="3">　　&nbsp;static函数与普通函数作用域不同,仅在本文件。只在当前源文件中使用的函数应该说明为内部函数(static修饰的函数)，内部函数应该在当前源文件中说明和定义。对于可在当前源文件以外使用的函数，应该在一个头文件中说明，要使用这些函数的源文件要包含这个头文件.</span></p>
<p><span style="color:red">static函数在内存中只有一份，普通函数在每个被调用中维持一份拷贝</span></p>
<div><br>
</div>
<div><span style="color:#ff0000">Extern与Static：</span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; font-family:Rosario,'Xin Gothic','Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',Arial,sans-serif-webkit-body; font-size:14px; line-height:21px">
&nbsp;&nbsp;&nbsp; 首先，<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">我要告诉你static与extern是一对“水火不容”的家伙</span></span>，也就是说extern和static不能同时修饰一个变量；其次，<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">static修
 饰的全局变量声明与定义同时进行</span></span>，也就是说当你在头文件中使用static声明了全局变量后，它也同时被定义了；最后，<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">static修饰全局变量的作用域 只能是本身的编译单元</span></span>，也就是说它的“全局”只对本编译单元有效，其他编译单元则看不到它,如:<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; test1.h:<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #ifndef TEST1H<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #define TEST1H<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; static char g_str[] = &quot;123456&quot;;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void fun1();<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #endif</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; font-family:Rosario,'Xin Gothic','Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',Arial,sans-serif-webkit-body; font-size:14px; line-height:21px">
&nbsp;&nbsp;&nbsp; test1.cpp:<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #include &quot;test1.h&quot;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void fun1()<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; {<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout &lt;&lt; g_str &lt;&lt; endl;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; }<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; test2.cpp<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #include &quot;test1.h&quot;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void fun2()<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; {<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout &lt;&lt; g_str &lt;&lt; endl;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; }<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; 以上两个编译单元可以连接成功, 当你打开test1.obj时，你可以在它里面找到字符串&quot;123456&quot;, 同时你也可以在test2.obj中找到它们，它们之所以可以连接成功而没有报重复定义的错误是因为虽然它们有相同的内容，但是存储的物理地址并不一样， 就像是两个不同变量赋了相同的&#20540;一样，而<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">这两个变量分别作用于它们各自的编译单元。</span></span><br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; 也许你比较较真，自己偷偷的跟踪调试上面的代码,结果你发现两个编译单元（test1, test2）的g_str的内存地址相同，于是你下结论static修饰的变量也可以作用于其他模块，但是我要告诉你，那是你的编译器在欺骗你，大多数编 译器都对代码都有优化功能，以达到生成的目标程序更节省内存，执行效率更高，当编译器在连接各个编译单元的时候，它会把相同内容的内存只拷贝一份，比如上 面的&quot;123456&quot;, 位于两个编译单元中的变量都是同样的内容，那么在连接的时候它在内存中就只会存在一份了， 如果你把上面的代码改成下面的样子，你马上就可以<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">拆穿编译器的谎言</span></span>:<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; test1.cpp:<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #include &quot;test1.h&quot;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void fun1()<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; {<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">&nbsp;g_str[0] = 'a';</span></span><br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout &lt;&lt; g_str &lt;&lt; endl;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; }</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; font-family:Rosario,'Xin Gothic','Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',Arial,sans-serif-webkit-body; font-size:14px; line-height:21px">
&nbsp;&nbsp;&nbsp; test2.cpp<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; #include &quot;test1.h&quot;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void fun2()<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; {<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout &lt;&lt; g_str &lt;&lt; endl;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; }<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; void main()<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; {<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fun1(); // a23456<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fun2(); // 123456<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; }<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp;&nbsp;<br style="margin:0px; padding:0px">
&nbsp;&nbsp;&nbsp; 这个时候你在跟踪代码时，就会发现两个编译单元中的g_str地址并不相同，因为你在一处修改了它，所以<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">编译器被强行的恢复内存的原貌</span></span>，在内存中存在了两份拷贝给两个模块中的变量使用。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; font-family:Rosario,'Xin Gothic','Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',Arial,sans-serif-webkit-body; font-size:14px; line-height:21px">
&nbsp;&nbsp;&nbsp;&nbsp;<span color="#ff0000" style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">正是因为static有以上的特性，所以一般定义static全局变量时，都把它放在原文件中而不是头文件，这样就不会给其他模块造成不必要的信息污染，同样记住这个原则吧！</span></span><br style="margin:0px; padding:0px">
</p>
<br></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


		</div>
		<div class = "postDesc">posted @ <span id="post-date">2015-01-06 22:19</span> <a href='https://www.cnblogs.com/SarielTang/'>SarielTang</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="https://i.cnblogs.com/EditPosts.aspx?postid=4501456" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(4501456);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=227647,cb_entryId=4501456,cb_blogApp=currentBlogApp,cb_blogUserGuid='b987a497-61f9-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/1/6 22:19:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
<script src="//common.cnblogs.com/script/syntax_highlighter_csdn.js" type="text/javascript"></script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id='cnblogs_c1' class='c_ad_block'>
    <div id='div-gpt-ad-1546353474406-0' style='height:250px; width:300px;'></div>
</div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'>
    <div id='div-gpt-ad-1539008685004-0' style='height:60px; width:468px;'></div>
</div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2019 SarielTang
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->

</body>
</html>
