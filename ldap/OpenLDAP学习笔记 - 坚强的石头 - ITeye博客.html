<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" dir="ltr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>
    OpenLDAP学习笔记 - 坚强的石头 - ITeye博客
  </title>
  <meta name="description" content="LDAP协议               目录是一组具有类似属性、以一定逻辑和层次组合的信息。常见的例子是通讯簿，由以字母顺序排列的名字、地址和电话号码组成。  目录服务是一种在分布式环境中发现目标的方法。目录具有两个主要组成部分：     第一部分是数据库，数据库是分布式的，且拥有一个描述数据的规划。  第二部分则是访问和处理数据的各种协议。        目录服务其实也是一种数据库系统，只是这种 ..." />
  <meta name="keywords" content=" OpenLDAP学习笔记" />
  <meta name="report" content='{"pid":"iteye"}'>
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
  <link rel="search" type="application/opensearchdescription+xml" href="/open_search.xml" title="ITeye" />
  <link href="/rss" rel="alternate" title="坚强的石头" type="application/rss+xml" />
  <link href="https://www.iteye.com/stylesheets/blog.css?1543400199" media="screen" rel="stylesheet" type="text/css" />
<link href="https://www.iteye.com/stylesheets/themes/blog/blue.css?1543400199" media="screen" rel="stylesheet" type="text/css" />
  <script src="https://www.iteye.com/javascripts/application.js?1544695506" type="text/javascript"></script>
  <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?e19a8b00cf63f716d774540875007664";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<style>
/* 折叠效果 */
.hide-main-content{
    position: relative;
}
.hide-article-box {
    display: none;
    position: absolute;
    z-index: 9999;
    bottom: -1px;
    width: 100%;
    padding-top: 160px;
    background-image: -webkit-gradient(linear,left top, left bottom,from(rgba(255,255,255,0)),color-stop(70%, #fff));
    background-image: linear-gradient(-180deg,rgba(255,255,255,0) 0%,#fff 70%);
}
.hide-article-box #btn-readmore{
    color: #ca0c16;
    border: 1px solid #ca0c16;
    margin: 10px auto;
    padding: 0 8px;
    display: block;
    font-size: 14px;
    border-radius: 4px;
    text-align: center;
    background-color: transparent;
    height: 34px;
    width: 74px;
    line-height: 32px;
    min-width: 72px;
    cursor: pointer;
}
.hide-article-box #btn-readmore:hover{
    background: #ca0c16;
    color:#fff;
    text-decoration: none;
}
</style>
<!-- 因INS广告原因 需要提前引入jquery -->
<script src="//csdnimg.cn/public/common/libs/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
<script type="text/javascript">var jQuery = jQuery.noConflict();// 解决jq与prototype.js命名空间冲突的问题</script>
<script src="https://g.csdnimg.cn/fixed-sidebar/1.1.1/fixed-sidebar.js" type="text/javascript"></script>

    <link href="https://www.iteye.com/javascripts/syntaxhighlighter/SyntaxHighlighter.css?1448702469" media="screen" rel="stylesheet" type="text/css" />
  <script src="https://www.iteye.com/javascripts/syntaxhighlighter/shCoreCommon.js?1448702469" type="text/javascript"></script>
<script src="https://www.iteye.com/javascripts/hotkey.js?1448702469" type="text/javascript"></script>
  <script src="https://www.iteye.com/javascripts/code_favorites.js?1448702469" type="text/javascript"></script>
<script src="https://www.iteye.com/javascripts/weiboshare.js?1448702469" type="text/javascript"></script>

  <!-- 请置于所有广告位代码之前 -->
  <script src="https://dup.baidustatic.com/js/ds.js"></script>
  <link ref="canonical" href="http://www.iteye.com/blog/jianshi-dlw-1557846">
  <script src="//msite.baidu.com/sdk/c.js?appid=1563894916825412"></script>
  <script src="https://g.csdnimg.cn/recommend/1.4.2/recommend.js"></script>
</head>

<body>
  <div id="header">
    <div id="blog_site_nav">
  <a href="https://www.iteye.com/" class="homepage">首页</a>
  <a href="https://www.iteye.com/news">资讯</a>
  <a href="https://www.iteye.com/magazines">精华</a>
  <a href="https://www.iteye.com/forums">论坛</a>
  <a href="https://www.iteye.com/ask">问答</a>
  <a href="https://www.iteye.com/blogs">博客</a>
  <a href="https://www.iteye.com/blogs/subjects">专栏</a>
  <a href="https://www.iteye.com/groups">群组</a>
  <a href="https://www.iteye.com/resources">下载</a>
</div>

    <div id="user_nav">

      <a href="/login" class="welcome" title="登录">您还未登录!</a>
    <a href="/login">登录</a>
    <a href="/signup" class="nobg">注册</a>
    <!--<a href="https://passport.csdn.net/account/mobileregister?from=https://www.iteye.com">注册</a>-->
  </div>


  </div>

  <div id="page">
<!--    <div id="branding" class="clearfix">-->
<!--      <div id="blog_name">-->
<!--        <h1><a href="/">-->
<!--            </a></h1>-->
<!--      </div>-->
<!--      <div id='fd'></div>-->
<!--      <div id="blog_navbar">-->
<!--        <ul>-->
          
          
          
          
          
          
<!--        </ul>-->

<!--        <div class="search">-->
<!--          <form action="/blog/search" method="get">-->
<!--            <input class="search_text" id="query" name="query" style="margin-left: 10px;width: 110px;" type="text"-->
<!--              value="" />-->
<!--            <input class="submit_search" type="submit" value="" />-->
<!--          </form>-->
<!--        </div>-->
<!--        <div id="fd"></div>-->
<!--      </div>-->
<!--    </div>-->
    `
    <div id="content" class="clearfix">
      <div id="local">
        <div class="local_top"></div>
        <div id="blog_owner">
  <div id="blog_owner_logo"><a href='https://www.iteye.com/blog/user/jianshi-dlw'><img alt="lewis122的博客" class="logo" src="https://www.iteye.com/upload/logo/user/840251/730737d0-91e7-3527-97e9-4a3ab58337b2.jpg?1367675892" title="lewis122的博客: 坚强的石头" width="" /></a></div>
  <div id="blog_owner_name">lewis122</div>
</div>

        <div id="blog_actions">
          <ul>
            <li>浏览:
              195490 次</li>
            
            <li>性别:
              <img alt="Icon_minigender_1" src="https://www.iteye.com/images/icon_minigender_1.gif?1448702469" title="男" />
            </li>
            
            
            <li>来自:
              北京
            </li>
            
            <li>
              <img src='/images/status/offline.gif'/>
            </li>
            
          </ul>
        </div>

        <div id="user_visits" class="clearfix">
          <h5>最近访客 <span style='font-weight:normal;font-size:12px;padding-left:30px;'>
              <a href="/blog/user_visits">更多访客&gt;&gt;</a></span></h5>
          
          <div class="user_visit">
            <div class="logo"><a href='https://www.iteye.com/blog/user/jason-dao' target='_blank'><img alt="jason_dao的博客" class="logo" src="https://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="jason_dao的博客: " width="48px" /></a></div>
            <div class="left">
              <a href='https://www.iteye.com/blog/user/jason-dao' target='_blank' title='jason_dao'>jason_dao</a>
            </div>
          </div>
          
          <div class="user_visit">
            <div class="logo"><a href='https://www.iteye.com/blog/user/tzh476' target='_blank'><img alt="进两步的博客" class="logo" src="https://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="进两步的博客: " width="48px" /></a></div>
            <div class="left">
              <a href='https://www.iteye.com/blog/user/tzh476' target='_blank' title='进两步'>进两步</a>
            </div>
          </div>
          
          <div class="user_visit">
            <div class="logo"><a href='https://www.iteye.com/blog/user/bettybetty' target='_blank'><img alt="aliceatah的博客" class="logo" src="https://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="aliceatah的博客: 仅作收藏" width="48px" /></a></div>
            <div class="left">
              <a href='https://www.iteye.com/blog/user/bettybetty' target='_blank' title='aliceatah'>aliceatah</a>
            </div>
          </div>
          
          <div class="user_visit">
            <div class="logo"><a href='https://www.iteye.com/blog/user/haitanshaou' target='_blank'><img alt="a87645759的博客" class="logo" src="https://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="a87645759的博客: " width="48px" /></a></div>
            <div class="left">
              <a href='https://www.iteye.com/blog/user/haitanshaou' target='_blank' title='a87645759'>a87645759</a>
            </div>
          </div>
          
        </div>

        <div id="user_title_list" class="clearfix">
          <h5>博主相关</h5>
          <li>
            <a href="https://www.iteye.com/blog/user/jianshi-dlw">博客</a>
          </li>

          <li>
            <a href="/weibo">微博</a>
          </li>

          <li>
            <a href="/album">相册</a>
          </li>

          <li>
            <a href="/link">收藏</a>
          </li>

          <li>
            <a href="/blog/guest_book">留言</a>
          </li>

          <li>
            <a href="/blog/profile">关于我</a>
          </li>
        </div>

        

                <div id="blog_menu">
          <h5>文章分类</h5>
          <ul>
            <li>
              <a href="/">全部博客 (111)</a>
            </li>
            
            <li>
              <a href="/category/178210">Java (3)</a>
              </li>
              
            <li>
              <a href="/category/178782">JVM (7)</a>
              </li>
              
            <li>
              <a href="/category/178208">Oracle (3)</a>
              </li>
              
            <li>
              <a href="/category/178211">Linux (6)</a>
              </li>
              
            <li>
              <a href="/category/178209">MySQL (0)</a>
              </li>
              
            <li>
              <a href="/category/179378">Spring (1)</a>
              </li>
              
            <li>
              <a href="/category/179380">Ibatis (0)</a>
              </li>
              
            <li>
              <a href="/category/178279">JavaScript (0)</a>
              </li>
              
            <li>
              <a href="/category/178275">Eclipse (0)</a>
              </li>
              
            <li>
              <a href="/category/178278">Tomcat (0)</a>
              </li>
              
            <li>
              <a href="/category/178277">Jboss (0)</a>
              </li>
              
            <li>
              <a href="/category/178267">Nginx (0)</a>
              </li>
              
            <li>
              <a href="/category/178215">Python (0)</a>
              </li>
              
            <li>
              <a href="/category/178212">LDAP (1)</a>
              </li>
              
            <li>
              <a href="/category/178213">Document (86)</a>
              </li>
              
            <li>
              <a href="/category/179374">技术积累 (4)</a>
              </li>
              
          </ul>
        </div>
        <div id='month_blogs'>
          <h5>社区版块</h5>
          <ul>
            <li>
              <a href="/blog/news">我的资讯</a> (
              0)</li>
            <li>
              <a href="/blog/post">我的论坛</a> (
              0)
            </li>
            <li>
              <a href="/blog/answered_problems">我的问答</a> (
              0)</li>
          </ul>
        </div>
        <div id="month_blogs">
          <h5>存档分类</h5>
          <ul>
            
            <li>
              <a href="/blog/monthblog/2013-07">2013-07</a>
              (
              1)</li>
            
            <li>
              <a href="/blog/monthblog/2013-05">2013-05</a>
              (
              1)</li>
            
            <li>
              <a href="/blog/monthblog/2012-08">2012-08</a>
              (
              4)</li>
            
            <li>
              <a href="/blog/monthblog_more">更多存档...</a>
            </li>
          </ul>
        </div>
        
        

        <div id="guest_books">
          <h5>最新评论</h5>
          <ul>
            
            <li>
              <a href='https://www.iteye.com/blog/user/me-' target='_blank' title='me-'>me-</a>：
                    <br />
              <a href="/blog/1557846#bc2389271">OpenLDAP学习笔记</a>
            </li>
            
            <li>
              <a href='https://www.iteye.com/blog/user/itfanr' target='_blank' title='itfanr'>itfanr</a>：
              非常好的文章！感谢！<br />
              <a href="/blog/1557846#bc2387735">OpenLDAP学习笔记</a>
            </li>
            
            <li>
              <a href='https://www.iteye.com/blog/user/zouwenjie00' target='_blank' title='zouwenjie00'>zouwenjie00</a>：
              写的太好了 ，对初学者入门很有帮助。 <br />
              <a href="/blog/1557846#bc2386997">OpenLDAP学习笔记</a>
            </li>
            
            <li>
              <a href='https://www.iteye.com/blog/user/delver-si' target='_blank' title='Delver_Si'>Delver_Si</a>：
              好文<br />
              <a href="/blog/1179834#bc2362611">java集合框架</a>
            </li>
            
            <li>
              <a href='https://www.iteye.com/blog/user/772646377' target='_blank' title='772646377'>772646377</a>：
              好文 mark<br />
              <a href="/blog/1179834#bc2358636">java集合框架</a>
            </li>
            
          </ul>
        </div>

        <div class="local_bottom"></div>
        
        <div id="nav_show_top_stop">
            <div>
              <!-- 广告位：PC端-iteye博客详情页左侧Button1-200*200 -->
              
              <!-- Ads ID 423 -->
              
                <div style="text-align: center">
                  <div id="kp_box_423" data-pid="423"><iframe  src="https://adaccount.csdn.net/#/preview/586?m=ncLDEiAAbUAASLttHcLiUESAEtLLbmpAHALpcDLnttUcpAEtLEHbtfDiSnUAEJEbpHvmXSHQEELLEJpiWEnnpcSbASbbiHEcQtnQ&k=" frameborder="0" width= "300px"  height= "250px" scrolling="no" ></iframe><img class="pre-img-lasy" data-src="https://kunyu.csdn.net/1.png?d=2&k=&m=ncLDEiAAbUAASLttHcLiUESAEtLLbmpAHALpcDLnttUcpAEtLEHbtfDiSnUAEJEbpHvmXSHQEELLEJpiWEnnpcSbASbbiHEcQtnQ"></div>
                </div>
              
            </div>
            <div>
              <!-- 广告位：PC端-iteye博客详情页左侧Button2-200*200 -->
              
              <!-- Ads ID 424 -->
              
                <div style="text-align: center">
                  <div id="kp_box_424" data-pid="424"><iframe  src="https://adaccount.csdn.net/#/preview/596?m=tJtAcviAUbtLHAbpbiALbbEtbtEcoAninbbLpJSbDHcLSLDLLALUmnLnHiEfDLpELEfiASHbvbAoLXHEJQJALLWStEppcHcJSQSQ&k=" frameborder="0" width= "300px"  height= "250px" scrolling="no" ></iframe><img class="pre-img-lasy" data-src="https://kunyu.csdn.net/1.png?d=2&k=&m=tJtAcviAUbtLHAbpbiALbbEtbtEcoAninbbLpJSbDHcLSLDLLALUmnLnHiEfDLpELEfiASHbvbAoLXHEJQJALLWStEppcHcJSQSQ"></div>
                </div>
              
            </div>
          </div>
      </div>
      
      <div id="main" class="not_exist_right_recommend">
        



        


<div class="h-entry" style='display:none'>
  <a href="https://www.iteye.com/blog/user/jianshi-dlw" class="p-author" target="_blank">lewis122</a>
</div>


<div class="blog_main">
  <script type="application/ld+json">
    {
        "@context": "https://zhanzhang.baidu.com/contexts/cambrian.jsonld",
        "@id": "http://www.iteye.com/blog/jianshi-dlw-1557846",
        "title": "OpenLDAP学习笔记",
        "images": [],
        "description": "",
        "pubDate": "2012-06-11T19:15:59"
    }
  </script>
  <div class="blog_title">
    <h3>
      OpenLDAP学习笔记
      <em class="actions">      </em>
    </h3>
    <ul class='blog_categories'><strong>博客分类：</strong> <li><a href="/category/178212">LDAP</a></li> </ul>
        <div class='news_tag'>&nbsp;</div>
  </div>

  <div id="blog_content" class="hide-main-content">
    <div class="hide-article-box text-center">
      <a class="btn" id="btn-readmore">阅读更多</a>
    </div>
    <p><span style="font-size: medium;"><strong>LDAP协议</strong>
</span>
</p>
<p> </p>
<p>      目录是一组具有类似属性、以一定逻辑和层次组合的信息。常见的例子是通讯簿，由以字母顺序排列的名字、地址和电话号码组成。<br>
目录服务是一种在分布式环境中发现目标的方法。目录具有两个主要组成部分：</p>
<p> </p>
<ul>
<li>第一部分是数据库，数据库是分布式的，且拥有一个描述数据的规划。</li>
<li>第二部分则是访问和处理数据的各种协议。</li>
</ul>
<p>      目录服务其实也是一种数据库系统，只是这种数据库是一种树形结构，而不是通常使用的关系数据库。目录服务与关系数据库之间的主要区别在于：二者都允许对存储数据进行访问，只是目录主要用于读取，其查询的效率很高，而关系数据库则是为读写而设计的。<br><em>提示：目录服务不适于进行频繁的更新，属于典型的分布式结构。</em>
<br>
      LDAP是一个目录服务协议，目前存在众多版本的LDAP，而最常见的则是V2和V3两个版本，它们分别于1995年和1997年首次发布。</p>
<p><span style="font-size: medium;"><strong>LDAP的基本模型</strong>
</span>
</p>
<p><br>
      LDAP的基本模型是建立在“条目”（Entry）的基础上。一个条目是一个或多个属性的集合，并且具有一个全局唯一的“可区分名称”（用dn表示）。与关系型数据（后面简称数据库）进行类比，一个条目相当于数据库中的一条记录，而dn相当于数据库中记录的关键字，属性相当于数据库中的字段。<br><em>提示：dn必须是全局唯一的。</em>
<br>
      LDAP中，将数据组织成一个树形结构，这与现实生活中的很多数据结构可以对应起来，而不像设计关系型数据库的表，需要进行多种变化。例如，图1-1所示就是一个树形结构的数据。</p>
<p><img height="371" alt="" src="http://dl.iteye.com/upload/picture/pic/114114/29b541f2-d1cc-3edb-a887-31ed439ab6ef.jpg" width="739"></p>
<p> </p>
<p>      在图1-1所示的树形结构中，树的根结点是一个组织的域名（dlw.com），其下分为3个部分，分别是managers、people和group，可将这3个组看作组织中的3个部门，如managers用来管理所有管理人员，people用来管理登录系统的用户，group用来管理系统中的用户组。当然，在该图中还可继续增加其他分支。<br>
      对于图1-1所示的树形结构，使用关系数据库来保存数据的话，需要设置多个表，一层一层分别保存，当需要查找某个信息时，再逐层进行查询，最终得到结果。<br>
      若使用目录来保存该图中的数据，则更直观。图中每个结点用一个条目来保存，不同类型的结点需要保存的数据可能不同，在LDAP中通过一个称为objectClass的类型来控制不同结点需要的数据（称为属性）。<br>
      对于目录中的数据怎样进行引用呢？前面提到过，每一个条目都有一个dn，因为dn是唯一的，因此就可找到需要结点的数据。dn的构造方式如下：<br>
      首先得到条目自己的名称（rdn，称为相对dn），然后开始向上逐级查找父结点，一直到根项为止。例如，对于图1-1中最右下方的结点，其dn为：</p>
<pre class="python" name="code">dn: cn=ldap, ou=group, o=dlw.com</pre>
 
<p>      通过这样的方式，即可唯一标识每一个结点。<br>
      在现实生活中，有很多这种树形结构的数据，如计算机文件系统的目录结构、Internet中的域名等。这些类型的数据，只要不需要频繁的更新，都适合用目录来保存。</p>
<p><span style="font-size: medium;"><strong>LDAP的功能</strong>
</span>
</p>
<p><br>
在LDAP的功能模型中定义了一系列利用LDAP协议的操作，主要包含以下4部分：</p>
<p> </p>
<ul>
<li>
<strong>查询操作</strong>
：允许查询目录和取得数据，其查询性能比关系数据库好。</li>
<li>
<strong>更新操作</strong>
：目录的更新操作没关系数据库方便，更新性能较差，但也同样允许进行添加、删除、修改等操作。</li>
<li>
<strong>复制操作</strong>
：前面也提到过，LDAP是一种典型的分布式结构，提供复制操作，可将主服务器的数据的更新复制到设置的从服务器中。</li>
<li>
<strong>认证和管理操作</strong>
：允许客户端在目录中识别自己，并且能够控制一个会话的性质。</li>
</ul>
<p> </p>
<p><span style="font-size: medium;"><strong>LDAP协议的特点</strong>
</span>
</p>
<p> </p>
<ul>
<li>LDAP是一种目录服务，保存在特殊的数据库中，数据的读取速度远高于写入速度。</li>
<li>LDAP对查询做了优化，读取速度优于普通关系数据库。</li>
<li>LDAP不支持事务、不能进行回滚，需要进行这些操作的应用只有选择关系数据库。</li>
<li>LDAP采用服务器/客户端模式，支持分布式结构。</li>
<li>LDAP中的条目以树形结构组织和存储。</li>
<li>LDAP基于Internet协议，直接运行在简单和通用的TCP/IP或其他可靠的传输协议层上，使连接的建立和包的处理简单、快捷，对于互联网和企业网应用都很方便。</li>
<li>LDAP协议简单，通过使用查找操作实现列表操作和读操作。</li>
<li>LDAP通过引用机制实现分布式访问，通过客户端API实现分布式操作（对于应用透明），平衡了负载。</li>
<li>LDAP实现具有低费用、易配置和易管理的特点，并提供了满足应用程序对目录服务所需求的特性。</li>
</ul>
<p> </p>
<p><span style="font-size: medium;"><strong>安装OpenLDAP</strong>
</span>
</p>
<p><br>
      在RHEL 5的安装光盘中提供了OpenLDAP 2.3.27软件包，通过OpenLDAP软件可实现LDAP服务。OpenLDAP程序包括客户端、服务器、开发工具包等软件包，本节将介绍安装这些程序包的具体过程。</p>
<p> </p>
<p>      可以先通过rpm命令查询系统中是否已安装OpenLDAP服务器程序，若未安装该服务器程序，再使用rpm命令从RHEL光盘中安装该程序。<br>
从RHEL 5安装光盘中找到OpenLDAP服务器程序，并安装到当前系统中。<br>
具体操作步骤如下：<br>
（1）在进行安装以前，首先使用以下命令创建管理OpenLDAP的用户和组。</p>
<p> </p>
<pre class="python" name="code"># groupadd ldap
# useradd -g ldap ldap
# passwd ldap</pre>
 
<p>（2）执行以下命令，查询系统中是否已安装openldap-servers程序。</p>
<p> </p>
<pre class="python" name="code"># rpm -qa openldap-servers</pre>
<p> 若无任何输出，则表示当前系统中未安装openldap-servers服务器程序。</p>
<p> </p>
<p>（3）使用以下命令将RHEL安装光盘挂载到系统中：</p>
<p> </p>
<pre class="python" name="code"># mount /dev/cdrom /mnt/cdrom</pre>
 
<p>（4）执行以下命令安装openldap-servers程序的依赖程序包libtools-ltdl：</p>
<p> </p>
<pre class="python" name="code"># rpm -ivh /mnt/cdrom/Server/libtool-ltdl-1.5.22-6.1.i386.rpm</pre>
<p> 若不执行上面的命令，直接执行下一步的安装命令，将提示有依赖程序未安装。</p>
<p> </p>
<p>（5）执行以下命令安装openldap-servers程序：</p>
<p> </p>
<pre class="python" name="code"># rpm -ivh /mnt/cdrom/Server/openldap-servers-2.3.27-5.i386.rpm</pre>
 
<p>这样就将openldap-servers服务器程序安装到系统中了。整个安装过程如下图所示。</p>
<p> </p>
<p><img height="478" alt="" src="http://dl.iteye.com/upload/picture/pic/114116/b327a93c-bd49-3970-80d1-6192bc978d36.jpg" width="774"></p>
<p> </p>
<p>（6）使用以下命令修改保存数据的目录/var/lib/ldap/及其文件的所有者，并修改权限，只有ldap用户才对数据有读写权限：</p>
<p> </p>
<pre class="python" name="code"># chown ldap.ldap /var/lib/ldap
# chmod -R 600 /var/lib/ldap</pre>
 
<p>在光盘中还有以下与openldap有关的软件包，也可使用类似命令进行安装，这里不再逐个介绍。<br>
  ● openldap-clients-2.3.27-5.i386.rpm：客户端操作的相关程序。<br>
  ● openldap-devel-2.3.27-5.i386.rpm：开发包。</p>
<p><span style="font-size: medium;"><strong><br></strong>
</span>
</p>
<p><span style="font-size: medium;"><strong>测试安装正确性</strong>
</span>
</p>
<p><br>
      安装完成后，将在/var/lib/目录中创建一个子目录ldap来保存数据，同时在/etc/目录中也将创建一个子目录openldap来保存配置文件。而openldap的守护进程slapd则保存在/usr/bin/目录中。<br><em>提示：如果是通过源代码进行编译安装的openldap，这些程序文件放置的位置可能不同。</em>
</p>
<p><strong>1．启动服务进程</strong>
<br>
      要检查安装是否正确，可直接运行守护进程，这里将使用默认的配置。<br>
      启动OpenLDAP服务器可使用以下命令之一：</p>
<p> </p>
<pre class="python" name="code"># server ldap start
# /etc/rc.d/init.d/ldap
# /usr/sbin/slapd</pre>
 
<p>使用第1条命令来启动ldap服务进程的过程如下图所示。</p>
<p> </p>
<p><img height="738" alt="" src="http://dl.iteye.com/upload/picture/pic/114118/8d70a257-1b41-392b-aa01-864c086c5430.png" width="873"></p>
<p> </p>
<p><em>提示：使用/usr/sbin/slapd命令启动服务程序是最好的一种方式，如果用前两条命令启动openldap服务程序失败，可使用最后一条命令试一下。</em>
</p>
<p> </p>
<p>      从上图可看出，启动的是slapd进程，并有一个提示信息，提示没有DB_CONFIG文件。可通过以下命令将DB_CONFIG文件复制到/var/lib/ldap/目录中：</p>
<p> </p>
<pre class="python" name="code"># cp /etc/openldap/DB_CONFIG.example /var/lib/ldap/DB_CONFIG</pre>
 
<p>另外，由于使用的是默认配置文件，提示希望使用后缀“dc=my-domain, dc=com”。下节将介绍修改配置文件的操作。</p>
<p> </p>
<p><strong>2．查看监听端口</strong>
<br>
      OpenLDAP使用的监听端口是389，通过netstat命令查看该端口是否处于监听状态，可了解slapd进程是否在工作。具体命令如下：</p>
<p> </p>
<pre class="python" name="code"># netstat –tnlp | grep 389</pre>
 
<p>执行结果如下图所示，可以看出，389端口处于监听状态，表示slapd进程正在工作。</p>
<p> </p>
<p><img height="50" alt="" src="http://dl.iteye.com/upload/picture/pic/114120/e09d4aef-7350-3c8f-8c2b-437b705eccf9.jpg" width="722"></p>
<p> </p>
<p><strong>3．搜索测试</strong>
<br>
      slapd服务进程启动后，可使用OpenLDAP客户端的一个搜索命令进行一次搜索，以检查服务的配置是否正确。<br>
      使用以下命令进行搜索：</p>
<p> </p>
<pre class="python" name="code"># ldapsearch -x -b '' -s base '(objectclass=*)'</pre>
 
<p><em>注意：-b后面是两个单引号，用来阻止特殊字符被Shell解析。</em>
</p>
<p> </p>
<p>      由于还未向LDAP服务器中添加任何数据，因此，系统中应该只有“根”这个条目，执行以上搜索的结果如下图所示。</p>
<p><img height="418" alt="" src="http://dl.iteye.com/upload/picture/pic/114122/e594a188-6a35-3e70-86e1-b3a59a16a378.jpg" width="563"></p>
<p> </p>
<p>从以上测试可看出，OpenLDAP已经正确安装到系统中，接下来就需要修改配置文件，设置LDAP的根目录了。</p>
<p> </p>
<p> </p>
<p><span style="font-size: medium;"><strong>配置OpenLDAP</strong>
</span>
</p>
<p> </p>
<p>      在上面的例子中的搜索结果可看出，在配置文件中是以默认的“dc=my-domain, dc=com”作为后缀，需要对其进行修改，当然也还需要修改其他的一些配置。下面将介绍对配置文件的修改操作。</p>
<p><span style="font-size: medium;"><strong>slapd.conf</strong>
</span>
</p>
<p><br>
      OpenLDAP的配置文件位于/etc/openldap/目录中，名称为slapd.conf。该文件内容较多，通常只需要修改几个地方即可，包括修改后缀、管理员及其密码。其初始内容如下：</p>
<p> </p>
<pre class="python" name="code">#######################################################################
# ldbm and/or bdb database definitions
#######################################################################

database        bdb
suffix          "dc=my-domain,dc=com"
rootdn          "cn=Manager,dc=my-domain,dc=com"
# Cleartext passwords, especially for the rootdn, should
# be avoided.  See slappasswd(8) and slapd.conf(5) for details.
# Use of strong authentication encouraged.
# rootpw                secret
# rootpw                {crypt}ijFYNcSNctBYg</pre>
 
<p>其中各语句的含义如下：<br>
  ● 以符号“#”开始的行是注释行，第1～3行、第8～12行都是。<br>
  ● 第5行设置数据库，可使用ldbm或bdb。<br>
  ● 第6行设置后缀。<br>
  ● 第7行设置超级管理员的名称，与Linux系统中的root类似。在配置时用该用户，配置完成后，建议将其删除。<br>
  ● 第11行设置超级管理员的密码，默认状态是被注释了的。这行的密码是明文状态。<br>
  ● 第12行也是设置超级管理员的密码，这行是以加密方式设置的（默认状态也是被注释了的）。<br>
根据实际情况，修改第6、7、11行即可，具体如下：</p>
<pre class="python" name="code">#######################################################################
# ldbm and/or bdb database definitions
#######################################################################

database        bdb
suffix          "dc=dlw,dc=com"
rootdn          "cn=root,dc=dlw,dc=com"
# Cleartext passwords, especially for the rootdn, should
# be avoided.  See slappasswd(8) and slapd.conf(5) for details.
# Use of strong authentication encouraged.
rootpw  secret
# rootpw  {crypt}ijFYNcSNctBYg</pre>
 
<p>      以上内容中，第6行将后缀修改为“dc=dlw,dc=com”，同时第7行的超级管理员的后缀部分也需要随之修改。将第11行的注释取消，设置超级管理员的密码为MD5密码secret。<br>
      <span style="color: #ff0000;">修改密码时需要注意rootpw前面不要有空格，以及rootpw与密码之间使用Tab键分割。</span>
<br>
      经过以上修改，保存后退出，接着使用以下命令重启slapd进程：</p>
<p> </p>
<pre class="python" name="code"># service ldap restart</pre>
 
<p><span style="font-size: medium;"><strong>了解schema</strong>
</span>
</p>
<p><br>
      对于LDAP目录中保存的信息，可以使用LDIF（LDAP Interchange Format）格式来保存。这是一种标准文本文件格式，使用这种格式保存得的LDAP服务器数据库中的数据可方便读取和修改，这也是其他大多数服务配置文件所采取的格式。<br>
      LDIF文件常用来向目录导入或更改记录信息，这些信息需要按照LDAP中schema的格式进行组织，并会接受schema的检查，不符合其要求的格式将会出现报错信息。有关LDIF文件的格式和创建将在第4章进行介绍，这里简单介绍一下组织LDAP数据格式的schema文件。<br>
      在LDAP中，schema用来指定一个目录中所包含的对象（objects）的类型（objectClass），以及每一个类型（objectClass）中必须提供的属性（Atrribute）和可选的属性。可将schema理解为面向对象程序设计中的类，通过类定义一个具体的对象。LDIF中的数据条目可理解为是一个具体的对象，是通过schema来规划创建的。因此，schema是一个数据模型，用来决定数据按什么方式存储，并定义存储在不同的条目（Entry）下的数据之间的关系。schema需要在主配置文件slapd.conf中指定，以用来决定在目录中可以使用哪些objectClass。<br>
      在/etc/openldap/schema/目录中提供了许多schema文件，只需要在配置文件slapd.conf中使用include命令将需要使用的schema包含即可。例如，配置文件默认包含了以下schema文件：</p>
<p> </p>
<div class="quote_title"> 写道</div>
<div class="quote_div">include         /etc/openldap/schema/core.schema<br>
include         /etc/openldap/schema/cosine.schema<br>
include         /etc/openldap/schema/inetorgperson.schema<br>
include         /etc/openldap/schema/nis.schema </div>
 
<p><em>提示：通常使用系统提供的schema就可解决大部分应用。管理员也可以自己设计制定schema，一般包括属性定义（AttributeDefinition）、类定义（ClassDefinition）以及语法定义（SyntaxDefinition）等部分。这里就不介绍具体的设计方法了。</em>
</p>
<p> </p>
<p><span style="font-size: medium;"><strong>管理OpenLDAP</strong>
</span>
</p>
<p><br>
      启动OpenLDAP服务器程序之后，接下来的操作就是通过客户端程序对目录进行操作，包括添加、修改、删除和搜索数据等操作。能对LDAP进行操作的客户端程序很多，下面简单介绍在Linux命令方式下进行这些操作的方法。</p>
<p> </p>
<p><span style="font-size: medium;"><strong>向目录数据库中添加数据</strong>
</span>
</p>
<p><br>
      初始状态下，LDAP是一个空目录，即没有任何数据。可通过程序代码向目录数据库中添加数据，也可使用OpenLDAP客户端工具ldapadd命令来完成添加数据的操作，该命令可将一个LDIF文件中的条目添加到目录。因此，需要首先创建一个LDIF文件，然后再进行添加操作。</p>
<p> </p>
<p><strong>1．LDIF文本条目格式</strong>
</p>
<p> </p>
<p>      LDIF用文本格式表示目录数据库的信息，以方便用户创建、阅读和修改。在LDIF文件中，一个条目的基本格式如下：</p>
<div class="quote_title"> 写道</div>
<div class="quote_div"># 注释<br>
dn: 条目名<br>
属性描述: 值<br>
属性描述: 值<br>
属性描述: 值<br>
... ...</div>
 
<p>      dn行类似于关系数据库中一条记录的关键字，不能与其他dn重复。一个LDIF文件中可以包含多个条目，每个条目之间用一个空行分隔。<br>
      例如，以下内容组成一个条目：</p>
<div class="quote_title"> 写道</div>
<div class="quote_div">1:      dn: dc=dlw, dc=com<br>
2:      objectclass: top<br>
3:      objectclass: dcobject<br>
4:      objectclass: organization<br>
5:      dc: dlw<br>
6:      o: dlw,Inc.</div>
 
<p>在以上文本中，各行含义如下：</p>
<p> </p>
<ul>
<li>第1行的dn定义该条目的标识。</li>
<li>第2～4行定义该条目的objectcCass，可以定义多个属性，如上面代码中定义了3个objectClass。条目的属性根据objectClass的不同而不同，有的objectClass有必须设置的属性。在2～4行的3个objectClass中，top没有必须定义的属性，dcobject必须定义属性dc，用来表示一个域名的部分，而organization必须定义属性o，用来表示一个组织的名称。</li>
<li>根据objectClass的要求，第5、6行分别定义属性dc和属性o的值。</li>
</ul>
<p><span style="font-size: x-small;"><strong>2.了解objectClass</strong>
</span>
</p>
<p><br>
      LDAP中，一个条目必须包含一个objectClass属性，且需要赋予至少一个值。每一个值将用作一条LDAP条目进行数据存储的模板；模板中包含了一个条目必须被赋值的属性和可选的属性。<br>
      objectClass有着严格的等级之分，最顶层是top和alias。例如，organizationalPerson这个objectClass就隶属于person，而person又隶属于top。</p>
<p> </p>
<p>      objectClass可分为以下3类：</p>
<ul>
<li>
<strong>结构型（Structural）</strong>
：如person和organizationUnit；</li>
</ul>
<ul>
<li>
<strong>辅助型（Auxiliary）</strong>
：如extensibeObject；</li>
</ul>
<ul>
<li>
<strong>抽象型（Abstract）</strong>
：如top，抽象型的objectClass不能直接使用。<br>
</li>
</ul>
<p>在OpenLDAP的schema中定义了很多objectClass，下面列出部分常用的objectClass的名称。<br>
  ● account<br>
  ● alias<br>
  ● dcobject<br>
  ● domain<br>
  ● ipHost<br>
  ● organization<br>
  ● organizationalRole<br>
  ● organizationalUnit<br>
  ● person<br>
  ● organizationalPerson<br>
  ● inetOrgPerson<br>
  ● residentialPerson<br>
  ● posixAccount<br>
  ● posixGroup</p>
<p> </p>
<p><span style="font-size: x-small;"><strong>3.了解Attribute</strong>
</span>
</p>
<p><br>
      属性（Attribute）类似于程序设计中的变量，可以被赋值。在OpenLDAP中声明了许多常用的Attribute（用户也可自己定义Attribute）。常见的Attribute含义如下：<br>
  ● c：国家。<br>
  ● cn：common name，指一个对象的名字。如果指人，需要使用其全名。<br>
  ● dc：domain Component，常用来指一个域名的一部分。<br>
  ● givenName：指一个人的名字，不能用来指姓。<br>
  ● l：指一个地名，如一个城市或者其他地理区域的名字。<br>
  ● mail：电子信箱地址。<br>
  ● o：organizationName，指一个组织的名字。<br>
  ● ou：organizationalUnitName，指一个组织单元的名字。<br>
  ● sn：surname，指一个人的姓。<br>
  ● telephoneNumber：电话号码，应该带有所在的国家的代码。<br>
  ● uid：userid，通常指某个用户的登录名，与Linux系统中用户的uid不同。</p>
<p> </p>
<p><em>提示：objectClass是一种特殊的Attribute，它包含其他用到的Attribute以及其自身。</em>
</p>
<p> </p>
<p>      对于不同的objectClass，通常具有一些必设属性值和一些可选属性值。例如，可使用person这个objectClass来表示系统中一个用户的条目，对于系统中用户通常需要有这样一些信息：姓名、电话、密码、描述等。如下图所示，对于person，通过cn和sn设置用户的名和姓，这是必须设置的，而其他属性则是可选的。</p>
<p> </p>
<p style="text-align: center;"><img height="489" alt="" src="http://dl.iteye.com/upload/picture/pic/114124/65f42f0a-510b-385e-b91b-0d0d7b2e3f5d.jpg" width="343"></p>
<p> </p>
<p>下面列出部分常用objectClass要求必设的属性。<br>
  ● account：userid。<br>
  ● organization：o。<br>
  ● person：cn和sn。<br>
  ● organizationalPerson：与person相同。<br>
  ● organizationalRole：cn。<br>
  ● organizationUnit：ou。<br>
  ● posixGroup：cn、gidNumber。<br>
  ● posixAccount：cn、gidNumber、homeDirectory、uid、uidNumber。</p>
<p><span style="font-size: x-small;"><strong>4.创建LDIF文件</strong>
</span>
</p>
<p><br>
      对以上内容有一定了解之后，就可以编写输入LDIF文件，编辑需要向目录数据库添加的条目了。<br>
      下面根据如下图所示的结构，创建LDIF文件dlw.com.ldif。</p>
<p> </p>
<p style="text-align: center;"><img height="405" alt="" src="http://dl.iteye.com/upload/picture/pic/114126/246430d2-db1b-36a8-a01b-a9a630abc7b1.jpg" width="525"></p>
<p> </p>
<p>      对上图进行分析，该目录结构分为3层，有4个结点。根据上图可创建LDIF文件如下：<br><em>提示：每个结点可用一个dn表示，对于每个结点，又可继续添加新的结点。如在根结点中可添加其他部门ou，在ou=managers结点也可继续添加其他管理人员的信息。</em>
</p>
<p> </p>
<div class="quote_title"> 写道</div>
<div class="quote_div">1:      dn:dc=dlw,dc=com<br>
2:      objectclass:top<br>
3:      objectclass:dcobject<br>
4:      objectclass:organization<br>
5:      dc:dlw<br>
6:      o:dlw,Inc.<br>
7:      <br>
8:      dn:ou=managers, dc=dlw, dc=com<br>
9:      ou:managers<br>
10:     objectclass:organizationalUnit<br>
11:<br>
12:     dn:cn=dlw,ou=managers,dc=dlw,dc=com<br>
13:     cn:dlw<br>
14:     sn:dongliwei<br>
15:     objectclass:person<br>
16:     <br>
17:     dn:cn=test,ou=managers,dc=dlw,dc=com<br>
18:     cn:test<br>
19:     sn:Test User<br>
20:     objectclass:person</div>
 
<p>以上文件中各行的含义如下：</p>
<p> </p>
<ul>
<li>第1～6行创建根结点，这部分在前面也有介绍，就不再重复了。</li>
<li>第7、11、16行为空行，用来分隔4个dn条目（4个结点）。</li>
<li>第8～10行定义cn=managers结点的条目，该条目的objectClass为organizationalUnit，因此需要用ou属性定义组织名称。</li>
<li>第12～15行定义cn=dlw结点的条目，该条目使用的objectClass为person，因此需设置cn和sn两个属性值。</li>
<li>第17～20行与第12～15行的意义相同。</li>
</ul>
<p> </p>
<p> </p>
<p>      在以上LDIF文件中，第1、8、12、17行以dn开头，这部分内容必须唯一，并且在向目录数据库添加这些数据时，也要确保这些数据不能与目录数据库中已有数据相同，否则，添加操作将中断。</p>
<p> </p>
<p><strong>5.从LDIF文件添加到目录数据库</strong>
</p>
<p><br>
      使用OpenLDAP客户端工具ldapadd命令，可将LDIF文件中的条目添加到目录数据库中，该命令的格式如下：<br>
       <strong>ldappadd  选项  LDIF文件</strong>
<br>
      在ldappadd命令中常用的选项如下：</p>
<p> </p>
<ul>
<li>-x：进行简单认证。</li>
</ul>
<ul>
<li>-D：用来绑定服务器的dn。</li>
</ul>
<ul>
<li>-h：目录服务的地址。</li>
</ul>
<ul>
<li>-w：绑定dn的密码。</li>
</ul>
<ul>
<li>-f：使用LDIF文件进行条目添加的文件。<br>
</li>
</ul>
<p> </p>
<p>将前面编写的LDIF文件的条目数据添加到目录数据库中。<br>
具体操作步骤如下：<br><br>
（1）检查dlw.com.ldif文件中的内容，需要注意的是，每个冒号后面都需要空一格，而每行结束处不能留有空格字符。 <br>
（2）使用以下命令将dlw.com.ldif文件中的条目添加到目录中：</p>
<div class="quote_title"> 写道</div>
<div class="quote_div"># ldapadd -x -D "cn=root,dc=dlw,dc=com" -w secret -f  dlw.com.ldif</div>
 
<p>执行以上命令，如果添加操作正常完成，将显示如下图所示的提示信息，表示添加了4个条目到目录数据库中。</p>
<p> </p>
<p><img height="155" alt="" src="http://dl.iteye.com/upload/picture/pic/114128/deaadc64-d408-3001-8190-6fb8d79fd3fb.jpg" width="555"></p>
<p> </p>
<p><em>提示：如果以上命令执行不成功，需要逐个字符检查dlw.com.ldif文件中的内容，特别注意空格的问题。</em>
</p>
<p> </p>
<p><span style="font-size: medium;"><strong>查询</strong>
</span>
</p>
<p><br>
      添加到目录中的条目被保存在目录数据库，在Linux命令界面下，可使用OpenLDAP客户端工具ldapsearch命令来进行查询。该命令的格式如下：</p>
<p><br>
      <strong>ldapsearch  选项  过滤  属性值</strong>
</p>
<p><br>
常用的选项有以下几个:</p>
<p><br>
  ● -x：进行简单认证。<br>
  ● -D：用来绑定服务器的dn。<br>
  ● -w：绑定dn的密码。<br>
  ● -b：指定要查询的根节点。<br>
  ● -H：制定要查询的服务器。</p>
<p> </p>
<p>使用ldapsearch命令查询“dc=dlw, dc=com”下的所有条目，可使用以下命令：</p>
<pre class="python" name="code"># ldapsearch -x -b "dc=dlw,dc=com"</pre>
 
<p>执行结果如下图所示。</p>
<p> </p>
<p><img height="616" alt="" src="http://dl.iteye.com/upload/picture/pic/114184/fed059fb-6f12-3219-9b1b-f8fa82b1b288.png" width="385"></p>
<p> </p>
<p>而如果使用以下命令，将查询显示sn中以字符wu开头的条目，将得到如下图所示的查询结果，只找到一个条目。</p>
<p> </p>
<pre class="python" name="code"># ldapsearch -x -b 'dc=dlw,dc=com' 'sn=wu*'</pre>
 
<p><img height="399" alt="" src="http://dl.iteye.com/upload/picture/pic/114186/e8221ab7-5360-3495-9191-b39e77198381.jpg" width="541"></p>
<p> </p>
<p> </p>
<p><span style="font-size: medium;"><strong>修改条目</strong>
</span>
</p>
<p><br>
      使用OpenLDAP客户端工具ldapmodify命令可对目录数据库中的条目进行修改。该命令的格式如下：</p>
<p><br>
      <strong>ldapmodify  选项</strong>
</p>
<p><br>
      该命令的选项也很多，常用选项与ldapadd类似，这里就不再列出了。<br>
      <em>提示：使用ldapmodify命令不能修改条目的dn，但可以修改其他属性值。</em>
</p>
<p>使用ldapmodify命令修改条目信息可以有两种方式：一种是交互式进行修改，另一种是通过文件进行修改。</p>
<p><strong>1．交互式修改</strong>
</p>
<p><br>
      修改前面创建的条目“cn=test, ou=managers, dc=dlw, dc=com”，将其sn属性修改为“Test User Modify”，并添加一个description属性，设置其值为“add Attribute”。<br>
      首先输入以下命令，进行修改状态：</p>
<pre class="python" name="code"># ldapmodify -x -D "cn=root,dc=dlw,dc=com" -W secret</pre>
 
<p>执行以上命令后，终端将等候用户输入需要修改条目的dn，输入以下内容：</p>
<p> </p>
<pre class="python" name="code">dn: cn=test, ou=managers, dc=dlw, dc=com
changetype: modify
replace: sn
sn: Test User Modify</pre>
 
<p>      以上输入内容中，第1行查找需要修改的条目，第2行设置修改模式，第3行设置需要替换的属性sn，第4行给属性sn重新设置一个值，替换该属性原有的值。<br>
      输入完以上内容之后再按Enter键，程序将按以上设置更新数据，然后按Ctrl+C键退出修改命令。执行过程如下图所示。</p>
<p><img height="200" alt="" src="http://dl.iteye.com/upload/picture/pic/114188/34f60da4-6296-3dce-ba50-60dbebcdd72a.jpg" width="563"></p>
<p> </p>
<p>使用以上命令修改条目的数据之后，可使用以下命令查看是否修改成功：</p>
<p> </p>
<pre class="python" name="code">#ldapsearch -x -b 'dc=dlw,dc=com' 'cn=test'</pre>
 
<p>执行以上命令查看test条目的数据如下图所示，可以看到sn属性被修改了。</p>
<p> </p>
<p><img height="398" alt="" src="http://dl.iteye.com/upload/picture/pic/114190/cdbab192-8a6d-3c86-a5aa-8ae1b31bca3b.jpg" width="553"></p>
<p> </p>
<p><strong>2．通过文件修改</strong>
</p>
<p><br>
    通过前面的方式对条目进行修改时，很不方便，如果在交互方式时输错了某个字符，只能中断命令后重新进行修改。因此，更好的修改方法是首先将修改时输入的文字保存到一个文件中，然后以该文件作为输入进行修改。用这种方式进行操作，首先需要创建一个临时文件，用来保存需要进行的修改操作，下面演示这种方式的修改过程。</p>
<p><strong>【例子】</strong>
 通过修改命令将前面LDAP数据库中的信息还原，即将sn属性由“Test User Modify”修改为“Test User”。<br>
具体操作步骤如下：<br>
（1）使用vi编辑器创建一个文件modify，在其中输入以下内容：</p>
<pre class="python" name="code">dn: cn=test,ou=managers,dc=dlw,dc=com
changetype: modify
replace: sn
sn: Test User</pre>
<p> 从以上输入内容可看到，与在交互式时输入的内容完全相同。<br><em>技巧：使用文件方式修改条目，可方便修改和检查，若某个地方有输入错误，可修改后再调用ldapmodify进行修改，减少输入量。</em>
</p>
<p>（2）使用以下命令调用modify的内容进行修改：</p>
<p> </p>
<pre class="python" name="code"># ldapmodify -x -D "cn=root,dc=dlw,dc=com" -w secret -f modify</pre>
 
<p>执行结果如下图所示。</p>
<p> </p>
<p><img height="469" alt="" src="http://dl.iteye.com/upload/picture/pic/114192/0b70127d-d6c6-33d8-93fb-99f2c199fa13.png" width="517"></p>
<p> </p>
<p><span style="font-size: medium;"><strong>删除条目</strong>
</span>
</p>
<p><br>
      对于目录数据库中不用的条目，也可使用ldapdelete命令将其删除。该命令的格式如下：</p>
<p><br>
      <strong>ldapdelete  选项  删除条目</strong>
</p>
<p><br>
      该命令使用的选项与ldapadd类似，就不再列出来了。<br>
      删除目录数据库中的“cn=test,ou=managers,dc=dlw,dc=com”条目，具体命令如下：</p>
<p> </p>
<pre class="python" name="code"># ldapdelete -x -D "cn=root,dc=dlw,dc=com" -w secret \
&gt; "cn=test,ou=managers,dc=dlw,dc=com"</pre>
 
<p>      顺利执行以上命令后，终端上将不会有任何信息输出，表示完成了删除操作。<br>
      使用ldapdelete命令只能删除树形结构中的叶结点条目，如果删除非叶结点条目，将出现错误提示。例如，执行以下命令删除根结点“dc=dlw,dc=com”，由于根结点下面还有结点，将显示如下图所示的错误提示信息：</p>
<p> </p>
<p><img height="94" alt="" src="http://dl.iteye.com/upload/picture/pic/114194/8a70ba09-5e79-3b61-87b0-a6ad9dda6a22.jpg" width="654"></p>
<p> </p>
<pre class="python" name="code"># ldapdelete -x -D "cn=root,dc=dlw,dc=com" -w secret "dc=dlw,dc=com"</pre>
 
<p><span style="font-size: medium;"><strong>数据导出</strong>
</span>
</p>
<p><br>
      通过ldapadd命令可向目录数据库中添加数据，在某些情况下，可能还需要进行反向操作，即将目录数据库中的数据导出。<br>
      使用ldapsearch命令对目录数据库进行搜索，然后通过重定向将搜索结果保存到一个文件中，可达到导出数据的目的。另外，导出数据更常用的是slapcat命令，该命令的格式如下：</p>
<p><br>
      <strong>slapcat  选项</strong>
</p>
<p><br>
      最常用的选项就是-l，表示导出为LDIF文件格式。<br>
      如将本章前面例子中创建的目录数据库导出为export.ldif文件，可使用以下命令：</p>
<p> </p>
<pre class="python" name="code">#slapcat -l export.ldif</pre>
 
<p>      执行以上命令将在当前工作目录得到文件export.ldif，打开文件将显示如下图所示的内容：</p>
<p> </p>
<p><img height="817" alt="" src="http://dl.iteye.com/upload/picture/pic/114196/22b92164-638c-3cd6-8c4f-e63c188272a7.png" width="352"></p>
<p> </p>
<p><em>提示：从导出结果可看出，除了使用ldapadd命令添加到目录数据库中的条目数据外，还导出了很多其他信息，包括条目录UUID、时间戳等信息。</em>
</p>
<p> </p>
<p> </p>
<p><span style="font-size: medium;"><strong>设置主从LDAP服务器</strong>
</span>
</p>
<p><br>
      在某些时候，为了对LDAP服务器进行负载均衡，可能希望设置多台LDAP服务器。对于设置多台LDAP服务器的关键问题是数据的同步问题，使用slurpd进程可进行主LDAP服务器向从LDAP服务器复制数据的操作。下面将介绍架设主从LDAP服务器的过程。</p>
<p> </p>
<p><strong>多台LDAP服务器工作过程</strong>
</p>
<p><br>
      对于多台LDAP服务器，可设置一台为主服务器，其他的为从服务器。本节介绍一台从服务器的配置，若是多台从服务器也可按此步骤进行操作。<br><em>注意：在进行配置之前应首先确保每个LDAP服务器都已安装好OpenLDAP服务器程序，并能正确工作。</em>
<br>
      通过本节下面介绍的方法配置好主从LDAP服务器之后，在主服务器运行slurpd进程，该进程使用LDAP协议从主服务器的数据库更新从服务器的数据，具体操作过程如下：</p>
<p><br>
（1）LDAP客户端向从服务器提交一个LDAP修改请求。<br>
（2）从服务器给LDAP客户端返回一个指向主服务器的引用。<br>
（3）LDAP客户端向主服务器提交LDAP修改请求。<br>
（4）主服务器对数据库中的数据进行修改，并将改变写入本机的日志文件。<br>
（5）在主服务器运行的slurpd进程检查到日志中有新内容，通过日志的信息将改变发送给从服务器。<br>
（6）从服务器接收slurpd发来的信息，对本地数据进行修改。</p>
<p><br>
      以上过程就是使用slurpd进程进行数据复制的过程。从以上过程可看出，需要在主服务器的配置文件中设置要向哪些从服务器发送复制信息、主服务器还要设置一个记录数据改变的日志文件，而从服务器需要设置一个指向主服务器的链接。</p>
<p><span style="font-size: medium;"><strong>复制数据库</strong>
</span>
</p>
<p><br>
首先，把主从服务器关闭。通过以下三步操作静态同步主从服务器上的数据：</p>
<p> </p>
<ul>
<li>把主服务器上/var/lib/ldap目录下的所有数据库文件全部拷贝到从服务器的同目录中，覆盖原有文件。</li>
<li>把主服务器上的/etc/ldap/schema目录下的所有schema文件拷贝到从服务器的同目录中，覆盖原有文件。</li>
<li>把主服务器上/etc/ldap/slapd.conf文件拷贝到从服务器的同目录中，覆盖原有文件。</li>
</ul>
<p> </p>
<p><span style="font-size: medium;"><strong>设置主服务器</strong>
</span>
</p>
<p><br>
配置主服务器上的slapd.conf文件，取消replogfile指令前的注释符号，取消后的结果如下：</p>
<pre class="python" name="code"># Replicas of this database
replogfile      /var/lib/ldap/replog</pre>
 
<p>增加replica指令，如：</p>
<p> </p>
<pre class="python" name="code">#replace config
replica uri=ldap://192.168.14.21:389     #指定从服务器主机名和端口号
binddn="cn=root,dc=dlw,dc=com"         #指定需同步的DN的管理员
bindmethod=simple credentials=111111  #指定验证方式和需同步的DN的管理员密码</pre>
 
<p><span style="font-size: medium;"><strong>设置从服务器</strong>
</span>
</p>
<p><br>
配置从服务器上的slapd.conf文件，增加updatedn指令，如：</p>
<p> </p>
<pre class="python" name="code">updatedn " cn=root,dc=dlw,dc=com"          #与主服务器的binddn对应</pre>
 
<p>在从服务器的配置文件中，不要包含replica和replogfile指令。</p>
<p><span style="font-size: medium;"><strong><br></strong>
</span>
</p>
<p><span style="font-size: medium;"><strong>测试主从LDAP服务器</strong>
</span>
</p>
<p><br>
经过以上步骤的操作，主从LDAP服务器都已准备好，接下来就可以测试相关操作。</p>
<p><br>
   1．启动主LDAP服务器<br>
        在主LDAP服务器中启动slapd进程和slurpd进程。<br>
   2．启动从LDAP服务器<br>
        在主LDAP服务器中启动slapd进程。</p>
<p><br>
【例子】测试主从LDAP服务器。<br>
具体操作步骤如下：</p>
<p>（1）在主LDAP服务器中使用以下命令修改一个条目：</p>
<p> </p>
<pre class="python" name="code">#ldapmodify -x -D "cn=root,dc=dlw,dc=com" -w secret</pre>
 
<p>输入以下内容，修改cn=dlw条目的内容：</p>
<p> </p>
<pre class="python" name="code">dn: cn=dlw,ou=managers,dc=dlw,dc=com
changetype: modify
replace: sn
sn: dongliwei</pre>
 
<p>输入后按Enter键完成修改，操作过程如图5-7所示（将sn修改为dongliwei）。</p>
<p> </p>
<p><img height="187" alt="" src="http://dl.iteye.com/upload/picture/pic/114198/7ec2c172-04fd-3747-8448-37b4c967703e.jpg" width="636"></p>
<p> </p>
<p>（2）在从LDAP服务器中进行操作，查看主LDAP服务器中的操作是否被复制到从LDAP服务器中来了。在从LDAP服务器中使用以下命令进行查询：</p>
<p> </p>
<pre class="python" name="code">#ldapsearch -x -b "dc=dlw,dc=com" "cn=dlw"</pre>
 
<p>执行结果如下图所示，从图中可看到其中的sn也被修改为dongliwei了（数据库中原来的内容为zhangsan.modi，是前面例子中修改的值），即被主LDAP服务器进行了同步复制。</p>
<p> </p>
<p><img height="465" alt="" src="http://dl.iteye.com/upload/picture/pic/114200/3c7de81d-d5ce-3d95-9eeb-fa8ec63a38df.png" width="446"></p>
<p> </p>
<p> </p>
<p><span style="font-size: large;"><strong>OpenLDAP在用户认证的应用</strong>
</span>
</p>
<p><br>
      OpenLDAP经常用在用户登录认证方面，通过LDAP的数据复制功能，可让用户使用一个账户登录网络中使用LDAP服务的所有服务器。在主LDAP服务器中设置好用户账户数据，然后通过在网络中的任意客户端都可使用设置的账号进行登录操作。下面将简单介绍将用户认证迁移到LDAP的操作方法。</p>
<p><span style="font-size: medium;"><strong>用户认证用到的ojbectClass</strong>
</span>
</p>
<p><br>
      在LDAP中用来保存用户认证条目的objectClass主要有以下3个，分别用来保存组、用户、密码等信息到目录的条目中。</p>
<ul>
<li>posixGroup：可设置属性cn、userPassword、gidNumber等。</li>
<li>posixAccount：可设置属性cn、gidNumber、uid、uidNumber、homeDirectory、loginShell等。</li>
<li>shadowAccount：可设置属性uid、shadowExpire、shadowFlag、shadowInactive、shadowLastChange、shadowMax、shadowMin、shadowWarning、userPassword等。</li>
</ul>
<p><em>提示：从上面列出的属性的名称可以很容易地与组、用户的相关信息联系起来。</em>
</p>
<p> </p>
<p><span style="font-size: medium;"><strong>使用迁移工具</strong>
</span>
</p>
<p><br>
      要使用LDAP进行用户认证，首先应该考虑的就是数据迁移的工作量。如果要操作员从/etc/passwd和/etc/group文件中逐个将信息重新录入，工作量将非常大。<br>
      OpenLDAP为用户考虑到了这些迁移工作，提供了多个迁移工具的脚本程序，这些程序位于/usr/share/openldap/migration/目录中，在该目录中有很多扩展名为pl和sh的脚本文件，通过这些迁移工具，可以很方便地将系统中的用户迁移到LDAP目录数据库中。下面介绍具体的迁移步骤。</p>
<p><strong>【例子】</strong>
将系统中的用户信息迁移到LDAP目录数据库中。<br>
具体操作步骤如下：<br>
（1）修改/usr/share/openldap/migration/migrate_common.ph文件，在其中查找以下内容：</p>
<pre class="python" name="code">$DEFAULT_BASE="dc=padl,dc=com";</pre>
 
<p>将其修改为目录服务器使用的根，如本章使用的例子要改为以下形式：</p>
<p> </p>
<pre class="python" name="code">$DEFAULT_BASE="dc=dlw,dc=com";</pre>
 
<p>保存后退出。</p>
<p> </p>
<p> </p>
<p>（2）使用以下命令执行脚本migrate_base.pl，用来创建根项，并为Hosts、Networks、Group和People等创建低一级的组织单元（执行该命令将生成base.ldif文件）：</p>
<p> </p>
<pre class="python" name="code">#./migrate_base.pl &gt; base.ldif</pre>
 
<p>（3）由于本章前面已在LDAP服务器中创建了根项“dc=dlw,dc=com”，因此将base.ldif文件中的第1个条目删除，另外，在用户认证中只用到组和用户，也将其他无关条目删除，只保存以下内容（例子）：</p>
<p> </p>
<pre class="python" name="code">dn: ou=People,dc=dlw,dc=com
ou: People
objectClass: top
objectClass: organizationalUnit

dn: ou=Group,dc=dlw,dc=com
ou: Group
objectClass: top
objectClass: organizationalUnit
</pre>
 
<p>（4）使用以下命令将base.ldif文件中的条目导入目录数据库：</p>
<p> </p>
<pre class="python" name="code"># ldapadd -x -D "cn=root,dc=dlw,dc=com" -w secret -f  base.ldif</pre>
 
<p>执行结果如下图所示。</p>
<p> </p>
<p><img height="101" alt="" src="http://dl.iteye.com/upload/picture/pic/114202/ec04b515-286d-3ea1-a246-a3c6870c7c6f.jpg" width="663"></p>
<p> </p>
<p>（5）开始迁移组信息。使用以下命令将/etc/group中的组信息保存到临时文件group.tmp中：</p>
<p> </p>
<pre class="python" name="code">#cat /etc/group &gt; group.tmp</pre>
 
<p>（6）系统组不导入LDAP目录数据库中，因此需对group.tmp文件中的信息进行编辑，只保留需要导入LDAP目录数据库的组的信息。</p>
<p><br>
（7）使用以下命令将组的数据生成LDIF条目信息：</p>
<pre class="python" name="code">#./migrate_group.pl group.tmp &gt; group.ldif</pre>
 
<p>（8）使用cat命令查看group.ldif的内容，可看到已按posixGroup这种objectClass将组的数据组织完成，如下图所示。</p>
<p> </p>
<p><img height="188" alt="" src="http://dl.iteye.com/upload/picture/pic/114204/6a5ca0cd-bb6e-332e-9479-6720e9aafa4d.jpg" width="433"></p>
<p> </p>
<p>（9）类似地，使用以下命令导出/etc/passwd中的用户数据，并删除不需要的用户，然后使用migrate_passwd.pl脚本生成LDIF文件：</p>
<p> </p>
<pre class="python" name="code">#cat /etc/passwd &gt; passwd.tmp
#./migrate_passwd.pl passwd.tmp &gt; passwd.ldif
#cat passwd.ldif</pre>
 
<p><em>提示：从上面列出的属性的名称可以很容易地与组、用户的相关信息联系起来。</em>
</p>
<p> </p>
<p>（10）使用以下命令将组和用户信息导入目录数据库：</p>
<p> </p>
<pre class="python" name="code">#ldapadd -x -D "cn=root,dc=dlw,dc=com" -w 111111 -f group.ldif
#ldapadd -x -D "cn=root,dc=dlw,dc=com" -w 111111 -f passwd.ldif</pre>
 
<p>执行以上命令的过程如下图所示。</p>
<p> </p>
<p><img height="316" alt="" src="http://dl.iteye.com/upload/picture/pic/114206/0e537212-8201-39ec-89c0-75e7a1f1f777.jpg" width="546"></p>
<p> </p>
<p>（11）使用以下命令查看目录数据库中用户root的信息，用“uid=root”作查询条件：</p>
<p> </p>
<pre class="python" name="code">#ldapsearch -x -b 'dc=dlw,dc=com' 'uid=root'</pre>
 
<p>查找结果如下图所示。</p>
<p> </p>
<p><img height="496" alt="" src="http://dl.iteye.com/upload/picture/pic/114208/a28af9d8-10a8-310c-98dc-10dfb8d2e7ab.png" width="554"></p>
<p> </p>
<p>      通过以上的操作，就将需要导入的组和用户的信息导入到了目录数据库中，接下来还需要对客户端进行设置，使用LDAP进行登录验证操作。</p>
<p> </p>
<p> </p>
<p><span style="font-size: medium;"><strong>设置客户端登录</strong>
</span>
</p>
<p><br>
若客户端要使用LDAP进行用户登录认证，则可使用本地计算机中不存在的用户名进行登录操作。<br><strong>【例子】</strong>
修改配置文件，设置客户端使用LDAP进行认证。<br>
具体操作步骤如下：<br>
（1）修改客户端计算机中的/etc/sysconfig/authconfig文件，将以下项都修改为yes：</p>
<p> </p>
<pre class="python" name="code">USELDAP=yes
USELDAPAUTH=yes
USEMD5=no
USESHADOW=yes
USELOCAUTHORIZE=yes</pre>
 
<p>（2）修改客户端计算机中的/etc/openldap/ldap.conf文件，修改内容如下：</p>
<p> </p>
<pre class="python" name="code">host 192.168.14.20
BASE dc=dlw,dc=com
ssl off</pre>
 
<p>（3）修改客户端计算机中的/etc/nsswitch.conf文件，在passwd、shadow、group后面都加上ldap，如下图所示。</p>
<p> </p>
<p><img height="264" alt="" src="http://dl.iteye.com/upload/picture/pic/114210/997b3613-872e-3c86-9096-9aed591db2ef.jpg" width="640"></p>
<p> </p>
<p>      经过以上配置以后，在客户端就可以使用LDAP目录数据库中的用户信息在客户端进行登录操作了。登录操作与使用本地用户账号相同，这里就不再演示了。</p>
<p> </p>
<p> </p>
<p><strong><span style="font-size: large;">LDAP Schema</span>
</strong>
</p>
<p><br>
      Schema是LDAP的一个重要组成部分，类似于数据库的模式定义，LDAP的Schema定义了LDAP目录所应遵循的结构和规则，比如一个 objectclass会有哪些属性，这些属性又是什么结构等等，schema给LDAP服务器提供了LDAP目录中类别，属性等信息的识别方式，让这些可以被LDAP服务器识别。<br>
在LDAP的schema中，有四个重要的元素：</p>
<p>    <span style="font-size: medium;"><strong>Objectclass</strong>
</span>
<br>
    objectclass定义了一个类别，这个类别会被不同的目录（在LDAP中就是一个Entry）用到，它说明了该目录应该有哪些属性，哪些属性是必须的，哪些又是可选的。一个objectclass的定义包括名称（NAME），说明（DESC），类型（STRUCTURAL或AUXILARY ，表示是结构型的还是辅助型的），必须属性（MUST），可选属性（MAY）等信息。</p>
<pre class="python" name="code">Objectclass格式：
objectclass = ( whsp
numericoid whsp //全局唯一的 OID
[ "NAME" qdescrs ] //类名称
[ "DESC" qdstring ] //类描述
[ "OBSOLETE" whsp ]
[ "SUP" oids ] ; //父类
[ ( "ABSTRACT" / "STRUCTURAL" / "AUXILIARY" ) whsp ]
[ "MUST" oids ] ; //必填属性集合
[ "MAY" oids ] //选填属性集合
whsp ")"
</pre>
 
<p>例如：</p>
<p> </p>
<pre class="python" name="code"># Object Class Definitions 
objectclass ( 1.3.6.1.4.1.7914.1.2.2.1 NAME 'kunmailUser' 
DESC 'KunMail-LDAP User' 
SUP top 
STRUCTURAL
MUST(username$cn$vuid$vgid)
MAY(maildir$home$clearpw$forwardAddr$quota$storeHost$delivery$mailReplyText$active))</pre>
 
<p>      这里kunmailUser这种数据，要包含maildir $ home $ clearpw $ forwardAddr $ quota $ storeHost $ delivery $ mailReplyText $ active等可选项，还要包括username $ cn $ vuid $ vgid 必选项。 可选项用MAY()来包含，必选项用MUST()来包含。DESC是说明项。SUP表示父类（有点像面向对象编程啊）top表示没有父类，他自己是顶级。STRUCTURAL是存储方式。一般来说每个节点都要包含一个ABSTRACT类("top" or "alias"), 至少一个STRUCTURAL类，0个或者多个AUXILIARY类。AUXILIARY表示辅助型、STRUCTURAL表示结构型（默认）、ABSTRACT表示摘要型。<br>
      下面定义一个允许将myPhoto增加到任何已经存在的条目中的auxiliary对象类：</p>
<pre class="python" name="code">objectclass= ( 1.1.2.2.1 NAME 'myPhotoObject'
DESC 'mixin myPhoto'
AUXILIARY
MAY myPhoto )</pre>
 
<p>      如果您的组织需要一个私有的结构化对象类来表示用户，你可以子类化任何一个已经存在的person类，比如inetOrgPerson(RFC2798)，然后增加需要的属性：</p>
<p> </p>
<pre class="python" name="code">objectclass =( 1.1.2.2.2 NAME 'myPerson'
DESC 'my person'
SUP inetOrgPerson
MUST ( 'myUniqueName' $ 'givenName' )
MAY 'myPhoto' )</pre>
 
<p>      该对象类从inetOrgPerson中继承允许的或者必须的属性，但是，要求myUniqueName和givenName，允许myPhoto。</p>
<p> </p>
<p> </p>
<p><strong><span style="font-size: medium;">Attribute</span>
</strong>
</p>
<p><br>
      attribute就是一个上面objectclass中可能包含的属性，对其的定义包括名称，数据类型，单值还是多值以及匹配规则等。后面用具体的例子来说明。</p>
<p> </p>
<p><strong>Attribute格式：</strong>
</p>
<p> </p>
<pre class="python" name="code">attributeType ( whsp
numericoid whsp //全局唯一的 OID
[ "NAME" qdescrs ] //属性名称
[ "DESC" qdstring ] //属性描述
[ "OBSOLETE" whsp ]
[ "SUP" woid ] //本属性从其它属性中派生出来的
[ "EQUALITY" woid //相等性匹配
[ "ORDERING" woid//顺序匹配
[ "SUBSTR" woid ] //字符串匹配
[ "SYNTAX" whsp noidlen whsp ] //字段的数据类型的OID
[ "SINGLE-VALUE" whsp ] //定义本属性为单值（默认多值）
[ "COLLECTIVE" whsp ] //default not collective
[ "NO-USER-MODIFICATION" whsp ]//default user modifiable
[ "USAGE" whsp AttributeUsage ]//default userApplications
whsp ")"
AttributeUsage =
"userApplications" /
"directoryOperation" /
"distributedOperation" / ; DSA-shared</pre>
 
<p>whsp是空格的意思(' ')。numericoid 是全局唯一的 OID，是带.的十进制形式 (e.g. 1.1.0)， qdescrs有一个或几个意思， woid 可以使名称或者是 OID 可选择的一定长度的后缀(e.g {10})。<br>
例如，属性类型name和cn在core.schema中如下定义：</p>
<pre class="python" name="code">attributeType ( 2.5.4.41 NAME 'name'
DESC 'name(s) associated with the object'
EQUALITY caseIgnoreMatch
SUBSTR caseIgnoreSubstringsMatch
SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )
attributeType ( 2.5.4.3 NAME ( 'cn' $ 'commonName' )
DESC 'common name(s) assciated with the object'
SUP name )
attributetype ( 1.3.6.1.4.1.7914.1.2.1.6 NAME 'quota' 
DESC 'The amount of space the user can use until all further messages get bounced.' 
SYNTAX 1.3.6.1.4.1.1466.115.121.1.44 
SINGLE-value ) 
</pre>
 
<p><em>请注意，每一个都定义了属性的OID，给出了一个短的名称，以及一个简短的描述。每一个名称都是OID的一个别名。Slapd(8)在返回结果的时候，将返回第1个列出的名称。</em>
<br>
      第1个名称，name，保存了directoryString（UTF-8编码的Unicode）语法。该语法由OID说明。（1.3.6.1.4.1.1466.115.121.1.15标识了目录字符串语法）。还说明了一个推荐长度为32768的选项。服务器应该支持该长度的值，但是，也可以支持更长的值。该域没有指明长度限制，因此，在服务器上被忽略，并且服务器不会限制其大小。另外，相等和子串匹配使用不区分大小写的规则。下面是经常使用的语法和匹配规则（OpenLDAP支持这些，以及更多）<br>
      第2个属性，cn，是name的一个子类型，因此，它继承了语法，匹配规则，并且使用name.commonName作为别名。<br>
      两个属性都没有限制到单一值。都可以被用户应用程序所使用，都不存在过期，都不是集合。<br>
      很多组织为用户保留唯一的名字(unique name)，虽然用户可以使用displayName，但是这个属性(name)依旧由用户控制。而不是organization。我们可以从 inetorgperson.schema 拷贝displayName ，替换OID，name，和描述(description)。</p>
<pre class="python" name="code">attributetype ( 1.1.2.1.1 NAME 'myUniqueName'
DESC 'unique name with my organization'
EQUALITY caseIgnoreMatch
SUBSTR caseIgnoreSubstringsMatch
SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
SINGLE-VALUE )
</pre>
 
<p>但是，如果我们要使name属性包含一个断言，这个属性可以被定义为name的子属性。</p>
<p> </p>
<pre class="python" name="code">attributetype ( 1.1.2.1.1 NAME 'myUniqueName'
DESC 'unique name with my organization'
SUP name )
</pre>
 
<p>      很多的组织为每一个用户保留一个头像。myPhoto属性类型的定义可以用来保存用户的头像。当然用户可以选择jpegPhoto属性类型（RFC2798）（或其子类型）来保存头像。当然你只能在图片符合JPEG File Interchange Format时使用。<br>
      当然，一个使用八进制语法的属性类型可以这样的定义：</p>
<p> </p>
<pre class="python" name="code">attributetype ( 1.1.2.1.2 NAME 'myPhoto'
DESC 'a photo (application defined format)'
SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
SINGLE-VALUE )
</pre>
 
<p>      在这，语法中并没有置顶photo的格式(format)，这里假设访问属性的应用可以对其值进行处理。<br>
      如果你想支持多种图片格式，你需要为每一个格式定义属性类型。为图片添加类型信息的前缀。或者使用ASN.1描述值，和use the ;binary transfer option。<br>
      可以使图片属性能够保存URI，你可以在labeledURI（RFC2079）后创建一个属性，或者创建一个子类型。</p>
<p> </p>
<pre class="python" name="code">attributetype ( 1.1.2.1.3 NAME 'myPhotoURI'
DESC 'URI and optional label referring to a photo'
SUP labeledURI )
</pre>
 
<p><span style="font-size: medium;"><strong>Syntax</strong>
</span>
</p>
<p><br>
      syntax是LDAP中的“语法”，其实就是LDAP中会用到的数据类型和数据约束，这个语法是遵从X.500中数据约束的定义的。其定义需要有一个ID（遵从X.500）以及说明（DESP）</p>
<p> </p>
<p> </p>
<table class="MsoNormalTable" style="border-collapse: collapse; border: none;" cellpadding="0" cellspacing="0" border="1">
<tr>
<td style="width: 426.1pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="568">
<p class="15074" style="text-indent: 0cm;"><strong><span>Commonly Used Syntaxes</span>
</strong>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13.0pt; line-height: 150%;">Name</span>
</strong>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13.0pt; line-height: 150%;">OID</span>
</strong>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13.0pt; line-height: 150%;">Description</span>
</strong>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>boolean</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.7</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>boolean value</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>distinguishedName</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.12</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>DN</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>directoryString</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.15</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>UTF-8 string</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>IA5String</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.26</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>ASCII string</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>Integer</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.27</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>integer</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>Name and Optional UID</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.34</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>DN plus UID</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>Numeric String</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.36</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>numeric string</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>OID</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.38</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>object identifier</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>Octet String</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.40</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>arbitary octets</span>
</p>
</td>
</tr>
<tr>
<td style="width: 122.4pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="163">
<p class="15074" style="text-indent: 0cm;"><span>Printable String</span>
</p>
</td>
<td style="width: 161.65pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="216">
<p class="15074" style="text-indent: 0cm;"><span>1.3.6</span>
<span>.1.4.1.1466.115.121.1.44</span>
</p>
</td>
<td style="width: 142.05pt; border-top: none; border-left: none; padding: 0cm 5.4pt 0cm 5.4pt;" width="189">
<p class="15074" style="text-indent: 0cm;"><span>printable string</span>
</p>
</td>
</tr>
</table>
<p> </p>
<p> </p>
<p><strong><span style="font-size: medium;">Matching Rules</span>
</strong>
</p>
<p><br>
      是用来指定某属性的匹配规则，实际上就是定义一个特殊的Syntax的别名，让LDAP服务器可以识别，并对定义的属性进行匹配。</p>
<p> </p>
<p> </p>
<table class="MsoNormalTable" style="border-collapse: collapse; border: medium none;" cellpadding="0" cellspacing="0" border="1">
<tr>
<td style="width: 426.1pt; padding: 0cm 5.4pt;" width="568">
<p class="15074" style="text-indent: 0cm;"><strong><span>Commonly Used Matching Rules</span>
</strong>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13pt; line-height: 150%;">Name</span>
</strong>
</p>
</td>
<td width="71">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13pt; line-height: 150%;">Type</span>
</strong>
</p>
</td>
<td width="305">
<p class="15074" style="text-align: center; text-indent: 0cm;"><strong><span style="font-size: 13pt; line-height: 150%;">Description</span>
</strong>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>booleanMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>boolean</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>octetStringMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>octet string</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>objectIdentiferMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>OID</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>distinguishedNameMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>DN</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>uniqueMemberMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>Name with optional
  UID</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>numericStringMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>numerical</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>numericStringOrderingMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>ordering</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>numerical</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>numericStringSubstringsMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>substrings</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>numerical</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreOrderingMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm; line-height: normal;"><span>ordering</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreSubstringsMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>substrings</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive,
  space insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactOrderingMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>ordering</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactSubstringsMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>substrings</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreIA5Match</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive,
  space insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreIA5OrderingMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>ordering</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive,
  space insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseIgnoreIA5SubstringsMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>substrings</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case insensitive,
  space insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactIA5Match</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>equality</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactIA5OrderingMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>ordering</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
<tr>
<td width="192">
<p class="15074" style="text-indent: 0cm;"><span>caseExactIA5SubstringsMatch</span>
</p>
</td>
<td width="71">
<p class="15074" style="text-indent: 0cm;"><span>substrings</span>
</p>
</td>
<td width="305">
<p class="15074" style="text-indent: 0cm;"><span>case sensitive, space
  insensitive</span>
</p>
</td>
</tr>
</table>
<p> </p>
<p>      LDAP的schema的主要元素就是这些了，下面列举出了一些LDAP规定好的或是现在比较通用的schema，一般的LDAP服务器都应该可以识别这些定义。<br>
      这就是一个名为subschema的objectclass的定义：</p>
<p> </p>
<pre class="python" name="code">objectclass=(2.5.20.1 NAME 'subschema'  AUXILIARY
 MAY ( dITStructureRules $ nameForms $ ditContentRules $
objectClasses $ attributeTypes $ matchingRules $ matchingRuleUse ) )
</pre>
 
<p>      首先是ID，这里是2.5.20.1，接着是NAME，AUXILIARY说明是辅助型，之后是可选属性的定义，subschema中没有定义必须属性，如果需要定义，应该和MAY一样，将属性放在MUST（）中并用$隔开<br>
      再来看一个属性定义：</p>
<p> </p>
<pre class="python" name="code">attributetype ( 2.5.4.3 NAME 'cn' SUP name EQUALITY caseIgnoreMatch )</pre>
 
<p>      可以看到cn属性的父属性是name，它相等性匹配于caseIgnoreMatch（匹配原则为EQUALITY，还有如SUBSTR是字符串匹配，ORDERING是顺序匹配）<br>
      syntax定义一般都比较简单，如：</p>
<p> </p>
<pre class="python" name="code">( 1.3.6.1.4.1.1466.115.121.1.6  DESC  'String' )</pre>
 
<p>      这个定义说明，这一串数字1.3.6.1.4.1.1466.115.121.1.5就代表了LDAP中的字符串，这个数字串的定义和X.500相关，包括了它的存储方式，所占空间大小等。 <br>
      最后看看Matching Rule的例子，前面提到了caseIgnoreMatch，就看他的吧</p>
<p> </p>
<pre class="python" name="code">attributetype ( 2.5.13.2 NAME 'caseIgnoreMatch'
      SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )</pre>
 
<p>      其实1.3.6.1.4.1.1466.115.121.1.15 就是LDAP数据类型Directory String的ID，说明前面的cn需要等于这个数据类型才有效。<br>
      还有很多常用schema的定义都在了RFC2252中，LDAP服务器都应该支持这些基本的schema。好了，现在基本对LDAP中的schema有个一个大致的说明，可能有不到位或不妥之处，还望大家指正。</p>
<p> </p>
<p> </p>

  


  <div id="bottoms" class="clearfix">
    
    <div id="share_weibo">分享到：
      <a data-type='sina' href="javascript:;" title="分享到新浪微博"><img src="/images/sina.jpg"></a>
      <a data-type='qq' href="javascript:;" title="分享到腾讯微博"><img src="/images/tec.jpg"></a>
    </div>
  </div>

  <div class="blog_nav">
    <div class="pre_next">
      <a href="/blog/1663176" class="next" title="Maven学习笔记（一）">Maven学习笔记（一）</a>
      |
      <a href="/blog/1556859" class="pre" title="Oracle数据库学习笔记（三）">Oracle数据库学习笔记（三）</a>
    </div>
  </div>
  <div class="blog_bottom">
    <ul>
      <li>2012-06-11 19:15</li>
      <li>浏览 102044</li>
      <li><a href="#comments">评论(6)</a></li>
      
      
      <li>分类:<a href="https://www.iteye.com/blogs/category/opensource">开源软件</a></li>      
      <li class='last'><a href="https://www.iteye.com/wiki/blog/1557846" target="_blank" class="more">查看更多</a></li>
    </ul>    
  </div>
    
  <div class="blog_comment">
    <h5>评论</h5>
    <a id="comments" name="comments"></a>
    <div id="bc2389271">
  <div class="comment_title">
    6 楼
    <a href='https://www.iteye.com/blog/user/me-' target='_blank' title='me-'>me-</a>
    2016-05-04&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content"><img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" />&nbsp;<img src="/images/smiles/icon_exclaim.gif" /> </div>
</div>

<div id="bc2387735">
  <div class="comment_title">
    5 楼
    <a href='https://www.iteye.com/blog/user/itfanr' target='_blank' title='itfanr'>itfanr</a>
    2016-04-07&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">非常好的文章！感谢！</div>
</div>

<div id="bc2386997">
  <div class="comment_title">
    4 楼
    <a href='https://www.iteye.com/blog/user/zouwenjie00' target='_blank' title='zouwenjie00'>zouwenjie00</a>
    2016-03-26&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">写的太好了 ，对初学者入门很有帮助。<img src="/images/smiles/icon_idea.gif" />&nbsp;<img src="/images/smiles/icon_idea.gif" /> </div>
</div>

<div id="bc2354808">
  <div class="comment_title">
    3 楼
    <a href='https://www.iteye.com/blog/user/wxhwdmxl' target='_blank' title='wxhwdmxl'>wxhwdmxl</a>
    2014-07-27&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">openldap只支持linux下配置复制么？在windows下怎样配置复制？</div>
</div>

<div id="bc2335400">
  <div class="comment_title">
    2 楼
    <a href='https://www.iteye.com/blog/user/feijiing' target='_blank' title='feijiing'>feijiing</a>
    2013-12-24&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content"><span style="font-size: xx-large;">[size=large]</span>[/size]sdfsdfsdfssdfsdf[size=xx-small][/size]</div>
</div>

<div id="bc2328645">
  <div class="comment_title">
    1 楼
    <a href='https://www.iteye.com/blog/user/wuyupengwoaini' target='_blank' title='wuyupengwoaini'>wuyupengwoaini</a>
    2013-10-17&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">写得实在是太好了，如果再配上这两个链接中的内容就跟好了<br />http://www.micmiu.com/opensource/java-ldap-demo/<br />http://www.micmiu.com/enterprise-app/sso/openldap-windows-config/</div>
</div>


    
    
  </div>

  <div class="blog_comment">
    <h5>发表评论</h5>
            <p style="text-align:center; margin-top:30px;margin-bottom:0px;"><a href="/login" style="background-color:white;"> <img src="/images/login_icon.png" style="vertical-align:middle; margin-right: 10px;" /></a><a href="/login">  您还没有登录,请您登录后再发表评论 </a></p>
      </div>
  </div>
  <div>
    <script type="text/javascript">
        (function() {
            var s = "_" + Math.random().toString(36).slice(2);
            document.write('<div style="" id="' + s + '"></div>');
            (window.slotbydup = window.slotbydup || []).push({
                id: "u4614430",
                container: s
            });
        })();
    </script>
    <!-- 多条广告如下脚本只需引入一次 -->
    <script type="text/javascript" src="//cpro.baidustatic.com/cpro/ui/c.js" async="async" defer="defer" >
    </script>
  </div>
</div>


<script type="text/javascript">
  dp.SyntaxHighlighter.HighlightAll('code', true, true);

  $$('#main .blog_content pre[name=code]').each(function(pre, index){ // blog content
    var post_id = 1557846;
    var location = window.location;
    source_url = location.protocol + "//" + location.host + location.pathname + location.search;
    pre.writeAttribute('codeable_id', post_id);
    pre.writeAttribute('codeable_type', "Blog");
    pre.writeAttribute('source_url', source_url);
    pre.writeAttribute('pre_index', index);
    pre.writeAttribute('title', 'OpenLDAP学习笔记');
  });

  fix_image_size($$('div.blog_content img'), 700);

  function processComment() {
    $$('#main .blog_comment > div').each(function(comment){// comment
      var post_id = comment.id.substr(2);
      $$("#"+comment.id+" pre[name=code]").each(function(pre, index){
        var location = window.location;
        source_url = location.protocol + "//" + location.host + location.pathname + location.search;
        source_url += "#" + comment.id;
        pre.writeAttribute('codeable_id', post_id);
        pre.writeAttribute('codeable_type', "BlogComment");
        pre.writeAttribute('source_url', source_url);
        pre.writeAttribute('pre_index', index);
        pre.writeAttribute('title', 'OpenLDAP学习笔记');
      });
    });
  }

  function quote_comment(id) {
    new Ajax.Request('/editor/quote', {
      parameters: {'id':id, 'type':'BlogComment'},
      onSuccess:function(response){editor.bbcode_editor.textarea.insertAfterSelection(response.responseText);
        Element.scrollTo(editor.bbcode_editor.textarea.element);}
    });
  }

  code_favorites_init();
  processComment();
  new WeiboShare({share_buttons: $('share_weibo'), img_scope: $('blog_content')});
</script>




      </div>
            <script>
        setTimeout(function () {
          var naviga_offsetTop = 0;

          function onload_function() {
            naviga_offsetTop = jQuery("#nav_show_top_stop").position().top;
            jQuery(window).bind("scroll", naviga_stay_top);
            jQuery(window).bind("mousewheel", naviga_stay_top);
            jQuery(document).bind("scroll", naviga_stay_top);
            jQuery(document).bind("mousewheel", naviga_stay_top);
          }

          function naviga_stay_top() {

            var scrollTop = jQuery(document).scrollTop();
            if (scrollTop > (naviga_offsetTop + 250)) {
              jQuery("#nav_show_top_stop").css({
                "position": "fixed"
              });
              jQuery("#nav_show_top_stop").css({
                "top": "0px"
              });
            } else {
              jQuery("#nav_show_top_stop").css({
                "position": "fixed"
              });
              jQuery("#nav_show_top_stop").css({
                "top": naviga_offsetTop + 250 - scrollTop + "px"
              });
            }
          }
          jQuery(document).ready(onload_function());
        }, 200);
      </script>
    </div>
    
    <div id="footer" class="clearfix">
      <!-- <div id="copyright">
        <hr />
        声明：ITeye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。<br />
        &copy; 2003-
        2019 ITeye.com. All rights reserved. [ 京ICP证110151号 京公网安备110105010620 ]
      </div> -->
      <div id="ad_pop">
        <div class="J_adv" data-view="true" data-mod="ad_popu_64" data-mtp="62" data-order="21" data-con="ad_content_2070">
          <!-- 广告位：PC端-iteye博客详情右侧弹窗-300*250 -->
          
          
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
  document.write("<img src='https://stat.iteye.com/?url="+ encodeURIComponent(document.location.href) + "&referrer=" + encodeURIComponent(document.referrer) + "&user_id=' width='0' height='0' />");
</script>



   Global site tag (gtag.js) - Google Analytics
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127895514-6"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-127895514-6');
  </script>

  
  
  <script src="//csdnimg.cn/public/common/libs/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="//g.csdnimg.cn/report/1.0.6/report.js" type="text/javascript"></script>
<style>
  .userinfo {display: none !important;}
  .persion_article h3{
    background: none !important;
    border-bottom: none!important;
    padding: 0!important;
    margin-bottom: 0!important;
    line-height: 1!important;
  }
  .persion_article .right_box{
    margin-top: 0!important;
  }
  .persion_article .footer_box .feed_new_tit span{
    padding-left: 0!important;
  }
</style>
<script>
(function($){
  var windowHeight = $(window).height(),
      contentHeight = $(".hide-main-content").height()
      windowHeight = windowHeight * 1.2 //获得可视区域高度
      if(contentHeight > windowHeight){
        $(".hide-article-box").show()
        $(".hide-main-content").css({'height': windowHeight,'overflow':'hidden'})
        $(".hide-article-box").find("#btn-readmore").click(function(){
          $(this).parents('.hide-main-content').removeAttr('style')
          $(this).parent().hide()
        })
      }
})(jQuery)
</script>
<script type="text/javascript">var $csdn_iteye_jq = jQuery.noConflict();// 解决jq与prototype.js命名空间冲突的问题</script>


  
  
  <script src="https://www.iteye.com/javascripts/web-storage-cache.min.js?1461122561" type="text/javascript"></script>
  <script src="https://www.iteye.com/javascripts/replace.min.js?1517971857" type="text/javascript"></script>
  

</body>
