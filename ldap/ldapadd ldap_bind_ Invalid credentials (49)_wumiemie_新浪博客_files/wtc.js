"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(g,y){var u="default",f=/^(.+\.)?(.+:)?(.+)?/,d=location.protocol+"//wtc.duoyi.com/wtc.gif",m=!0,h=/^dimension\d+$/,p=/^metric\d+$/,v=Array.prototype.slice,t=g.DuoYiAnalyticsObject||"_wtc",e=g[t].operate||[],w="tna",x="aid",o="leave",n=!1,k=["sll","kwn","rze","mwn","mve","spe","ber","pch"],i=["scroll","keydown","resize","mousedown","mousemove","swipe","turn","pinch"],b={keys:function(t){if(t=t||{},Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},indexOfArray:function(t,e){if(!this.isArray(t))return-1;if(Array.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1},findFromArray:function(t,e){for(var n=null,i=0,o=t.length;i<o;i+=1)if(e(t[i])){n=t[i];break}return n},composedPath:function(t){for(var e=[];t;){if(e.push(t),"HTML"===t.tagName)return e.push(document),e.push(window),e;t=t.parentElement}},getEventPath:function(t){return t.path||t.composedPath&&t.composedPath()||b.composedPath(t.target)},each_Object:function(t,e){for(var n=this.keys(t),i=0,o=n.length;i<o;++i){var r=n[i];e&&e(r,t[r])}},extend:function(n,i,o){return n=n||{},b.each_Object(i,function(t,e){null==e||o&&!o(t,i[t],n,i)||(n[t]=i[t])}),n},delay:function(t,e){var n=!1;return e=e||3e3,function(){return!0===n?n:(n=!0,setTimeout(function(){t.apply(null,arguments),n=!1},e),!1)}},url:function(t,e){var n=e||d;n+="?";var i=[];return b.each_Object(t,function(t,e){i.push(t+"="+e)}),n+=i.join("&")},invoke:function(e,n){return function(t){if(t===e)return n}},dispatch:function(){var o=v.call(arguments),r=o.length;return function(t){for(var e=v.call(arguments,1),n=0;n<r;++n){var i=o[n](t);if(i)return i.apply(null,e)}}},flash:function(){var t="";if(navigator.plugins&&navigator.mimeTypes.length){var e=navigator.plugins["Shockwave Flash"];e&&e.description&&(t=e.description.replace(/^.*\s+(\S+)\s+\S+$/,"$1"))}else if(window.ActiveXObject)try{(e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))&&(t=e.GetVariable("$version"))&&(t=t.replace(/^.*\s+(\d+),(\d+).*$/,"$1.$2"))}catch(t){}return t},addEvent:function(e,t,n){e.attachEvent?e.attachEvent("on"+t,function(t){n.call(e,t)}):e.addEventListener&&e.addEventListener(t,n,!1)},viewTime:function(t){function e(t){var e="";if(t in y)e=t;else for(var n=["webkit","ms","moz","o"],i=0;i<n.length;i++){var o=n[i]+t.charAt(0).toUpperCase()+t.slice(1);if(o in y){e=o;break}}return e}function n(t){("focus"===t.type||"blur"===t.type)&&t.target&&t.target!=window||(a="focus"===t.type||"focusin"===t.type,i())}function i(){var t;clearTimeout(p),o&&(t="visible"==y[o]),r&&(t=!y[r]),s=void 0===t?m:t,c&&l||!s||!a?!c||!l||a&&s||(u=!1,h+=new Date-d):(u=m,d=+new Date),l=s,c=a,p=setTimeout(i,100)}var o=e("visibilityState"),r=e("hidden"),a=m,s=m,c=m,l=m,u=m,f=+new Date,d=f,h=0,p="";i();var v=o.replace(/[vV]isibilityState/,"visibilitychange");b.addEvent(y,v,i),b.addEvent(g,"pageshow",i),b.addEvent(g,"pagehide",i),"object"===_typeof(y.onfocusin)?(b.addEvent(y,"focusin",n),b.addEvent(y,"focusout",n)):(b.addEvent(g,"focus",n),b.addEvent(g,"blur",n)),b.addEvent(g,"unload",function(){t(new Date-f,u?new Date-d+h:h)})},getCookie:function(t,e){if(!(t.indexOf(e)<0)){var n=t.indexOf(e),i=t.indexOf(";",n);return t.slice(n,i<0?t.length:i).replace(e+"=","")}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},listenEvent:function(t,e,n){var i=2<arguments.length&&void 0!==n?n:{};if(void 0!==window.addEventListener)window.addEventListener(t,e,i);else if(void 0!==document.addEventListener)document.addEventListener(t,e,i);else if(void 0!==window.attachEvent)window.attachEvent("on"+t,e);else{var o=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){o(),e()}}},ellocate:function(t){for(var e={xpath:"",css:""},n=function(t){var e="",n=t.className;return void 0!==n&&""!=n&&(e="."+n.split(/[\s\n]+/).join(".")),e},i=function(t){for(var e=t.parentNode.children||[],n=0;n<e.length;n++)if(e[n]==t)return n};t&&1==t.nodeType;t=t.parentNode){var o=i(t);if("/"!=t.tagName.substring(0,1)&&"body"!==t.tagName.toLowerCase()&&"html"!==t.tagName.toLowerCase())if("undefined"!=t.id&&""!=t.id){var r="[@id='"+t.id+"']";e.xpath="/"+t.tagName.toLowerCase()+r+e.xpath,e.css=t.tagName.toLowerCase()+"#"+t.id+" > "+e.css}else o="["+o+"]",e.xpath="/"+t.tagName.toLowerCase()+o+e.xpath,e.css=t.tagName.toLowerCase()+n(t)+" > "+e.css}return e.xpath="//html[1]/body[1]/"+e.xpath,e.css=e.css.substr(0,e.css.length-3),e},each:function(t,e){for(var n=0,i=t.length;n<i;n+=1)e(t[n],n)},resetHistoryFn:function(i,o){if(!i)return!1;b.each(["replaceState","pushState"],function(t){var n=i[t];i[t]=function(t,e){return o&&"function"==typeof o&&o({state:t,param:e,url:arguments[2]}),n.apply(i,arguments)}})}};function E(t){this.type=t,this.keys=[],this.fields={}}E.prototype.set=function(t,e){return this.keys.push(t),e&&(this.fields[t]=e),this},E.prototype.key=function(){return this.keys},E.prototype.field=function(){return this.fields},E.prototype.exist=function(t){return 0<=b.indexOfArray(this.keys,t)},E.prototype.alias=function(t){return this.fields[t]};function r(t,e,n){function i(t){var e=!(0<arguments.length&&void 0!==t)||t;r.onload=r.onerror=r.onabort=null,r=null,e&&n&&n()}var o=b.url(t,e),r=new Image;r.onload=i,r.onabort=r.onerror=function(){return i(!1)},r.src=o}var O=b.dispatch(b.invoke("xml",function(e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var t=i.responseText;console.log("xml send data successfully with responseText: "+t)}else 4===i.readyState&&console.warn("xml send data failedly with code :"+i.status)},i.onerror=i.onabort=i.ontimeout=function(t){console.error("xml send according "+o+"\n msg :"+t.message),i=void 0,r(e,n)};var o=b.url(e,n);i.open("post",o,!1),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.send()}),b.invoke("beacon",function(t,e){var n=b.url(t,e);navigator.sendBeacon&&navigator.sendBeacon(n)||r(t,e)}),b.invoke("image",r),b.invoke(void 0,r));function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.title=document.title||"",this.url=t.url||location.href||"",this.key=b.guid(),this.duration=0,this.state="show",this.startTime=new Date,this.enter()}function T(t,n){var e=t.limitNum||10,i={name:"wtc_click_store_v1.0.0",get:function(){var t=[];try{t=JSON.parse(localStorage.getItem(this.name)||"[]")}catch(t){console.log("解析数据失败")}return t},set:function(t){localStorage.setItem(this.name,JSON.stringify(t))}},o=t.presetData?t.presetData:function(t){return t};return{record:function(t){var e=i.get();e.push(t),e=function(t,n,e){var i=2<arguments.length&&void 0!==e?e:function(t,e){return t-e};return t.sort(function(t,e){return i(t[n],e[n])})}(e,"clickTime"),i.set(e),this.checkToSend(e)&&this.send()},send:function(){var t=this,e=i.get();e.length&&n&&n({eventAction:"click",clickData:JSON.stringify(o(function(t){return JSON.parse(JSON.stringify(t))}(e)))},function(){t.successSend(e)})},successSend:function(t){var e=i.get();e=e.filter(function(e){return!b.findFromArray(t,function(t){return function(t,e){return JSON.stringify(t)===JSON.stringify(e)}(e,t)})}),i.set(e)},checkToSend:function(t){return t.length>=e}}}function s(t,e){var r=0<arguments.length&&void 0!==t?t:{},n=e,a=r.collectClickNode||["button","a","input"],s=r.collectUrl,c=r.collectElement,l=T(r,n),u={text:function(t){return t.innerText.trim()},classValue:function(t){return t.classList.value},label:function(t){return t.getAttribute("data-wtc-label")},xpath:function(t){return b.ellocate(t).xpath}};return u=r.collectMsgMergeMethod&&"merge"!==r.collectMsgMergeMethod?r.collectMsg||{}:b.extend(u,r.collectMsg||{}),{fn:function(t){if(s&&"function"==typeof s&&!s(window.location.href))return!1;var e=c&&"function"==typeof c?c(t):b.findFromArray(b.getEventPath(t)||[],function(t){return function(t){var e=r.collectElementByPath;return e&&"function"==typeof e&&e(t)}(t)||function(t){return 0<=b.indexOfArray(a,(t.nodeName||"").toLocaleLowerCase())}(t)});if(e&&function(t,e){var n=r.validTarget;return!n||"function"!=typeof n||n(t,e)}(e,t)){var n={};for(var i in u)try{n[i]=u[i](e)}catch(t){console.warn(i+" 对应的收集方法不生效:",t)}var o=b.extend(n,{curPage:location.href,eventAction:"click",clickTime:+new Date});l.record(o)}},clicker:l}}a.prototype.enter=function(){this.duration=0,this.startTime=new Date},a.prototype.exit=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"beforeunload",e=arguments[1];this.duration=new Date-this.startTime+this.duration;var n={title:this.title,url:this.url,key:this.key,stayTime:this.duration,type:t,markTime:new Date,eventAction:"stayTime"};e&&e(n)},a.prototype.active=function(){this.startTime=new Date},a.prototype.inactive=function(){this.duration=new Date-this.startTime+this.duration};var S={hasBuild:!(a.prototype.toggleVisible=function(){visibile?this.active():this.inactive()}),clicker:null,init:function(t){var e=t.name,n=t.emit,i=t.opt;if(this.hasBuild)return!1;this.hasBuild=!0;var o=new a({name:e});n({page:window.location.href,eventAction:"pageview"}),b.resetHistoryFn(window.history,function(t){o&&o.exit("hashChange",n),o=new a({url:t.url,name:e}),n({page:t.url,eventAction:"pageview",markTime:+new Date})}),this.clicker=s(i,n),b.listenEvent("click",this.clicker.fn,{capture:!0}),b.listenEvent("beforeunload",function(){o&&o.exit(null,n)}),b.listenEvent("popstate",function(t){o&&o.exit("popstate",n),o=new a({name:e})}),b.listenEvent("visibilitychange",function(t){o.toggleVisible(!t.target.hidden)})},sendCacheData:function(){this.clicker&&this.clicker.clicker&&this.clicker.clicker.send()}};function c(s,n,c){this.construct={},this.cache={};var l={create:function(t){var e=t[w]||u;if(!this.tracks[e])return this.tracks[e]=new n(e,t),this.tracks[e]},remove:function(t){var e=t[w]||u;this.tracks[e]&&delete this.tracks[e]},send:function(t,e){e.send.apply(e,t)},sendCacheData:function(){S.sendCacheData()},openCollectBP:function(t){var e=t[0]||u;if(this.tracks[e]){var n=this.tracks[e];S.init({name:e,opt:t[1]||{},emit:function(t,e){n.collectBP.apply(n,[b.extend({hitType:"event",eventCategory:"collect",eventAction:"default"},t),e])}})}else console.log("打开收集器失败")},collectBP:function(t,e){e.collectBP.apply(e,t)},set:function(t,e){e.set.apply(e,t)},require:function(t,e){var n=t.name;if(!this.construct[n])return this.cache[n]=t,void(s.isStop()||s.changeState());this.plugins[n]=new this.construct[n](t,e),this.plugins[n].name=n,this.plugins[n].type="plugin",s.isStop()&&(s.changeState(),s.run())},provide:function(t){var e=t.name;if("function"!=typeof t.construct)throw new TypeError("插件必须是一个构造函数。");this.construct[e]=t.construct,this.cache[e]&&this.require.call(this,this.cache[e])},getByName:function(t){return this.tracks[t]||this.plugins[t]},distribute:function(t){if(s.isStop()&&"provide"!==t)return s.add.apply(s,arguments);if("create"===t||"delete"===t||"require"===t||"provide"===t){var e=c.call(null,t,v.call(arguments,1));return l[t].call(this,e)}if("function"==typeof t)return t.call(null,this.tracks[u]);var n=f.exec(t),i=n[2]&&n[2].replace(":","");t=n[3]&&n[3];var o=n[1]&&n[1].replace(".","")||u,r=this.tracks[o]||this.plugins[o];if(!r)throw new TypeError("不存在指定的跟踪器:"+o);if(i){if(!this.plugins[i]||!this.plugins[i][t])throw new TypeError("不存在指定的插件或者插件无此方法：plugin: "+i+" command: "+t);var a=v.call(arguments,1);a.unshift(r),this.plugins[i][t].apply(this.plugins[i],a)}else{if(!l[t])throw new TypeError("尚未创建跟踪器或者无此命令 track: "+o+" command: "+t+"  arguments"+arguments[0]);l[t].call(this,v.call(arguments,1),r)}}};b.extend(this,l),b.extend(this,{tracks:{},plugins:{}})}var l={};function D(t,e){return e[t]=new E(t),e[t]}var A=D("create",l),N=D("delete",l),j=D("set",l),C=D("pageview",l),L=D("event",l),_=D("social",l),K=D("screenview",l),B=D("timing",l),M=D(o,l),P=D("exception",l),I=D("require",l),V=D("plus",l),F=(D("plugin",l),D("provide",l));A.set("trackId","tid").set("cookieDomain","").set("name",w).set("fieldOption","").set("userId","uid"),N.set("name","").set("fieldOption",""),j.set("field","").set("value","").set("fieldOption",""),C.set("page","dp").set("fieldOption",""),L.set("eventCategory","ec").set("eventAction","ea").set("eventLabel","el").set("eventValue","ev").set("fieldOption","").set("userId","uid"),_.set("socialNetwork","sn").set("socialAction","sa").set("socialTarget","st").set("fieldOption",""),K.set("screenName","sna").set("appName","an").set("appId","appid").set("appVersion","av").set("appInstallerId","aiid").set("fieldOption",""),B.set("timingCategory","tc").set("timingVar","tv").set("timingValue","tval").set("timingLabel","tl").set("fieldOption",""),M.set("openTime","ot").set("visitTime","vt"),P.set("exDescription","ed").set("exFatal","ef").set("fieldOption",""),I.set("name","").set("fieldOption",""),V.set(i[0],"").set(i[1],"").set(i[2],"").set(i[3],"").set(i[4],"").set(i[5],"").set(i[6],"").set(i[7],""),F.set("name","").set("construct","");var $,q,J,H,R,z,U,X=($=l,q={create:function(t){t=b.extend({},t);var e=b.getCookie(y.cookie,"fromadid");return e&&(t.aid=e),t},require:function(t){return(t=b.extend({},t)).option&&(b.extend(t,t.option),delete t.option),t},provide:function(t){return t},pageview:function(t,i){var e=$.pageview.field();return t[e.page]||(t[e.page]=encodeURI(location.pathname)),n||(b.viewTime(function(t,e){var n=X.call(null,o,[t,e],i);n&&O("image",n,i.url)}),n=!0),t},plus:function(o,e){o=b.extend({},o,function(t){return 0<b.indexOfArray(i,t)});var t,r,n,a,s,c,l=(t=b.delay,r=i.length,s={},c=t(function(){var t={t:"plus"};t.ub=a.join("-"),b.extend(t,s,function(t,e,n,i){if(e)return i[t]=e.join(","),!0}),b.extend(t,e.data),O(e.transport,t,e.url)},n),function(i,o){return function(t){var e=o&&o(t),n=k[i];if(!0===c())return a[i]||++a[i],void(e&&(b.isArray(s[n])?s[n].push(e):s[n]=[e]));s={},e&&(s[n]=[e]),(a=function(t,e){for(var n=new Array(t);t;)n[--t]=e;return n}(r,0))[i]=1}});!function(t,e,n){for(var i=(t=n(t)).length;i;)t[--i]&&b.addEvent(e,t[i],l(i,o[t[i]]))}(i,y,function(t){for(var e=0,n=t.length;e<n;++e)"turn"===t[e]?t[e]=g.orientation?"orientationchange":null:"swipe"!==t[e]&&"pinch"!==t[e]||(t[e]="ontouchstart"in g?"touchmove":null);return t})}},function(t,e,n){if(!t||!$[t])throw new TypeError("无此类型的操作:"+t);var i=function(t,e,n){var i=$[t],o=i.key(),r={};if(b.isArray(e)){for(var a=0,s=Math.min(o.length,e.length);a<s;++a)r[o[a]]=e[a];"object"===_typeof(r.fieldOption)&&(n&&b.keys(n.extra),b.extend(r,r.fieldOption),delete r.fieldOption)}else n&&(o=o.concat(b.keys(n.extra))),b.extend(r,e);var c=i.field(),l={};return b.each_Object(r,function(t,e){c[t]?l[c[t]]=e:h.test(t)?l[t.replace("dimension","cde")]=e:p.test(t)?l[t.replace("metric","cme")]=e:l[t]=e}),l.t=t,l.type&&delete l.type,l}(t,e,n);if(n){var o=b.extend({},n.data);b.extend(o,n.extra||{}),i=b.extend(o,i)}var r=q[t];return r&&(i=r(i,n)),b.each_Object(i,function(t,e){"string"==typeof e&&(i[t]=encodeURIComponent(e))}),i}),W=function(u,o,r){function t(t,e){if(null==t||null==e||null==e.tid)throw TypeError("trackId or name lost.");u(this),this.data||(this.data={}),this.dataKey||(this.dataKey=new E),this.config||(this.config={}),this.configKey||(this.configKey=new E);var i=this.extra={};if(this.name=t,e[w]&&delete e[w],this.type="tracker",this.url=d,"auto"===e.cookieDomain)if(/^\d{1,3}(\.\d{1,3}){3}$/.test(y.location.hostname))this.config.cookieDomain=y.location.hostname;else{var n=y.location.hostname.split(".");"www"===n[0]&&n.pop(),2<n.length&&(n=n.slice(-2)),this.config.cookieDomain=n.join(".")}else e.cookieDomain&&(this.config.cookieDomain=e.cookieDomain);delete e.cookieDomain;var o=this;if(b.extend(this.data,e,function(t,e,n){return o.dataKey.exist(t)?n[t]!==e:o.configKey.exist(t)?e!=o.config[t]&&(o.config[t]=e):void(i[t]=e)}),b.getCookie(y.cookie,"_wtc")){var r=b.getCookie(y.cookie,"_wtc");this.data.cid=r.split(".").slice(-2).join(".")}else{var a=this.config.cookieDomain.split("."),s=a.length;"www"===a[0]&&--s;var c=Math.floor(2147483647*Math.random())+"."+ +new Date,l="WTC."+s+"."+c;y.cookie="_wtc="+l+";max-age="+this.config.cookieExpires+";domain="+this.config.cookieDomain,this.data.cid=c}this.transport||(this.transport="image"),this.data.tid=e.tid,b.getCookie(y.cookie,x)&&(this.data[x]=b.getCookie(y.cookie,x))}u=u||function(){};var e=t.prototype;return e.get=function(t){if(t)return this.data[t]||this.extra&&this.extra[t]||this.config&&this.config[t]},e.set=function(t,e){var n=this.data;this.extra||(this.extra={});var i=this.extra;if("object"===_typeof(t)){var o=this;b.extend(n,t,function(t,e,n){return o.dataKey.exist(t)?e!==n[t]:o.configKey.exist(t)?e!==o.config[t]&&(o.config[t]=e):void(i[t]=e)})}else{if(this.configKey.exist(t))return value&&value!==this.config[t]&&(this.config[t]=value);if(this.dataKey.exist(t))null!=e&&(n[t]=e);else{if(this.extra[t]&&"undefined"===e)return void delete this.extra[t];this.extra[t]=e}}},e.send=function(t){if("object"===(void 0===t?"undefined":_typeof(t))){var e=t;t=e.hitType,delete e.hitType}else e=v.call(arguments,1);var n=o.call(null,t,e,this);n&&r(this.transport,n,this.url)},e.collectBP=function(t,e){if("object"===(void 0===t?"undefined":_typeof(t))){var n=t;t=n.hitType,delete n.hitType}else n=v.call(arguments,1);var i=o.call(null,t,n,this);i&&r(this.transport,i,this.url,e)},t}(function(t){t.data={ce:navigator.cookieEnabled?1:0,cd:(screen.colorDepth||0)+"-bit",de:y.charset||y.characterSet,dt:y.title||"",dr:y.referrer||"",dl:location.href,fl:b.flash(),je:navigator.javaEnabled()?1:0,v:"0.0.2",sr:screen.width+"x"+screen.height,vp:screen.availWidth+"x"+screen.availHeight},t.dataKey=new E("origin"),t.dataKey.set("cookiesEnable","ce").set("colorDeep","cd").set("encoding","de").set("title","dt").set("referer","dr").set("location","dl").set("flashVersion","fl").set("javaEnable","je").set("apiVersion","v").set("screenResolution","sr").set("viewportSize","vp"),t.configKey=new E("configKey"),t.configKey.set("cookieName","").set("cookieDomain","").set("cookieExpires",""),t.config={cookieDomain:window.location.hostname,cookieExpires:63072e3}},X,O);function G(){var t=[];b.extend(t,J,function(t,e,n){"provide"!==e[0]?n.push(e):R.apply(R,e)}),J=t;for(var e=0;e<J.length;++e){if(Y())return void(J=J.slice(e));R.apply(R,J[e])}}function Y(){return z}J=e,H=t,z=!1,U=new c({run:G,add:function(){J.push(arguments)},isStop:Y,changeState:function(){z=!z}},W,X),(R=function(t){U.distribute.apply(U,arguments)}).getByName=function(){return U.getByName.apply(U,arguments)},g[H||"_wtc"]=R,G()}(window,document);