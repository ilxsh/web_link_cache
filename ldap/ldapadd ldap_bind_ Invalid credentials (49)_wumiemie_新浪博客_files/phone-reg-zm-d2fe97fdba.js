define("phone-reg-zm",function(require,e,i){function t(){$("#account").on(D,function(){H||c();var e=$.trim($(this).val());e.length>32&&($(this).val(e.substr(0,32)),a.bubble("帐号最多为32个字符")),h=!!a.isPhone(e,_)}),$("#account").on("blur",function(){p=!1;var e=$.trim($(this).val());if(!h)return void r("请输入正确的手机号");r(""),v=!0,$.when(d.isExistAcct({acct:e})).done(function(e){v=!1,r("帐号已被注册，请重新输入"),p=!0}).fail(function(e){v=!1,p=!1,k.element&&($(k.element).trigger(k.type),k={}),10300!=e.code&&a.bubble(e.msg)})}),$("#smscode").on(D,function(){var e=$.trim($(this).val());e.length>9&&($(this).val(e.substr(0,9)),a.bubble("手机验证码最多为9位字符"))}),$("#smscode").on("blur",function(){var e=$.trim($(this).val());e&&!/^[a-zA-Z\d]+$/.test(e)?(f=!1,r("手机验证码只能输入字母或数字","smscode")):f=!0}),$("#password").on(D,function(){var e=$.trim($(this).val());e.length>16&&($(this).val(e.substr(0,16)),a.bubble("密码最多为16个字母或数字"))}),$("#password").on("blur",function(){var e=$.trim($(this).val());e.length<6||e.length>16||!C.test(e)?(g=!1,r("请输入6-16个数字或字母","password")):g=!0}),$("#btn-getSmscode").on("click",function(){H||c();var e=$.trim(u.val());if(!e)return a.bubble("手机号码不能为空");if(!h)return a.bubble("请输入正确的手机号码");if(p)return a.bubble("帐号已被注册，请重新输入");if(n({element:"#btn-getSmscode",type:"click"})){if(v)return void(k={element:"#btn-getSmscode",type:"click"});a.countDown($(this),120),a.sendSmscode(e,!0)}}),$("#img-code,#link-imgcode").on("click",function(){a.refreshImgcode(z)}),$(".confirm-imgcode").on("click",function(){$("#popup-mask").hide(),w.element&&($(w.element).trigger(w.type),w={})}),$("#btn-register").on("click",function(){if(H||c(),!m){var e=$.trim($("#account").val()),i=l.MD5($.trim($("#password").val())),t=$.trim($("#smscode").val()),s=$.trim($("#imgcode").val()),r=$("#agree").prop("checked");if(!h)return a.bubble("请输入正确的手机号码");if(p)return a.bubble("帐号已被注册，请重新输入");if($("#smscode").is(":hidden")&&$("#codeTips").is(":hidden"))return a.bubble("请获取手机验证码");if(!$("#smscode").is(":hidden")&&!t)return a.bubble("请输入手机验证码");if(!$("#smscode").is(":hidden")&&!f)return a.bubble("请输入正确的手机验证码");if(!g)return a.bubble("请输入正确格式的密码");if(!r)return a.bubble("请先勾选“已阅读并同意”服务条款");if(n({element:"#btn-register",type:"click"})){if(v)return void(k={element:"#btn-register",type:"click"});var u={acct:e,pass:i,phone:e,smscode:t,reg_source:A};"captcha"==a.whichCode?(u.slider_token=S.token||"",u.slider_pass=S.pass||""):(u.vkey=a.vkey,u.vcode=s),m=!0,$.when(d.regAcct(u)).done(function(i){m=!1,$("#register-form").hide(),$("#result-phone").show(),$(".reg-account").html(e)}).fail(function(e){m=!1,a.bubble(e.msg),o(e)})}}}),$("#agree").on("click",function(){$(this).prev(".icon-check").toggleClass("checked")}),$("#account, #smscode, #password").on("focus",function(){r("",this.id)})}function n(e){return a.isHascode?"captcha"!=a.whichCode||S?!("imgcode"==a.whichCode&&!$.trim($("#imgcode").val()))||($("#popup-mask").show(),e&&(w=e),!1):($("#slideWrap").css("visibility","visible"),e&&(w=e),!1):(y=!0,e&&(w=e),!1)}function o(e){10101==e.code||10102==e.code||10103==e.code?($("#popup-mask").show(),$("#img-code").attr("src","data:image/gif;base64,"+e.data.img),a.vkey=e.data.vkey):c()}function c(){b||W||(b=!0,a.isHascode=!1,S=null,H=!0,$.when(d.getSlider({gate:"id",env:3})).done(function(e){b=!1,a.isHascode=!0,a.whichCode="captcha",$.fn.slideDrage?s(e):(W=!0,seajs.use(["captcha"],function(){s(e),W=!1})),y&&(n(),y=!1)}).fail(function(e){b=!1,a.isHascode=!0,a.whichCode="imgcode",$("#img-code").attr("src","data:image/gif;base64,"+e.data.img),a.vkey=e.data.vkey}))}function s(e){var i=7.5*parseFloat($("html").css("font-size"))+"px";x||(i="190px");var t={token:e.data.token,appid:e.data.appid,product:"popup",width:i,onsuccess:function(e){$("#slideWrap").css("visibility","hidden"),S=e,w.element&&($(w.element).trigger(w.type),w={})},onclose:function(){$("#slideWrap").css("visibility","hidden")}};$("#slideWrap").slideDrage(t)}function r(e,i){i=i||"account",$(".info-"+i).hide(),$(".error-"+i).show(),$(".error-"+i).html(e)}var $=require("jquery"),a=require("commonZm"),d=require("api"),l=require("md5js");require("placeholders");var u=$("#account"),m=!1,b=!1,h=!1,f=!1,g=!1,p=!0,v=!1,k={},w={},y=!1,S=null,_="0086",C=/^[A-Za-z\d]{6,16}$/,z="reg",x=location.href.indexOf("phone-reg-zm-mobile")>0,A="sw4_pc_booking";x&&(A="sw4_h5_booking"),a.getUrlParam("regSource")&&(A=a.getUrlParam("regSource"));var D=x?"input":"keyup",H=!1,W=!1;$(function(){t()})});