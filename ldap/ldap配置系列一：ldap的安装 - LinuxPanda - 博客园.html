
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="origin" />
    <meta property="og:description" content="ldap的安装 ldap的简介 LDAP是轻量目录访问协议，英文全称是Lightweight Directory Access Protocol，一般都简称为LDAP。它是基于X.500标准的，但是简" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <title>ldap配置系列一：ldap的安装 - LinuxPanda - 博客园</title>
    
    <link rel="stylesheet" href="/css/blog-common.min.css?v=PyyhYDRKBG1sYtpoHme_xHO5AMd5iN57I45iBKF8FVY" />
    <link id="MainCss" rel="stylesheet" href="/skins/anothereon001/bundle-anothereon001.min.css?v=vmUk-3Bh8LDsKXwjNHs2GDiFna-ZMTUgOJzjUaXTlPA" />
    <link type="text/css" rel="stylesheet" href="https://www.cnblogs.com/zhaojiedi1992/custom.css?v=AwtrzG9ibL6uwfoukND&#x2B;Q1t7W&#x2B;8=" />
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/anothereon001/bundle-anothereon001-mobile.min.css?v=mrrPG4yy1c4rO5dX3ghe_4HUi7tMlrfN1z76EsgaDL0" />
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/zhaojiedi1992/rss" />
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/zhaojiedi1992/rsd.xml" />
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/zhaojiedi1992/wlwmanifest.xml" />
    <script src="https://common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script src="/js/blog-common.min.js?v=uwQIVMwLSzesgv0gdhdPchpc77YYlTqoNxDhi2Mz790"></script>
    <script>
        var currentBlogId = 123056;
        var currentBlogApp = 'zhaojiedi1992';
        var cb_enable_mathjax = true;
        var isLogined = false;
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
        tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processClass: 'math', processEscapes: true },
        TeX: {
        equationNumbers: { autoNumber: ['AMS'], useLabelIds: true },
        extensions: ['extpfeil.js', 'mediawiki-texvc.js'],
        Macros: {bm: "\\boldsymbol"}
        },
        'HTML-CSS': { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
        });
    </script>
    <script src="https://mathjax.cnblogs.com/2_7_5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
</head>
<body>
    <a name="top"></a>
    <div id="page_begin_html">
        <!-- 指定返回顶部位置#shwtop -->
<a href="#shwtop"><div id="toTop" style="zoom:0;"></div></a>

<!-- 添加页面放大和缩小功能按键 -->
<div id="divExpandViewArea" onclick="$('#main_container').css({'margin-left':'-195px'});$('#leftmenu').css({'display':'none'});">扩大</div>
<div id="divCollapseViewArea" onclick="$('#main_container').css({'margin-left':'0px'});$('#leftmenu').css({'display':'block'});">缩小</div>

<!-- 创建新的导航栏，内容可更改为你自己的-->
<div id="shwtop" >
    <ul style="margin-left:0px;margin-right: 0px;" class="test11" >
        <div class="dropdown">
            <a href="https://www.cnblogs.com/" class="dropbtn">博客园首页</span></a>
            <div class="dropdown-content">

            </div>
        </div>

        <div class="dropdown">
            <a href="http://www.cnblogs.com/zhaojiedi1992/" class="dropbtn">我的首页</span></a>
            <div class="dropdown-content">

            </div>
        </div>

        <div class="dropdown">
            <a href="#" class="dropbtn">全部分类</a>
            <div class="dropdown-content">
                <!-- <a class="menu" href="这里是你文章或随笔分类的链接地址，自己修改下面同理"> 这里更改下拉具体内容 </a> -->
                <a class="menu" href=""  >1.Linux</a>
                <a class="menu" href=""  >2.数据库</a>
                <a class="menu" href=""  >3.编程开发</a>
                <a class="menu" href=""  >4.容器学习</a>
                <a class="menu" href=""  >5.个人文档</a>
            </div>
        </div>


        <div class="dropdown">
            <a href="#" class="dropbtn">Linux</a>
            <div class="dropdown-content">
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/linux/"  >1.基础知识</a>
                <a class="menu" href="https://my-study-linux.readthedocs.io"  >2.基础笔记</a>
                <a class="menu" href="https://my-study-linux-services.readthedocs.io" >    3.服务笔记</a>
                <a class="menu" href="https://my-study-grep.readthedocs.io" >    4.grep笔记</a>
                <a class="menu" href="https://my-study-sed.readthedocs.io/en/latest/" >    5.sed笔记</a>
                <a class="menu" href="https://my-study-gawk.readthedocs.io/en/latest/" >    6.awk笔记</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/"  >更多...</a>
            </div>
        </div>


        <div class="dropdown">
            <a href="#" class="dropbtn">数据库</a>
            <div class="dropdown-content">
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/oracle/"  target="_Blank">1.oracle</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/mysql/"  target="_Blank">2.mysql</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/"  target="_Blank">更多...</a>
            </div>
        </div>



        <div class="dropdown">
            <a href="#" class="dropbtn">编程开发</a>
            <div class="dropdown-content">
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/C%23/"  target="_Blank">1.C#</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/c%2B%2B/"  target="_Blank">2.C++</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/python/"  target="_Blank">3.Python</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/PL%2FSQL/"  target="_Blank">4.PL/SQL</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/"  target="_Blank">更多...</a>
            </div>
        </div>

        <div class="dropdown">
            <a href="#" class="dropbtn">容器学习</a>
            <div class="dropdown-content">
                <a class="menu" href="https://my-study-docker.readthedocs.io/"  target="_Blank">1.docker</a>
                <a class="menu" href="https://my-study-kubernates.readthedocs.io/en/latest/"  target="_Blank">2.k8s</a>
                <a class="menu" href="https://www.cnblogs.com/zhaojiedi1992/tag/"  target="_Blank">更多...</a>
            </div>
        </div>

 
 
       <div class="dropdown">
            <a href="#" class="dropbtn">个人文档</a>
            <div class="dropdown-content">
                <a class="menu" href="https://my-study-linux.readthedocs.io"  target="_Blank">1.linu基础学习</a>
                <a class="menu" href="https://my-study-linux-services.readthedocs.io/"  target="_Blank">2.linux服务学习</a>
                <a class="menu" href="https://my-study-python.readthedocs.io/"  target="_Blank">3.python学习</a>
            </div>
        </div>


        </div>
    </ul>
</div>
    </div>
    <div id="wrapper">
<div id="header">

<div id="top">
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/zhaojiedi1992/">赵杰迪</a>
</h1>
<div id="subtitle">

</div>
</div>
<div id="sub"><div class="BlogStats">随笔 - 
337, 文章 - 
0, 评论 - 
38, 引用 - 
0</div>

</div>




</div>
<div id="main_container">
<div id="main_content">
<div id="content">
	<div id="post_detail">
    <div class="post">
        <h2>
            
<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/zhaojiedi1992/p/zhaojiedi_liunx_52_ldap.html">ldap配置系列一：ldap的安装</a>

        </h2>
        <div class="postbody">
            
<div id="cnblogs_post_body" class="blogpost-body ">
    <h1>ldap的安装</h1>
<h2>ldap的简介</h2>
<p>LDAP是轻量目录访问协议，英文全称是Lightweight Directory Access Protocol，一般都简称为LDAP。它是基于X.500标准的，但是简单多了并且可以根据需要定制。与X.500不同，LDAP支持TCP/IP，这对访问Internet是必须的。LDAP的核心规范在RFC中都有定义，所有与LDAP相关的RFC都可以在LDAPman RFC网页中找到。</p>
<h2>选择一个域名</h2>
<p>我个人的域名为linuxpanda.tech，我给ldap服务配置一个域名为ldap.aibeike.com。通过dns解析添加一个A记录值为我自己的ldap服务器的外网ip。</p>
<p>测试域名正确性。</p>
<div class="cnblogs_code">
<pre>[root@VM_0_15_centos ~]# <span style="color: #0000ff;">ping</span> -c <span style="color: #800080;">2</span><span style="color: #000000;"> ldap.linuxpanda.tech
PING ldap.linuxpanda.tech (</span><span style="color: #800080;">39.106</span>.<span style="color: #800080;">157.220</span>) <span style="color: #800080;">56</span>(<span style="color: #800080;">84</span><span style="color: #000000;">) bytes of data.
</span><span style="color: #800080;">64</span> bytes from <span style="color: #800080;">39.106</span>.<span style="color: #800080;">157.220</span> (<span style="color: #800080;">39.106</span>.<span style="color: #800080;">157.220</span>): icmp_seq=<span style="color: #800080;">1</span> ttl=<span style="color: #800080;">52</span> <span style="color: #0000ff;">time</span>=<span style="color: #800080;">3.40</span><span style="color: #000000;"> ms
</span><span style="color: #800080;">64</span> bytes from <span style="color: #800080;">39.106</span>.<span style="color: #800080;">157.220</span> (<span style="color: #800080;">39.106</span>.<span style="color: #800080;">157.220</span>): icmp_seq=<span style="color: #800080;">2</span> ttl=<span style="color: #800080;">52</span> <span style="color: #0000ff;">time</span>=<span style="color: #800080;">3.37</span><span style="color: #000000;"> ms

</span>--- ldap.linuxpanda.tech <span style="color: #0000ff;">ping</span> statistics ---
<span style="color: #800080;">2</span> packets transmitted, <span style="color: #800080;">2</span> received, <span style="color: #800080;">0</span>% packet loss, <span style="color: #0000ff;">time</span><span style="color: #000000;"> 1000ms
rtt min</span>/avg/max/mdev = <span style="color: #800080;">3.370</span>/<span style="color: #800080;">3.385</span>/<span style="color: #800080;">3.401</span>/<span style="color: #800080;">0.060</span> ms</pre>
</div>
<h2>安装openldap服务端</h2>
<div class="cnblogs_code">
<pre>[root@VM_0_15_centos ~]# <span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> openldap-servers openldap-clients -y ^<span style="color: #000000;">C
[root@VM_0_15_centos </span>~]# <span style="color: #0000ff;">cp</span> /usr/share/openldap-servers/DB_CONFIG.example  /var/lib/ldap/<span style="color: #000000;">DB_CONFIG 
[root@VM_0_15_centos </span>~]# <span style="color: #0000ff;">chown</span> -R ldap.ldap /var/lib/<span style="color: #000000;">ldap 
[root@VM_0_15_centos </span>~<span style="color: #000000;">]# systemctl enable slapd 
Created symlink from </span>/etc/systemd/system/multi-user.target.wants/slapd.service to /usr/lib/systemd/system/<span style="color: #000000;">slapd.service.
[root@VM_0_15_centos </span>~]# systemctl start slapd<br />[root@VM_0_15_centos ~]# systemctl status slapd</pre>
</div>
<h2>设置ldap的管理员用户的密码</h2>
<div class="cnblogs_code">
<pre># 设置ldap的管理员密码，用户名为root<br />[root@VM_0_15_centos ~<span style="color: #000000;">]# slappasswd 
New password: 
Re</span>-<span style="color: #000000;">enter new password: 
{SSHA}6qygfSS2fBqjb0KhiaPo21btIt9</span>+<span style="color: #000000;">8EbL
<br /># 创建ldif文件
[root@VM_0_15_centos ldap]# cd </span>/etc/openldap/<span style="color: #000000;">
[root@VM_0_15_centos openldap]# </span><span style="color: #0000ff;">mkdir</span><span style="color: #000000;"> myself
[root@VM_0_15_centos openldap]# cd myself</span>/<span style="color: #000000;">
[root@VM_0_15_centos myself]# vim chrootpw.ldif
dn: olcDatabase</span>={<span style="color: #800080;">0</span>}config,cn=<span style="color: #000000;">config
changetype: modify
add: olcRootPW
olcRootPW: {SSHA}6qygfSS2fBqjb0KhiaPo21btIt9</span>+<span style="color: #000000;">8EbL
<br /># 根据文件导入
[root@VM_0_15_centos myself]# ldapadd </span>-Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f chrootpw.ldif </span>
SASL/<span style="color: #000000;">EXTERNAL authentication started
SASL username: gidNumber</span>=<span style="color: #800080;">0</span>+uidNumber=<span style="color: #800080;">0</span>,cn=peercred,cn=external,cn=<span style="color: #000000;">auth
SASL SSF: </span><span style="color: #800080;">0</span><span style="color: #000000;">
modifying entry </span><span style="color: #800000;">"</span><span style="color: #800000;">olcDatabase={0}config,cn=config</span><span style="color: #800000;">"</span></pre>
</div>
<h2>添加基础的schema</h2>
<div class="cnblogs_code">
<pre>ldapadd -Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f /etc/openldap/schema/cosine.ldif</span>
ldapadd -Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f /etc/openldap/schema/nis.ldif</span>
ldapadd -Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f /etc/openldap/schema/inetorgperson.ldif</span></pre>
</div>
<h2>设置根域和数据库超级管理员</h2>
<p>这里的根域和上面提到的linuxpanda.tech不是一回事，我们这里为了和自身域名还是保持一致好些，设置为dc=linuxpanda.tech,dc=com。</p>
<p>这里的数据库管理员和上面的超级管理员也不是一回事，为了方便，我们还是使用上面的管理员密码来设置数据库库的密码。</p>
<div class="cnblogs_code">
<pre>[root@VM_0_15_centos myself]# vim domain-<span style="color: #000000;">dbadmin.ldif

[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">cat</span> domain-<span style="color: #000000;">dbadmin.ldif 
dn: olcDatabase</span>={<span style="color: #800080;">1</span>}monitor,cn=<span style="color: #000000;">config
changetype: modify
replace: olcAccess
olcAccess: {</span><span style="color: #800080;">0</span>}to *<span style="color: #000000;">
  by dn.base</span>=<span style="color: #800000;">"</span><span style="color: #800000;">gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth</span><span style="color: #800000;">"</span><span style="color: #000000;"> read
  by dn.base</span>=<span style="color: #800000;">"</span><span style="color: #800000;">cn=admin,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span><span style="color: #000000;"> read
  by </span>*<span style="color: #000000;"> none

dn: olcDatabase</span>={<span style="color: #800080;">2</span>}hdb,cn=<span style="color: #000000;">config
changetype: modify
replace: olcSuffix
olcSuffix: dc</span>=linuxpanda,dc=<span style="color: #000000;">tech

dn: olcDatabase</span>={<span style="color: #800080;">2</span>}hdb,cn=<span style="color: #000000;">config
changetype: modify
replace: olcRootDN
olcRootDN: cn</span>=admin,dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: olcDatabase</span>={<span style="color: #800080;">2</span>}hdb,cn=<span style="color: #000000;">config
changetype: modify
add: olcRootPW
olcRootPW: {SSHA}6qygfSS2fBqjb0KhiaPo21btIt9</span>+<span style="color: #000000;">8EbL

dn: olcDatabase</span>={<span style="color: #800080;">2</span>}hdb,cn=<span style="color: #000000;">config
changetype: modify
add: olcAccess
olcAccess: {</span><span style="color: #800080;">0</span>}to attrs=<span style="color: #000000;">userPassword,shadowLastChange
  by dn</span>=<span style="color: #800000;">"</span><span style="color: #800000;">cn=admin,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">write</span><span style="color: #000000;">
  by anonymous auth
  by self </span><span style="color: #0000ff;">write</span><span style="color: #000000;">
  by </span>*<span style="color: #000000;"> none
olcAccess: {</span><span style="color: #800080;">1</span>}to dn.base=<span style="color: #800000;">""</span><span style="color: #000000;">
  by </span>*<span style="color: #000000;"> read
olcAccess: {</span><span style="color: #800080;">2</span>}to *<span style="color: #000000;">
  by dn</span>=<span style="color: #800000;">"</span><span style="color: #800000;">cn=admin,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">write</span><span style="color: #000000;">
  by </span>*<span style="color: #000000;"> read

[root@VM_0_15_centos myself]# ldapadd  </span>-Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f domain-dbadmin.ldif</span></pre>
</div>
<h2>&nbsp;创建基本的用户节点，组节点，数据库管理员</h2>
<div class="cnblogs_code">
<pre><span style="color: #000000;">[root@VM_0_15_centos myself]# vim basedomain.ldif

[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">cat</span><span style="color: #000000;"> basedomain.ldif 
dn: dc</span>=linuxpanda,dc=<span style="color: #000000;">tech
objectClass: top
objectClass: dcObject
objectclass: organization
o: Example Inc.
dc: linuxpanda

dn: ou</span>=people,dc=linuxpanda,dc=<span style="color: #000000;">tech
objectClass: organizationalUnit
ou: user

dn: ou</span>=group,dc=linuxpanda,dc=<span style="color: #000000;">tech
objectClass: organizationalUnit
ou: group

dn: cn</span>=admin,dc=linuxpanda,dc=<span style="color: #000000;">tech
objectClass: organizationalRole
cn: admin
description: Directory Administrator

[root@VM_0_15_centos myself]# ldapadd  </span>-x -D cn=admin,dc=linuxpanda,dc=tech -W -<span style="color: #000000;">f basedomain.ldif  
Enter LDAP Password: 
adding new entry </span><span style="color: #800000;">"</span><span style="color: #800000;">dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span><span style="color: #000000;">

adding new entry </span><span style="color: #800000;">"</span><span style="color: #800000;">ou=people,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span><span style="color: #000000;">

adding new entry </span><span style="color: #800000;">"</span><span style="color: #800000;">ou=group,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span><span style="color: #000000;">

adding new entry </span><span style="color: #800000;">"</span><span style="color: #800000;">cn=admin,dc=linuxpanda,dc=tech</span><span style="color: #800000;">"</span></pre>
</div>
<h2>防火墙设置</h2>
<div class="cnblogs_code">
<pre>[root@VM_0_15_centos myself]# firewall-cmd --permanent --add-service=<span style="color: #000000;">ldap 
success
[root@VM_0_15_centos myself]# firewall</span>-cmd --<span style="color: #000000;">reload 
success</span></pre>
</div>
<h2>配置日志</h2>
<div class="cnblogs_code">
<pre><span style="color: #000000;">[root@VM_0_15_centos myself]# vim log.ldif

[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">cat</span><span style="color: #000000;"> log.ldif   
dn: cn</span>=<span style="color: #000000;">config
changetype: modify
add: olcLogLevel
olcLogLevel: </span><span style="color: #800080;">32</span>     
                                                                          
<span style="color: #800000;">"</span><span style="color: #800000;">log.ldif</span><span style="color: #800000;">"</span> [New] <span style="color: #800080;">4L</span><span style="color: #000000;">, 66C written                                                   
[root@VM_0_15_centos myself]# ldapmodify </span>-Y EXTERNAL -H ldapi:<span style="color: #808080;">///</span><span style="color: #008000;"> -f log.ldif</span>
SASL/<span style="color: #000000;">EXTERNAL authentication started
SASL username: gidNumber</span>=<span style="color: #800080;">0</span>+uidNumber=<span style="color: #800080;">0</span>,cn=peercred,cn=external,cn=<span style="color: #000000;">auth
SASL SSF: </span><span style="color: #800080;">0</span><span style="color: #000000;">
modifying entry </span><span style="color: #800000;">"</span><span style="color: #800000;">cn=config</span><span style="color: #800000;">"</span><span style="color: #000000;">

[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">mkdir</span> -p /var/log/<span style="color: #000000;">slapd
[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">chown</span> ldap:ldap /var/log/slapd/<span style="color: #000000;">
[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">local4.* /var/log/slapd/slapd.log</span><span style="color: #800000;">"</span> &gt;&gt; /etc/<span style="color: #000000;">rsyslog.conf
[root@VM_0_15_centos myself]# systemctl restart rsyslog<br />[root@VM_0_15_centos myself]# systemctl restart slapd
[root@VM_0_15_centos myself]# </span><span style="color: #0000ff;">tail</span> -n <span style="color: #800080;">4</span> /var/log/slapd/<span style="color: #000000;">slapd.log
Sep  </span><span style="color: #800080;">5</span> <span style="color: #800080;">20</span>:<span style="color: #800080;">43</span>:<span style="color: #800080;">31</span> VM_0_15_centos slapd[<span style="color: #800080;">4520</span>]: =&gt;<span style="color: #000000;"> test_filter
Sep  </span><span style="color: #800080;">5</span> <span style="color: #800080;">20</span>:<span style="color: #800080;">43</span>:<span style="color: #800080;">31</span> VM_0_15_centos slapd[<span style="color: #800080;">4520</span><span style="color: #000000;">]:    PRESENT
Sep  </span><span style="color: #800080;">5</span> <span style="color: #800080;">20</span>:<span style="color: #800080;">43</span>:<span style="color: #800080;">31</span> VM_0_15_centos slapd[<span style="color: #800080;">4520</span>]: &lt;= test_filter <span style="color: #800080;">6</span><span style="color: #000000;">
Sep  </span><span style="color: #800080;">5</span> <span style="color: #800080;">20</span>:<span style="color: #800080;">43</span>:<span style="color: #800080;">31</span> VM_0_15_centos slapd[<span style="color: #800080;">4523</span>]: slapd starting</pre>
</div>
<h2>使用工具连接</h2>
<p>有些人喜欢安装套ldap环境来管理ldap用户， 我这里使用ldapadmin.exe来管理。下载地址为：&nbsp;</p>
<p>连接信息如下：</p>
<p><img src="https://images2018.cnblogs.com/blog/429277/201809/429277-20180905205434367-418389381.png" alt="" /></p>
<p>主界面如下：&nbsp;</p>
<p><img src="https://images2018.cnblogs.com/blog/429277/201809/429277-20180905205441909-1185981155.png" alt="" /></p>
<p><span style="color: #ff0000;">&nbsp;这里强烈建议给每个用户配置邮箱。</span></p>
<h2>添加用户或者测试组</h2>
<p><img src="https://images2018.cnblogs.com/blog/429277/201809/429277-20180905205754278-1009049348.png" alt="" /></p>
<p>&nbsp;</p>
<h2>常用查询命令</h2>
<div class="cnblogs_code">
<pre># 查询主域下的信息<br />[root@VM_0_15_centos ~]# ldapsearch  -LLL -<span style="color: #0000ff;">w</span> oracle  oracle -x -H ldap:<span style="color: #008000;">//</span><span style="color: #008000;">58.87.98.84 -D"cn=admin,dc=linuxpanda,dc=tech" -b "dc=linuxpanda,dc=tech"  </span>
dn: dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: ou</span>=people,dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: ou</span>=group,dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: cn</span>=admin,dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: uid</span>=test01,ou=people,dc=linuxpanda,dc=<span style="color: #000000;">tech

# 查询people组下面的uid=test01的用户
[root@VM_0_15_centos </span>~]# ldapsearch  -LLL -<span style="color: #0000ff;">w</span> oracle  oracle -x -H ldap:<span style="color: #008000;">//</span><span style="color: #008000;">58.87.98.84 -D"cn=admin,dc=linuxpanda,dc=tech" -b "ou=people,dc=linuxpanda,dc=tech" "(uid=test01)"</span>
dn: ou=people,dc=linuxpanda,dc=<span style="color: #000000;">tech

dn: uid</span>=test01,ou=people,dc=linuxpanda,dc=<span style="color: #000000;">tech
# 备份
[root@VM_0_15_centos </span>~]# ldapsearch  -LLL -<span style="color: #0000ff;">w</span> oracle  oracle -x -H ldap:<span style="color: #008000;">//</span><span style="color: #008000;">58.87.98.84 -D"cn=admin,dc=linuxpanda,dc=tech" -b "dc=linuxpanda,dc=tech" "(uid=test01)" &gt;linuxpanda.tech.ldap.bak</span></pre>
</div>
<p>&nbsp;</p>
<h2>参考</h2>
<p>&nbsp;李广慧： https://www.jianshu.com/p/dc7112873e68</p>
<p>&nbsp;ldap-how-to:&nbsp;<a href="https://www.itzgeek.com/how-tos/linux/centos-how-tos/step-step-openldap-server-configuration-centos-7-rhel-7.html" target="_blank">https://www.itzgeek.com/how-tos/linux/centos-how-tos/step-step-openldap-server-configuration-centos-7-rhel-7.html</a></p>
<p>&nbsp;wiki：&nbsp;<a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_blank">https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol</a></p>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
    <div id="blog_post_info"></div>
    <div class="clear"></div>
    <div id="post_next_prev"></div>
</div>
        </div>
        <p class="postfoot">
            posted on 
<span id="post-date">2018-09-06 13:20</span>&nbsp;<a href="https://www.cnblogs.com/zhaojiedi1992/">LinuxPanda</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>) <a href="https://i.cnblogs.com/EditPosts.aspx?postid=9594166" rel="nofollow"> 编辑</a> <a href="javascript:void(0)" onclick="AddToWz(9594166); return false;">收藏</a>

        </p>
    </div>
</div>

<script src="https://common.cnblogs.com/highlight/9.12.0/highlight.min.js"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 123056, cb_blogApp = 'zhaojiedi1992', cb_blogUserGuid = 'a6c0819a-7fd1-e111-aa3f-842b2b196315';
    var cb_entryId = 9594166, cb_entryCreatedDate = '2018-09-06 13:20', cb_postType = 1; 
    loadViewCount(cb_entryId);
</script><a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>

<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
    <div id="comment_form_container"></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"></div>
    <div id="opt_under_post"></div>
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag.pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block">
        <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;"></div>
    </div>
    <div id="under_post_news"></div>
    <div id="cnblogs_c2" class="c_ad_block">
        <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;">
            <script>
                if (new Date() >= new Date(2018, 9, 13)) {
                    googletag.cmd.push(function () { googletag.display("div-gpt-ad-1539008685004-0"); });
                }
            </script>
        </div>
    </div>
    <div id="under_post_kb"></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div>

</div>
</div>
<div id="leftmenu">


<h3>导航</h3>
<ul>
    <li>
        <a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>

    </li>
    <li>
        
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/zhaojiedi1992/">
首页</a>

    </li>
    <li>
        

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>

    </li>
    <li>
        
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/LinuxPanda">
联系</a>
    </li>
    <li>
        

        

    </li>
    <li>
        
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>

    </li>
</ul>


<div id="blog-calendar" style="display:none"></div><script>loadBlogDefaultCalendar();</script>

<div id="sidebar_news" class="newsItem">
            <script>loadBlogNews();</script>
</div>

<div id="blog-sidecolumn"></div>
                    <script>loadBlogSideColumn();</script>

</div>
</div>
<div class="clear"></div>
<div id="footer">
<p id="footer">
	Powered by: 
	<br />
	
	
<a href="https://www.cnblogs.com/" id="Footer1_Hyperlink3" style="font-size: 12px; font-family: Verdana">博客园</a>
	<br />
	Copyright &copy; 2019 LinuxPanda
<br /><span id="poweredby">Powered by .NET Core 3.0.0 on Linux</span>

</p>


</div>
</div>


    <div id="page_end_html">
        <!-- 生成博客目录的JS代码，两级目录 -->
<script type="text/javascript">
/*  
    这段代码按H2、H3格式生成两级菜单
    写博客按H2、H3格式写，不然生成不了
    Markdown写作按##、###两级目录写
    当然你也可以改写代码成三级菜单
    参考：孤傲苍狼    zhang_derek
    洪卫    2018-5-18 
*/
var BlogDirectory = {
    /* 获取元素位置，距浏览器左边界的距离（left）和距浏览器上边界的距离（top）*/
    getElementPosition:function (ele) {
        var topPosition = 0;
        var leftPosition = 0;
        while (ele){
            topPosition += ele.offsetTop;
            leftPosition += ele.offsetLeft;
            ele = ele.offsetParent;
        }
        return {top:topPosition, left:leftPosition};
    },
    /*获取滚动条当前位置 */
    getScrollBarPosition:function () {
        var scrollBarPosition = document.body.scrollTop || document.documentElement.scrollTop;
        return  scrollBarPosition;
    },
    /* 移动滚动条，finalPos 为目的位置，internal 为移动速度 */
    moveScrollBar:function(finalpos, interval) {
        //若不支持此方法，则退出
        if(!window.scrollTo) {
            return false;
        }
        
        //窗体滚动时，禁用鼠标滚轮
        window.onmousewheel = function(){
            return false;
        };
        
        //清除计时
        if (document.body.movement) {
            clearTimeout(document.body.movement);
        }
        
        //获取滚动条当前位置
        var currentpos =BlogDirectory.getScrollBarPosition();

        var dist = 0;
        //到达预定位置，则解禁鼠标滚轮，并退出
        if (currentpos == finalpos) {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }
        //未到达，则计算下一步所要移动的距离
        if (currentpos < finalpos) {
            dist = Math.ceil((finalpos - currentpos)/10);
            currentpos += dist;
        }
        if (currentpos > finalpos) {
            dist = Math.ceil((currentpos - finalpos)/10);
            currentpos -= dist;
        }

        var scrTop = BlogDirectory.getScrollBarPosition();//获取滚动条当前位置
        window.scrollTo(0, currentpos);//移动窗口
        if(BlogDirectory.getScrollBarPosition() == scrTop)//若已到底部，则解禁鼠标滚轮，并退出
        {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }

        //进行下一步移动
        var repeat = "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")";
        document.body.movement = setTimeout(repeat, interval);
    },

    htmlDecode:function (text){
        var temp = document.createElement("div");
        temp.innerHTML = text;
        var output = temp.innerText || temp.textContent;
        temp = null;
        return output;
    },
    
    /*
    创建博客目录，id表示包含博文正文的 div 容器的 id，
    mt 和 st 分别表示主标题和次级标题的标签名称（如 H2、H3，大写或小写都可以！），
    interval 表示移动的速度
    */
    createBlogDirectory:function (id, mt, st, interval){
        //获取博文正文div容器
        var elem = document.getElementById(id);
        if(!elem) return false;
        //获取div中所有元素结点
        var nodes = elem.getElementsByTagName("*");
        //创建博客目录的div容器
        var divSideBar = document.createElement('DIV');
        divSideBar.className = 'uprightsideBar';
        divSideBar.setAttribute('id', 'uprightsideBar');
        var divSideBarTab = document.createElement('DIV');
        divSideBarTab.setAttribute('id', 'sideBarTab');
        divSideBar.appendChild(divSideBarTab);
        var h2 = document.createElement('H2');
        divSideBarTab.appendChild(h2);
        var txt = document.createTextNode('目录导航');
        h2.appendChild(txt);
        var divSideBarContents = document.createElement('DIV');
        divSideBarContents.style.display = 'none';
        divSideBarContents.setAttribute('id', 'sideBarContents');
        divSideBar.appendChild(divSideBarContents);
        //创建自定义列表
        var dlist = document.createElement("dl");
        divSideBarContents.appendChild(dlist);
        var num = 0;//统计找到的mt和st
        mt = mt.toUpperCase();//转化成大写
        st = st.toUpperCase();//转化成大写
        //遍历所有元素结点
        for(var i=0; i<nodes.length; i++)
        {
            if(nodes[i].nodeName == mt|| nodes[i].nodeName == st)
            {
                //获取标题文本
                var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g,"");//innerHTML里面的内容可能有HTML标签，所以用正则表达式去除HTML的标签
                nodetext = nodetext.replace(/ /ig, "");//替换掉所有的
                nodetext = BlogDirectory.htmlDecode(nodetext);
                //插入锚
                nodes[i].setAttribute("id", "blogTitle" + num);
                var item;
                switch(nodes[i].nodeName)
                {
                    case mt:    //若为主标题
                        item = document.createElement("dt");
                        break;
                    case st:    //若为子标题
                        item = document.createElement("dd");
                        break;
                }

                //创建锚链接
                var itemtext = document.createTextNode(nodetext);
                item.appendChild(itemtext);
                item.setAttribute("name", num);
                //添加鼠标点击触发函数
                item.onclick = function(){        
                var pos = BlogDirectory.getElementPosition(document.getElementById("blogTitle" + this.getAttribute("name")));
                    if(!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
                };
                //将自定义表项加入自定义列表中
                dlist.appendChild(item);
                num++;
            }
        }

        if(num == 0) return false;
        /* 鼠标进入时的事件处理 */
        divSideBarTab.onmouseenter = function(){
            divSideBarContents.style.display = 'block';
        }
        /* 鼠标离开时的事件处理 */
        divSideBar.onmouseleave = function() {
            divSideBarContents.style.display = 'none';
        }

        document.body.appendChild(divSideBar);
    }

};

window.onload=function(){
    /* 页面加载完成之后生成博客目录 */
    BlogDirectory.createBlogDirectory("cnblogs_post_body","h2","h3",20);
    
    //为右下角推荐推荐区域添加关注按钮
    $('#div_digg').prepend('<div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px"></span><a onclick="cnblogs.UserManager.FollowBlogger(\'a6c0819a-7fd1-e111-aa3f-842b2b196315\');" href="javascript:void(0);" style="font-weight: bold; padding-left:5px;">关注一下楼主吧</a> </div>');
}
</script>
    </div>
</body>
</html>
