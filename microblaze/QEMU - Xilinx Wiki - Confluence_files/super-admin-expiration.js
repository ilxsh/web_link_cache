(window.webpackJsonp=window.webpackJsonp||[]).push([[360],{IkOR:function(e,n,t){"use strict";t.r(n);var i=t("VrFO"),o=t.n(i),r=t("N+ot"),a=t.n(r),s=t("AuHH"),u=t.n(s),c=t("1Pcy"),d=t.n(c),l=t("5Yy7"),p=t.n(l),f=t("KEM+"),m=t.n(f),g=t("ERkP"),y=t.n(g),v=t("PTiB"),h=(t("aWzz"),t("WlwD")),E=t("tqyq"),A=t("B5Kc"),w=t("Y9Ll"),S=t.n(w),x=t("7wq/"),b=t.n(x),C=t("L21V"),K=t("KsTJ"),T=t("n9CL"),k=function(e){function n(){var e,t;o()(this,n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=a()(this,(e=u()(n)).call.apply(e,[this].concat(r))),m()(d()(t),"state",{countdown:0,interval:void 0}),m()(d()(t),"startCountdown",function(){t.props.initialCountdown>0&&t.setState({countdown:t.props.initialCountdown},function(){return t.setState({interval:setInterval(t.intervalHandler,1e3)})})}),m()(d()(t),"stopCountdown",function(){clearInterval(t.state.interval)}),m()(d()(t),"intervalHandler",function(){t.state.countdown>0?t.decrementCountdown():t.stopCountdown()}),m()(d()(t),"decrementCountdown",function(){t.setState({countdown:t.state.countdown-1})}),t}return p()(n,e),S()(n,[{key:"componentDidMount",value:function(){this.startCountdown()}},{key:"componentWillUnmount",value:function(){this.stopCountdown()}},{key:"render",value:function(){return this.state.countdown}}]),n}(g.Component);function F(){var e=b()(["\n  font-weight: bold;\n  display: inline;\n"]);return F=function(){return e},e}k.displayName="Counter";var M=Object(C.f)({timeoutSuperAdminTitle:{id:"super-admin.timeout.super.admin.title",defaultMessage:"Still there?",description:"Title for the flag for Admin Key expiry notification"},superAdminTimerFlagAction:{id:"super-admin.timer.flag,action",defaultMessage:"Keep using admin key",description:"Text for the action on Super Admin timeout flag"}}),D=K.default.div(F()),I=function(){},O=function(e){function n(){var e,t;o()(this,n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=a()(this,(e=u()(n)).call.apply(e,[this].concat(r))),m()(d()(t),"state",{flagId:void 0}),m()(d()(t),"handleAKTimeout",function(e,n,i){Object(T.b)(Object(T.c)())({beforeNotify:function(){return t.waitFor1Second(function(){i&&t.hideFlag(n),t.handleAKTimeout(e,n,!1)})},afterNotify:function(o){return t.waitFor1Second(function(){i||t.showFlag(n,o),t.handleAKTimeout(e,n,!0)})},afterExpiry:function(){return e()},noTimeout:I})}),m()(d()(t),"waitFor1Second",function(e){setTimeout(e,1e3)}),m()(d()(t),"showFlag",function(e,n){var i=t.props.intl;e.showWarningFlag({title:i.formatMessage(M.timeoutSuperAdminTitle),description:t.renderFlagDescription(n),actions:[{content:i.formatMessage(M.superAdminTimerFlagAction),onClick:t.onClickKeepUsing(e)}]}).then(function(e){return t.setState({flagId:e.id})})}),m()(d()(t),"renderFlagDescription",function(e){return y.a.createElement(C.b,{id:"super-admin.timeout.super.admin.description",defaultMessage:"Due to inactivity, you will be signed out in {counter}.",description:"Description  for the flag for Admin Key expiry notification",values:{counter:y.a.createElement(D,null,y.a.createElement(C.b,{id:"super-admin.timeout.super.admin.description.counter",defaultMessage:"{counter} seconds",description:"Part of description for the flag for Admin Key expiry notification",values:{counter:y.a.createElement(k,{initialCountdown:Object(T.d)(e)})}}))}})}),m()(d()(t),"onClickKeepUsing",function(e){return function(){Object(T.e)(),t.fireAdminKeyExtendedAnalyticsEvent(),t.hideFlag(e)}}),m()(d()(t),"fireAdminKeyExtendedAnalyticsEvent",function(){t.props.createAnalyticsEvent({type:"sendTrackEvent",data:{source:"superAdminExpiration",action:"extended",actionSubject:"adminKeySession"}}).fire()}),t}return p()(n,e),S()(n,[{key:"componentDidMount",value:function(){var e=this.props,n=e.disableSuperAdminTrigger,t=e.flags;this.handleAKTimeout(n,t,!1)}},{key:"hideFlag",value:function(e){void 0!==this.state.flagId&&e.hideFlag(this.state.flagId)}},{key:"render",value:function(){return null}}]),n}(g.Component);O.displayName="SuperAdminExpirationTimerComponent";var j=Object(v.a)()(Object(C.g)(O)),N=Object(C.f)({sessionExpirationTitle:{id:"super-admin.session.expiration.title",defaultMessage:"Access to restricted pages has ended",description:"Title for Super admin session expiration flag"},sessionExpirationDescription:{id:"super-admin.session.expiration.description",defaultMessage:"You’ve been inactive for a while. To keep things secure, we’ve ended your access to restricted pages.",description:"Description for Super admin session expiration flag"}}),P=function(e){function n(){var e,t;o()(this,n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=a()(this,(e=u()(n)).call.apply(e,[this].concat(r))),m()(d()(t),"showFlag",function(){var e=t.props,n=e.flags,i=e.intl;n.showInfoFlag({title:i.formatMessage(N.sessionExpirationTitle),description:i.formatMessage(N.sessionExpirationDescription)})}),t}return p()(n,e),S()(n,[{key:"componentDidMount",value:function(){var e=this;h.a.getAndRemoveItem(E.a.SUPERADMIN_SESSION_EXPIRED).then(function(n){n&&e.showFlag()})}},{key:"render",value:function(){return null}}]),n}(g.Component);P.displayName="SuperAdminExpirationFlagComponent";var R=Object(C.g)(P);t.d(n,"SuperAdminExpiration",function(){return H});var U=function(e){function n(){var e,t;o()(this,n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=a()(this,(e=u()(n)).call.apply(e,[this].concat(r))),m()(d()(t),"fireAdminKeyExpiredAnalyticsEvent",function(){t.props.createAnalyticsEvent({type:"sendTrackEvent",data:{source:"superAdminExpiration",action:"expired",actionSubject:"adminKeySession"}}).fire()}),m()(d()(t),"fireAdminKeyExpiryFailedAnalyticsEvent",function(){return t.props.createAnalyticsEvent({type:"sendTrackEvent",data:{action:"failed",actionSubject:"exitAdminKeySession",source:"superAdminExpiration"}}).fire()}),m()(d()(t),"setAKSessionExpired",function(){return h.a.setItem(E.a.SUPERADMIN_SESSION_EXPIRED,!0,Object(T.a)(new Date,10))}),m()(d()(t),"render",function(){return y.a.createElement(A.a,{handleMutationCompleteCallback:function(){return t.fireAdminKeyExpiredAnalyticsEvent(),t.setAKSessionExpired()},handleMutationErrorCallback:function(){return t.fireAdminKeyExpiryFailedAnalyticsEvent(),Promise.resolve()}},function(e,n){return y.a.createElement(g.Fragment,null,y.a.createElement(j,{flags:n,disableSuperAdminTrigger:e}),y.a.createElement(R,{flags:n}))})}),t}return p()(n,e),n}(g.Component),H=Object(v.a)()(U)}}]);
//# sourceMappingURL=super-admin-expiration.d0723f3803cfd1c36819-v38.js.map