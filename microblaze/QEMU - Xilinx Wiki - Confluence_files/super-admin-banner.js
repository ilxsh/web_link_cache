(window.webpackJsonp=window.webpackJsonp||[]).push([[361],{"OC/i":function(e,n,t){"use strict";t.r(n);var i=t("VrFO"),r=t.n(i),a=t("Y9Ll"),o=t.n(a),u=t("N+ot"),s=t.n(u),c=t("AuHH"),l=t.n(c),d=t("1Pcy"),m=t.n(d),f=t("5Yy7"),v=t.n(f),p=t("KEM+"),S=t.n(p),E=t("7wq/"),y=t.n(E),h=t("ERkP"),k=t.n(h),A=(t("aWzz"),t("L21V")),b=t("kFJ8"),g=t("KsTJ"),w=t("2srY"),I=t.n(w),B=t("lZoD"),D=t("uAoU"),R=t("OOEx"),x=t.n(R),U=t("PTiB"),M=t("cMUv"),N=t("WlwD"),V=t("tqyq"),F=t("hcZD"),C=t("yJma"),O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"IsSuperAdmin"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"current"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"confluence"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"roles"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSuperAdmin"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:145,source:{body:"\n  query IsSuperAdmin {\n    user(current: true) {\n      id\n      confluence {\n        roles {\n          isSuperAdmin\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},K=t("B5Kc");function P(){var e=y()(["\n  height: ",";\n"]);return P=function(){return e},e}function T(){var e=y()(["\n  color: inherit;\n  cursor: pointer;\n  font-weight: normal;\n  margin-left: 5px;\n  text-decoration: underline;\n"]);return T=function(){return e},e}function Y(){var e=y()(["\n  position: fixed; /* So the banner always stays at the top of the page, even when content is scrolled */\n  top: 0;\n  width: 100%;\n  z-index: 600; /* Because the new editor toolbar has a z-index of 500 */\n"]);return Y=function(){return e},e}t.d(n,"SuperAdminBannerComponent",function(){return Q}),t.d(n,"SuperAdminBanner",function(){return z});var _="SuperAdminBanner",q=g.default.div(Y()),j=g.default.a(T()),H=g.default.div(P(),function(e){return"".concat(e.height,"px")}),Q=function(e){function n(e){var t;return r()(this,n),t=s()(this,l()(n).call(this,e)),S()(m()(t),"componentDidMount",function(){N.a.getItemAsBoolean(V.a.SUPERADMIN_SURVEY_REQUESTED).then(function(e){e&&t.setState({surveyIsVisible:e})})}),S()(m()(t),"superAdminEnabled",function(e){return I()(e,"user.confluence.roles.isSuperAdmin")}),S()(m()(t),"showSurvey",function(e){N.a.getItemAsBoolean(V.a.SUPERADMIN_SURVEY_SUBMITTED).then(function(n){n||(N.a.setItem(V.a.SUPERADMIN_SURVEY_REQUESTED,"true"),e&&t.setState({surveyIsVisible:!0}))})}),S()(m()(t),"hideSurvey",function(){N.a.removeItem(V.a.SUPERADMIN_SURVEY_REQUESTED),t.setState({surveyIsVisible:!1})}),S()(m()(t),"hideBanner",function(e){return e.hide(_),null}),S()(m()(t),"fireAdminKeyExitAnalyticsEvent",function(){return t.props.createAnalyticsEvent({type:"sendUIEvent",data:{action:"clicked",actionSubject:"link",actionSubjectId:"adminKeyExit",source:"superAdminBanner"}}).fire()}),S()(m()(t),"fireAdminKeyExitFailedAnalyticsEvent",function(){return t.props.createAnalyticsEvent({type:"sendTrackEvent",data:{action:"failed",actionSubject:"exitAdminKeySession",source:"superAdminBanner"}}).fire()}),S()(m()(t),"renderBanner",function(e){var n=k.a.createElement(x.a,{size:"medium",secondaryColor:"fill"}),i=m()(t),r=function(n){if(n){var t=n.clientHeight;i.setState({bannerHeight:t}),e.show(_,t)}};return k.a.createElement(K.a,{handleMutationCompleteCallback:function(){return t.showSurvey(!1),t.fireAdminKeyExitAnalyticsEvent(),Promise.resolve()},handleMutationErrorCallback:function(){return t.fireAdminKeyExitFailedAnalyticsEvent(),Promise.resolve()}},function(e){return k.a.createElement(h.Fragment,null,k.a.createElement(q,null,k.a.createElement(D.a,{appearance:"warning",icon:n,isOpen:!0,innerRef:r},k.a.createElement(A.b,{id:"super-admin.banner.message",description:"Message in the banner to notify users of super admin mode",defaultMessage:"Youâ€™re using admin key, which gives you temporary access to restricted pages."}),k.a.createElement(j,{onClick:e},k.a.createElement(A.b,{id:"super-admin.banner.exit",description:"Click to action in banner to allow users to exit super admin mode",defaultMessage:"Stop using admin key"})))),k.a.createElement(H,{height:t.state.bannerHeight,ref:t.bannerSpacerRef}))})}),t.state={bannerHeight:0,surveyIsVisible:!1},t.bannerSpacerRef=k.a.createRef(),t}return v()(n,e),o()(n,[{key:"renderQuery",value:function(e){var n=this;return Object(F.a)()?k.a.createElement(b.d,{query:O},function(t){var i=t.data;return n.superAdminEnabled(i)?n.renderBanner(e):n.hideBanner(e)}):null}},{key:"render",value:function(){var e=this;return k.a.createElement(B.c,{to:[M.a]},function(n){return k.a.createElement(h.Fragment,null,e.renderQuery(n),e.state.surveyIsVisible?k.a.createElement(C.SuperAdminSatisfactionSurvey,{onDone:e.hideSurvey}):null)})}}]),n}(h.Component);Q.displayName="SuperAdminBannerComponent";var z=Object(U.a)()(Object(A.g)(Q))}}]);
//# sourceMappingURL=super-admin-banner.84890c6655958cbba3d3-v38.js.map