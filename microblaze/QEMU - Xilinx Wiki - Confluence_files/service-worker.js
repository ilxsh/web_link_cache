(window.webpackJsonp=window.webpackJsonp||[]).push([[577],{QPsM:function(e,n,t){"use strict";t.r(n);var a=t("KEM+"),i=t.n(a),r=t("Jygk"),o=t.n(r),c=t("2srY"),s=t.n(c),l=t("LodO"),u=t("Z49i"),d=t("/FQd"),v=t("lPPs"),g=t.n(v),m=t("ddV6"),f=t.n(m);function k(e){(function(){return navigator&&navigator.serviceWorker?navigator.serviceWorker.controller?Promise.resolve(navigator.serviceWorker.controller):navigator.serviceWorker.getRegistrations().then(function(e){var n=e.find(function(e){return e.active});return n?n.active:null}):Promise.resolve(null)})().then(function(n){n&&n.postMessage(e)})}function p(e){Object.entries(e).forEach(function(e){var n=f()(e,2);return k({type:"workerFlagChange",key:n[0],value:n[1]})})}function h(e){return function(){for(var n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return y(t[2]),e.apply(history,t)}}function y(e){e&&k({type:"urlChanged",url:e})}var N=function(e){o.a.navigator&&o.a.navigator.serviceWorker&&(e.enabled?(!function(){var n=!1;navigator.serviceWorker.addEventListener("message",function(t){t.data&&"reloadWindow"===t.data.type&&!n&&(n=!0,console.log("[".concat(e.name,"] Page refresh scheduled")),o.a.location.reload())})}(),function(){history.pushState=h(history.pushState),history.replaceState=h(history.replaceState),o.a.addEventListener("popstate",function(){y(o.a.location.href)})}(),g.a.register().then(function(n){e.workerFlags.logging&&console.log("[".concat(e.name,"] Registered")),n.addEventListener("updatefound",function(){(function(n){return new Promise(function(t){!function a(i){i<=0?console.log("[".concat(e.name,"] Activation timed out. Give up.")):setTimeout(function(){if(e.workerFlags.logging&&console.log("[".concat(e.name,"] Waiting for activation")),n.active)return t();a(--i)},50)}(20)})})(n).then(function(){p(e.workerFlags)})}),p(e.workerFlags),k({type:"clientReady"})}).catch(function(n){e.workerFlags.logging&&console.log("[".concat(e.name,"] Registration failed:"),n)})):function(){navigator.serviceWorker.getRegistrations().then(function(n){if(n.length>0){e.workerFlags.logging&&console.log("[".concat(e.name,"] Unregistering"));for(var t=0;t<n.length;t++)n[t].unregister()}})}())},F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GDPRScannerQuery"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"current"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"companyName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emails"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isPrimary"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isPrimary"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:243,source:{body:"\n  query GDPRScannerQuery {\n    user(current: true) {\n      id\n      userName\n      title\n      location\n      companyName\n      emails {\n        value\n        isPrimary\n      }\n      photos {\n        value\n        isPrimary\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};t.d(n,"register",function(){return w});var S="confluence.frontend.cache.service.worker",w=function(){Object(d.b)(Object(u.a)()).catch(function(){var e;return{featureFlags:(e={},i()(e,"".concat(S),!0),i()(e,"".concat(S,".logging"),!0),e)}}).then(function(e){var n=e.featureFlags;N({name:"SW Client(classic)",enabled:n["".concat(S)],workerFlags:{logging:n["".concat(S,".logging")],stackDetector:n["".concat(S,".next-stack-detector")],cacheStatic:n["".concat(S,".cache.static")],gdprScanner:n["".concat(S,".gdpr.scanner")]}})}),o.a.navigator&&o.a.navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",function(e){e.data&&"sendOperationalEvent"===e.data.type&&Object(l.a)().then(function(n){e.data.values.forEach(function(e){n.sendOperationalEvent({source:"confluence-frontend",actionSubject:"gdpr",action:"foundPersonalData",attributes:e})})})}),o.a&&o.a.requestIdleCallback&&o.a.requestIdleCallback(function(){Object(u.a)().query({query:F}).then(function(e){var n,t=e.data,a=(n={},i()(n,s()(t,"user.displayName"),"displayName"),i()(n,s()(t,"user.userName"),"userName"),i()(n,s()(t,"user.title"),"title"),i()(n,s()(t,"user.location"),"location"),i()(n,s()(t,"user.companyName"),"companyName"),n);(s()(t,"user.emails")||[]).forEach(function(e){var n=e.value;return a[n]="email"}),delete a[void 0],delete a.null,delete a[""],p({gdprScannerTargets:a})})})}},lPPs:function(e,n){var t="/wiki/frontend-service-worker-cache.js";Object.defineProperty(n,"__esModule",{value:!0}),n.default={register:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!navigator.serviceWorker&&navigator.serviceWorker.register(t,e)}},e.exports=n.default}}]);
//# sourceMappingURL=service-worker.020ed7b3311cbbcf4ed7-v38.js.map