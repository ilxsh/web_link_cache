(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{"1oXH":function(e,n,t){"use strict";function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return"".concat(i()+i(),"-").concat(i(),"-").concat(i(),"-").concat(i(),"-").concat(i()).concat(i()).concat(i())}t.d(n,"a",function(){return o})},"7eka":function(e,n,t){var i=t("7vTW"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}},"7vTW":function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,".CommentBody_author_1H4{padding-bottom:8px;padding-top:1px;cursor:pointer;display:inline-block}.CommentBody_author_1H4 div+div{font-weight:400}.CommentBody_author_1H4 a,.CommentBody_authorOld_1ei a{font-size:16px}.CommentBody_authorLabel_1nv{background-color:#3572b0;color:#fff;text-transform:uppercase;font-size:10px;margin-left:10px;padding:2px 3px;border-radius:3px;vertical-align:middle}.CommentBody_body_1Lt{padding-right:20px;word-wrap:break-word}",""]),n.locals={author:"CommentBody_author_1H4",authorOld:"CommentBody_authorOld_1ei",authorLabel:"CommentBody_authorLabel_1nv",body:"CommentBody_body_1Lt"}},"8rMV":function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,".CommentsSection_root_3ge{padding-top:1px;list-style:none}.aui-page-panel-inner{overflow:visible}",""]),n.locals={root:"CommentsSection_root_3ge"}},C4P7:function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,".Comment_comment_d0q{position:relative;padding-top:8px;padding-bottom:8px;overflow-y:visible;min-height:35px;word-wrap:break-word}.Comment_comment_d0q #rte{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;margin:0;width:100%}.Comment_comment_d0q form.aui{margin:0}#comments-section .preformattedContent{word-wrap:normal}.Comment_addComment_24d{padding-top:20px}.Comment_focused_cml{border-bottom:1px solid #ccc;background:#ebf2f9;padding-left:10px!important;margin-bottom:-1px;padding-bottom:9px}.Comment_focused_cml+.Comment_focused_cml{-webkit-box-shadow:inset 0 1px 0 #ccc;box-shadow:inset 0 1px 0 #ccc}.Comment_avatar_2px{width:32px;height:32px;margin-right:10px;float:left;cursor:pointer}.Comment_spinner_27V{opacity:.5;height:100%;position:relative}.Comment_bodyContainer_sJT{position:relative;margin-left:42px}#comments-section .comment{border-top:none!important;border-bottom:none!important}.quick-comment-loading-container{position:absolute;top:0;bottom:-10px;left:0;right:0;z-index:999;background-color:#f5f5f5;border:1px solid #f5f5f5;min-height:271px;width:100%}.quick-comment-form #previewArea{display:block}.quick-comment-container{margin-top:0!important}",""]),n.locals={comment:"Comment_comment_d0q",addComment:"Comment_addComment_24d",focused:"Comment_focused_cml",avatar:"Comment_avatar_2px",spinner:"Comment_spinner_27V",bodyContainer:"Comment_bodyContainer_sJT"}},JzH8:function(e,n,t){"use strict";var i=t("97Jx"),o=t.n(i),a=t("m3Bd"),r=t.n(a),d=t("VrFO"),c=t.n(d),m=t("Y9Ll"),s=t.n(m),l=t("N+ot"),u=t.n(l),p=t("AuHH"),v=t.n(p),k=t("5Yy7"),f=t.n(k),h=(t("aWzz"),t("ERkP")),y=t.n(h),g=t("sbiO"),C=function(e){function n(){return c()(this,n),u()(this,v()(n).apply(this,arguments))}return f()(n,e),s()(n,[{key:"render",value:function(){var e=this.props,n=e.children,t=e.href,i=r()(e,["children","href"]);return t?y.a.createElement("a",o()({},i,{href:0===t.indexOf(g.a)?t:"".concat(g.a).concat(t)}),n):y.a.createElement("span",i,n)}}]),n}(h.Component);C.displayName="ContextAwareLink",C.displayName="ContextAwareLink",n.a=C},TcLa:function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,'.CommentActions_actions_Hnn{font-size:12px;color:#707070;margin-top:5px}.CommentActions_actionsList_3yu{padding:0}.CommentActions_actionItem_1ro{display:inline-block}.CommentActions_actionItem_1ro:not(.CommentActions_noDot_1Yj):before{content:"\\2022";color:#707070;padding:0 5px}.CommentActions_actionItem_1ro:first-child:before{display:none}.wiki-content .CommentActions_actionItem_1ro a,.wiki-content .CommentActions_actionItem_1ro a:hover,.wiki-content .CommentActions_actionItem_1ro a:link,.wiki-content .CommentActions_actionItem_1ro a:visited{color:#707070;cursor:pointer}.wiki-content .CommentActions_actionItem_1ro a:hover{text-decoration:underline}',""]),n.locals={actions:"CommentActions_actions_Hnn",actionsList:"CommentActions_actionsList_3yu",actionItem:"CommentActions_actionItem_1ro",noDot:"CommentActions_noDot_1Yj"}},UbDs:function(e,n,t){var i=t("8rMV"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}},"V/ff":function(e,n,t){"use strict";t.d(n,"f",function(){return a}),t.d(n,"g",function(){return r}),t.d(n,"e",function(){return d}),t.d(n,"b",function(){return c}),t.d(n,"a",function(){return m}),t.d(n,"c",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"h",function(){return u});var i=t("Jygk"),o=t.n(i),a={activateEditor:function(e){return o.a.AJS.Confluence.QuickEdit.activateEditor(e)},deactivateEditor:function(){return o.a.AJS.Confluence.QuickEdit.deactivateEditor()},postInitialise:function(){return o.a.AJS.Confluence.QuickEdit.postInitialise()}},r={preInitialise:function(e){return o.a.AJS.Confluence.QuickEdit.QuickEditPage.preInitialise(e)}},d={preInitialise:function(){return o.a.AJS.Confluence.QuickEdit.QuickComment.preInitialise()},postInitialise:function(e){return o.a.AJS.Confluence.QuickEdit.QuickComment.postInitialise(e)}},c={removeAllCancelHandlers:function(){return o.a.AJS.Confluence.Editor.removeAllCancelHandlers()},addCancelHandler:function(e){return o.a.AJS.Confluence.Editor.addCancelHandler(e)},setSaveHandler:function(e){return o.a.AJS.Confluence.Editor.overrideSave(e)},addSaveHandler:function(e){return o.a.AJS.Confluence.Editor.addSaveHandler(e)},setSavingState:function(e){return o.a.AJS.Confluence.Editor.UI.toggleSavebarBusy(e)},getCommentsPlugins:function(){return o.a.AJS.Confluence.Editor._Profiles.createProfileForCommentEditor().plugins},getPagePlugins:function(){return o.a.AJS.Confluence.Editor._Profiles.createProfileForPageEditor({versionComment:!0,notifyWatchers:!0}).plugins}},m=function(){return new o.a.AJS.Confluence.QuickEditCaptchaManager},s=function(){return o.a.tinymce&&o.a.tinymce.activeEditor},l=function(){var e=s();return e?e.getContent().trim():null},u=function(){var e=s();return e?e.getContent()!==e.startContent:null}},ZGQn:function(e,n,t){"use strict";t.r(n);var i=t("tQaH"),o=t.n(i),a=t("RhWx"),r=t.n(a),d=t("Y9Ll"),c=t.n(d),m=t("1Pcy"),s=t.n(m),l=t("KEM+"),u=t.n(l),p=t("VrFO"),v=t.n(p),k=t("N+ot"),f=t.n(k),h=t("AuHH"),y=t.n(h),g=t("5Yy7"),C=t.n(g),_=t("mAxt"),S=t.n(_),E=t("aWzz"),b=t.n(E),N=t("ERkP"),I=t.n(N),w=t("kFJ8"),A=t("uDfI"),F=t("kD2R"),x=t("2srY"),T=t.n(x),P=t("zr3P"),L=t.n(P),D=t("sbiO"),O=t("bsva"),H=t("ilPL"),V=I.a.createContext({isLikesEnabled:!1});V.Provider.propTypes={value:b.a.shape({isLikesEnabled:b.a.bool})},V.Provider.defaultProps={value:{isLikesEnabled:!1}};var M,j,U,B,q=t("UIW9"),R=t("OlTx"),Q=t("GYRL"),J=t("Zpwg"),W=t("1oXH"),G=t("6lDt"),z=t("D3Uu"),K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CommentsSectionQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"contentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"child"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"location"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"footer",block:!1}]}},{kind:"Argument",name:{kind:"Name",value:"depth"},value:{kind:"StringValue",value:"all",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ancestors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"container"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"history"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profilePicture"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"editor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"view"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webresource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"keys"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"history"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profilePicture"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"links"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webui"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"operations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"operation"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"friendlyWhen"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"when"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"by"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"operations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"operation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"targetType"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"space"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"homepageId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"current"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isPrimary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:2150,source:{body:'\n  query CommentsSectionQuery($offset: Int, $first: Int, $contentId: ID!) {\n    content(id: $contentId) {\n      child {\n        comment(\n          offset: $offset\n          first: $first\n          location: ["footer"]\n          depth: "all"\n        ) {\n          count\n          pageInfo {\n            hasNextPage\n            endCursor\n          }\n          edges {\n            cursor\n            node {\n              ancestors {\n                id\n              }\n              container {\n                history {\n                  createdBy {\n                    type\n                    displayName\n                    profilePicture {\n                      path\n                    }\n                    ... on KnownUser {\n                      accountId\n                    }\n                  }\n                }\n              }\n              body {\n                editor {\n                  value\n                }\n                view {\n                  value\n                  webresource {\n                    keys\n                  }\n                }\n              }\n              history {\n                createdBy {\n                  type\n                  displayName\n                  profilePicture {\n                    path\n                  }\n                  ... on KnownUser {\n                    accountId\n                  }\n                }\n              }\n              id\n              links {\n                webui\n              }\n              operations {\n                operation\n              }\n              version {\n                friendlyWhen\n                when\n                by {\n                  type\n                  displayName\n                  ... on KnownUser {\n                    accountId\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      nodes {\n        id\n        operations {\n          operation\n          targetType\n        }\n        space {\n          id\n          homepageId\n        }\n        type\n      }\n    }\n    user(current: true) {\n      displayName\n      photos {\n        isPrimary\n        value\n      }\n      id\n    }\n  }\n',name:"GraphQL request",locationOffset:{line:1,column:1}}}},Y=t("EfWO"),$=t.n(Y),X=t("nnRT"),Z=t.n(X),ee=t("lKOy"),ne=t.n(ee),te=t("uZih"),ie=t.n(te),oe=t("L21V"),ae=t("swvn"),re=t.n(ae),de=t("IGvV"),ce=t("bfgX"),me=t("PTiB"),se=t("0Dc1"),le=t("U728"),ue=t("kSEI"),pe=t("97Jx"),ve=t.n(pe),ke=t("6OdC"),fe=t.n(ke),he=t("O94r"),ye=t.n(he),ge=t("x98U"),Ce=t("iUdj"),_e=t("fLXQ"),Se=t("M2LZ"),Ee=t("Sl8s"),be=t("9Kiz"),Ne=t("fYdy"),Ie=t("jqY8"),we=t("JzH8"),Ae=t("1vxf"),Fe=t("v45N"),xe=t.n(Fe),Te=Object(de.a)(xe.a)(M=Object(oe.g)((U=j=function(e){function n(){var e;return v()(this,n),(e=f()(this,y()(n).call(this)))._onDeleteClick=e._onDeleteClick.bind(s()(e)),e._onReplyClick=e._onReplyClick.bind(s()(e)),e._onEditClick=e._onEditClick.bind(s()(e)),e}return C()(n,e),c()(n,[{key:"shouldComponentUpdate",value:function(e){return!Z()(this.props,e)}},{key:"_onReplyClick",value:function(e){e.preventDefault();var n=this.props,t=n.comment;(0,n.replyToComment)(t.id)}},{key:"_onEditClick",value:function(e){e.preventDefault();var n=this.props,t=n.comment;(0,n.editComment)(t.id)}},{key:"_onDeleteClick",value:function(){var e=this.props.intl.formatMessage;if(Object(Ie.b)(e({id:"remove.comment.confirmation.message"}))){var n=this.props;(0,n.deleteComment)(n.comment.id)}}},{key:"_renderLikesAction",value:function(e,n,t,i){return I.a.createElement("li",{key:e.id,className:ye()("comment-action-like",n.actionItem,n.noDot)},I.a.createElement(Ae.a,{contentId:e.id,contentType:"comment",containerId:t,containerType:i,isForComment:!0}))}},{key:"render",value:function(){var e=this,n=this.props,t=n.contentId,i=n.contentType,o=n.comment;return I.a.createElement("div",{className:xe.a.actions},I.a.createElement("ul",{className:xe.a.actionsList},I.a.createElement("li",{className:ye()(xe.a.actionItem,"action-reply-comment")},I.a.createElement("a",{className:"comment-reply-link",onClick:this._onReplyClick},I.a.createElement(oe.b,{id:"comment.reply"}))),o.operations.find(function(e){return"update"===e.operation})?I.a.createElement("li",{className:ye()(xe.a.actionItem,"comment-action-edit")},I.a.createElement("a",{className:"comment-edit-link",onClick:this._onEditClick},I.a.createElement(oe.b,{id:"comment.edit"}))):null,o.operations.find(function(e){return"delete"===e.operation})?I.a.createElement("li",{className:xe.a.actionItem},I.a.createElement("a",{"data-test-id":"comment-delete-link",onClick:this._onDeleteClick,id:"remove-comment-".concat(o.id)},I.a.createElement(oe.b,{id:"remove.name"}))):null,I.a.createElement(V.Consumer,null,function(n){return n.isLikesEnabled?e._renderLikesAction(o,xe.a,t,i):null}),I.a.createElement("li",{className:xe.a.actionItem},I.a.createElement(we.a,{href:T()(o,"linkWebui")},T()(o,"createdFriendly")))))}}]),n}(N.Component),u()(j,"displayName","CommentActions"),M=U))||M)||M,Pe=t("7eka"),Le=t.n(Pe),De=Object(de.a)(Le.a)(B=function(e){function n(){var e,t;v()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f()(this,(e=y()(n)).call.apply(e,[this].concat(o))),u()(s()(t),"state",{commentNode:null}),t._bodyContainer=I.a.createRef(),t}return C()(n,e),c()(n,[{key:"componentDidMount",value:function(){var e=this.props.comment;this._setCommentNode(),Se.a.require(T()(e,"webResourceKeys")||[]),Object(Ee.d)(this._bodyContainer.current)}},{key:"shouldComponentUpdate",value:function(e,n){return!Z()(this.props,e)||!Z()(this.state,n)}},{key:"_setCommentNode",value:function(){this.setState({commentNode:this._bodyContainer.current})}},{key:"_renderUserLink",value:function(){var e=this.props,n=e.canViewProfile,t=e.comment.createdBy,i={userId:t.accountId,fullName:t.displayName,isAnonymous:t.isAnonymous,canViewProfile:n};return I.a.createElement("div",{className:Le.a.author},I.a.createElement(Ne.a,i))}},{key:"_renderCommentActions",value:function(){var e=this.props,n=e.comment,t=e.commentActions,i=e.contentId,a=e.contentType,r=o()({comment:n,contentId:i,contentType:a},t);return I.a.createElement(Te,r)}},{key:"render",value:function(){var e=this.props,n=e.comment,t=e.showAuthorLabel,i=n.bodyExportView&&n.bodyExportView.replace(/confluence-userlink/g,"");return I.a.createElement("div",{className:"wiki-content"},I.a.createElement("h4",null,this._renderUserLink(),n.createdByAuthor&&t?I.a.createElement("span",{className:Le.a.authorLabel},I.a.createElement(oe.b,{id:"author.name"})):null),I.a.createElement("div",{className:ye()(Le.a.body,"comment-content"),ref:this._bodyContainer,dangerouslySetInnerHTML:{__html:i}}),this._renderCommentActions(),I.a.createElement(be.a,{node:this.state.commentNode}))}}]),n}(N.Component))||B;De.displayName="CommentBody";var Oe,He,Ve=t("pYTW"),Me=t.n(Ve),je=(Oe=Object(de.a)(Me.a),Object(oe.g)(He=Oe(He=function(e){function n(){return v()(this,n),f()(this,y()(n).apply(this,arguments))}return C()(n,e),c()(n,[{key:"render",value:function(){var e=this.props,n=e.intl.formatMessage,t=e.onClick;return I.a.createElement("div",{"data-test-id":"add-comment-button",title:n({id:"comment.name.tooltip"}),className:ye()("quick-comment-prompt",Me.a.root),onClick:t},I.a.createElement(oe.b,{id:"quick.comment.placeholder.message"}))}}]),n}(N.Component))||He)||He);je.displayName="CommentSpinner";var Ue,Be,qe,Re,Qe=t("2hrV"),Je=t("wjr4"),We=t.n(Je),Ge=Object(de.a)(We.a)(Ue=function(e){function n(){return v()(this,n),f()(this,y()(n).apply(this,arguments))}return C()(n,e),c()(n,[{key:"componentDidMount",value:function(){this.props.onDidMount()}},{key:"render",value:function(){return I.a.createElement("div",{className:"quick-comment-loading-container",style:{display:"block"}},I.a.createElement("div",{className:We.a.spinner},I.a.createElement(Qe.a,{size:"medium"})))}}]),n}(N.Component))||Ue;Ge.displayName="CommentSpinner",Ge.defaultProps={onDidMount:function(){}};var ze=function(){},Ke=function(e,n,t,i){if("editor"===t)return"view"===i.mode||e.isEditorLoaded===n.isEditorLoaded},Ye=Object(de.a)(We.a)((Re=qe=function(e){function n(){var e,t;v()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=f()(this,(e=y()(n)).call.apply(e,[this].concat(o))))._editorSaveHandler=t._editorSaveHandler.bind(s()(t)),t._editorCancelHandler=t._editorCancelHandler.bind(s()(t)),t._editorAfterActivate=t._editorAfterActivate.bind(s()(t)),t._assignContainer=t._assignContainer.bind(s()(t)),t.state={Editor:null},t}return C()(n,e),c()(n,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,Object(Ce.a)(function(n){e._isMounted&&e.setState({Editor:n})})}},{key:"shouldComponentUpdate",value:function(e,n){var t=this.props.mode===e.mode?Ke:ze;return!fe()(this.props,e,t)||this.state.Editor!==n.Editor&&"view"!==this.props.mode}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"_editorSaveHandler",value:function(e){var n=this.props,t=n.editorSaveHandler,i=n.contentId,a=n.comment.id;return t(o()({contentId:i,commentId:a},e))}},{key:"_editorCancelHandler",value:function(){return this.props.editorCancelHandler()}},{key:"_editorAfterActivate",value:function(){Object(_e.k)(this.commentContainer,{topGap:60,bottomGap:10,duration:100})}},{key:"_renderProfilePicture",value:function(){var e=this.props,n=e.canViewProfile,t=e.userInfo,i=t.avatarUrl,a=t.accountId,r={userId:a,src:i,isAnonymous:!a},d=o()({},r,{canViewProfile:n,withUserHover:n,size:"medium"});return I.a.createElement("div",{className:We.a.avatar},I.a.createElement(ge.a,d))}},{key:"_renderCommentBody",value:function(){var e=this.props,n=e.comment,t=e.contentId,i=e.contentType,o=e.commentActions,a={comment:n,contentId:t,contentType:i,canViewProfile:e.canViewProfile,showAuthorLabel:e.showAuthorLabel,commentActions:o};return I.a.createElement(De,a)}},{key:"_renderCommentEditor",value:function(){var e=this.props,n=e.editor,t=e.comment,i=e.contentId,o=e.onEditorLoaded,a=e.shouldHideEditor,r=this.state.Editor;if(a)return null;var d={saveHandler:this._editorSaveHandler,cancelHandler:this._editorCancelHandler,afterActivate:this._editorAfterActivate,hasError:!!n.errorMessage,updateTime:n.updateTime,content:{editorContent:t.bodyEditorView},contentType:"comment",commentId:t&&t.id,contentId:i,onLoadCompleteCallBack:o};return r?I.a.createElement(r,d):null}},{key:"_assignContainer",value:function(e){this.commentContainer=e}},{key:"render",value:function(){var e=this.props,n=e.comment,t=e.className,i=e.id,a=e.style,r=e.onClickCommentAddPrompt,d=e.editor,c=e.isEditorEnabled,m=e.mode,s=e.isFocused,l=e.isHighlighted,p={style:o()({},a,{marginLeft:40*n.depthLevel-(s||l?10:0)||0}),className:ye()("comment",We.a.comment,u()({},We.a.focused,(s||l)&&"view"===m),t)};"view"!==m&&"edit"!==m||(p.id="comment-".concat(n.id),p["data-test-id"]="comment-".concat(n&&n.id?n.id:"new")),i&&(p.id=i);var v="replyComment"===d.mode;v&&(p["data-parent-comment-id"]=n.id);var k="add"===m&&c&&!d.isEditorLoaded,f="edit"===m&&(!d.isEditorLoaded||!n.bodyEditorView&&"editComment"===d.mode),h=k||f,y="view"===m?"":"quick-comment-container ".concat(v?"reply":m);return I.a.createElement("div",ve()({},p,{ref:this._assignContainer}),this._renderProfilePicture(),I.a.createElement("div",{className:ye()(We.a.bodyContainer,y)},"view"===m?this._renderCommentBody():null,"edit"===m?this._renderCommentEditor():null,"add"!==m?null:c?this._renderCommentEditor():I.a.createElement(je,{onClick:r}),h?I.a.createElement(Ge,{onDidMount:this._editorAfterActivate}):null))}}]),n}(N.Component),u()(qe,"displayName","CommentComponent"),u()(qe,"defaultProps",{comment:{},onEditorLoaded:function(){}}),Be=Re))||Be;var $e=Object(A.connect)(function(e,n){var t=n.mode,i=n.comment,o=n.editor,a=e.views.viewPage.quickEditPreload.get("hasLoaded");return{shouldHideEditor:!("edit"!==t||"replyComment"===o.mode||i.bodyEditorView&&a)}})(Ye);$e.displayName="Comment";var Xe,Ze,en,nn=$e,tn=t("g/An"),on=t.n(tn),an=Object(de.a)(on.a)((en=Ze=function(e){function n(){return v()(this,n),f()(this,y()(n).apply(this,arguments))}return C()(n,e),c()(n,[{key:"shouldComponentUpdate",value:function(e){return!Z()(this.props,e)}},{key:"render",value:function(){var e=this.props,n=e.contentType,t=e.editor,i=e.userInfo,a=e.canViewProfile,r=e.contentId,d=e.editorSaveHandler,c=e.editorCancelHandler,m=e.comments,s=e.highlightedComments,l=e.commentActions,u=e.focusOnCommentId,p=e.showAuthorLabel,v=e.atlToken,k=e.onEditorLoaded,f=[],h={contentId:r,contentType:n,commentActions:l,canViewProfile:a,showAuthorLabel:p,editor:t,atlToken:v,editorSaveHandler:d,editorCancelHandler:c,onEditorLoaded:k};return m.forEach(function(e){var n=o()({},h,{comment:e,userInfo:e.createdBy,isFocused:u===e.id,isHighlighted:s.indexOf(e.id)>-1,mode:t.contentId===e.id&&"editComment"===t.mode?"edit":"view"});if(f.push(I.a.createElement(nn,ve()({key:e.id},n))),t.contentId===e.id&&"replyComment"===t.mode){var a=o()({},h,{userInfo:i,mode:"edit",isEditorEnabled:!0,comment:{id:e.id,depthLevel:e.depthLevel+1}});f.push(I.a.createElement(nn,ve()({key:"".concat(e.id,"-reply")},a)))}}),I.a.createElement("div",{className:"comment-threads top-level ".concat(on.a.root),id:"page-comments","data-test-id":"page-comments"},f)}}]),n}(N.Component),u()(Ze,"defaultProps",{highlightedComments:[],onEditorLoaded:function(){}}),Xe=en))||Xe,rn=function(e){var n=e.contentId,t=e.onClick;return I.a.createElement("div",{id:"comments-actions",style:{display:"none"}},I.a.createElement("a",{href:"".concat(D.a,"/pages/viewpage.action?pageId=").concat(n,"&showComments=true&showCommentArea=true#addcomment"),id:"add-comment-rte",className:"full-load",onClick:t}))};rn.displayName="CommentLegacyAction";var dn=rn;rn.displayName="CommentLegacyAction";var cn,mn,sn,ln=t("V/ff"),un=t("Xzcx"),pn=t("utTn"),vn=t("UbDs"),kn=t.n(vn),fn={"Captcha check failed":"captcha.response.failed"},hn={ADD:"addComment",EDIT:"editComment",REPLY:"replyComment",RESET:null},yn=(cn=Object(de.a)(kn.a),mn=Object(me.a)(),Object(oe.g)(sn=cn(sn=mn(sn=function(e){function n(){var e,t;v()(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return t=f()(this,(e=y()(n)).call.apply(e,[this].concat(a))),u()(s()(t),"state",{commentsIds:t.props.commentsIds,updatedCommentsIds:[],hasNextPage:t.props.hasNextPage,editorState:{contentId:null,mode:hn.RESET,errorMessage:"",errorType:null,updateTime:0,isEditorLoaded:!1}}),u()(s()(t),"domNodes",{}),u()(s()(t),"_eligibleAddPageCommentTracking",function(e,n){return"page"===t.props.contentType&&t.state.editorState.mode===n&&!e}),u()(s()(t),"_showEditor",function(e){t.setState({editorState:o()({},t.state.editorState,e)})}),u()(s()(t),"_hideEditor",function(){var e={contentId:null,mode:hn.RESET};t.setState({editorState:o()({},t.state.editorState,e)})}),u()(s()(t),"_onEditorLoaded",function(){t.setState({editorState:o()({},t.state.editorState,{isEditorLoaded:!0})})}),u()(s()(t),"_hideEditorIfNotForComments",function(){var e=Object(ln.c)();t.domNodes.root.querySelectorAll("#".concat(e.id)).length||t._hideEditor()}),u()(s()(t),"_replyCommentAction",function(e){t._showEditor({contentId:e,mode:hn.REPLY})}),u()(s()(t),"_editCommentAction",function(e){t._showEditor({mode:hn.EDIT,contentId:e})}),u()(s()(t),"_showAddCommentEditor",function(e){var n=t.props.contentId;e&&e.preventDefault(),t._warnCommentLost(function(){t._showEditor({mode:hn.ADD,contentId:n})})}),u()(s()(t),"_triggerShowAddCommentEditor",function(e){setTimeout(function(){return t.scrollToElement("addcomment")},0),t._showAddCommentEditor(e)}),u()(s()(t),"_warnCommentLost",function(e){var n=t.props.intl.formatMessage;Object(ln.h)()&&!Object(Ie.b)(n({id:"unsaved.comment.lost"}))||e()}),u()(s()(t),"_callAnalyticsEvent",function(e){t.props.createAnalyticsEvent({type:"sendTrackEvent",data:e}).fire()}),u()(s()(t),"_getCommentAnalyticsObject",function(e){var n=e.id,t=e.spaceId,i=e.ownerId,o=e.requestType,a=e.isInlineComment,r=e.contentType,d=e.parentId;return{containerType:"space",containerId:t,source:"viewPageScreen",objectType:"page",objectId:i.toString(),action:"editComment"===o?"updated":"created",actionSubject:"comment",actionSubjectId:n,attributes:{commentType:a?"inline":"page",pageType:r,parentCommentId:d.toString()}}}),u()(s()(t),"_sendExperienceAnalytics",function(e){Object(le.a)(o()({},e,{experienceId:t.props.contentId}))}),u()(s()(t),"_editorSaveHandler",function(e){var n=t.props.intl.formatMessage,i=t.props,a=i.saveComment,r=i.onRefetchComments,d=t.state.editorState;if(e.html&&e.html.trim())e.requestType=d.mode,d.mode===hn.REPLY&&(e.showCommentAfter=t._getThreadLastCommentId(d.contentId)),t._eligibleAddPageCommentTracking(!1,hn.ADD)&&t._sendExperienceAnalytics({experience:R.b.PAGE_COMMENT_PUBLISH,isAttempt:!0}),a(e).then(function(n){var i=n.data.experimentalSaveComment,o=i.id,a=i.parentId,c=i.ownerId,m=i.isInlineComment,s=t.props,l=s.spaceId,u=s.contentType,p=t._getCommentAnalyticsObject({id:o,spaceId:l,parentId:a,contentType:u,ownerId:c,isInlineComment:m,requestType:e.requestType});t._callAnalyticsEvent(p);var v={commentId:o,threadLastCommentId:t._getThreadLastCommentId(d.contentId),parentId:a,mode:d.mode};r(v).then(function(){t._hideEditor(),t._eligibleAddPageCommentTracking(m,hn.RESET)&&t._sendExperienceAnalytics({experience:R.b.PAGE_COMMENT_PUBLISH,wasExperienceSuccessful:!0})})}),t._removeSlowCommentURLParams();else{var c={errorMessage:n({id:"content.empty"}),errorType:"warning"};t.setState({editorState:o()({},t.state.editorState,c)})}}),u()(s()(t),"_editorCancelHandler",function(){t._eligibleAddPageCommentTracking(!1,hn.ADD)&&t._sendExperienceAnalytics({experience:R.b.PAGE_COMMENT_CLOSE,isAttempt:!0}),t._hideEditor(),t._removeSlowCommentURLParams(),t._eligibleAddPageCommentTracking(!1,hn.RESET)&&t._sendExperienceAnalytics({experience:R.b.PAGE_COMMENT_CLOSE,wasExperienceSuccessful:!0})}),u()(s()(t),"_onDeleteComment",function(e){(0,t.props.deleteComment)(e)}),u()(s()(t),"_onReplyToComment",function(e){t._warnCommentLost(function(){return t._replyCommentAction(e)})}),u()(s()(t),"_onEditComment",function(e){t._warnCommentLost(function(){return t._editCommentAction(e)})}),u()(s()(t),"_getCommentActions",function(){return{deleteComment:t._onDeleteComment,replyToComment:t._onReplyToComment,editComment:t._onEditComment}}),u()(s()(t),"_closeEditorError",function(){t.setState({editorState:o()({},t.state.editorState,{errorMessage:"",updateTime:0})})}),u()(s()(t),"_getReference",function(e){return function(n){return t.domNodes[e]=n}}),t}return C()(n,e),c()(n,[{key:"componentDidMount",value:function(){var e=this.props,n=e.replyToCommentId,t=e.shouldOpenAddComment,i=e.openEditCommentId,o=e.isEditCommentFound,a=e.focusOnCommentId,r=e.readyToScrollToElement,d=this.state.editorState;i&&o&&(this._editCommentAction(i),this.scrollToElement("comment-".concat(i))),n&&d.contentId!==n&&this._replyCommentAction(n),t&&this._triggerShowAddCommentEditor(),a&&r&&this.scrollToElement("comment-".concat(a)),t&&r&&this.scrollToElement("addcomment"),Object(ce.a)("rte-quick-edit-ready",this._hideEditorIfNotForComments)}},{key:"componentDidUpdate",value:function(){Object(pn.d)()}},{key:"componentWillUnmount",value:function(){Object(ce.c)("rte-quick-edit-ready",this._hideEditorIfNotForComments),this._hideEditor()}},{key:"scrollToElement",value:function(e){var n=Object(un.d)(e);n&&n.scrollIntoView()}},{key:"_getThreadLastCommentId",value:function(e){var n,t,i,o;return this.props.commentsData.forEach(function(a){n||(void 0!==t&&(t>=a.depthLevel?n=i:o=a.id),a.id===e&&(t=a.depthLevel),i=a.id)}),n||(n=o||e),n}},{key:"_removeSlowCommentURLParams",value:function(){var e=this.props,n=e.replace,t=e.location,i=t.query,a=["showCommentArea","showComments","editComment","commentId"];if(a.map(function(e){return void 0!==i[e]}).filter(function(e){return e}).length){var r=ie()(t.query,a);n(o()({},t,{query:r,search:$.a.format({query:r})}))}}},{key:"_canViewProfile",value:function(){var e=this.props.currentUserInfo,n=e.isAnonymous,t=e.currentUserCanViewProfile;return n?!0===t:!1!==t}},{key:"_isAddCommentEditorEnabled",value:function(){var e=this.props.contentId,n=this.state.editorState;return n.contentId===e&&n.mode===hn.ADD}},{key:"_renderHeadLine",value:function(){var e=this.props.totalComments;return e?I.a.createElement("h2",{"data-test-id":"comments-count"},1===e?I.a.createElement(oe.b,{id:"comment.singular",values:{0:e}}):I.a.createElement(oe.b,{id:"comment.plural",values:{0:e}})):null}},{key:"_renderEditCommentErrorFlag",value:function(){var e=this.props,n=e.openEditCommentId,t=e.isEditCommentFound;return n&&!t?I.a.createElement(re.a,{type:"error"},I.a.createElement(oe.b,{id:"comment.edit.not.found"})):null}},{key:"_renderCommentsList",value:function(){var e=this.props,n=e.contentId,t=e.currentUserInfo,i=e.commentsData,o=e.contentType,a=e.focusOnCommentId,r=e.editedCommentsIds,d=e.atlToken,c=this.state,m=c.updatedCommentsIds,s=c.commentsIds,l=c.editorState,u={atlToken:d,commentsIds:s,contentType:o,contentId:n,comments:i,commentActions:this._getCommentActions(),showAuthorLabel:"blogpost"===o,focusOnCommentId:a,highlightedComments:r.length>0?r:m,userInfo:t,editor:l,canViewProfile:this._canViewProfile(),editorSaveHandler:this._editorSaveHandler,editorCancelHandler:this._editorCancelHandler,onEditorLoaded:this._onEditorLoaded};return I.a.createElement(an,u)}},{key:"_renderAddCommentField",value:function(){var e=this.props,n=e.contentId,t=e.canAddComments,i=e.currentUserInfo,o=e.atlToken,a=this.state.editorState;if(t){var r={style:{paddingTop:20},contentId:n,atlToken:o,mode:"add",id:"addcomment",userInfo:i,isEditorEnabled:this._isAddCommentEditorEnabled(),onClickCommentAddPrompt:this._showAddCommentEditor,editor:a,canViewProfile:this._canViewProfile(),editorSaveHandler:this._editorSaveHandler,editorCancelHandler:this._editorCancelHandler,onEditorLoaded:this._onEditorLoaded};return I.a.createElement(N.Fragment,null,I.a.createElement(nn,r),a.mode===hn.ADD&&I.a.createElement(J.a,null))}}},{key:"_renderEditorMessage",value:function(){var e=this.props.intl.formatMessage,n=this.state.editorState;return I.a.createElement(N.Fragment,null,I.a.createElement(ue.a,{isShowing:!0,type:n.errorType||"error",body:fn[n.errorMessage]?e({id:fn[n.errorMessage]}):n.errorMessage,close:"manual",onClose:this._closeEditorError}),I.a.createElement(J.b,null))}},{key:"_renderGraphQLErrorMessage",value:function(){var e=this.props.intl.formatMessage,n=this.props,t=n.saveCommentError,i=n.deleteCommentError,o=t||i,a=T()(o,"graphQLErrors[0].message");return I.a.createElement(N.Fragment,null,I.a.createElement(ue.a,{isShowing:!0,type:"error",body:fn[a]?e({id:fn[a]}):a,close:"manual",onClose:this._closeEditorError}),I.a.createElement(J.b,null))}},{key:"render",value:function(){var e=this.props,n=e.contentId,t=e.saveCommentError,i=e.deleteCommentError,o=e.totalComments,a=e.hasNextPage,r=this._isAddCommentEditorEnabled(),d=this.state.editorState;return I.a.createElement("div",{className:kn.a.root,ref:this._getReference("root"),id:"comments-section","data-test-id":"comments-section-new"},this._renderHeadLine(),this._renderEditCommentErrorFlag(),t||i?this._renderGraphQLErrorMessage():null,this._renderCommentsList(),this._renderAddCommentField(),d.errorMessage?this._renderEditorMessage():null,r?null:I.a.createElement(dn,{contentId:n,onClick:this._triggerShowAddCommentEditor}),a?null:I.a.createElement(se.a,{subject:"comments",details:{totalComments:o}}),d.isEditorLoaded&&d.mode===hn.ADD&&I.a.createElement(J.c,null))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return!Z()(n.commentsIds,e.commentsIds)&&!1===n.hasNextPage&&!1===e.hasNextPage&&e.hasFetchedComments?{commentsIds:e.commentsIds,hasNextPage:e.hasNextPage,updatedCommentsIds:ne()(e.commentsIds,n.commentsIds)}:o()({},n,{commentsIds:e.commentsIds,hasNextPage:e.hasNextPage})}}]),n}(N.Component))||sn)||sn)||sn),gn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CommentsSectionQuerySaveComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"params"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExperimentalCommentInput"}},directives:[]}],directives:[{kind:"Directive",name:{kind:"Name",value:"experimental"},arguments:[]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"experimentalSaveComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"params"},value:{kind:"Variable",name:{kind:"Name",value:"params"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"asyncRenderSafe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"html"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isInlineComment"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ownerId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:249,source:{body:"\n  mutation CommentsSectionQuerySaveComment($params: ExperimentalCommentInput)\n    @experimental {\n    experimentalSaveComment(params: $params) {\n      asyncRenderSafe\n      html\n      id\n      isInlineComment\n      ownerId\n      parentId\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Cn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CommentsSectionQueryDeleteComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[{kind:"Directive",name:{kind:"Name",value:"experimental"},arguments:[]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"experimentalDeleteComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"contentId"},value:{kind:"Variable",name:{kind:"Name",value:"contentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contentId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"statusCode"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:177,source:{body:"\n  mutation CommentsSectionQueryDeleteComment($contentId: ID!) @experimental {\n    experimentalDeleteComment(contentId: $contentId) {\n      contentId\n      statusCode\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},_n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CommentsSectionGetSingleCommentQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"contentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ancestors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"container"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"history"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profilePicture"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"editor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"view"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webresource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"keys"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"history"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profilePicture"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"links"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webui"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"operations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"operation"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"friendlyWhen"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"when"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"by"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"KnownUser"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:1183,source:{body:"\n  query CommentsSectionGetSingleCommentQuery($contentId: ID!) {\n    content(id: $contentId) {\n      nodes {\n        ancestors {\n          id\n        }\n        container {\n          history {\n            createdBy {\n              type\n              displayName\n              profilePicture {\n                path\n              }\n              ... on KnownUser {\n                accountId\n              }\n            }\n          }\n        }\n        body {\n          editor {\n            value\n          }\n          view {\n            value\n            webresource {\n              keys\n            }\n          }\n        }\n        history {\n          createdBy {\n            type\n            displayName\n            profilePicture {\n              path\n            }\n            ... on KnownUser {\n              accountId\n            }\n          }\n        }\n        id\n        links {\n          webui\n        }\n        operations {\n          operation\n        }\n        version {\n          friendlyWhen\n          when\n          by {\n            ... on KnownUser {\n              accountId\n              displayName\n              type\n            }\n          }\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Sn=function(e){function n(){var e,t;v()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];t=f()(this,(e=y()(n)).call.apply(e,[this].concat(o)));var r=o[0];return t.message=r.message,t.graphQLErrors=r.graphQLErrors,t}return C()(n,e),n}(S()(Error));var En=Object(A.connect)(function(e,n){var t=n.commentsData,i=n.hasFetchedComments,o=t.map(function(e){return e.id}),a=Object(D.v)(e),r=a.query,d=r.focusedCommentId,c=r.replyToComment,m=r.showCommentArea,s=r.editComment,l=r.commentId,u="true"===s&&l||"";return{focusOnCommentId:d||c,replyToCommentId:c,shouldOpenAddComment:"true"===m,openEditCommentId:u,isEditCommentFound:!!u&&-1!==o.indexOf(u),readyToScrollToElement:i,hasFetched:i,commentsData:t,commentsIds:o,location:a,atlToken:""}},function(e){return{replace:function(n){return e(Object(F.replace)(n))}}})(yn),bn=[],Nn=Object(w.e)(function(e){function n(){var e,t;v()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f()(this,(e=y()(n)).call.apply(e,[this].concat(o))),u()(s()(t),"state",{webPanels:null}),u()(s()(t),"_loadedCursor",{}),u()(s()(t),"fetchWebPanels",function(){var e=t.props,n=e.contentId,i=e.client,o={contentId:n,location:G.a.ATL_PAGE_CONTENT_FOOTER_ACTIONS};i.query({query:z.a,variables:o}).then(function(e){var n=e.data,i=T()(n,"webPanels");t.setState({webPanels:i})})}),u()(s()(t),"_getCommentVersion",function(e){return{id:T()(e,"node.id"),by:T()(e,"node.version.by"),when:T()(e,"node.version.when")}}),u()(s()(t),"_buildUserInfo",function(e){return{displayName:T()(e,"displayName"),avatarUrl:T()(e,"photos.length")&&T()(e,"photos").find(function(e){return e.isPrimary}).value,accountId:T()(e,"id")}}),u()(s()(t),"_saveComment",function(e,n){return function(t){var i=t.watch,o=void 0!==i&&i,a=t.contentId,r=t.commentId,d=void 0===r?"":r,c=t.html,m=t.requestType,s=t.captcha;return n({variables:{params:{contentId:a||e,commentId:d,requestType:m,html:c,watch:o,uuid:Object(W.a)(),captcha:s}}})}}),u()(s()(t),"_deleteComment",function(e,n){return function(e){return n({variables:{contentId:e}})}}),u()(s()(t),"_onRefetchComments",function(e,n){var t=e.commentId;return n({variables:{contentId:t},query:_n,updateQuery:function(n,i){var o=i.fetchMoreResult,a=T()(o,"content.nodes[0]");if(!a)return n;var d=L()(n),c=[],m=e.threadLastCommentId,s=e.parentId,l=e.mode;if("editComment"===l){var u=n.content.child.comment.edges.findIndex(function(e){return e.node.id===t}),p=d.content.child.comment.edges.slice(0,u),v=[{cursor:u.toString(),node:a,__typename:"ContentEdge"}],k=d.content.child.comment.edges.slice(u+1);c=[].concat(r()(p),v,r()(k)),bn=[t]}else if("replyComment"===l){var f=m||s,h=n.content.child.comment.edges.findIndex(function(e){return e.node.id===f}),y=d.content.child.comment.edges.slice(0,h+1),g=[{cursor:(h+1).toString(),node:a,__typename:"ContentEdge"}],C=d.content.child.comment.edges.slice(h+1);c=[].concat(r()(y),g,r()(C)),bn=[]}else"addComment"!==l&&"0"!==s||(c=d.content.child.comment.edges.concat([{cursor:n.content.child.comment.count.toString(),node:a,__typename:"ContentEdge"}]),bn=[]);return Object.assign({},n,{content:{child:{comment:{count:c.length,pageInfo:{endCursor:(c.length-1).toString(),hasNextPage:!1,__typename:d.content.child.comment.pageInfo.__typename},edges:c,__typename:d.content.child.comment.__typename},__typename:d.content.child.__typename},nodes:r()(d.content.nodes),__typename:d.content.__typename}})}})}),t}return C()(n,e),c()(n,[{key:"componentDidMount",value:function(){this.fetchWebPanels()}},{key:"_buildCommentsData",value:function(e){var n=this,t=T()(e,"content.child.comment.edges");return t&&0!==t.length?t.map(function(e){var t=T()(e,"node.ancestors")||[],i=T()(t,"length")||0,o=T()(t,"ancestors[0].id")||null,a=T()(e,"node.body.view.value")||"",r=T()(e,"node.body.editor.value")||"",d=n._getCommentVersion(e),c=T()(e,"node.body.view.webresource.key")||[],m=Object(H.h)(T()(e,"node.history.createdBy"));return{ancestors:t,depthLevel:i,parentId:o,bodyExportView:a,contentContainerCreatedBy:Object(H.h)(T()(e,"node.container.history.createdBy")),bodyEditorView:r,version:d,webResourceKeys:c,createdBy:m,createdByAuthor:Boolean(T()(e,"node.container.history.createdBy.accountId")&&T()(e,"node.version.by.accountId")&&T()(e,"node.container.history.createdBy.accountId")===T()(e,"node.version.by.accountId")),id:T()(e,"node.id")||"",linkWebui:T()(e,"node.links.webui")||"",operations:T()(e,"node.operations")||[],createdFriendly:T()(e,"node.version.friendlyWhen")||"",createdDate:T()(e,"node.version.when")||""}}):[]}},{key:"_fetchMore",value:function(e,n){return e({variables:n,updateQuery:function(e,n){var t=n.fetchMoreResult;return t?Object.assign({},e,{content:{child:{comment:{count:e.content.child.comment.count+t.content.child.comment.count,pageInfo:o()({},t.content.child.comment.pageInfo,{__typename:t.content.child.comment.pageInfo.__typename}),edges:[].concat(r()(e.content.child.comment.edges),r()(t.content.child.comment.edges)),__typename:t.content.child.comment.__typename},__typename:t.content.child.__typename},nodes:r()(t.content.nodes),__typename:t.content.__typename}}):e}})}},{key:"_getExperience",value:function(e){return"page"===e?R.b.PAGE_COMMENT_ADD:""}},{key:"render",value:function(){var e=this,n=this.props.contentId;return n?I.a.createElement(O.f,null,I.a.createElement(q.a,{subject:"comments",beforeMount:!0}),I.a.createElement(w.d,{query:K,variables:{contentId:n,offset:0,first:100},fetchPolicy:"cache-and-network",errorPolicy:"all"},function(t){var i=t.data,a=t.loading,d=t.error,c=t.fetchMore,m=t.networkStatus;return I.a.createElement(w.c,{mutation:gn},function(t,s){var l=s.error,u=s.data;return I.a.createElement(w.c,{mutation:Cn,update:function(e,t){var i=t.data.experimentalDeleteComment.contentId,a=e.readQuery({query:K,variables:{contentId:n,offset:0,first:100}}),d=a.content.child.comment.edges.filter(function(e){return e.node.id!==i}).map(function(e){var n=e.node.ancestors.filter(function(e){return e.id!==i}),t=e.node,a={container:t.container,body:t.body,history:t.history,id:t.id,links:t.links,operations:t.operations,version:t.version},r=e.cursor;return Object.assign({},e,{cursor:r,node:o()({ancestors:n},a,{__typename:e.node.__typename}),__typename:e.__typename})}),c=a.user;e.writeQuery({query:K,variables:{contentId:n,offset:0,first:100},data:{content:{child:{comment:{count:d.length,pageInfo:{endCursor:(d.length-1).toString(),hasNextPage:!1,__typename:a.content.child.comment.pageInfo.__typename},edges:d,__typename:a.content.child.comment.__typename},__typename:a.content.child.__typename},nodes:r()(a.content.nodes),__typename:a.content.__typename},user:c}})}},function(o,r){var s=r.error,p=r.data;if(d)throw new Sn(d);if(!T()(i,"content.nodes[0]")||!T()(i,"content.child.comment"))return null;var v=T()(i,"content.child.comment"),k=v.count,f=v.pageInfo,h=f.hasNextPage,y=f.endCursor,g=T()(i,"content.nodes[0]"),C=g.operations,_=g.space,S=_.homepageId,E=_.id,b=g.type,N=e._buildUserInfo(T()(i,"user")),w=e.state.webPanels,A=S===n,F=C.find(function(e){return"create"===e.operation&&"comment"===e.targetType})&&Boolean(!A||k>0);return!h||a||e._loadedCursor[y]||(e._loadedCursor[y]=!0,e._fetchMore(c,{contentId:n,offset:Number(y)+1})),I.a.createElement(V.Provider,{value:{isLikesEnabled:!!w}},I.a.createElement(Q.a,{experience:e._getExperience(b),experienceId:n},I.a.createElement(J.d,null,I.a.createElement(En,{onRefetchComments:function(n){return e._onRefetchComments(n,c)},canAddComments:F,currentUserInfo:N,canViewProfile:!!N,commentsData:e._buildCommentsData(i),contentId:n,contentType:b,spaceId:E,currentUserCanViewProfile:!!N,isAnonymous:!N,totalComments:h?0:k,hasFetchedComments:!a,hasNextPage:h,networkStatus:m,saveComment:e._saveComment(n,t),deleteComment:e._deleteComment(n,o),saveCommentData:u,saveCommentError:l,deleteCommentData:p,deleteCommentError:s,editedCommentsIds:bn}))))})})})):null}}]),n}(N.Component));n.default=Nn},dNso:function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,".CommentsList_root_47I{margin-top:5px}",""]),n.locals={root:"CommentsList_root_47I"}},eeAI:function(e,n,t){(n=e.exports=t("RDo7")(!1)).push([e.i,".CommentAddPrompt_root_24r{border:1px solid #ccc;border-radius:3px;height:42px;color:#999;padding-top:5px}.CommentAddPrompt_root_24r span{padding:6px}",""]),n.locals={root:"CommentAddPrompt_root_24r"}},"g/An":function(e,n,t){var i=t("dNso"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}},iUdj:function(e,n,t){"use strict";n.a=function(e){Promise.all([t.e(107),t.e(294)]).then(t.bind(null,"LbM8")).then(function(n){return e(n.default)})}},pYTW:function(e,n,t){var i=t("eeAI"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}},utTn:function(e,n,t){"use strict";t.d(n,"c",function(){return r}),t.d(n,"b",function(){return d}),t.d(n,"a",function(){return c}),t.d(n,"d",function(){return m});var i=t("Jygk"),o=t.n(i),a=t("M2LZ"),r=function(){a.a.require(["wr!com.atlassian.confluence.plugins.confluence-create-content-plugin:resources"]).then(function(){o.a.Confluence.SpaceBlueprint.Dialog.launch()})},d=function(){a.a.require(["wr!com.atlassian.confluence.plugins.confluence-create-content-plugin:resources"]).then(function(){o.a.Confluence.Blueprint.loadDialogAndOpenTemplate({})})},c=function(){return Confluence.Link},m=("undefined"!=typeof Confluence&&Confluence,function(){return"undefined"!=typeof Confluence&&Confluence.Binder&&Confluence.Binder.userHover&&Confluence.Binder.userHover()})},v45N:function(e,n,t){var i=t("TcLa"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}},wjr4:function(e,n,t){var i=t("C4P7"),o=t("7l8p");"string"==typeof i&&(i=[[e.i,i,""]]),e.exports=i.locals||{},e.exports._getContent=function(){return i},e.exports._getCss=function(){return i.toString()},e.exports._insertCss=function(e){return o(i,e)}}}]);
//# sourceMappingURL=page.comments~space.overview.079de18c3c4783cc765f-v38.js.map