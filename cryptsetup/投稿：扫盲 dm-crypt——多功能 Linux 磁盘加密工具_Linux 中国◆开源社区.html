
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具|Linux 中国◆开源社区</title>
<link href="https://linux.cn/thread-14738-1-1.html" rel="canonical" /> 
<meta name="keywords" content="投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具" />
<meta name="description" content=" 投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具 " />
<meta name="copyright" content="2005-2017 Linux.cn" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<meta name="applicable-device" content="pc,mobile">
<meta name="referrer" content="always">
<base href="https://linux.cn/" /><link rel="stylesheet" type="text/css" href="https://img.linux.net.cn/data/cache/style_1_common.css?C0M" />
<link rel="stylesheet" type="text/css" href="https://img.linux.net.cn/data/cache/style_1_forum_viewthread.css?C0M" />
<link href="https://img.linux.net.cn/static/css/responsive.css?C0M" rel="stylesheet">

<script type="text/javascript">var STYLEID = '1', STATICURL = 'https://img.linux.net.cn/static/', IMGDIR = 'https://img.linux.net.cn/static/image/common', VERHASH = 'C0M', charset = 'utf-8', discuz_uid = '0', cookiepre = 'dx_516d_', cookiedomain = '.linux.cn', cookiepath = '/', showusercard = '1', attackevasive = '0', disallowfloat = '', creditnotice = '1|经验|,2|L币|,3|贡献|', defaultstyle = '', REPORTURL = 'aHR0cDovL2xpbnV4LmNuL3RocmVhZC0xNDczOC0xLTEuaHRtbA==', SITEURL = 'https://linux.cn/', JSPATH = 'https://img.linux.net.cn/static/js/', CSSPATH = 'data/cache/style_', DYNAMICURL = '';</script>
<script src="https://img.linux.net.cn/static/js/common.js?C0M" type="text/javascript"></script>
<script src="https://img.linux.net.cn/static/js/jquery-1.11.0.min.js" type="text/javascript"></script>
<script type="text/javascript">jQuery.noConflict();</script>
<script src="https://img.linux.net.cn/static/js/jquery.plugins.js?C0M" type="text/javascript"></script>
<script src="https://img.linux.net.cn/static/js/bootstrap.min.js?C0M" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="Linux 中国◆开源社区 RSS" href="/rss.xml" />
<link rel="shortcut icon" href="https://img.linux.net.cn/favicon.ico"  sizes="32x32" />
<link rel="stylesheet" id="css_widthauto" type="text/css" href='data/cache/style_1_widthauto.css?C0M' />
<script type="text/javascript">HTMLNODE.className += ' widthauto'</script>
<script src="https://img.linux.net.cn/static/js/forum.js?C0M" type="text/javascript"></script>
</head>

<body id="nv_forum" class="pg_viewthread" onkeydown="if(event.keyCode==27) return false;">
<div id="append_parent"></div><div id="ajaxwaitid"></div>
<div id="toptb" class="cl">
<div class="wp">
<div class="z"><a href="/rss.xml" target="_blank" >RSS</a><a href="/tag/" >TAG</a></div>
<div class="y">
<a href="/aboutus.html" >关于我们/aboutus</a><a href="/business.html" >广告合作/ad</a><a href="/article-8670-1.html" >帮助我们/contribute</a></div>
</div>
</div>


<div id="hd">
<div class="wp" style="box-shadow: 1px 1px 2px #666;">
<h1 id="linuxcn_logo" style="display: block;margin: 24px;padding:0;position: absolute; width: 128px;height: 128px;background-image: url(https://img.linux.net.cn/static/image/common/linuxcn_logo_2017.png);"><a href="https://linux.cn/" title="Linux.中国 - 开源社区"><img src="https://img.linux.net.cn/static/image/common/linuxcn_logo_2017.png" class="logo_rotate" border="0" style="border-radius: 50%;text-indent: 0px;position: absolute;">
<img src="https://img.linux.net.cn/static/image/common/radio.png" style="border-radius: 50%; -webkit-animation: spin 60s linear infinite; animation: spin 60s linear infinite;transform: rotate(0deg);" /></a><style type="text/css">@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);}}@keyframes spin{100%{transform:rotate(360deg);}}</style></h1>
<div class="hdc cl"><div class="y"><script src="https://img.linux.net.cn/static/js/logging.js?C0M" type="text/javascript"></script>
<form method="post" autocomplete="off" id="lsform" action="member.php?mod=logging&amp;action=login&amp;loginsubmit=yes&amp;infloat=yes&amp;lssubmit=yes" onsubmit="pwmd5('ls_password');return lsSubmit();">
<div class="fastlg cl">
<span id="return_ls" style="display:none"></span>
<div class="y pns">
<table cellspacing="0" cellpadding="0">
<tr>
<td><label for="ls_username">帐号</label></td>
<td><input type="text" name="username" id="ls_username" class="px vm xg1"  value="用户名/Email" onfocus="if(this.value == '用户名/Email'){this.value = '';this.className = 'px vm';}" onblur="if(this.value == ''){this.value = '用户名/Email';this.className = 'px vm xg1';}" tabindex="901" /></td>
<td class="fastlg_l"><label for="ls_cookietime"><input type="checkbox" name="cookietime" id="ls_cookietime" class="pc" value="2592000" tabindex="903" />自动登录</label></td>
<td>&nbsp;<a href="javascript:;" onclick="showWindow('login', 'member.php?mod=logging&action=login&viewlostpw=1')">找回密码</a></td>
</tr>
<tr>
<td><label for="ls_password">密码</label></td>
<td><input type="password" name="password" id="ls_password" class="px vm" autocomplete="off" tabindex="902" /></td>
<td class="fastlg_l"><button type="submit" class="pn vm" tabindex="904"><em>登录</em></button></td>
<td>&nbsp;<a href="member.php?mod=knight" class="xi2 xw1">骑士注册</a></td>
</tr>
</table>
<input type="hidden" name="quickforward" value="yes" />
<input type="hidden" name="handlekey" value="ls" />
</div>

<div class="fastlg_fm y" style="margin-right: 10px; padding-right: 10px">
<p><a href="https://linux.cn/connect.php?mod=login&op=init&referer=forum.php%3Fmod%3Dviewthread%26tid%3D14738%26extra%3Dpage%5C%253D1%26page%3D1&statfrom=login_simple"><img src="https://img.linux.net.cn/static/image/common/qq_login.gif" class="vm" alt="QQ登录" /></a></p>
<p><a href="xwb.php?m=xwbAuth.login"><img src="https://img.linux.net.cn/static/image/common/sina_login.gif" class="vm" style="padding: 2px 0;" alt="微博登录" /></a></p>
</div>

<script>
try{
(function(){
var node = document.getElementById("lsform").firstChild;
var i = 1;
while(i < 3 && node.nodeType!=1){
node=node.nextSibling;
i++;
}
node.style.width = 'auto';
})();
}catch(e){}
</script>
</div>
</form>

<script src="https://img.linux.net.cn/static/js/md5.js?C0M" type="text/javascript" reload="1"></script>
</div>
<h2 style="float:right;width: 400px;height: 70px;overflow: hidden;margin: 5px 20px;">
<div class="linuxcnad">
    </div>
</h2>
</div>
<div class="p_pop h_pop" id="mn_userapp_menu" style="display: none"></div><div id="topmenu_wrapper">
<div id="topmenu">
<div id="nv">
<ul><li id="mn_N6666" ><a href="/" hidefocus="true"   style="font-weight: bold;">Linux 中国</a></li><li id="mn_P3" onmouseover="navShow('P3')"><a href="https://linux.cn/tech/" hidefocus="true"   style="color: #FFFAE5;">技术</a></li><li id="mn_P1" ><a href="https://linux.cn/news/" hidefocus="true"   style="color: #FFFAE5;">新闻</a></li><li id="mn_P4" onmouseover="navShow('P4')"><a href="https://linux.cn/talk/" hidefocus="true"   style="color: #FFFAE5;">观点</a></li><li id="mn_P8" onmouseover="navShow('P8')"><a href="https://linux.cn/share/" hidefocus="true"   style="color: #FFFAE5;">分享</a></li><li id="mn_N1fa1" ><a href="/lctt/" hidefocus="true" target="_blank"  >LCTT</a></li></ul>
</div>
<div id="mu" class="cl">
<ul class="cl " id="snav_mn_P3" style="display:none;">
<li><a href="https://linux.cn/tech/desktop/" hidefocus="true" >桌面应用</a></li><li><a href="https://linux.cn/tech/sa/" hidefocus="true" >系统运维</a></li><li><a href="https://linux.cn/tech/program/" hidefocus="true" >软件开发</a></li><li><a href="https://linux.cn/tech/raspberrypi/" hidefocus="true" >树莓派</a></li><li><a href="https://linux.cn/tech/container/" hidefocus="true" >容器与云</a></li></ul>
<ul class="cl " id="snav_mn_P4" style="display:none;">
<li><a href="https://linux.cn/talk/comic/" hidefocus="true" >极客漫画</a></li><li><a href="https://linux.cn/talk/ossip/" hidefocus="true" >开源智慧</a></li><li><a href="https://linux.cn/talk/interview/" hidefocus="true" >穿山甲专访</a></li><li><a href="https://linux.cn/talk/ocselected/" hidefocus="true" >开源之道</a></li></ul>
<ul class="cl " id="snav_mn_P8" style="display:none;">
<li><a href="https://linux.cn/share/distro/" hidefocus="true" >Linux 发行版</a></li></ul>
<ul class="cl " id="snav_mn_userapp" style="display:none;">
</ul>
</div></div>
</div>
<div id="scbar" class="cl" >
<form id="scbar_form" method="post" autocomplete="off" onsubmit="searchFocus($('scbar_txt'))" action="search.php?searchsubmit=yes" target="_blank">
<input type="hidden" name="mod" id="scbar_mod" value="search" />
<input type="hidden" name="formhash" value="01efc05f" />
<input type="hidden" name="srchtype" value="title" />
<input type="hidden" name="srhfid" value="119" />
<input type="hidden" name="srhlocality" value="forum::viewthread" />
<table id="scbar_table" cellspacing="0" cellpadding="0" style="float:right;">
<tr>
<td class="scbar_icon_td"></td>
<td class="scbar_txt_td"><input type="text" name="srchtxt" id="scbar_txt" value="请注册后再搜索" autocomplete="off" speech /></td>
<td class="scbar_type_td"><a href="javascript:;" id="scbar_type" class="xg1" onclick="showMenu(this.id)" hidefocus="true">搜索</a></td>
<td class="scbar_btn_td"><button type="submit" name="searchsubmit" id="scbar_btn" sc="1" class="pn pnc" value="true"><strong class="xi2">搜索</strong></button></td>
<td class="scbar_hot_td">
<div id="scbar_hot">
</div>
</td>
</tr>
</table>
</form>
<span class="z titletext" style="padding: 0 10px 0 20px;">❏ 站外平台：</span>
<ul id="ext_plantform" class="cl mutag z">
<li><a class="hidefocus tsina" hidefocus="true" href="https://weibo.com/linuxcn" target="_blank" title="微博认证号：Linux中国"></a></li>
<li><a class="hidefocus tticon" hidefocus="true" href="https://www.toutiao.com/c/user/52889878622/" target="_blank" title="今日头条：Linux中国"></a></li>
<li><a class="hidefocus tticon" hidefocus="true" href="http://www.toutiao.com/c/user/3357852467/" target="_blank" title="今日头条：Linux技术"></a></li>
<li><a class="hidefocus wyicon" hidefocus="true" href="http://dy.163.com/v2/article/detail/D282EJLD0511CPOJ.html" target="_blank" title="网易号：Linux"></a></li>
<li><a class="hidefocus fbicon" hidefocus="true" href="https://www.facebook.com/linux.china/" target="_blank" title="Facebook Page：Linux中国"></a></li>
<li><a class="hidefocus zhicon" hidefocus="true" href="https://www.zhihu.com/org/linuxzhong-guo/" target="_blank" title="知乎机构号：Linux中国"></a></li>
<li><a class="hidefocus twicon" hidefocus="true" href="https://twitter.com/linux_cn" target="_blank" title="Twitter：Linux中国"></a></li>
<li><a class="hidefocus tgicon" hidefocus="true" href="https://t.me/linuxdotcn" target="_blank" title="Telegram Channel：Linux中国"></a></li>
</ul>
</div>
<br class="clear" />
<ul id="scbar_type_menu" class="p_pop" style="display: none;"><li><a href="javascript:;" rel="curforum" fid="119" >本版</a></li></ul>
<script type="text/javascript">
initSearchmenu('scbar', '');
</script>
<script type="text/javascript">
(function($){
$(window).load(function() {
function logo_rotate() {
var curdate = new Date();
var minutes = curdate.getHours() * 60 + curdate.getMinutes();
var r = (360 * (minutes % 720)) / 720;

$('#hd h1 img.logo_rotate')
.animate({textIndent: r }, {
    step: function(now,fx) {
      $(this).css('transform','rotate('+now+'deg)');
    },
    duration:'slow'
});
$('#hd h1')
.unbind()
.mouseout(function() {
$('#hd h1 img.logo_rotate').animate({textIndent: r }, {
    step: function(now,fx) {
      $(this).css('transform','rotate('+now+'deg)');
    },
    duration:'slow'
})
})
.mouseover(function() {
$('#hd h1 img.logo_rotate').animate({textIndent: 0 }, {
    step: function(now,fx) {
      $(this).css('transform','rotate('+now+'deg)');
    },
    duration:'slow'
})
});
}
logo_rotate();
setInterval(logo_rotate,60000);
/*function logo_radio() {
var curdate = new Date();
var seconds = curdate.getSeconds() + curdate.getMilliseconds() / 1000;
var r = 360 * (seconds / 60);
$('#logo_radio').css({
//	'-webkit-transform':'rotate('+r+'deg)',
//	'-moz-transform':'rotate('+r+'deg)',
'transform':'rotate('+r+'deg)'});
}
setInterval(logo_radio,1000);
*/
$("#topmenu").affix({offset : {
top : $("#topmenu").offset().top,
bottom: 218}});
$('#topmenu_wrapper').height($("#topmenu").height());
$("#topmenu").on('affixed.bs.affix',function() {
if ($('#linuxcn_logo').is(':visible')) {
$('#mn_N6666').css({'display': 'block','width': '179px'});
$('#mn_N6666 a').css({'padding': '0 45px'});
$(this).css({'padding-left': 0,'width':'1200px'});
}
});
$("#topmenu").on('affixed-top.bs.affix',function() {
if ($('#linuxcn_logo').is(':visible')) {
$('#mn_N6666').css({'display': 'none'});
$(this).css({'padding-left': '180px','width': '1020px'});
}
});
})
})(jQuery);
</script>

</div>
</div>
<div id="wp" class="wp">
<script type="text/javascript">var fid = parseInt('119'), tid = parseInt('14738');</script>

<script src="https://img.linux.net.cn/static/js/forum_viewthread.js?C0M" type="text/javascript"></script>
<script type="text/javascript">zoomstatus = parseInt(1);var imagemaxwidth = '700';var aimgcount = new Array();</script>

<style id="diy_style" type="text/css"></style>
<!--[diy=diynavtop]--><div id="diynavtop" class="area"></div><!--[/diy]-->
<div id="pt" class="bm cl">
<div class="z">
<a href="./" class="nvhm" title="首页">Linux 中国◆开源社区</a><em>&raquo;</em><a href="forum.php">论坛</a> <em>&rsaquo;</em> <a href="forum.php?gid=76">站务区</a> <em>&rsaquo;</em> <a href="forum/post/1/">投稿</a> <em>&rsaquo;</em> <a href="thread-14738-1-1.html">投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具 ...</a>
</div>
</div>

<style id="diy_style" type="text/css"></style>
<div class="wp">
<!--[diy=diy1]--><div id="diy1" class="area"></div><!--[/diy]-->
</div>

<div id="ct" class="wp cl">
<div id="pgt" class="pgs mbm cl ">
<div class="pgt"></div>
<span class="y pgb"><a href="forum/post/1/">返回列表</a></span>
<a id="newspecial" onmouseover="$('newspecial').id = 'newspecialtmp';this.id = 'newspecial';showMenu({'ctrlid':this.id})" onclick="showWindow('newthread', 'forum.php?mod=post&action=newthread&fid=119')" href="javascript:;" title="发新帖"><img src="https://img.linux.net.cn/static/image/common/pn_post.png" alt="发新帖" /></a></div>



<div id="postlist" class="pl bm">
<table cellspacing="0" cellpadding="0">
<tr>
<td class="pls ptn pbn">
<div class="hm ptn">
<span class="xg1">查看:</span> <span class="xi1">8448</span><span class="pipe">|</span><span class="xg1">回复:</span> <span class="xi1">0</span>
</div>
</td>
<td class="plc ptm pbn vwthd">
<div class="y">
<a href="forum.php?mod=viewthread&amp;action=printable&amp;tid=14738" title="打印" target="_blank"><img src="https://img.linux.net.cn/static/image/common/print.png" alt="打印" class="vm" /></a>
<a href="forum.php?mod=redirect&amp;goto=nextoldset&amp;tid=14738" title="上一主题"><img src="https://img.linux.net.cn/static/image/common/thread-prev.png" alt="上一主题" class="vm" /></a>
<a href="forum.php?mod=redirect&amp;goto=nextnewset&amp;tid=14738" title="下一主题"><img src="https://img.linux.net.cn/static/image/common/thread-next.png" alt="下一主题" class="vm" /></a>
</div>
<span class="xg1 side_btn">
<a onclick="setcookie('close_leftinfo', 1);location.reload();" title="收起左侧" class="btn_s_close" href="javascript:;"><img src="https://img.linux.net.cn/static/image/common/control_l.png" alt="收起左侧" class="vm" /></a>
</span>
<h1 class="ts">
<span id="thread_subject">投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具</span>
</h1>
<span class="xg1">
<a href="thread-14738-1-1.html" onclick="return copyThreadUrl(this, 'Linux 中国◆开源社区')" >[复制链接]</a>
</span>
</td>
</tr>
</table>


<table cellspacing="0" cellpadding="0" class="ad">
<tr>
<td class="pls">
</td>
<td class="plc">
</td>
</tr>
</table><div id="post_53775" ><table id="pid53775" class="plhin" summary="pid53775" cellspacing="0" cellpadding="0">
<tr>
<td class="pls" rowspan="2">
<div id="favatar53775" class="pls favatar">
<a name="newpost"></a> <a name="lastpost"></a><div class="p_pop blk bui card_gender_" id="userinfo53775" style="display: none; ">
<div class="m z">
<div id="userinfo53775_ma"></div>
</div>
<div class="i y">
<div>
<strong><a href="space/15424/" target="_blank" class="xi2" style="color: #00B050">kashu</a></strong>
<em>当前离线</em>
</div>
<dt>级别</dt><dd><a href="home.php?mod=spacecp&amp;ac=usergroup&amp;gid=15" target="_blank"><font color="#00B050">五行</font></a> {/authortitle}</dd>
<dt>积分</dt><dd><a href="home.php?mod=space&uid=15424&do=profile" target="_blank" class="xi2">16445</a></dd>
<dt>精华</dt><dd></dd>
<dt><img style="vertical-align:middle" src="https://dn-linuxcn.qbox.me/static/image/common/extcredits1.png" /> 经验</dt><dd> </dd>
<dt>主题</dt><dd><a href="home.php?mod=space&uid=15424&do=thread&type=thread&view=me&from=space" target="_blank" class="xi2"></a></dd>
<dt><img style="vertical-align:middle" src="https://dn-linuxcn.qbox.me/static/image/common/extcredits2.png" /> L币</dt><dd> </dd>
<dt>帖子</dt><dd><a href="home.php?mod=space&uid=15424&do=thread&type=reply&view=me&from=space" target="_blank" class="xi2"></a></dd>
<dt><img style="vertical-align:middle" src="https://dn-linuxcn.qbox.me/static/image/common/extcredits3.png" /> 贡献</dt><dd> </dd><div class="imicn">
<a href="home.php?mod=space&uid=15424&do=profile" target="_blank" title="查看详细资料"><img src="https://img.linux.net.cn/static/image/common/userinfo.gif" alt="查看详细资料" /></a>
<img src="https://img.linux.net.cn/xwb/images/bgimg/icon_off.gif" title="未绑定新浪微博" /></div>
<div id="avatarfeed"><span id="threadsortswait"></span></div>
</div>
</div>
<div>
<div class="avatar"><a href="space/15424/" class="avtm" target="_blank"><img src="//linux.cn/ucsrv/data/avatar/000/01/54/24_avatar_middle.jpg" onerror="this.onerror=null;this.src='https://img.linux.net.cn/ucsrv/images/noavatar_middle.gif'" /></a></div>
</div>
 <!-- 仅仅楼主显示完整发帖人信息 -->
</div>
</td>
	
<td class="plc">
<div class="pi">
<div id="fj" class="y">
<label class="z">电梯直达</label>
<input type="text" class="px p_fre z" size="2" onkeyup="$('fj_btn').href='forum.php?mod=redirect&ptid=14738&authorid=0&postno='+this.value" onkeydown="if(event.keyCode==13) {window.location=$('fj_btn').href;return false;}" title="跳转到指定楼层" />
<a href="javascript:;" id="fj_btn" class="z" title="跳转到指定楼层"><img src="https://img.linux.net.cn/static/image/common/fj_btn.png" alt="跳转到指定楼层" class="vm" /></a>
</div>
<strong>
<a href="thread-14738-1-1.html"   id="postnum53775" onclick="setCopy(this.href, '帖子地址复制成功');return false;">
楼主</a>
</strong>
<div class="pti">
<div class="pdbt">
</div>
<div class="authi">
<img class="authicn vm" id="authicon53775" src="https://img.linux.net.cn/static/image/common/online_member.gif" />
<a href="space/15424/" target="_blank" class="xi2">kashu</a>
<em id="authorposton53775">发表于 2016-02-16 11:11:22</em>
<span class="pipe">|</span>
<a href="forum.php?mod=viewthread&amp;tid=14738&amp;page=1&amp;authorid=15424" rel="nofollow">只看该作者</a>
<span class="none"><img src="https://img.linux.net.cn/static/image/common/arw_r.gif" class="vm" alt="回帖奖励" /></span>
<span class="pipe show">|</span><a href="forum.php?mod=viewthread&amp;tid=14738&amp;extra=&amp;ordertype=1"  class="show">倒序浏览</a>
<span class="pipe show">|</span><a href="javascript:;" onclick="readmode($('thread_subject').innerHTML, 53775);" class="show">阅读模式</a>
</div>
</div>
</div><div class="pct"><style type="text/css">.pcb{margin-right:0}</style><div class="pcb">
 
<div class="t_fsz">
<table cellspacing="0" cellpadding="0"><tr><td class="t_f" id="postmessage_53775">
<i class="pstatus"> 本帖最后由 kashu 于 2016-2-15 18:48 编辑 </i><br /><br /><h1 class="post-title entry-title"><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html" target="_blank">扫盲 dm-crypt&mdash;&mdash;多功能 Linux 磁盘加密工具（兼容 TrueCrypt &amp; VeraCrypt）</a></h1>
<p>2015-10-27<strong>文章目录</strong><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-1" target="_blank">★引子</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-2" target="_blank">★本文的目标读者</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-3" target="_blank">★&ldquo;dm-crypt/cryptsetup&rdquo;是啥玩意儿？</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-4" target="_blank">★&ldquo;dm-crypt&rdquo;的功能和特色</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-5" target="_blank">★&ldquo;dm-crypt&rdquo;与&ldquo;TrueCrypt/VeraCrypt&rdquo;的对比</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-6" target="_blank">★预备知识</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-7" target="_blank">★cryptsetup 命令行概述</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-8" target="_blank">★用 cryptsetup 创建 LUKS 的物理加密盘（加密物理分区）</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-9" target="_blank">★用 cryptsetup 创建 LUKS 的虚拟加密盘（逻辑卷）</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-10" target="_blank">★LUKS 加密盘使用 keyfile 作为认证因素</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-11" target="_blank">★用 cryptsetup 操作 TrueCrypt/VeraCrypt 的加密盘</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-12" target="_blank">★用 cryptsetup 加密系统分区（root filesystem）或全盘加密</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-13" target="_blank">★混用 dm-crypt 和 TrueCrypt/VeraCrypt</a><br /><a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html#head-14" target="_blank">★如果你对 TrueCrypt/VeraCrypt 不放心，该咋办？</a><br />　　很抱歉，又拖了好几天才更新博文。最近实在太忙了 :( 而且这篇博文的内容比较杂，整理起来也有点费时。<br />　　（本文发出后，俺顺便清理了博客管理界面的&ldquo;留言垃圾箱&rdquo;，里面有30多条&ldquo;被 Google 误判为垃圾广告的留言&rdquo;，刚才都已经恢复了）<br /><br /><a name="head-1"></a></p>
<h2>★引子</h2>
<p><br />　　9月底，TrueCrypt 曝光了高危安全漏洞。于是俺在10月初写了<a href="https://program-think.blogspot.com/2015/10/VeraCrypt.html" target="_blank">一篇教程</a>，介绍 VeraCrypt 这个替代品&mdash;&mdash;它可以完全覆盖 TrueCrypt 原有的功能，并且在安全方面还所有增强（比如用 PIM 来对抗&ldquo;抗暴力破解&rdquo;）。<br />　　那篇博文发出后，有些读者担心这个 VeraCrypt 本身是否可靠，是否会有后门。从目前 VeraCrypt 的口碑来看，这款工具应该还是比较靠谱的。当然，俺无法向你担保 VeraCrypt 一定没有后门（谁都没法打这个保票）。<br />　　为了照顾那些&ldquo;对安全要求特别高的同学&rdquo;，今天俺来介绍另一款磁盘加密工具&mdash;&mdash;Linux 内核自带的&ldquo;dm-crypt&rdquo;。<a name="more"></a><br />　　在本文的结尾部分，俺也会聊到：如何在【不使用】TrueCrypt/VeraCrypt 软件的情况下使用它们的加密盘。<br /><br /><a name="head-2"></a></p>
<h2>★本文的目标读者</h2>
<p><br />　　既然是&ldquo;扫盲&rdquo;，本文主要面向那些不太懂技术的读者（技术菜鸟）。如今 Linux 已经比较普及了，有些技术菜鸟也开始玩 Linux。<br />　　如果你属于此类用户，并且你还比较关注隐私保护，希望用上磁盘加密工具。那么 Linux 内核自带的 dm-crypt 是一个不错的选择。<br />　　本文的主题，就是向技术菜鸟介绍 dm-crypt 的基本用法。<br /><br /><a name="head-3"></a></p>
<h2>★&ldquo;dm-crypt/cryptsetup&rdquo;是啥玩意儿？</h2>
<p><br />　　在某些技术文章中，&ldquo;dm-crypt&rdquo;和&ldquo;cryptsetup&rdquo;经常被混用或并用。或者说，这两者常常被用来指代同一个东西。如果要细说的话，&ldquo;dm-crypt&rdquo;是 Linux 内核提供的一个磁盘加密功能，而&ldquo;cryptsetup&rdquo;是一个命令行的前端（通过它来操作&ldquo;dm-crypt&rdquo;）。<br />　　&ldquo;dm-crypt&rdquo;在 Linux Kernel 2.6 的早期版本就被整合到内核中，距今已经10多年了。经过这么多年发展，至少能说明如下几点：<br />1. 它的开源代码足够成熟<br />2. 它提供的功能足够通用<br />3. 它在安全方面足够靠谱<br /><br /><a name="head-4"></a></p>
<h2>★&ldquo;dm-crypt&rdquo;的功能和特色</h2>
<p><br />　　先大致描述一下 dm-crypt 支持的功能以及相关特色。<br /><br /></p>
<h3>◇支持多种加密格式</h3>
<p><br />　　目前 dm-crypt 支持如下几种加密格式（模式）。<br />　　<strong>1. LUKS（Linux Unified Key Setup）</strong><br />　　这是 dm-crypt 最常用的一种模式。在本文后续章节，俺会详细介绍。<br /><br />　　<strong>2. Plain</strong><br />　　Plain 模式是提供给技术老手用的。如果你是技术菜鸟，就不用关心这个模式了；如果你是技术老鸟，请自己去查 dm-crypt 相关手册。<br /><br />　　<strong>3. loop-AES</strong><br />　　loop-AES 是一款比较陈旧的 Linux 磁盘加密工具。dm-crypt 提供了对它的支持。<br />　　通常情况下，大伙儿【不需要】用到该模式。<br /><br />　　<strong>4. TCRYPT</strong><br />　　在 cryptsetup 的 1.6.0 版本之后，开始提供对 TrueCrypt 加密盘的支持。&ldquo;TCRYPT&rdquo;就是&ldquo;TrueCrypt&rdquo;的缩写。<br />　　在该模式下，可以打开 TrueCrypt 和 VeraCrypt 的加密盘，并对盘中的文件进行读写。<br />　　请注意：这个模式并【没有】实现 TrueCrypt 和 VeraCrypt 的所有功能。比如修改密码和 keyfiles 的功能就没有。具体欠缺哪些功能，参见下一章节的对照表。<br /><br /></p>
<h3>◇【无需】额外安装软件</h3>
<p><br />　　由于 dm-crypt 早已被整合到 Linux Kernel 中。因此，你无需额外安装它。<br />　　至于它的命令行前端（cryptsetup），大部分主流的发行版都会内置 cryptsetup 的软件包。<br /><br /></p>
<h3>◇可以跟 LVM 无缝整合</h3>
<p><br />　　LVM（Logical Volume Manager）是 Linux 内核提供的另一个很有用的工具。比如用它来创建分区，将来可以随时调整分区大小；比如现有的硬盘空间用完了，可以另外加一块硬盘并且新加硬盘可以用来扩展现有分区。<br />　　LVM 和 dm-crypt 都是基于 Linux 内核的&nbsp;<a href="https://en.wikipedia.org/wiki/Device_mapper" target="_blank">device mapper</a>&nbsp;机制。因此两者可以很好地整合。比如你既可以玩&ldquo;LVM over LUKS&rdquo;；也可以玩&ldquo;LUKS over LVM&rdquo;。<br />　　有空的话，俺再单独写一篇关于 LVM 的扫盲（又是一个坑）<br /><br /><a name="head-5"></a></p>
<h2>★&ldquo;dm-crypt&rdquo;与&ldquo;TrueCrypt/VeraCrypt&rdquo;的对比</h2>
<p><br />　　为了让大伙儿有个直观的认识，俺整理了如下的对照表。通过对比，你可以大致了解 dm-crypt 相对于&ldquo;TrueCrypt和VeraCrypt&rdquo;的优缺点。<br />　　再次提醒：dm-crypt 的 TCRYPT 模式，需要 cryptsetup 的版本号大于等于1.6.0才行。<br /><br /></p>
<table border="1" cellspacing="0" cellpadding="5">
<tbody>
<tr><th>功能点</th><th>dm-crypt 的 LUKS 模式</th><th>dm-crypt 的 TCRYPT 模式</th><th>TrueCrypt / VeraCrypt</th></tr>
<tr>
<td>支持的操作系统</td>
<td>Linux</td>
<td>Linux</td>
<td>Windows<br />Linux<br />Mac OS</td>
</tr>
<tr>
<td>支持的加密算法</td>
<td>AES<br />Twofish<br />Serpent</td>
<td>AES<br />Twofish<br />Serpent<br />AES-Twofish<br />Serpent-AES<br />Twofish-Serpent<br />AES-Twofish-Serpent<br />Serpent-Twofish-AES</td>
<td>AES<br />Twofish<br />Serpent<br />AES-Twofish<br />Serpent-AES<br />Twofish-Serpent<br />AES-Twofish-Serpent<br />Serpent-Twofish-AES</td>
</tr>
<tr>
<td>支持多重加密算法</td>
<td><strong>NO</strong></td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>物理分区加密</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>虚拟分区加密</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>无系统分区的全盘加密</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>含系统分区的全盘加密</td>
<td>YES</td>
<td><strong>NO</strong></td>
<td>仅限 Windows</td>
</tr>
<tr>
<td>加密系统分区</td>
<td>Yes</td>
<td><strong>NO</strong></td>
<td>仅限 Windows</td>
</tr>
<tr>
<td>基于&ldquo;密码&rdquo;的认证</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>基于&ldquo;Keyfiles&rdquo;的认证</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>修改认证因素</td>
<td>Yes</td>
<td><strong>NO</strong></td>
<td>Yes</td>
</tr>
<tr>
<td>加密系统分区并用 Keyfiles 认证</td>
<td>Yes</td>
<td><strong>NO</strong></td>
<td><strong>NO</strong></td>
</tr>
<tr>
<td>隐藏卷（Plausible Deniability）</td>
<td><strong>NO</strong></td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>操作外层卷并对隐藏卷写保护</td>
<td><strong>NO</strong></td>
<td><strong>NO</strong></td>
<td>Yes</td>
</tr>
<tr>
<td>自定义&ldquo;生成密钥的迭代次数&rdquo;</td>
<td>Yes</td>
<td><strong>NO</strong></td>
<td>仅 VeraCrypt</td>
</tr>
</tbody>
</table>
<p><br /><a name="head-6"></a></p>
<h2>★预备知识</h2>
<p><br />　　在使用 cryptsetup 命令行进行操作之前，建议你先掌握如下的技能：</p>
<blockquote>如何对硬盘分区（相关的命令行是 fdisk）<br />如何创建文件系统（相关的命令行是 mkfs.ext4 等）<br />如何挂载/卸载文件系统（相关的命令行是 mount umount）<br />如何显示已挂载的文件系统（相关的命令行是 df）</blockquote>
<p><br />　　上述这几个命令都比较简单，可以自己用 man 查一下帮助。会洋文的话，应该能看懂；就算你不懂洋文，Google 一下也可以查到这几个常用命令的语法。<br /><br /><a name="head-7"></a></p>
<h2>★cryptsetup 命令行概述</h2>
<p><br />　　说完预备知识，开始来介绍 cryptsetup 的基本用法。<br />　　提醒一下：需要使用管理员权限（比如 root）来运行 cryptsetup 相关命令。<br /><br /></p>
<h3>◇查看版本号</h3>
<p><br />　　使用如下命令行查看版本号。</p>
<blockquote>cryptsetup --version</blockquote>
<p>　　因为 dm-crypt/cryptsetup 的某些新功能，只有新版本才提供。比如 cryptsetup 的版本号必须大于等于 1.6.0 才能支持 TrueCrypt 的加密盘格式。<br />　　如果你要用到这些新功能，先看一下版本号，以确保已经支持。<br /><br /></p>
<h3>◇查看性能指标</h3>
<p><br />　　使用如下命令查看 dm-crypt/cryptsetup 针对不同&ldquo;加密算法&rdquo;和&ldquo;散列算法&rdquo;的性能指标。</p>
<blockquote>cryptsetup benchmark</blockquote>
<p>&nbsp;</p>
<h3>◇创建加密盘</h3>
<p><br />　　前面提到 dm-crypt/cryptsetup 支持的几种加密盘格式。作为扫盲教程，本文只介绍如何创建 LUKS 格式加密盘。<br />　　另外，dm-crypt/cryptsetup 只能用来打开 TrueCrypt 或 VeraCrypt 的加密盘，但是【无法】创建。<br /><br />　　创建（格式化） LUKS 加密盘的命令，大致写法如下：</p>
<blockquote>cryptsetup 相关参数 luksFormat 物理设备或逻辑设备</blockquote>
<p>　　运行该命令之后，首先警告你，格式化会导致原有数据被覆盖。如果你确实要格式化，需要输入【大写】的 YES 进行确认。<br />　　然后会提示你输入两次密码（passphrase）。<br />　　输入完密码，还要再稍等片刻（创建加密盘需要时间，具体的时长取决于加密盘的大小以及相关的加密参数）。<br /><br />　　上述写法中的【相关参数】是可以不写的。如果不写，则 cryptsetup 会采用相应的默认值。对于安全性要求较高的同学，【不要】使用默认值，要根据自己的需求指定相关的参数。<br />　　当你使用 luksFormat 进行格式化的时候，下面是几个常用参数以及俺推荐的参数值：</p>
<table border="1" cellspacing="0" cellpadding="5">
<tbody>
<tr><th>参数名称</th><th>含义</th><th>推荐值</th><th>备注</th></tr>
<tr>
<td>--cipher</td>
<td>加密方式</td>
<td>aes-xts-plain64</td>
<td>AES 加密算法搭配 XTS 模式<br />关于 XTS 模式，可以参见之前的博文：<br />《<a href="https://program-think.blogspot.com/2013/08/truecrypt-1.html" target="_blank">TrueCrypt 使用经验[1]：关于加密算法和加密盘的类型</a>》</td>
</tr>
<tr>
<td>--key-size</td>
<td>密钥长度</td>
<td>512</td>
<td>因为 XTS 模式需要两对密钥，每个的长度是256</td>
</tr>
<tr>
<td>--hash</td>
<td>散列算法</td>
<td>sha512</td>
<td>N/A</td>
</tr>
<tr>
<td>--iter-time</td>
<td>迭代时间</td>
<td>最好大于10000</td>
<td>单位是毫秒。该值越大，暴力破解越难；但是你在打开加密盘时也要等待更久</td>
</tr>
</tbody>
</table>
<p>　　下面给一个具体的例子&mdash;&mdash;用 LUKS 方式创建（格式化）加密盘，该加密盘位于 /dev/sda2 分区</p>
<blockquote>cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 10000 luksFormat /dev/sda2</blockquote>
<p>&nbsp;</p>
<h3>◇打开加密盘</h3>
<p><br />　　dm-crypt/cryptsetup 可以打开前面提及的各种格式的加密（只要是它支持的格式，就可以打开）。<br />　　命令行大致的写法如下：</p>
<blockquote>cryptsetup open --type 类型名 已加密的物理设备或逻辑设备 映射名</blockquote>
<p>　　上述命令行中的【open --type 类型名】，也可以改用某种简写形式。<br />　　比如下面这个命令：</p>
<blockquote>cryptsetup open --type luks 已加密的物理设备或逻辑设备 映射名</blockquote>
<p>　　其实等价于如下：</p>
<blockquote>cryptsetup luksOpen 物理设备或逻辑设备 映射名</blockquote>
<p>　　下面举个具体的例子：<br />　　假设物理分区 /dev/sda2 采用 LUKS 加密，那么你可以用如下命令打开（命令中的 xxx 是映射名，你可以换成其它单词）</p>
<blockquote>cryptsetup luksOpen /dev/sda2 xxx</blockquote>
<p>　　执行上述命令后，原有的加密分区 /dev/sda2 就被解密并映射到 /dev/mapper/xxx<br />　　打开加密盘之后，你就【不要】再去操作 /dev/sda2 了，而应该去操作 /dev/mapper/xxx<br /><br /></p>
<h3>◇查看加密盘状态</h3>
<p><br />　　当你已经打开某个加密盘之后，可以用如下命令查看该加密盘的状态。</p>
<blockquote>cryptsetup status 映射名</blockquote>
<p>&nbsp;</p>
<h3>◇关闭加密盘</h3>
<p><br />　　当你已经打开某个加密盘之后，可以用如下命令关闭该加密盘。</p>
<blockquote>cryptsetup close 映射名</blockquote>
<p><br />　　与 open 类似，cryptsetup 也对 close 提供了相应的别名（比如：luksClose、tcryptClose）<br />　　实际上 cryptsetup 是根据已经打开的加密盘的 header 来判断该加密盘的类型。所以上述别名的意义不大。比如说，你对某个 TrueCrypt 的加密盘使用 luksClose，依然可以正确关闭，不会出错。<br /><br /><a name="head-8"></a></p>
<h2>★用 cryptsetup 创建 LUKS 的物理加密盘（加密物理分区）</h2>
<p>&nbsp;</p>
<h3>◇准备一个物理分区</h3>
<p><br />　　首先，你要准备一个物理分区，用来加密。<br />　　【<strong>你必须确保该分区上的数据是没用的</strong>】。因为待会儿要对该分区进行格式化操作，该分区上原有的数据会被破坏掉。<br />　　在下面的介绍中，俺以 /dev/sda2 来进行举例。你实际使用的分区，可能会有所差异（具体取决于你的分区情况）。<br /><br /></p>
<h3>◇用 LUKS 方式加密（格式化）物理分区</h3>
<p><br />　　使用前面章节提及的参数，对上述物理分区进行加密。得到一个加密分区。</p>
<blockquote>cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 10000 luksFormat /dev/sda2</blockquote>
<p>&nbsp;</p>
<h3>◇打开加密之后的文件容器</h3>
<p><br />　　使用如下命令打开上述的加密分区，使用的映射名是 xxx（你也可以改用其它单词）。</p>
<blockquote>cryptsetup luksOpen /dev/sda2 xxx</blockquote>
<p>　　打开之后，该虚拟盘会被映射到 /dev/mapper/xxx<br />　　你可以用如下命令看到：</p>
<blockquote>ls /dev/mapper/</blockquote>
<p>&nbsp;</p>
<h3>◇创建文件系统</h3>
<p><br />　　由于加密分区已经打开并映射到 /dev/mapper/xxx 你可以在 /dev/mapper/xxx 之上创建文件系统。命令如下（文件系统类型以 ext4 为例）</p>
<blockquote>mkfs.ext4 /dev/mapper/xxx</blockquote>
<p>&nbsp;</p>
<h3>◇挂载文件系统</h3>
<p><br />　　创建完文件系统之后，你还需要挂载该文件系统，才能使用它。挂载的步骤如下。<br />　　首先，你要先创建一个目录，作为【挂载点】。俺把&ldquo;挂载点&rdquo;的目录设定为 /mnt/xxx（当然，你可以用其它目录作为挂载点）。</p>
<blockquote>mkdir /mnt/xxx</blockquote>
<p>　　创建好&ldquo;挂载点&rdquo;对应的目录，下面就可以进行文件系统的挂载。</p>
<blockquote>mount /dev/mapper/xxx /mnt/xxx</blockquote>
<p>　　挂载好文件系统，用如下命令查看，就可以看到你刚才挂载的文件系统。</p>
<blockquote>df -hT</blockquote>
<p>　　接下来，你就可以通过 /mnt/xxx 目录去访问该文件系统。当你往 /mnt/xxx 下面创建下级目录或下级文件，这些东东将被存储到加密分区上。<br /><br /></p>
<h3>◇退出</h3>
<p><br />　　当你使用完，要记得退出。包括下面两步：<br />　　卸载文件系统</p>
<blockquote>umount /mnt/xxx</blockquote>
<p>　　关闭加密盘</p>
<blockquote>cryptsetup close xxx</blockquote>
<p><br /><a name="head-9"></a></p>
<h2>★用 cryptsetup 创建 LUKS 的虚拟加密盘（逻辑卷）</h2>
<p><br />　　在前一个章节，已经介绍了&ldquo;对物理分区的加密&rdquo;。其实 cryptsetup 也可以支持虚拟加密盘（逻辑加密盘）&mdash;&mdash;类似于 TrueCrypt 那样。<br /><br /></p>
<h3>◇何为&ldquo;虚拟加密盘&rdquo;？</h3>
<p><br />　　考虑到某些读者没有看过《<a href="https://program-think.blogspot.com/2013/08/truecrypt-1.html" target="_blank">TrueCrypt 使用经验[1]：关于加密算法和加密盘的类型</a>》，俺再次唠叨一下：所谓的&ldquo;虚拟加密盘&rdquo;，就是说这个盘并【不是】对应物理分区，而是对应一个虚拟分区（逻辑卷）。这个虚拟分区，说白了就是一个大文件。虚拟分区有多大，这个文件就有多大。<br />　　&ldquo;虚拟加密盘&rdquo;的一个主要好处在于&mdash;&mdash;可以拷贝复制。比如你可以在不同的机器之间复制这个虚假分区对应的大文件。甚至可以把这个大文件上传到云端（网盘）进行备份&mdash;&mdash;这么干的好处参见《<a href="https://program-think.blogspot.com/2013/07/online-backup-virtual-encrypted-disk.html" target="_blank">文件备份技巧：组合&ldquo;虚拟加密盘&rdquo;和&ldquo;网盘&rdquo;</a>》。<br /><br /></p>
<h3>◇创建一个文件作为容器</h3>
<p><br />　　下面用 dd 命令创建1GB（1024MB）的大文件，该文件位于 /root/luks.vol 路径。当然，你也可以指定其它的文件大小或其它的文件路径。</p>
<blockquote>dd if=/dev/zero of=/root/luks.vol bs=1M count=1024</blockquote>
<p>　　（dd 命令是一个牛逼命令，之前在《<a href="https://program-think.blogspot.com/2013/12/create-bootable-usb-stick-from-iso.html" target="_blank">如何用 ISO 镜像制作 U 盘安装盘（通用方法、无需 WinPE）</a>》介绍过该命令）<br /><br />　　经某个热心读者提醒，还可以使用 fallocate 命令创建容器文件。对于特别大的容器文件，性能【高于】dd 命令。<br />　　以下示例通过 fallocate 瞬间创建一个 64GB 的大文件。</p>
<blockquote>fallocate -l 64G /root/luks.vol</blockquote>
<p>&nbsp;</p>
<h3>◇用 LUKS 方式加密（格式化）该文件容器</h3>
<p><br />　　使用前面章节提及的参数，对上述文件容器进行加密。得到一个虚拟的加密盘。</p>
<blockquote>cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 10000 luksFormat /root/luks.vol</blockquote>
<p>&nbsp;</p>
<h3>◇打开加密之后的文件容器</h3>
<p><br />　　使用如下命令打开上述的文件容器，使用的映射名是 xxx（你也可以改用其它单词）。</p>
<blockquote>cryptsetup luksOpen /root/luks.vol xxx</blockquote>
<p>　　打开之后，该虚拟盘会被映射到 /dev/mapper/xxx<br />　　你可以用如下命令看到：</p>
<blockquote>ls /dev/mapper/</blockquote>
<p>&nbsp;</p>
<h3>◇创建文件系统</h3>
<p><br />　　由于加密盘已经打开并映射到 /dev/mapper/xxx 你可以在 /dev/mapper/xxx 之上创建文件系统。命令如下（文件系统类型以 ext4 为例）</p>
<blockquote>mkfs.ext4 /dev/mapper/xxx</blockquote>
<p>&nbsp;</p>
<h3>◇挂载文件系统</h3>
<p><br />　　创建完文件系统之后，你还需要挂载该文件系统，才能使用它。挂载的步骤如下。<br />　　首先，你要先创建一个目录，作为【挂载点】。俺把&ldquo;挂载点&rdquo;的目录设定为 /mnt/xxx（当然，你可以用其它目录作为挂载点）。</p>
<blockquote>mkdir /mnt/xxx</blockquote>
<p>　　创建好&ldquo;挂载点&rdquo;对应的目录，下面就可以进行文件系统的挂载。</p>
<blockquote>mount /dev/mapper/xxx /mnt/xxx</blockquote>
<p>　　挂载好文件系统，用如下命令查看，就可以看到你刚才挂载的文件系统。</p>
<blockquote>df -hT</blockquote>
<p>　　接下来，你就可以通过 /mnt/xxx 目录去访问该文件系统。当你往 /mnt/xxx 下面创建下级目录或下级文件，这些东东将被存储到该虚拟加密盘上。<br /><br /></p>
<h3>◇退出</h3>
<p><br />　　当你使用完，要记得退出。包括下面两步：<br />　　卸载文件系统</p>
<blockquote>umount /mnt/xxx</blockquote>
<p>　　关闭加密盘</p>
<blockquote>cryptsetup close xxx</blockquote>
<p><br /><a name="head-10"></a></p>
<h2>★LUKS 加密盘使用 keyfile 作为认证因素</h2>
<p>&nbsp;</p>
<h3>◇啥是&ldquo;keyfile 认证因素&rdquo;？</h3>
<p><br />　　其实这个概念，在当年扫盲 TrueCrypt 的教程中（《<a href="https://program-think.blogspot.com/2011/05/recommend-truecrypt.html" target="_blank">TrueCrypt&mdash;&mdash;文件加密的法宝</a>》）已经有提及。今天俺再重复罗嗦一下。<br />　　传统的&ldquo;密码认证&rdquo;用的是一串密不示人的字符串作为认证因素。密码的缺点：<br />1. 当你密码设置得比较短，容易被暴力破解。<br />2. 不好记。尤其当你为了防范暴力破解，把密码设置得很复杂，于是就更不好记了。<br />　　而&ldquo;keyfile 认证&rdquo;就是用一个文件来替代密码，可以解决密码的上述两个缺点。<br /><br /></p>
<h3>◇什么文件作&ldquo;keyfile&rdquo;比较合适？</h3>
<p><br />　　用信息学的术语来讲就是：文件内容的&ldquo;熵值&rdquo;越大，越适合作 keyfile。换用通俗的人话来讲就是：文件内容越紊乱越随机，就越适合。<br />　　通常而言，二进制可执行文件（比如 exe）、图片文件（比如 JPG、PNG、GIF）、视频文件，都可以用来作 keyfile。<br />　　对于 Linux 的用户，可以用如下命令生产一个【内容完全随机】的文件，作为 keyfile 使用。</p>
<blockquote>dd if=/dev/urandom of=放置keyfile的文件路径 bs=1k count=64</blockquote>
<p>　　（上述命令生产的文件大小是 64KB，你可以自行设定其它尺寸，但是【不要】小于1KB）<br />　　另外，【不建议】用纯文本文件作 keyfile&mdash;&mdash;因为纯文本文件的&ldquo;熵值&rdquo;通常都不够大。<br /><br /></p>
<h3>◇预备知识&mdash;&mdash;关于&ldquo;Key Slot&rdquo;</h3>
<p><br />　　在继续介绍 keyfile 之前，稍微聊点预备知识。<br />　　LUKS 格式的加密盘，默认会提供8个&ldquo;Key Slot&rdquo;（编号从0到7）。每个&ldquo;Key Slot&rdquo;好比是一个独立的钥匙&mdash;&mdash;都可以用来打开这个 LUKS 加密盘。<br />　　你可以用如下命令，查看某个 LUKS 加密盘的&ldquo;Key Slot&rdquo;。</p>
<blockquote>cryptsetup luksDump 已加密的物理设备或逻辑设备</blockquote>
<p>　　如果你刚才已经尝试过创建一个 LUKS 加密盘，用了这个命令之后，你会发现8个&ldquo;Key Slot&rdquo;中，头一个（编号为0的那个）已经被用掉了（显示为&ldquo;ENABLED&rdquo;），其它7个还没用（显示为&ldquo;DISABLED&rdquo;）。因为你刚才创建加密盘的时候，已经设置过一次密码，所以用掉了一个&ldquo;Key Slot&rdquo;。<br /><br /></p>
<h3>◇如何给 LUKS 加密盘增加 keyfile 认证？</h3>
<p><br />　　明白了&ldquo;Key Slot&rdquo;之后，咱们可以开始给 LUKS 加密盘增加新的&ldquo;Key Slot&rdquo;。<br />　　采用如下命令，可以指定某个文件作为 keyfile，并指派为某个 LUKS 加密盘的认证因素。</p>
<blockquote>cryptsetup luksAddKey 已加密的物理分区或虚拟盘 所用keyfile的路径</blockquote>
<p>　　再次使用前一小节提及的 luksDump 查看一下，你会发现：又有一个&ldquo;Key Slot&rdquo;被用掉了。<br /><br /></p>
<h3>◇如何用 keyfile 打开 LUKS 加密盘？</h3>
<p><br />　　如果你执行完前一个小节的步骤（设定了 keyfile），接下来就可以用如下命令打开该 LUKS 加密盘。</p>
<blockquote>cryptsetup --key-file 所用keyfile的路径 luksOpen 已加密的物理分区或虚拟盘 映射名</blockquote>
<p>　　（此时，你既可以用密码打开，也可以用 keyfile 打开）<br /><br /></p>
<h3>◇如何删除&ldquo;Key Slot&rdquo;？</h3>
<p><br />　　采用如下命令，可以删除某个 LUKS 加密盘的&ldquo;Key Slot&rdquo;。</p>
<blockquote>cryptsetup luksKillSlot 已加密的物理分区或虚拟盘 Slot的编号</blockquote>
<p>　　（再次提醒：编号是从0到7，头一个 Slot 的编号是0）<br />　　再次使用前一小节提及的 luksDump 查看一下，你会发现：某个&ldquo;Key Slot&rdquo;被删除了。<br /><br /><a name="head-11"></a></p>
<h2>★用 cryptsetup 操作 TrueCrypt/VeraCrypt 的加密盘</h2>
<p><br />　　（再次罗嗦：cryptsetup 的版本号需要【大于等于 1.6.0】才能兼容 TrueCrypt/VeraCrypt 加密盘）<br /><br /></p>
<h3>◇基本命令</h3>
<p><br />　　在前面的&ldquo;功能概述&rdquo;中提及：dm-crypt/cryptsetup 可以用来打开 TrueCrypt/VeraCrypt 加密盘。<br />　　命令行的大致写法如下：</p>
<blockquote>cryptsetup open --type tcrypt 已加密的物理分区或虚拟盘 映射名</blockquote>
<p>　　也可以使用简写的方式如下：</p>
<blockquote>cryptsetup tcryptOpen 已加密的物理分区或虚拟盘 映射名</blockquote>
<p>&nbsp;</p>
<h3>◇相关参数</h3>
<p><br />　　在 TCRYPT 模式下，有一些相关的参数，简要说明如下：</p>
<table border="1" cellspacing="0" cellpadding="5">
<tbody>
<tr><th>参数名称</th><th>说明</th><th>参数值</th></tr>
<tr>
<td>--tcrypt-hidden</td>
<td>打开隐藏卷，需要追加该参数</td>
<td>无</td>
</tr>
<tr>
<td>--tcrypt-system</td>
<td>打开加密的系统分区，需要追加该参数</td>
<td>无</td>
</tr>
<tr>
<td>--readonly</td>
<td>以&ldquo;只读&rdquo;方式打开加密分区，需要追加该参数</td>
<td>无</td>
</tr>
<tr>
<td>--key-file</td>
<td>如果该加密盘用到了&ldquo;keyfiles&rdquo;认证，需要追加该参数</td>
<td>keyfile 的路径</td>
</tr>
<tr>
<td>--veracrypt</td>
<td>打开 VeraCrypt 格式的加密盘，需要追加该参数</td>
<td>无</td>
</tr>
</tbody>
</table>
<p><br />　　关于 VeraCrypt 的补充说明：<br />　　cryptsetup 的版本号要大于等于 1.6.7 才可以打开 VeraCrypt 的加密盘。由于这个功能是近期才加入 dm-crypt/cryptsetup，好像还不支持 VeraCrypt 的 PIM 功能&mdash;&mdash;（俺简单测试了一下）如果 VeraCrypt 加密盘设置了 PIM，用 cryptsetup 对其进行 open 操作，没有提示俺输入 PIM，然后显示打开失败。<br />　　估计要等 cryptsetup 更新的版本，或许就会支持 VeraCrypt 加密盘的 PIM 功能。<br />　　（关于 PIM 功能，参见《<a href="https://program-think.blogspot.com/2015/10/VeraCrypt.html" target="_blank">扫盲 VeraCrypt&mdash;&mdash;跨平台的 TrueCrypt 替代品</a>》）<br /><br /><a name="head-12"></a></p>
<h2>★用 cryptsetup 加密系统分区（root filesystem）或全盘加密</h2>
<p>&nbsp;</p>
<h3>◇配置方法</h3>
<p><br />　　在本文开头，俺已经说了&mdash;&mdash;这篇教程面向技术菜鸟。而&ldquo;加密系统分区&rdquo;对技术菜鸟来讲，有一定难度。万一没搞好，可能会把系统搞坏掉（导致 Linux 系统无法启动）。<br />　　咋办捏？俺帮大伙儿想了一招比较简单的玩法&mdash;&mdash;在安装系统的时候，加密系统分区（甚至全盘加密）。<br />　　能否使用这招，要看具体的 Linux 发行版，在安装过程中是否提供相应的功能。如果俺没记错的话，如下几个主流的发行版，是可以在安装过程中加密系统分区或全盘加密的。（如果你觉得俺列举的发行版，有遗漏，欢迎到博客留言进行补充）</p>
<blockquote>Debian<br />Fedora<br />Ubuntu<br />Linux Mint<br />CentOS<br />RedHat Enterprise Linux</blockquote>
<p>　　由于不同的发行版，安装界面各不相同，所以俺就偷懒一下，不提供截图了。<br />　　大体上，这些发行版的安装过程，都有一个步骤是&ldquo;硬盘分区&rdquo;。在这个步骤，会提供相关的&ldquo;加密选项&rdquo;。<br />　　对于想要进行全盘加密的同学，装系统过程中进行分区的时候，要把 /boot 单独分一个区。并且这个分区是【不能】加密的&mdash;&mdash;因为 /boot 要用来放置引导管理器与内核。<br /><br /></p>
<h3>◇&ldquo;全盘加密&rdquo;的弱点</h3>
<p><br />　　从理论上讲：任何一种磁盘加密工具，（在不借助外部机制的情况下）都【不可能】实现真正的&ldquo;自启动全盘加密&rdquo;。<br />　　为啥捏？因为要想【自启动】，必须要有一个引导程序，至少这个引导程序不能加密（引导程序如果被加密了，就无法引导了）。所以，凡是能够实现&ldquo;自启动全盘加密&rdquo;的，其【引导程序】都是明文的（无加密的）<br />　　比如 TrueCrypt 和 VeraCrypt 进行全盘加密，都会替换原有的主引导扇区的内容，在里面放入一段代码。这段代码会在开机启动的时候，提示你输入密码，然后用你输入的密码进行解密。<br />　　对于 dm-crypt 的全盘加密，除了&ldquo;主引导扇区&rdquo;【没有】加密，还包括 /boot 分区也【没有】加密（因为启动管理器放置在 /boot 分区）。<br />　　如前所述，<strong>这些【没有加密】的部分，会成为攻击者瞄准的弱点</strong>。<br /><br />　　攻击举例：<br />　　如果某个攻击者可以物理接触你的电脑，此人完全可以把你硬盘上的引导程序替换为一个假的引导程序。当你开机启动的时候，这个【假的】引导程序照样会提示你输入解密的密码。如此一来，你的密码就泄漏了。<br /><br /></p>
<h3>◇如何防范&ldquo;全盘加密的弱点&rdquo;</h3>
<p><br />　　常规的防范措施有如下几种：<br />　　<strong>采用 BIOS 提供的&ldquo;硬盘口令&rdquo;功能</strong><br />　　一般而言，台式机没有这个功能；大部分商用笔记本有这个功能。<br />　　这个功能的安全性如何，要看具体的笔记本品牌（不同厂商的实现，可能不一样，因此安全性也不一样）。如果这个功能比较靠谱，就可以防止攻击者在你不知情的情况下，替换你硬盘上的引导程序。<br /><br />　　<strong>采用外部存储介质进行引导</strong><br />　　简而言之，就是把引导程序放到【可引导的】外部介质（比如 U盘、SD卡、MMC卡）。先用外部介质进行引导，然后通过外部介质中的引导程序，提示你输入密码，然后解密硬盘，最后再启动硬盘上的操作系统。<br />　　对于&ldquo;U盘/SD卡/MMC卡&rdquo;而言，因为可以随身携带或隐藏在某处，被攻击者物理接触的风险会降低。<br />　　对于 TrueCrypt/VeraCrypt【没法】用这招。而对于 dm-crypt，可以用这招。这种玩法略显复杂，不适合菜鸟。考虑到本文是&ldquo;扫盲性质&rdquo;的教程，暂且不提。<br /><br />　　<strong>把系统安装到外部存储介质</strong><br />　　这种玩法就是把【整个操作系统】都安装到外部存储介质（比如 U盘、SD卡、MMC卡）。开机时，需要先插入外部存储介质，启动整个操作系统。然后在这个操作系统中内置的 dm-crypt 挂载加密的硬盘。<br />　　对于&ldquo;U盘/SD卡/MMC卡&rdquo;而言，因为可以随身携带或隐藏在某处，被攻击者物理接触的风险会降低。<br />　　很多主流的 Linux 发行版，默认提供了 Live CD 的功能（也就是用光盘直接启动出一个【可用】的 Linux 环境）<br />　　对这类发行版，你可以用工具把 Live CD 的 ISO 镜像文件&ldquo;烧制&rdquo;到 U盘/SD卡/MMC卡。然后就可以用来启动电脑。具体的教程参见《<a href="https://program-think.blogspot.com/2013/12/create-bootable-usb-stick-from-iso.html" target="_blank">如何用 ISO 镜像制作 U 盘安装盘（通用方法、无需 WinPE）</a>》。<br /><br /><a name="head-13"></a></p>
<h2>★混用 dm-crypt 和 TrueCrypt/VeraCrypt</h2>
<p><br />　　在本文结束前，俺最后聊一下如何混用 dm-crypt 和 TrueCrypt/VeraCrypt。<br /><br /></p>
<h3>◇为啥要混用？</h3>
<p><br />　　在本文开头部分给出了一个&ldquo;功能对比&rdquo;的清单，从中可以看出 dm-crypt 和 TrueCrypt/VeraCrypt&nbsp;<strong>各有独到之处</strong>。<br />　　比如 dm-crypt 可以用来加密 Linux 的系统分区（root filesystem），而 TrueCrypt 和 VeraCrypt 都做不到；<br />　　反之，TrueCrypt 和 VeraCrypt 提供了&ldquo;隐藏卷&rdquo;的功能。可以用该功能来实现&ldquo;Plausible Deniability&rdquo;（介绍参见&ldquo;<a href="https://program-think.blogspot.com/2013/10/truecrypt-4.html" target="_blank">这里</a>&rdquo;），而 dm-crypt 做不到这点。<br />　　因此，有必要组合这两者。<br /><br /></p>
<h3>◇&ldquo;dm-crypt + TrueCrypt&rdquo; VS &ldquo;dm-crypt + VeraCrypt&rdquo;</h3>
<p><br />　　截止俺写本文的时候，TrueCrypt 的 Linux 版本【尚未发现】高危漏洞，所以你如果要继续使用 Linux 下的 TrueCrypt，也是可以的。<br />　　但是考虑到 TrueCrypt 已经停止维护，长远来讲，还是建议用&ldquo;dm-crypt + VeraCrypt&rdquo;这个组合进行混用。<br />　　另外，VeraCrypt 增加了 PIM 功能来对抗暴力破解。对那些安全要求非常高的同学，这个&ldquo;PIM 功能&rdquo;也是有吸引力的。（关于 PIM 功能，参见《<a href="https://program-think.blogspot.com/2015/10/VeraCrypt.html" target="_blank">扫盲 VeraCrypt&mdash;&mdash;跨平台的 TrueCrypt 替代品</a>》）<br /><br /></p>
<h3>◇混用的思路</h3>
<p><br />　　首先用 dm-crypt/cryptsetup 对系统分区（root filesystem）进行加密 或者 实现全盘加密。（具体玩法参见前面的章节）<br />　　然后在已经加密的分区中，创建 TrueCrypt/VeraCrypt 的虚拟加密盘，并使用隐藏卷的功能。（如何使用隐藏卷，参见《<a href="https://program-think.blogspot.com/2013/10/truecrypt-4.html" target="_blank">TrueCrypt 使用经验[4]：关于隐藏卷的使用和注意事项</a>》）<br />　　把你最敏感最重要的数据，存储在隐藏卷中。<br />　　假设将来有一天，你受到胁迫，你可以交出 dm-crypt 的加密密码。然后利用隐藏卷这个功能，来施展&ldquo;Plausible Deniability&rdquo;的技巧，迷惑胁迫你的人。关于该技巧的使用场景，参见<a href="https://program-think.blogspot.com/2011/05/recommend-truecrypt.html" target="_blank">这篇博文中的</a>&ldquo;◇Plausible Deniability&rdquo;章节。<br /><br /><a name="head-14"></a></p>
<h2>★如果你对 TrueCrypt/VeraCrypt 不放心，该咋办？</h2>
<p><br />　　本来这个话题应该是放到<a href="https://program-think.blogspot.com/2015/10/VeraCrypt.html" target="_blank">之前那篇博文</a>来聊的。但是在写前面那篇博文的时候，俺还没有扫盲&ldquo;dm-crypt/cryptsetup&rdquo;。所以只好把这个话题留到今天这篇博文。<br /><br /></p>
<h3>◇某些用户的担心</h3>
<p><br />　　从俺博客的读者留言中，可以看出某些人对这两款工具都不太放心。<br />　　TrueCrypt<br />　　虽然历史悠久，口碑极好。但是官网已经宣布&ldquo;停止维护&rdquo;。而且上个月底（9月底）刚曝光了 Windows 版本的高危漏洞。<br />　　VeraCrypt<br />　　因为这个开源项目的历史比较短，有些同学担心这个项目会不会是一个蜜罐项目。<br /><br /></p>
<h3>◇俺的分析</h3>
<p><br />　　先不管这两个软件在【代码层面】是否有后门，咱们先来说【加密盘的格式】。<br />　　&ldquo;加密盘格式&rdquo;与&ldquo;程序代码&rdquo;不同。&ldquo;加密盘格式&rdquo;是很少变化的（基本是静态的），而&ldquo;程序代码&rdquo;会随着软件版本的升级，而不断发生变化&mdash;&mdash;有可能这个版本没有后门，但是下一个版本就被植入后门。<br />　　&ldquo;TrueCrypt 的加密盘格式&rdquo;已经被很多安全专家研究过。包括这两年安全界发起了对 TrueCrypt 的安全审计，其中一项工作就是：评估加密盘的格式。<br />　　到目前为止，至少【没有】发现该格式有明显的后门或弱点。<br />　　综上所述，俺认为&nbsp;<strong>TrueCrypt 的加密盘格式是可靠的（可信的）</strong>。<br /><br />　　而 VeraCrypt 的加密盘格式，跟 TrueCrypt 的格式<strong>几乎完全一样</strong>&mdash;&mdash;俺专门看过这两者的技术规范文档，加密盘头部（header）的结构完全一样，仅有的差异在于某个标志位（从 TrueCrypt 的标志改为 VeraCrypt 的标志）。<br />　　因此，<strong>VeraCrypt 的加密盘格式，也是可靠的（可信的）</strong>。<br /><br /></p>
<h3>◇防范措施</h3>
<p><br />　　基于上述分析，有一个策略可以帮你规避 TrueCrypt/VeraCrypt【软件本身】潜在的后门。具体步骤如下：<br /><br />　　1.<br />　　你在某个<strong>操作系统虚拟机</strong>中，安装好 TrueCrypt 或 VeraCrypt。<br />　　2.<br />　　使用虚拟机中的 TrueCrypt 或 VeraCrypt 帮你创建【虚拟】加密盘。<br />　　3.<br />　　把创建好的【虚拟】加密盘 copy 到你的 Linux 环境中，用 dm-crypt 打开加密盘进行使用。<br />　　4.<br />　　如果需要修改加密盘的密码或 keyfile，再把【虚拟】加密盘 copy 回操作系统虚拟机中，用 TrueCrypt 或 VeraCrypt 修改密码或 keyfile。<br /><br />　　基于上述步骤，你的 Linux 系统中完全不会运行 TrueCrypt 或 VeraCrypt，但是又可以享受这两款软件的强大功能（比如&ldquo;隐藏卷&rdquo;、比如&ldquo;多重加密算法&rdquo;）。<br />　　代价就是：操作步骤稍嫌繁琐（需要 copy 虚拟加密盘）。这也是没办法滴&mdash;&mdash;&ldquo;安全性&rdquo;和&ldquo;易用性&rdquo;通常都是矛盾的。<br /><br /><br /><strong>俺博客上，和本文相关的帖子（需翻墙）</strong>：<br /><a href="https://program-think.blogspot.com/2015/10/VeraCrypt.html" target="_blank">扫盲 VeraCrypt&mdash;&mdash;跨平台的 TrueCrypt 替代品</a><br /><a href="https://program-think.blogspot.com/2011/05/recommend-truecrypt.html" target="_blank">TrueCrypt&mdash;&mdash;文件加密的法宝</a><br /><a href="https://program-think.blogspot.com/2013/08/truecrypt-1.html" target="_blank">TrueCrypt 使用经验[1]：关于加密算法和加密盘的类型</a><br /><a href="https://program-think.blogspot.com/2013/08/truecrypt-2.html" target="_blank">TrueCrypt 使用经验[2]：关于加密盘的密码认证和 KeyFiles 认证</a><br /><a href="https://program-think.blogspot.com/2013/08/truecrypt-3.html" target="_blank">TrueCrypt 使用经验[3]：关于加密盘的破解和防范措施</a><br /><a href="https://program-think.blogspot.com/2013/10/truecrypt-4.html" target="_blank">TrueCrypt 使用经验[4]：关于隐藏卷的使用和注意事项</a><br /><a href="https://program-think.blogspot.com/2014/06/truecrypt-dead.html" target="_blank">分析一下 TrueCrypt 之死（自杀 or 他杀？），介绍一下应对措施</a><br /><a href="https://program-think.blogspot.com/2011/05/file-encryption-overview.html" target="_blank">文件加密的扫盲介绍</a><br /><a href="https://program-think.blogspot.com/2013/07/online-backup-virtual-encrypted-disk.html" target="_blank">文件备份技巧：组合&ldquo;虚拟加密盘&rdquo;和&ldquo;网盘&rdquo;</a><br /><a href="https://program-think.blogspot.com/2013/12/create-bootable-usb-stick-from-iso.html" target="_blank">如何用 ISO 镜像制作 U 盘安装盘（通用方法、无需 WinPE）</a></p>
<p><strong><strong>版权声明</strong><br />本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者<a href="mailto:program.think@gmail.com">编程随想</a>和本文原始地址：</strong></p>
<p><strong>原文来自:&nbsp;<a href="https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html" target="_blank">https://program-think.blogspot.com/2015/10/dm-crypt-cryptsetup.html</a></strong></p></td></tr></table>

<div id="messageinfo" class="messageinfo">
</div>

</div>
<div id="comment_53775" class="cm">
</div>

<div id="post_rate_div_53775"></div>
</div>
</div>

</td></tr>
<tr><td class="plc plm">
<div id="p_btn" class="mtw mbm hm cl">

</div>

<div class="y pob">
<em>
<a class="fastre" href="forum.php?mod=post&amp;action=reply&amp;fid=119&amp;tid=14738&amp;reppost=53775&amp;extra=&amp;page=1" onclick="showWindow('reply', this.href)">回复</a>
<a href="javascript:;" onclick="showWindow('miscreport53775', 'misc.php?mod=report&rtype=post&rid=53775&tid=14738&fid=119', 'get', -1);return false;" style="padding:5px">举报</a>
</em>
</div>

</td>
</tr>
<tr id="_postposition53775"></tr>
<tr>
<td class="pls"></td>
<td class="plc" style="overflow:visible;">
<div class="po hin">
<div class="pob cl">
<em>
<b>分享到:&nbsp;</b>


<a href="javascript:void(0);" onclick="postToWb();" class="k_share_tqq" id="k_share_tqq" title="腾讯微博"><i>腾讯微博</i></a>

<script type="text/javascript">
function postToWb(){
var _t = encodeURI(document.title);
var _url = encodeURIComponent(document.location);
var _appkey = encodeURI("cec3d21e5c924153b3927352082de92d");
var _pic = "";
var _site = encodeURIComponent("Linux 中国◆开源社区");
var _from = 'discuz';
var _u = 'http://v.t.qq.com/share/share.php?url='+_url+'&appkey='+_appkey+'&site='+_site+'&pic='+_pic+'&title='+_t+'&from='+_from;
window.open( _u,'', 'width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no' );
}
function postToPengyou(){
var _url = encodeURIComponent(document.location.href);
var _site = encodeURIComponent("Linux 中国◆开源社区");
var _title = encodeURIComponent("投稿：扫盲 dm-crypt——多功能 Linux 磁盘加密工具");
var _pics = "";
var _from = 'discuz';
var _u = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?to=pengyou&url='+_url+'&site='+_site+'&title='+_title+'&pics='+_pics+'&from='+_from;
window.open(_u);
}
</script>
	

</em>

<p>
</p>

</div>
</div>
</td>
</tr>
<tr class="ad">
<td class="pls">
</td>
<td class="plc">
</td>
</tr>
</table>
</div><div id="postlistreply" class="pl"><div id="post_new" class="viewthread_table" style="display: none"></div></div>
</div>


<form method="post" autocomplete="off" name="modactions" id="modactions">
<input type="hidden" name="formhash" value="01efc05f" />
<input type="hidden" name="optgroup" />
<input type="hidden" name="operation" />
<input type="hidden" name="listextra" value="" />
<input type="hidden" name="page" value="1" />
</form>



<div class="pgs mtm mbm cl">
<span class="pgb y"><a href="forum/post/1/">返回列表</a></span>
<a id="newspecialtmp" onmouseover="$('newspecial').id = 'newspecialtmp';this.id = 'newspecial';showMenu({'ctrlid':this.id})" onclick="showWindow('newthread', 'forum.php?mod=post&action=newthread&fid=119')" href="javascript:;" title="发新帖"><img src="https://img.linux.net.cn/static/image/common/pn_post.png" alt="发新帖" /></a>
</div>

<!--[diy=diyfastposttop]--><div id="diyfastposttop" class="area"></div><!--[/diy]-->
<script type="text/javascript">
var postminchars = parseInt('10');
var postmaxchars = parseInt('64000');
var disablepostctrl = parseInt('0');
</script>

<div id="f_pst" class="pl bm bmw">
<form method="post" autocomplete="off" id="fastpostform" action="forum.php?mod=post&amp;action=reply&amp;fid=119&amp;tid=14738&amp;extra=&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost" onSubmit="return fastpostvalidate(this)">
<table cellspacing="0" cellpadding="0">
<tr>
<td class="pls">
</td>
<td class="plc">

<span id="fastpostreturn"></span>


<div class="cl">
<div id="fastsmiliesdiv" class="y"><div id="fastsmiliesdiv_data"><div id="fastsmilies"></div></div></div><div class="hasfsl" id="fastposteditor">
<div class="tedt mtn">
<div class="bar">
<span class="y">
<a href="forum.php?mod=post&amp;action=reply&amp;fid=119&amp;tid=14738" onclick="return switchAdvanceMode(this.href)">高级模式</a>
</span><script src="https://img.linux.net.cn/static/js/seditor.js?C0M" type="text/javascript"></script>
<div class="fpd">
<a href="javascript:;" title="文字加粗" class="fbld">B</a>
<a href="javascript:;" title="设置文字颜色" class="fclr" id="fastpostforecolor">Color</a>
<a id="fastpostimg" href="javascript:;" title="图片" class="fmg">Image</a>
<a id="fastposturl" href="javascript:;" title="添加链接" class="flnk">Link</a>
<a id="fastpostquote" href="javascript:;" title="引用" class="fqt">Quote</a>
<a id="fastpostcode" href="javascript:;" title="代码" class="fcd">Code</a>
<a href="javascript:;" class="fsml" id="fastpostsml">Smilies</a>
</div></div>
<div class="area">
<div class="pt hm">
您需要登录后才可以回帖 <a href="member.php?mod=logging&amp;action=login" onclick="showWindow('login', this.href)" class="xi2">登录</a>


<a href="https://linux.cn/connect.php?mod=login&op=init&referer=forum.php%3Fmod%3Dviewthread%26tid%3D14738%26extra%3Dpage%5C%253D1%26page%3D1&statfrom=login" target="_top" rel="nofollow"><img src="https://img.linux.net.cn/static/image/common/qq_login.gif" class="vm" /></a>

<a href="xwb.php?m=xwbAuth.login" rel="nofollow" alt="&#19968;&#27493;&#25630;&#23450;"><img src="https://img.linux.net.cn/xwb/images/bgimg/sina_login_btn.png" onerror="this.onerror=null;this.src='static/image/common/none.gif'" class="vm" /></a></div>
</div>
</div>
</div>
</div>
<div id="seccheck_fastpost">
</div>


<input type="hidden" name="formhash" value="01efc05f" />
<input type="hidden" name="usesig" value="" />
<input type="hidden" name="subject" value="  " />
<p class="ptm pnpost">
<a href="home.php?mod=spacecp&amp;ac=credit&amp;op=rule&amp;fid=119" class="y" target="_blank">本版积分规则</a>
<button type="button" onclick="showWindow('login', 'member.php?mod=logging&action=login&guestmessage=yes')" onmouseover="checkpostrule('seccheck_fastpost', 'ac=reply');this.onmouseover=null" name="replysubmit" id="fastpostsubmit" class="pn pnc vm" value="replysubmit" tabindex="5"><strong>发表回复</strong></button>
<label for="fastpostrefresh"><input id="fastpostrefresh" type="checkbox" class="pc" />回帖后跳转到最后一页</label>
<script type="text/javascript">if(getcookie('fastpostrefresh') == 1) {$('fastpostrefresh').checked=true;}</script>
</p>
</td>
</tr>
</table>
</form>
</div>

<script type="text/javascript">
var connect_qzone_share_url = 'https://linux.cn/home.php?mod=spacecp&ac=plugin&id=qqconnect:spacecp&pluginop=share&sh_type=1&thread_id=14738';
var connect_weibo_share_url = 'https://linux.cn/home.php?mod=spacecp&ac=plugin&id=qqconnect:spacecp&pluginop=share&sh_type=2&thread_id=14738';
var connect_thread_info = {
thread_url: 'https://linux.cn/thread-14738-1-1.html',
thread_id: '14738',
post_id: '53775',
forum_id: '119',
author_id: '15424',
author: 'kashu'
};

connect_autoshare = '0';
connect_isbind = '';
if(connect_autoshare == 1 && connect_isbind) {
_attachEvent(window, 'load', function(){
connect_share(connect_weibo_share_url, connect_openid);
});
}
</script>


<script type="text/javascript">document.onkeyup = function(e){keyPageScroll(e, 0, 0, 'forum.php?mod=viewthread&tid=14738', 1);}</script>
</div>

<div class="wp mtn">
<!--[diy=diy3]--><div id="diy3" class="area"></div><!--[/diy]-->
</div>

<script type="text/javascript">
function succeedhandle_followmod(url, msg, values) {
var fObj = $('followmod_'+values['fuid']);
if(values['type'] == 'add') {
fObj.innerHTML = '不收听';
fObj.href = 'home.php?mod=spacecp&ac=follow&op=del&fuid='+values['fuid'];
} else if(values['type'] == 'del') {
fObj.innerHTML = '收听TA';
fObj.href = 'home.php?mod=spacecp&ac=follow&op=add&hash=01efc05f&fuid='+values['fuid'];
}
}
</script>	</div>


<script type="text/javascript">var cookieLogin = Ajax("TEXT");cookieLogin.get("connect.php?mod=check&op=cookie", function() {});</script>

<script language="javascript">
function xwb_loadScript(file, charset){
	var script = document.createElement('SCRIPT');
	script.type = 'text/javascript'; script.charset = charset; script.src = file;
	document.getElementsByTagName('HEAD')[0].appendChild(script);
}

var _xwb_cfg_data ={
	tipsType:	'',site_uid:	'0',sina_uid:	'',
	siteVer:	'3.2',siteName:	'Linux 中国◆开源社区',pName:'forum_viewthread',
	regUrl:		'https://linux.cn/xwb.php?m=xwbSiteInterface.reg',
	setUrl:		'https://linux.cn/xwb.php?m=xwbSiteInterface.bind',
	bindUrl:	'https://linux.cn/xwb.php?m=xwbSiteInterface.bind',
	signerUrl:	'https://linux.cn/xwb.php?m=xwbSiteInterface.signer',
	authUrl:	'https://linux.cn/xwb.php?m=xwbAuth.login',
	getTipsUrl:	'https://linux.cn/xwb.php?m=xwbSiteInterface.getTips',
	attentionUrl:	'https://linux.cn/xwb.php?m=xwbSiteInterface.attention&tokenhash=01efc05f',
	wbxUrl:		'',
    tipGetCountUrl: 'https://linux.cn/xwb.php?m=xwbSiteInterface.getTips',
    loadingImgUrl : 'https://img.linux.net.cn/xwb/images/bgimg/xwb_loading.gif',
	switchToStd: '0',
	baseurlToStd: ''
};

xwb_loadScript("https://img.linux.net.cn/xwb/images/xwb.js", "UTF-8");
</script>
<link href="https://img.linux.net.cn/xwb/images/xwb_base.css" rel="stylesheet" type="text/css" />
<link href="https://img.linux.net.cn/xwb/images/xwb_3.2.css" rel="stylesheet" type="text/css" />
    <div id="footer">
        <p>
            <span>Linux.CN &copy; 2003 →→→  Linux中国</span>
            <span class="line">|</span>
            <span>Powered by <strong>DX</strong> | 图片存储于<a href="http://www.qiniu.com/" target="_blank">七牛云</a></span>
        </p>
        <p>
            <a href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备05083684号-1</a>            京公网安备110105001595
        </p>
        <p>
        <a href="https://linux.cn/legal.html">服务条款</a> |
        除特别申明外，本站原创内容版权遵循 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank">CC-BY-NC-SA 协议规定</a></p>
        <p>
        <a href="https://linux.cn/"><img src="https://img.linux.net.cn/static/image/common/linuxcn_logo_mini.png" align="absmiddle" /></a>
        <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><img src="https://img.linux.net.cn/static/image/common/cc.png" align="absmiddle" /></a>
        </p>
<p>
<a href="forum.php?mod=misc&action=showdarkroom" >小黑屋</a><span class="pipe">|</span></p>
</div>

<div id="ft" class="cl"></div>
<div id="scrolltop">
<span><a href="forum.php?mod=post&amp;action=reply&amp;fid=119&amp;tid=14738&amp;extra=&amp;page=1" onclick="showWindow('reply', this.href)" class="replyfast" title="快速回复"><b>快速回复</b></a></span>
<span hidefocus="true"><a title="返回顶部" onclick="window.scrollTo('0','0')" class="scrolltopa" ><b>返回顶部</b></a></span>
<span>
<a href="forum/post/1/" hidefocus="true" class="returnlist" title="返回列表"><b>返回列表</b></a>
</span>
</div>
<script type="text/javascript">_attachEvent(window, 'scroll', function () { showTopLink(); });</script>
<div id="qrcode">
<p>分享到微信</p>
<div id="canvas"></div>
<p><em>打开微信，点击顶部的“╋”，<br />
使用“扫一扫”将网页分享至微信。</em></p></div>
<!-- script type="text/javascript" src="https://img.linux.net.cn/static/js/ads.js?C0M"></script -->
<!-- div id="LC0MCisOsS" style="display: none; background-color: #A00; position: fixed; top: 0; width: 100%; z-index: 9999; left: 0; font-size: 16px; color: #fff; text-align: center; padding: 10px; opacity: 0.8;">请将我们加入您的广告过滤器的白名单，请支持开源站点。谢谢您。</div -->
<script type="text/javascript">
(function($){
$(window).load(function() {
/*if ($('#pleaseRemoveOurSiteFromBlackList').length == 0 && $(window).width() >= 480) {
$('#LC0MCisOsS').css('display','block');
}*/
if (location.href.substr(0,17) != 'https://linux.cn/') {
location.href = 'https://linux.cn/';
}
function roundTopFocus() {
if ($('.topfocus').length) {
//var tf1 = $('.topfocus').children().first();
//$('.topfocus').children().fadeOut('fast',function(){tf1.remove().appendTo($('.topfocus')).fadeIn()}).fadeIn();
} else if ($('.article_titlead').length) {
var ad1 = $('.article_titlead').children().first();
$('.article_titlead').children().fadeOut('slow',function(){ad1.remove().appendTo($('.article_titlead')).fadeIn()}).fadeIn();

}
}
setInterval(roundTopFocus, 10000);
});
})(jQuery);
</script>
</body>
</html>
