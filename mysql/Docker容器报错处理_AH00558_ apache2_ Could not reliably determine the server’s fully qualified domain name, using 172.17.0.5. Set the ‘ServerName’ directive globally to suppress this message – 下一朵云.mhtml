<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE">
	<!-- Support IE and Edge -->
	<meta charset="UTF-8">
	<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <title>Docker容器报错处理:AH00558: apache2: Could not reliably determine the server&#8217;s fully qualified domain name, using 172.17.0.5. Set the &#8216;ServerName&#8217; directive globally to suppress this message &#8211; 下一朵云</title>
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="下一朵云 &raquo; Feed" href="http://www.orcy.net.cn/feed" />
<link rel="alternate" type="application/rss+xml" title="下一朵云 &raquo; 评论Feed" href="http://www.orcy.net.cn/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="下一朵云 &raquo; Docker容器报错处理:AH00558: apache2: Could not reliably determine the server&#8217;s fully qualified domain name, using 172.17.0.5. Set the &#8216;ServerName&#8217; directive globally to suppress this message评论Feed" href="http://www.orcy.net.cn/775.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.orcy.net.cn\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.3"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='http://www.orcy.net.cn/wp-includes/css/dist/block-library/style.min.css?ver=5.3' type='text/css' media='all' />
<link rel='stylesheet' id='mkaz-code-syntax-css-css'  href='http://www.orcy.net.cn/wp-content/plugins/code-syntax-block/assets/blocks.style.css?ver=1587178815' type='text/css' media='all' />
<link rel='stylesheet' id='mkaz-code-syntax-prism-css-css'  href='http://www.orcy.net.cn/wp-content/plugins/code-syntax-block/assets/prism/prism.css?ver=1587178816' type='text/css' media='all' />
<link rel='stylesheet' id='hacker-style-css'  href='http://www.orcy.net.cn/wp-content/themes/hacker/style.css?ver=5.3' type='text/css' media='all' />
<link rel='https://api.w.org/' href='http://www.orcy.net.cn/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.orcy.net.cn/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.orcy.net.cn/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='TrendMicro(亚信) officescan隔离删除文件恢复' href='http://www.orcy.net.cn/771.html' />
<link rel='next' title='Windows如何快速修改远程桌面端口3389' href='http://www.orcy.net.cn/789.html' />
<meta name="generator" content="WordPress 5.3" />
<link rel="canonical" href="http://www.orcy.net.cn/775.html" />
<link rel='shortlink' href='http://www.orcy.net.cn/?p=775' />
<link rel="alternate" type="application/json+oembed" href="http://www.orcy.net.cn/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.orcy.net.cn%2F775.html" />
<link rel="alternate" type="text/xml+oembed" href="http://www.orcy.net.cn/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.orcy.net.cn%2F775.html&#038;format=xml" />
<link rel="icon" href="http://www.orcy.net.cn/wp-content/uploads/2019/12/cropped-Cloud_257px_1141440_easyicon.net_-32x32.png" sizes="32x32" />
<link rel="icon" href="http://www.orcy.net.cn/wp-content/uploads/2019/12/cropped-Cloud_257px_1141440_easyicon.net_-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.orcy.net.cn/wp-content/uploads/2019/12/cropped-Cloud_257px_1141440_easyicon.net_-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.orcy.net.cn/wp-content/uploads/2019/12/cropped-Cloud_257px_1141440_easyicon.net_-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			html {
  /*  2020-04-04
	filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
    -webkit-filter: grayscale(100%);
	*/
}		</style>
		</head>
<body class="post-template-default single single-post postid-775 single-format-standard">
<div id="page" class="site">
	<div id="primary" class="content-area">
		<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
				            <p class="site-title"><a href="http://www.orcy.net.cn/" rel="home">下一朵云</a></p>
        <p class="site-description">WWW.ORCY.NET.CN</p>			</div>
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="menu-menu-1-container"><ul id="primary-menu" class="primary-menu"><li id="menu-item-5" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5"><a href="http://www.orcy.net.cn">首页</a></li>
<li id="menu-item-34" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-34"><a href="http://www.orcy.net.cn/category/original">原创</a></li>
<li id="menu-item-33" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-33"><a href="http://www.orcy.net.cn/category/share">分享</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a href="http://www.orcy.net.cn/search">搜索</a></li>
</ul></div>			</nav>
			<!-- END #site-navigation -->
		</header>
		<!-- END .site-header -->
		<div id="content" class="site-content"><main id="main" class="site-main" role="main">
		<article id="post-775" class="Article Article--single post-775 post type-post status-publish format-standard hentry category-original">
		<h1 class="Article__title">Docker容器报错处理:AH00558: apache2: Could not reliably determine the server&#8217;s fully qualified domain name, using 172.17.0.5. Set the &#8216;ServerName&#8217; directive globally to suppress this message</h1>
		<div class="Article__topMeta">
			<span class="cat-links"><span class="screen-reader-text">目录  </span><a href="http://www.orcy.net.cn/category/original" rel="category tag">原创</a></span><span class="posted-on"><a href="http://www.orcy.net.cn/775.html" rel="bookmark"><time class="entry-date published" datetime="2020-03-13T15:37:23+08:00">2020-03-13</time></a></span>		</div>
				
		<div class="Article__content Content">
		
<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img src="http://www.orcy.net.cn/wp-content/uploads/2019/12/logo-docker.jpg" alt="" class="wp-image-223" width="240" srcset="http://www.orcy.net.cn/wp-content/uploads/2019/12/logo-docker.jpg 500w, http://www.orcy.net.cn/wp-content/uploads/2019/12/logo-docker-300x268.jpg 300w" sizes="(max-width: 500px) 100vw, 500px" /></figure></div>



<p><strong>故障描述：</strong>宿主机Centos7下安装docker服务，有一个提供web服务的容器，已经设置容器跟随docker服务器自启动，但是每当重启Centos7后，其他容器正常，唯有这一个容器的web服务不正常，无法访问。</p>



<p><strong>解决办法：</strong>在apache的默认配置文件内增加  <strong>ServerName IP</strong></p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img src="http://oss.orcy.net.cn/image/20200313152856.JPG" alt=""/></figure></div>



<p><strong>故障处理：</strong>重启CentOS后查看不正常的容器日志：</p>



<pre class="wp-block-code"><code>$ docker logs --since 30m CONTAINER_ID //产看30分钟内的日志</code></pre>



<figure class="wp-block-image size-large"><img src="http://oss.orcy.net.cn/image/20200313145012.JPG" alt=""/></figure>



<p class="has-text-color has-vivid-red-color"><strong>1.</strong>如上图可见容器内apache有报错：<strong>AH00558: apache2: Could not reliably determine the server&#8217;s fully qualified domain name, using 172.17.0.5. Set the &#8216;ServerName&#8217; directive globally to suppress this message</strong></p>



<p>查看出问题的容器的IP，确定容器IP为172.17.0.5</p>



<pre class="wp-block-code"><code>$ docker inspect CONTAINER_ID | grep IPAddress</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img src="http://oss.orcy.net.cn/image/20200313154340.JPG" alt=""/></figure></div>



<p><strong>2.</strong>此报错可能是因为apache的配置文件没有定义 <strong>ServerName</strong> 这一项，需要添加：</p>



<p class="has-text-color has-vivid-red-color"><strong>ServerName 172.17.0.5</strong> </p>



<pre class="wp-block-code"><code>$ odcker exec -it CONTAINER_ID bash  //进入容器</code></pre>



<pre class="wp-block-code"><code>$ cat /etc/apache2/sites-enable/000-defalut.conf //查看配置文件</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img src="http://oss.orcy.net.cn/image/20200313150916.JPG" alt=""/></figure></div>



<p><strong>3.</strong>如上图 <strong>#ServerName</strong> 是被注释的，问题处理就很简单了，直接取消注释，新增一条：</p>



<pre class="wp-block-code"><code>ServerName 172.17.0.5</code></pre>



<p><strong>4.</strong>但是容器里边没有vim编辑器，怎么办？</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img src="http://oss.orcy.net.cn/image/20200313151708.JPG" alt=""/></figure></div>



<p>直接从容器中拷贝文件到宿主机，然后在宿主机修改完成后拷贝进容器</p>



<pre class="wp-block-code"><code>$docker cp host_path containerID:container_path  //从主机复制到容器</code></pre>



<pre class="wp-block-code"><code>$docker cp containerID:container_path host_path  //从容器复制到主机</code></pre>



<p>复制完成后，注意在容器中检查文件权限配置是否和之前一致</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img src="http://oss.orcy.net.cn/image/20200313152152.JPG" alt=""/></figure></div>



<p>检查一致，Ctrl+d退出容器，重启容器</p>



<pre class="wp-block-code"><code>$ docker restart CONTAINER_ID</code></pre>



<p><strong>5.</strong>容器web服务正常访问！重启宿主机，之前的故障消失。</p>



<p>附：docker查看日志记录</p>



<pre class="wp-block-preformatted"> 命令格式：
 $ docker logs [OPTIONS] CONTAINER
   Options:
         --details        显示更多的信息
     -f, --follow         跟踪实时日志
         --since string   显示自某个timestamp之后的日志，或相对时间，如42m（即42分钟）
         --tail string    从日志末尾显示多少行日志， 默认是all
     -t, --timestamps     显示时间戳
         --until string   显示自某个timestamp之前的日志，或相对时间，如42m（即42分钟）
 例子：
 查看指定时间后的日志，只显示最后100行：
 $ docker logs -f -t --since="2018-02-08" --tail=100 CONTAINER_ID
 查看最近30分钟的日志:
 $ docker logs --since 30m CONTAINER_ID
 查看某时间之后的日志：
 $ docker logs -t --since="2018-02-08T13:23:37" CONTAINER_ID
 查看某时间段日志：
 $ docker logs -t --since="2018-02-08T13:23:37" --until "2018-02-09T12:23:37" CONTAINER_ID</pre>
		</div>
		<!-- END .Article__content -->
		<footer class="Article__footer">
				<div class="Article__meta pull-left">
		</div>
	<!-- END .pull-left -->
	<div class="Article__meta pull-right">
	<span><i class="icon-comments"></i><span><a href="http://www.orcy.net.cn/775.html#comments">2 条评论</a></span></span>	</div>
	<!-- END .pull-right -->
		</footer>
		<!-- END .Article__footer -->
	</article>
	<!-- END .Article -->
	
<div id="discussion" class="Discussion">
	<header class="Discussion__header">
		<h3 class="Discussion__heading">2 条评论</h3>
	</header>
	<!-- END .Comments-area__header -->
			<ul class="CommentList">
			
				<!-- commment -->
    <li id="comment-43" class="comment even thread-even depth-1 Comment">
    	    	<div class="Comment__media">
    		<img src="http://www.orcy.net.cn/wp-content/uploads/2019/12/Frendster_257px_1141464_easyicon.net_-150x150.png" width="48" height="48" alt="头像" class="avatar avatar-48wp-user-avatar wp-user-avatar-48 alignnone photo avatar-default" />    	</div>
    	<div class="Comment__body">
      		<div class="Comment__heading">
      			<div class="Comment__meta">
      				<div class="Comment__username">slena</div>
      				<div class="Comment__date">2020-05-09</div>
      			</div>
      			<div class="Comment__actions">
      				<span class="Comment__reply"><a rel='nofollow' class='comment-reply-link' href='http://www.orcy.net.cn/775.html?replytocom=43#respond' data-commentid="43" data-postid="775" data-belowelement="comment-43" data-respondelement="respond" aria-label='回复给slena'>回复</a></span>
      			</div>
			</div>
      			        <p>2步骤下面，docker exec -it CONTAINER_ID bash //进入容器<br />
这里容器没有启动，进不去啊。</p>
    	</div>
    </li>
    <!-- End .Comment -->
<ul class="children">
	<!-- commment -->
    <li id="comment-47" class="comment byuser comment-author-pony bypostauthor odd alt depth-2 Comment">
    	    	<div class="Comment__media">
    		<img src="http://www.orcy.net.cn/wp-content/uploads/2020/03/dracula_ghoul_helloween_vampire_512px_1228542_easyicon.net_-150x150.png" width="48" height="48" alt="Pony" class="avatar avatar-48 wp-user-avatar wp-user-avatar-48 alignnone photo" />    	</div>
    	<div class="Comment__body">
      		<div class="Comment__heading">
      			<div class="Comment__meta">
      				<div class="Comment__username">Pony</div>
      				<div class="Comment__date">2020-05-14</div>
      			</div>
      			<div class="Comment__actions">
      				<span class="Comment__reply"><a rel='nofollow' class='comment-reply-link' href='http://www.orcy.net.cn/775.html?replytocom=47#respond' data-commentid="47" data-postid="775" data-belowelement="comment-47" data-respondelement="respond" aria-label='回复给Pony'>回复</a></span>
      			</div>
			</div>
      			        <p>docker ps 看一下正在运行的容器，上边会有ID显示 ，将“CONTAINER_ID”替换为你的容器ID。</p>
    	</div>
    </li>
    <!-- End .Comment -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			
		</ul>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/775.html#respond" style="display:none;">取消回复</a></small></h3><form action="http://www.orcy.net.cn/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">电子邮件地址不会被公开。</span> 必填项已用<span class="required">*</span>标注</p><div class="comment-form__comment">
                                    <textarea placeholder="输入你的评论." required name="comment" id="comment" rows="3"></textarea>
                                  </div><div class="comment-form__author"><input id="author" name="author" type="text" class="form-control" value="" size="30" placeholder="姓名*" aria-required='true' required='required' /></div>
<div class="comment-form__email"><input id="email" name="email" type="email" class="form-control" value="" size="30" placeholder="Email*" aria-describedby="email-notes" aria-required='true' required='required' /></div>
<div class="comment-form__url"><input id="url" name="url" type="url" class="form-control" value="" size="30" placeholder="网站" /></div>
<div class="comment-form__submit"><button type="submit" name="submit" id="submit" class="btn btn-primary">发表评论</button> <input type='hidden' name='comment_post_ID' value='775' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</div></form>	</div><!-- #respond -->
	</div>
<!-- END #comments --></main>
<!-- END #main -->
﻿			</div>
			<!-- END #content -->
			<footer id="colophon" class="site-footer" role="contentinfo">
				<div class="site-info">
					<p class="meta">
					<a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备18152420号-1</a>&nbsp;&nbsp;<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44060602001554" target="_blank"><img src="http://oss.orcy.net.cn/5e79c700-gongan-ico.png" width="16px" height="16px" style="vertical-align:-8%;"/>粤公网安备 44060602001554号</a>					</p>
					<p class="meta">
					Copyright © 2018-2020 Carmen. All rights reserved.					</p>
					<div style="display:none;"><!-- CNZZ访问统计(div不显示) --><script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278577305'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1278577305%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script></div>
				</div>
				<!-- END .site-info -->
			</footer>
			<!-- END #colophon -->
		</div>
		<!-- END #primary -->
	</div>
	<!-- END #page -->
	<script type='text/javascript'>
/* <![CDATA[ */
var prism_settings = {"pluginUrl":"http:\/\/www.orcy.net.cn\/wp-content\/plugins\/code-syntax-block\/"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.orcy.net.cn/wp-content/plugins/code-syntax-block/assets/prism/prism.js?ver=1587178816'></script>
<script type='text/javascript' src='http://www.orcy.net.cn/wp-includes/js/comment-reply.min.js?ver=5.3'></script>
<script type='text/javascript' src='http://www.orcy.net.cn/wp-includes/js/wp-embed.min.js?ver=5.3'></script>
</body>
</html>