<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="referrer" content="origin" />
    <title>python文件操作之二进制 - cherry小樱桃 - 博客园</title>
<meta property="og:description" content="列表项 三元运算符号: 文件处理 首先给你一个文件，或者自己建立一个文件，那如何查看文件的内容呢？ 1.安装个文本编辑器 2.选中右键，利用文本编辑器软件打开 3.查看OR写入 4.保存关闭 正常的文" />
    <link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=svlZeZMvc3He7PqOD4T7SOuQn0_kIfLBYiy3idqd35Y1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/blue/bundle-blue.css?v=qe6u77TIvtk3zFn4c3Mlr949VSXYrmBnoTr0CJCG0QU1"/>
<link type="text/css" rel="stylesheet" href="/blog/customcss/368104.css?v=ZO2nNt1LEIeYAKcv0RB%2fiTwwW6I%3d"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/blue/bundle-blue-mobile.css?v=Go8Bj0ZU9gZXuPSKWcSQabps3E1njgJKYz4DiOq6-N41"/>
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/surewing/rss"/>
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/surewing/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/surewing/wlwmanifest.xml"/>
    <script src="//common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script>var currentBlogId=368104;var currentBlogApp='surewing',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="/bundles/blog-common.js?v=OFBZTzkHKauV7mtIFLF9jlqrX-sesK9-mY9KjurLrq01" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>


<div class="pagelayout">
    
<div class="header">
	<div>
		<a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/surewing/">爱陪小樱桃</a>
	</div>
	<div>
		
	</div>
</div>
    <div id="leftmenu" class="leftcolumn">
        
            
<h1 class = "listtitle">导航</h1>
<ul class = "list">
			<li class = "listitem"><a id="blog_nav_sitehome" class="listitem" href="https://www.cnblogs.com/">博客园</a></li>
			<li class = "listitem"><a id="blog_nav_myhome" href="https://www.cnblogs.com/surewing/">首页</a>
			<li class = "listitem"><a id="blog_nav_newpost" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a>
			<li class = "listitem"><a id="blog_nav_contact" accesskey="9" class="listitem" rel="nofollow" href="https://msg.cnblogs.com/send/cherry%E5%B0%8F%E6%A8%B1%E6%A1%83">联系</a></li>
			<li class = "listitem"><a id="blog_nav_rss" class="listitem" href="https://www.cnblogs.com/surewing/rss">订阅</a><a id="blog_nav_rss_image" href="https://www.cnblogs.com/surewing/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>
			<li class = "listitem"><a id="blog_nav_admin" class="listitem" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
            <div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
            <div id="blog_stats">
<div class = "listtitle">统计</div>
	<ul class = "list">
		<li class = "listitem">随笔 - 116
		<li class = "listitem">文章 - 0
		<li class = "listitem">评论 - 3
		<li class = "listitem">引用 - 0
	</li>
</ul></div>
            
<div class = "listtitle">公告</div>
	<ul class = "list">
		<li class = "listitem">
			<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
	</li>
</ul>
            <div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
        
        <div class="spacer">
            &nbsp;</div>
    </div>
    <div class="centercolumn">
        
        <div id="post_detail">
<div class = "singlepost">
	<div class = "posttitle">
		<a id="cb_post_title_url" class="singleposttitle" href="https://www.cnblogs.com/surewing/p/9130453.html">python文件操作之二进制</a>
	</div>
    <div class="postbody">
	<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown"><ul>
<li>列表项</li>
</ul>
<h2 id="三元运算符号">三元运算符号:</h2>
<pre class="python"><code>a=3
b=7
val=a if a&gt;b else val=b
print(val)</code></pre>
<h2 id="文件处理">文件处理</h2>
<p>首先给你一个文件，或者自己建立一个文件，那如何查看文件的内容呢？<br />
1.安装个文本编辑器<br />
2.选中右键，利用文本编辑器软件打开<br />
3.查看OR写入<br />
4.保存关闭</p>
<h3 id="正常的文件如上面的步骤怎么用python打开这个文件修改删除">正常的文件如上面的步骤，怎么用Python打开这个文件，修改删除</h3>
<p>1.怎么样用Python读一个文件；(自己在桌面建了一个文件叫test123)</p>
<pre class="python"><code>f =open(file=&#39;D:/Users/tufengchao/Desktop/test123&#39;,mode=&#39;r&#39;,encoding=&#39;utf-8&#39;)
data = f.read()
f.close()</code></pre>
<blockquote>
<ul>
<li>file是路径</li>
<li>mode 是打开的模式，r-读，w-写，rb-二进制</li>
<li>encoding 编码格式</li>
<li>read() 是读一个文件</li>
<li>close()是读了一个文件然后关闭</li>
</ul>
</blockquote>
<p><img src="https://images2018.cnblogs.com/blog/1202550/201806/1202550-20180605220342858-525618541.png" /></p>
<blockquote>
<ul>
<li>这里解释一下这个问题，首先我们的文件在硬盘里面是以二进制存储格式，最终读到内存是不是要转换我们能看懂的东西，从二进制转化为我们能看懂的内容，是有个对应的关系的，是按照字符编码来的，这个文件是按照gbk存储的，结果读的时候是按照utf-8来读的，所以在对应的编码表里面找不到对应的关系；</li>
<li>我们平时使用的Word，也是这样的，只是微软帮你转换好了，小白用户是看不到这里面的转换的，直接使用就OK了</li>
<li>在Python里面，你一定要记住你自己的文档是什么格式的，读的时候用什么格式的读，你要告诉Python你之前的是什么格式，要以什么格式打开，如果不指定，Python3默认的编码格式就是utf-8,（只要出现上述的报错，就是编码格式错误）；</li>
<li>如果不知道自己的文件原来的编码格式可以使用pycharm打开，pycharm右下角会自动给你检测的；</li>
</ul>
</blockquote>
<h3 id="文件处理二进制模式">文件处理二进制模式：</h3>
<h4 id="python3里面所有的字符都是utf-8的形式如果在打开一个文件的时候我不知道这个编码怎么办">python3里面所有的字符都是utf-8的形式，如果在打开一个文件的时候我不知道这个编码怎么办？</h4>
<p>那我们就不指定encoding的编码，那么Python3默认就是utf8但是这样也不行，同时我们要改变读的模式，才可以，r就是文本模式，可以直接读取字符串的，如果用户不知道文件的格式的话可以不指定编码格式，同时直接使用rb的模式，就是硬盘怎么存储的你就怎么存到内存，直接以二进制的形式，就可以了；</p>
<pre class="python"><code>f=open(file=&#39;D:/Users/tufengchao/Desktop/test123&#39;,mode=&#39;r&#39;,encoding=&#39;utf-8&#39;)
data=f.read()
print(data)</code></pre>
<blockquote>
<ul>
<li>如上述我指定了编码格式会报错：binary mode doesn't take an encoding argument</li>
</ul>
</blockquote>
<pre class="python"><code>f=open(file=&#39;D:/Users/tufengchao/Desktop/test123&#39;,mode=&#39;r&#39;,)
data=f.read()
print(data)</code></pre>
<blockquote>
<ul>
<li>以上则不会报错</li>
<li>基本二进制就是不给人家看的，例如视频的格式，等等就是二进制的；</li>
<li>基本来说 rb的模式就是不给人看的，就是网络传输用的，硬盘里面存的是什么读出来的就是什么；</li>
</ul>
</blockquote>
<h3 id="以上如果用户就是想看呢怎么办呢二进制的传来传去的最终有人会使用这个文件的不管什么文件传来传去如果记不得什么格式怎么办呢">以上如果用户就是想看呢，怎么办呢？二进制的传来传去的最终有人会使用这个文件的，不管什么文件传来传去如果记不得什么格式怎么办呢？</h3>
<blockquote>
<ul>
<li>问题：在传输的时候对方不知道是以什么格式传给用户，传来传去彼此都忘了什么格式：</li>
</ul>
</blockquote>
<pre><code>在编码的时候：utf8:是3个字符，gbk是2个字符，每个字符数字对应的字符，一段2进制串，如果10个字节全部都是中文，永远不能是utf-8，但是又要存成中文，就只能是gbk了，第三方的工具箱，会自动检测这段文字是什么编码。
我们需要用到一个第三方的工具包叫：**chardet**</code></pre>
<h3 id="教大家如何安装chardet">教大家如何安装chardet</h3>
<blockquote>
<ul>
<li>pip3 install chardet</li>
<li>然后代码输入：</li>
</ul>
</blockquote>
<pre class="python"><code>import chardet
f= open(&#39;log&#39;,mode=&#39;rb&#39;)
data=f.read()
f.close()
result=chardet.detect(open(&#39;log&#39;,mode=&#39;rb&#39;).read())
print(result)</code></pre>
<blockquote>
<ul>
<li>通过上述我们可以知道什么的编码了，然后就可以通过具体的编码来看了;** 备注 **以上文件的路劲都是自己的本地，如果需要练习，大家可以自己创造文件；</li>
</ul>
</blockquote>
<h2 id="文件处理写模式操作文件">文件处理写模式操作文件：</h2>
<ul>
<li>如果文件特别大，一read就全部读出来，如果内存小怎么办？<br />
1.可以不可以每次读一点，然后丢掉一点，然后在读一点？答案是当然可以了<br />
</li>
</ul>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test123&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)
for line in f:
    print(line)
f.close()</code></pre>
<p><img src="https://images2018.cnblogs.com/blog/1202550/201806/1202550-20180605220439144-93264179.png" /></p>
<ul>
<li>如上述的代码执行的结果中，竟然每行下边会有空格，为什么会有空格呢？<br />
1.因为prit本身就会换行；如上述的代码换成：</li>
</ul>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test123&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)
data=f.read()
print(data)</code></pre>
<p><img src="https://images2018.cnblogs.com/blog/1202550/201806/1202550-20180605220453590-426124027.png" /></p>
<p>就不会有问题了，<br />
如果是：</p>
<pre class="python"><code>for line in f:
    print(line)</code></pre>
<p>就会换行</p>
<h3 id="写文件">写文件：</h3>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test123&#39;,&#39;w&#39;,encoding=&#39;utf-8&#39;)
f.write(&#39;老北京科技大学,微信号：xxx&#39;)
f.close()</code></pre>
<p>如上述就是写的格式，（备注：文件可以自行准备，写的内容可以自己写入，同时这里面的编码要根据你要编写的文件的编码格式，并不是所有文件都是utf8，有可能是gbk等等）</p>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test123&#39;,&#39;wb&#39;)
f.write(&#39;第二梦&#39;)
print(f.read())</code></pre>
<p>会发现，之间的文件内容，现在只有：“第二梦”了<br />
w不是修改，是创建了一个新的文件名字，如果和原来的旧文件有名字一样，原来的文件就是清空，如果是文件名字不一样就是新建，所以我们要是小心使用：w</p>
<h3 id="追加模式">追加模式</h3>
<ul>
<li>如果对一个文件我要修改一个条，或者追加一个内容：</li>
</ul>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test&#39;,&#39;a&#39;,encoding=&#39;utf-8&#39;)
f.write(&#39;我要追加哈哈！！！！&#39;)
f.close()</code></pre>
<ul>
<li>注意：文件操作的时候，以 “a” 或者“ab”模式打开，则只能追加，即：在原来的内容尾部追加内容</li>
<li>写入硬盘时候，必须是：0101010101，打开时候需要注意：</li>
<li>ab,写入时，需要直接传入以某种编码的010101010 ，即：字节类型</li>
<li><p>a 和encoding 写入时需要传入Unicode字符串，内部会根据encoding制定的编码将Unicode字符串转换为该编码的01001010101</p>
<h3 id="读写混合模式">读写混合模式</h3></li>
<li>r+ 就是读写混合模式：</li>
</ul>
<pre class="python"><code>f=open(&#39;D:/Users/tufengchao/Desktop/test&#39;,&#39;r+&#39;,encoding=&#39;utf-8&#39;)
data=f.read()
print(data)
f.write(&#39;混合模式啦！！！！&#39;)
data1=f.read()
print(data1)
f.close()</code></pre>
<ul>
<li>注意上述的第二个，read()没有打印出来对应的插入的内容，</li>
<li><p>不是每次读完了，都重新读，就类似一个光标，光标在开始时候光标在第一个位置，然后read之后光标在最后，然后写的时候，结果光标又定位在最后了，所以读的时候从光标的位置往后读，所有读出来的结果就是空的，没有读出来；</p></li>
<li>写读模式：w +</li>
<li>读写和写读 听上去是一样的，其实完全不一样，读写模式：先读写，写读：是写模式打开，是写打开写，然后在读；（写：可以把原来的覆盖掉的）</li>
<li><p>w+基本上应用场景比较少；</p>
<h3 id="文件操作的其他的基本功能">文件操作的其他的基本功能：</h3>
def fileno(self,*args,**kwargs):返回文件句柄在内核中的索引值，以后做IO多路复用的时候可以用到；<br />
def flush(self ,*args,**kwargs):把文件从内存buffer里面强制刷新到硬盘上，例如：</li>
</ul>
<pre class="pthhon"><code>f=(&quot;f_flush_test.txt&quot;,&#39;w&#39;)
f.write(&quot;\ntest&quot;)</code></pre>
<blockquote>
<ul>
<li>这时候打开文件f_flush_test.txt，发现是空白的：why?</li>
</ul>
</blockquote>
<ul>
<li>主要是写入的内容会先存入内存，然后在从内容写入硬盘，因为存入内存要比写入硬盘快很多；</li>
<li>如上述的代码后边加入：f.close()就可以在文件f_flush_test.txt这个文件里面看到了；so每写一个字符都要往硬盘里面写的话会让速度很慢，所以就搞了个缓存功能，buffer，这个是可以改的，满了就会刷到硬盘里面，<br />
1.如果数据特别的大，但是有突然断电了这个怎么办呢？<br />
2.默认是buffer满了自动刷，现在要求强制刷，有没有这么的功能呢？</li>
</ul>
<pre class="pthhon"><code>f=(&quot;f_flush_test.txt&quot;,&#39;w&#39;)
f.write(&quot;\ntest&quot;)
f.flush()</code></pre>
<p>3.这时候打开文件是不是就有了刚才写的内容了；</p>
<p>def readable(self ,*args ,**kwargs):判断是否可读<br />
def readline(self ,*args,**kwargs):只读一行，遇到\r or \n为止<br />
def seek(self ,*args ,**kwargs):<br />
把文件的光标移动到制定的位置；</p>
<ul>
<li>注意：seek的长度是按照字节算的，字符编码存每个字符所占的字节长度不一样。</li>
<li>如：我爱祖国，用gbk存就是2个字节，用utf-8存就是3个字节，因此以gbk打开时，seek（4）光标就会定位在“爱”之后</li>
<li>如果是utf-8，seek(4)会导致，拿到“爱”这个字的一部分字节，打印的话会报错，因此处理剩下的文本时发现用</li>
<li>def seekabale(self,*args,**kwargs)判断文件是否可以进行seek操作</li>
<li><p>def tell(self,*args,**kwargs)返回当前文件操作的光标位置</p>
<blockquote>
<ul>
<li>read()是按照字符来读的，tell()和seek()是按照字节来的</li>
</ul>
</blockquote></li>
<li>def truncate(self,*args,**kwargs)按照指定的长度截取文件</li>
<li><p>def writable(self,*args,**kwargs)判断是否可以写</p></li>
</ul>
<blockquote>
<ul>
<li>word 在读取大文件的时候会慢，是因为他把硬盘的文件全部读取到内存，然后在内存中进行增删改查，在内存中就可以随便的修改了，就像列表一样，可以随意的修改东西；</li>
<li>文件特别的大，会不会内存爆掉呀？</li>
<li>有没有即不爆掉内存，又可以存到内存，我可以边读边修改，先读出来一点，然后检测一下是否修改，如果修改，就修改了放到新文件，如果不修改，就直接放到新文件里面，从一边读往一边写，这样就不会占内存了，就多站点硬盘；</li>
</ul>
</blockquote>
<pre class="python"><code>f_name=&#39;f_test.txt&#39;
f_new_name =&#39;%s.new&#39; %f_name
old_str=&#39;wo&#39;
new_str=&#39;haha&#39;
f=open(f_name,&quot;r&quot;,encoding=&#39;utf8&#39;)
f_new =open(f_new_name,&quot;w&quot;,encoding=&#39;utf-8&#39;)
for line in f:
    if old_str in line:
        line=line.replace(old_str,new_str)
    f_new.write(line)
f.close()
f_new.write(line)
f.close()
f_new.close()
os.rename(f_new_name,f_name)</code></pre>
</div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


    </div>
	<div class = "itemdesc">
		posted on <span id="post-date">2018-06-05 21:51</span> <a href='https://www.cnblogs.com/surewing/'>cherry小樱桃</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="https://i.cnblogs.com/EditPosts.aspx?postid=9130453" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(9130453);return false;">收藏</a>
	</div>
</div>
	<script src="//common.cnblogs.com/highlight/9.12.0/highlight.min.js"></script><script>markdown_highlight();</script><script type="text/javascript">var allowComments=true,cb_blogId=368104,cb_entryId=9130453,cb_blogApp=currentBlogApp,cb_blogUserGuid='4b8dfa51-b011-4e71-2ca4-08d49c352df3',cb_entryCreatedDate='2018/6/5 21:51:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=true;</script>
	
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id='cnblogs_c1' class='c_ad_block'>
    <div id='div-gpt-ad-1546353474406-0' style='height:250px; width:300px;'></div>
</div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'>
    <div id='div-gpt-ad-1539008685004-0' style='height:60px; width:468px;'></div>
</div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
        <div class="spacer">
            &nbsp;</div>
    </div>
    
<div class="footer">
	Powered by: 
	<br />
	
	<a id="Footer1_Hyperlink3" NAME="Hyperlink1" href="https://www.cnblogs.com/" style="font-family:Verdana;font-size:12px;">博客园</a>
	<br />
	Copyright &copy; cherry小樱桃
</div>
</div>


</body>
</html>
