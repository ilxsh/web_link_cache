<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0049)https://bbs.archlinux.org/viewtopic.php?id=240841 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>[Solved] encrypt hook - "Keyfile could not be opened." / Kernel &amp; Hardware / Arch Linux Forums</title>
<link rel="stylesheet" type="text/css" href="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/ArchLinux.css">
<link rel="canonical" href="https://bbs.archlinux.org/viewtopic.php?id=240841" title="Page 1">
<link rel="alternate" type="application/atom+xml" href="https://bbs.archlinux.org/extern.php?action=feed&amp;tid=240841&amp;type=atom" title="Atom topic feed">
    <link rel="stylesheet" media="screen" href="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/arch.css">
        <link rel="stylesheet" media="screen" href="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/archnavbar.css">
    
<link rel="shortcut icon" href="https://bbs.archlinux.org/style/ArchLinux/favicon.ico">
</head>

<body>
<div id="archnavbar" class="anb-forum">
	<div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div>
	<div id="archnavbarmenu">
		<ul id="archnavbarlist">
			<li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-security"><a href="https://security.archlinux.org/">Security</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li>		</ul>
	</div>
</div>


<div id="punviewtopic" class="pun">
<div class="top-box"></div>
<div class="punwrap">

<div id="brdheader" class="block">
	<div class="box">
		<div id="brdmenu" class="inbox">
			<ul>
				<li id="navindex" class="isactive"><a href="https://bbs.archlinux.org/index.php">Index</a></li>
				<li id="navrules"><a href="https://bbs.archlinux.org/misc.php?action=rules">Rules</a></li>
				<li id="navsearch"><a href="https://bbs.archlinux.org/search.php">Search</a></li>
				<li id="navregister"><a href="https://bbs.archlinux.org/register.php">Register</a></li>
				<li id="navlogin"><a href="https://bbs.archlinux.org/login.php">Login</a></li>
			</ul>
		</div>
		<div id="brdwelcome" class="inbox">
			<p class="conl">You are not logged in.</p>
			<ul class="conr">
				<li><span>Topics: <a href="https://bbs.archlinux.org/search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="https://bbs.archlinux.org/search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li>
			</ul>
			<div class="clearer"></div>
		</div>
	</div>
</div>



<div id="brdmain">
<div class="linkst">
	<div class="inbox crumbsplus">
		<ul class="crumbs">
			<li><a href="https://bbs.archlinux.org/index.php">Index</a></li>
			<li><span>»&nbsp;</span><a href="https://bbs.archlinux.org/viewforum.php?id=22">Kernel &amp; Hardware</a></li>
			<li><span>»&nbsp;</span><strong><a href="https://bbs.archlinux.org/viewtopic.php?id=240841">[Solved] encrypt hook - "Keyfile could not be opened."</a></strong></li>
		</ul>
		<div class="pagepost">
			<p class="pagelink conl"><span class="pages-label">Pages: </span><strong class="item1">1</strong></p>
		</div>
		<div class="clearer"></div>
	</div>
</div>

<div id="p1810347" class="blockpost rowodd firstpost blockpost1">
	<h2><span><span class="conr">#1</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1810347#p1810347">2018-09-29 18:33:48</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>KairiTech</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>From: Toronto, Canada</span></dd>
						<dd><span>Registered: 2011-06-04</span></dd>
						<dd><span>Posts: 265</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>[Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<p>Synopsys:</p><p>I have reverted to using the keyfile included in the initramfs instead:</p><div class="codebox"><pre><code>cryptkey=rootfs:/boot/lxK/k_HDD</code></pre></div><p>I have been modifying my encrypt hook as indicated here, <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Specialties#Encrypted_system_using_a_detached_LUKS_header" rel="nofollow">Modifying encrypt hook</a>, for quite some time with no issues. However, over the last several weeks it can no longer find the keyfile specified in the kernel parameter below and I get the passphrase prompt.</p><div class="codebox"><pre><code>cryptkey=UUID=D4C1-41C0:vfat:/boot/lxK/k_64SSDx3</code></pre></div><p>However, when I force the <strong>ckeyfile</strong> variable to the same keyfile as below it works and there's no prompt.</p><div class="codebox"><pre><code>run_hook() {
    modprobe -a -q dm-crypt &gt;/dev/null 2&gt;&amp;1
    [ "${quiet}" = "y" ] &amp;&amp; CSQUIET="&gt;/dev/null"

    # Get keyfile if specified
    ckeyfile="/crypto_keyfile.bin"
    ckeyfile="/boot/lxK/k_HDD"
    if [ -n "$cryptkey" ]; then
        IFS=: read ckdev ckarg1 ckarg2 &lt;&lt;EOF
$cryptkey
EOF</code></pre></div><p>For completeness here's the sylinux boot menu item (same thing happens if I go the UEFI route):</p><div class="codebox"><pre><code>        MENU LABEL ]HDD 
        LINUX /EFI/HDD/vmlinuz-linux.efi
        APPEND root=/dev/mapper/HDD cryptdevice=/dev/md1:HDD:header cryptkey=UUID=D4C1-41C0:vfat:/boot/lxK/k_HDD init=/usr/lib/systemd/systemd pcie_aspm=force rootdelay=3 quiet loglevel=0 rd.udev.log-priority=3 
        INITRD /EFI/HDD/initramfs-linux.img</code></pre></div><p>This is how I format the partition holding the keyfile:</p><div class="codebox"><pre><code>mkfs.vfat -v -s2 -F32 -n lxK_boot /dev/sdf1</code></pre></div><p>This confirms the UUID I specify in the krenel parameter:</p><div class="codebox"><pre><code>/dev/sdf1: LABEL="lxK_boot" UUID="D4C1-41C0" TYPE="vfat" PARTLABEL="lxk_boot" PARTUUID="aa7281c7-a586-4eb6-abb4-a2e5146ad8b2"</code></pre></div><p>I've been looking over my LUKS setup for a while now but just can't see anything that might explain this.</p><p>Am I missing something so bovious that I should go out and buy myself some brown paper bags?</p>
						<p class="postedit"><em>Last edited by KairiTech (2019-06-13 14:20:07)</em></p>
					</div>
					<div class="postsignature postmsg"><hr><p>-=[ LIVE enabled UEFI with redundant syslinux pure systemd detached LUKS header partitionless encrypted GPT SSDx3 RAID0 because I can.&nbsp; ]=-<br>Backward compatibility is for the masses. There's no dual-boot here.</p><p>[KairiTech is only artificially intelligent.&nbsp; Turing would be agast at just how artificial.]</p></div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1812115" class="blockpost roweven">
	<h2><span><span class="conr">#2</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1812115#p1812115">2018-10-11 23:07:56</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>jecki</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>Registered: 2018-10-11</span></dd>
						<dd><span>Posts: 1</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<p>I had a very similar problem: A week or two ago, the system suddenly could not open the keyfile from my usb-stick any more. I was able to solve the problem by adding uas and usb_storage to MODULES in /etc/mkinitcpio.conf : </p><div class="codebox"><pre><code>MODULES=(uas usb_storage ...)</code></pre></div>
					</div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1812396" class="blockpost rowodd">
	<h2><span><span class="conr">#3</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1812396#p1812396">2018-10-14 04:03:03</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>nyn</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd class="postavatar"><img src="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/91462.png" width="80" height="80" alt=""></dd>
						<dd><span>Registered: 2015-05-27</span></dd>
						<dd><span>Posts: 11</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<div class="quotebox"><cite>jecki wrote:</cite><blockquote><div><p>I had a very similar problem: A week or two ago, the system suddenly could not open the keyfile from my usb-stick any more. I was able to solve the problem by adding uas and usb_storage to MODULES in /etc/mkinitcpio.conf : </p><div class="codebox"><pre><code>MODULES=(uas usb_storage ...)</code></pre></div></div></blockquote></div><p>Thank you very much. I encountered the same problem after updating my system yesterday and this fixed it.</p>
					</div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827291" class="blockpost roweven">
	<h2><span><span class="conr">#4</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827291#p1827291">2019-01-17 22:38:33</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>KairiTech</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>From: Toronto, Canada</span></dd>
						<dd><span>Registered: 2011-06-04</span></dd>
						<dd><span>Posts: 265</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<div class="quotebox"><cite>jecki wrote:</cite><blockquote><div><p>I had a very similar problem: A week or two ago, the system suddenly could not open the keyfile from my usb-stick any more. I was able to solve the problem by adding uas and usb_storage to MODULES in /etc/mkinitcpio.conf : </p><div class="codebox"><pre><code>MODULES=(uas usb_storage ...)</code></pre></div></div></blockquote></div><p>I've been trying this since you suggested it and even after a few upgrades to the mkinitcpio package I still get prompted for the passphrase.</p>
					</div>
					<div class="postsignature postmsg"><hr><p>-=[ LIVE enabled UEFI with redundant syslinux pure systemd detached LUKS header partitionless encrypted GPT SSDx3 RAID0 because I can.&nbsp; ]=-<br>Backward compatibility is for the masses. There's no dual-boot here.</p><p>[KairiTech is only artificially intelligent.&nbsp; Turing would be agast at just how artificial.]</p></div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827295" class="blockpost rowodd">
	<h2><span><span class="conr">#5</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827295#p1827295">2019-01-17 23:25:50</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>frostschutz</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd class="postavatar"><img src="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/76897.png" width="80" height="80" alt=""></dd>
						<dd><span>Registered: 2013-11-15</span></dd>
						<dd><span>Posts: 909</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<p>Now this is just wild guesswork... but does the file you specified even exist?</p><div class="codebox"><pre><code>mkdir /mnt/tmp
mount -o ro -t vfat UUID=D4C1-41C0 /mnt/tmp
stat /mnt/tmp/boot/lxK/k_64SSDx3</code></pre></div><div class="quotebox"><blockquote><div><p>However, when I force the ckeyfile variable to the same keyfile as below it works and there's no prompt.</p></div></blockquote></div><p>It would make sense if you have usually mounted that key filesystem to /boot/lxK of your running arch, and added /boot/lxK/k_64SSDx3 to FILES in your mkinitcpio.conf</p><p>In that case the key is embedded into the initramfs itself and the physical key device no longer matters at all...</p>
					</div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827303" class="blockpost roweven">
	<h2><span><span class="conr">#6</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827303#p1827303">2019-01-18 01:08:29</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>KairiTech</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>From: Toronto, Canada</span></dd>
						<dd><span>Registered: 2011-06-04</span></dd>
						<dd><span>Posts: 265</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<div class="quotebox"><blockquote><div><p>It would make sense if you have usually mounted that key filesystem to /boot/lxK of your running arch, and added /boot/lxK/k_64SSDx3 to FILES in your mkinitcpio.conf</p></div></blockquote></div><p>Which confirms that the keyfile on the keyfile device I copy into the initramfs is valid.</p><p>Is it that dm-crypt doesn't like UUIDs anymore?</p><p>My current install has the following characteristics - </p><p>The keyfile:</p><div class="codebox"><pre><code>-rwxr-xr-x 1 root root 2048 Dec  8 14:17 /boot/lxK/k_64SSDx3</code></pre></div><p>The keyfile device mounted on /boot:</p><div class="codebox"><pre><code>├─sdf1        8:81   1   256M  0 part  /boot</code></pre></div><p>The UUID of the keyfile device:</p><div class="codebox"><pre><code>/dev/sdf1: LABEL_FATBOOT="lxK_boot" LABEL="lxK_boot" UUID="2492-8796" TYPE="vfat" PARTLABEL="lxK_boot" PARTUUID="2518fe82-35be-42a0-93e6-8be2713ea7f5"</code></pre></div><p>The vfat module is included in the initramfs:</p><div class="codebox"><pre><code>MODULES=(dm_mod dm_crypt aes_x86_64 raid0 nls_iso8859_1 vfat ext4 zram ext2)</code></pre></div><p>The kernel boot parameter for the keyfile:</p><div class="codebox"><pre><code>cryptkey=UUID=2492-8796:vfat:/boot/lxK/k_64SSDx3</code></pre></div>
					</div>
					<div class="postsignature postmsg"><hr><p>-=[ LIVE enabled UEFI with redundant syslinux pure systemd detached LUKS header partitionless encrypted GPT SSDx3 RAID0 because I can.&nbsp; ]=-<br>Backward compatibility is for the masses. There's no dual-boot here.</p><p>[KairiTech is only artificially intelligent.&nbsp; Turing would be agast at just how artificial.]</p></div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827306" class="blockpost rowodd">
	<h2><span><span class="conr">#7</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827306#p1827306">2019-01-18 02:07:29</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>frostschutz</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd class="postavatar"><img src="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/76897.png" width="80" height="80" alt=""></dd>
						<dd><span>Registered: 2013-11-15</span></dd>
						<dd><span>Posts: 909</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<div class="quotebox"><cite>KairiTech wrote:</cite><blockquote><div><p>Which confirms that the keyfile on the keyfile device I copy into the initramfs is valid.</p></div></blockquote></div><p>The keyfile may be valid, sure. Putting it in the initramfs would likely defeat your security concept regardless. ;-)</p><div class="quotebox"><cite>KairiTech wrote:</cite><blockquote><div><p>Is it that dm-crypt doesn't like UUIDs anymore?</p></div></blockquote></div><p>What I was trying to point out is that you're likely using the wrong path. You have to specify the path relative to the filesystem itself, not to whatever you mount it to because that doesn't matter. (The initramfs mounts it elsewhere. The mount path is not specified anywhere.)</p><p>So I'm guessing you do not have a boot directory on that vfat filesystem. And maybe not a lxK directory either. Depending on that you'd have to change the supplied path (remove /boot or /boot/lxK).</p><div class="codebox"><pre><code>cryptkey=UUID=2492-8796:vfat:/boot/lxK/k_64SSDx3</code></pre></div><p>Yeah, try that without /boot/</p><p>And if that works, make sure /boot/lxK/k_64SSDx3 is no longer included into the initramfs.</p><p>( Or maybe that's what you really want to achieve here - is this a stick that only supplies a keyfile, or is this the stick you're actually booting from? If you want it to boot without passphrase, just including the key as /crypto_keyfile.bin will do. That works without modification to the encrypt hook at all and without cryptkey parameter then. Low safety though. )</p>
						<p class="postedit"><em>Last edited by frostschutz (2019-01-18 02:11:24)</em></p>
					</div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827482" class="blockpost roweven">
	<h2><span><span class="conr">#8</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827482#p1827482">2019-01-19 04:01:57</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>KairiTech</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>From: Toronto, Canada</span></dd>
						<dd><span>Registered: 2011-06-04</span></dd>
						<dd><span>Posts: 265</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<div class="quotebox"><blockquote><div><p>Depending on that you'd have to change the supplied path (remove /boot or /boot/lxK).</p><div class="codebox"><pre><code>cryptkey=UUID=2492-8796:vfat:/boot/lxK/k_64SSDx3</code></pre></div><p>Yeah, try that without /boot/</p></div></blockquote></div><p>I tried just that a while back and just to be sure I tried it again but I still get the passphrase prompt.</p><p>The oddest thing though is that even when I do have the ckeyfile variable in the encrypt hook set to '/boot/lxK/k_64SSDx3' if I do not also have the cryptkey kernel parameter set to the keyfile on the USB thumb drive I get prompted for the passphrase.&nbsp; I would have thought that the keyfile in the initramfs and the keyfile on the USB were totally independent of each other.</p>
					</div>
					<div class="postsignature postmsg"><hr><p>-=[ LIVE enabled UEFI with redundant syslinux pure systemd detached LUKS header partitionless encrypted GPT SSDx3 RAID0 because I can.&nbsp; ]=-<br>Backward compatibility is for the masses. There's no dual-boot here.</p><p>[KairiTech is only artificially intelligent.&nbsp; Turing would be agast at just how artificial.]</p></div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1827503" class="blockpost rowodd">
	<h2><span><span class="conr">#9</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1827503#p1827503">2019-01-19 11:12:55</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>frostschutz</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd class="postavatar"><img src="./[Solved] encrypt hook - _Keyfile could not be opened._ _ Kernel &amp; Hardware _ Arch Linux Forums_files/76897.png" width="80" height="80" alt=""></dd>
						<dd><span>Registered: 2013-11-15</span></dd>
						<dd><span>Posts: 909</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<p>Well, no idea.</p><p>You could enable shell debugging ( set -x to enable, set +x to disable ).</p><p>You can remove what output is suppressed explicitely ( get rid of &gt; /dev/null 2&gt;&amp;1 ) .</p><p>That way maybe you can see what it is doing in the encrypt hook up to the passphrase. Helps if the console is already in high res mode at that point (if it's intel graphics, might have to add i915 to MODULES)</p>
					</div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div id="p1850093" class="blockpost roweven">
	<h2><span><span class="conr">#10</span> <a href="https://bbs.archlinux.org/viewtopic.php?pid=1850093#p1850093">2019-06-13 14:18:28</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postbody">
				<div class="postleft">
					<dl>
						<dt><strong>KairiTech</strong></dt>
						<dd class="usertitle"><strong>Member</strong></dd>
						<dd><span>From: Toronto, Canada</span></dd>
						<dd><span>Registered: 2011-06-04</span></dd>
						<dd><span>Posts: 265</span></dd>
					</dl>
				</div>
				<div class="postright">
					<h3>Re: [Solved] encrypt hook - "Keyfile could not be opened."</h3>
					<div class="postmsg">
						<p>The&nbsp; <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Encrypting_an_entire_system" rel="nofollow">dm-crypt/Encrypting an entire system</a> wiki no longer has any mention of using the UUID of the USB containing the key file in the 'cryptkey' kernel parameter.&nbsp; It did work for me a while back though.</p><p>I have reverted to using the keyfile included in the initramfs instead:</p><div class="codebox"><pre><code>cryptkey=rootfs:/boot/lxK/k_HDD</code></pre></div>
						<p class="postedit"><em>Last edited by KairiTech (2019-06-13 14:21:30)</em></p>
					</div>
					<div class="postsignature postmsg"><hr><p>-=[ LIVE enabled UEFI with redundant syslinux pure systemd detached LUKS header partitionless encrypted GPT SSDx3 RAID0 because I can.&nbsp; ]=-<br>Backward compatibility is for the masses. There's no dual-boot here.</p><p>[KairiTech is only artificially intelligent.&nbsp; Turing would be agast at just how artificial.]</p></div>
				</div>
			</div>
		</div>
		<div class="inbox">
			<div class="postfoot clearb">
				<div class="postfootleft"><p><span>Offline</span></p></div>
			</div>
		</div>
	</div>
</div>

<div class="postlinksb">
	<div class="inbox crumbsplus">
		<div class="pagepost">
			<p class="pagelink conl"><span class="pages-label">Pages: </span><strong class="item1">1</strong></p>
		</div>
		<ul class="crumbs">
			<li><a href="https://bbs.archlinux.org/index.php">Index</a></li>
			<li><span>»&nbsp;</span><a href="https://bbs.archlinux.org/viewforum.php?id=22">Kernel &amp; Hardware</a></li>
			<li><span>»&nbsp;</span><strong><a href="https://bbs.archlinux.org/viewtopic.php?id=240841">[Solved] encrypt hook - "Keyfile could not be opened."</a></strong></li>
		</ul>
		<div class="clearer"></div>
	</div>
</div>
</div>

<div id="brdfooter" class="block">
	<h2><span>Board footer</span></h2>
	<div class="box">
		<div id="brdfooternav" class="inbox">
			<div class="conl">
				<form id="qjump" method="get" action="https://bbs.archlinux.org/viewforum.php">
					<div><label><span>Jump to<br></span>
					<select name="id" onchange="window.location=(&#39;viewforum.php?id=&#39;+this.options[this.selectedIndex].value)">
						<optgroup label="Technical Issues and Assistance">
							<option value="23">Newbie Corner</option>
							<option value="17">Installation</option>
							<option value="22" selected="selected">Kernel &amp; Hardware</option>
							<option value="18">Applications &amp; Desktop Environments</option>
							<option value="31">Laptop Issues</option>
							<option value="8">Networking, Server, and Protection</option>
							<option value="32">Multimedia and Games</option>
							<option value="50">System Administration</option>
							<option value="35">Other Architectures</option>
						</optgroup>
						<optgroup label="Arch-centric">
							<option value="24">Announcements, Package &amp; Security Advisories</option>
							<option value="1">Arch Discussion</option>
							<option value="13">Forum &amp; Wiki discussion</option>
						</optgroup>
						<optgroup label="Pacman Upgrades, Packaging &amp; AUR">
							<option value="44">Pacman &amp; Package Upgrade Issues</option>
							<option value="49">[testing] Repo Forum</option>
							<option value="4">Creating &amp; Modifying Packages</option>
							<option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option>
						</optgroup>
						<optgroup label="Contributions &amp; Discussion">
							<option value="20">GNU/Linux Discussion</option>
							<option value="27">Community Contributions</option>
							<option value="33">Programming &amp; Scripting</option>
							<option value="30">Other Languages</option>
							<option value="47">Artwork and Screenshots</option>
						</optgroup>
					</select></label>
					<input type="submit" value=" Go " accesskey="g">
					</div>
				</form>
			</div>
			<div class="conr">
				<p id="feedlinks"><span class="atom"><a href="https://bbs.archlinux.org/extern.php?action=feed&amp;tid=240841&amp;type=atom">Atom topic feed</a></span></p>
				<p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p>
			</div>
			<div class="clearer"></div>
		</div>
	</div>
</div>

</div>
<div class="end-box"></div>
</div>



</body></html>