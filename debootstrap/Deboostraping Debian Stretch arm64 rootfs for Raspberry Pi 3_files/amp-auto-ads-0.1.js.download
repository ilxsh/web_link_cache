(self.AMP=self.AMP||[]).push({n:"amp-auto-ads",v:"2004172112280",f:(function(AMP,_){
var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},h;if("function"==typeof Object.setPrototypeOf)h=Object.setPrototypeOf;else{var k;a:{var ba={a:!0},m={};try{m.__proto__=ba;k=m.a;break a}catch(a){}k=!1}h=k?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var p=h,ca=Object.prototype.toString;function t(a){return a||{}};function u(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c}function v(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)};function x(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var da=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function y(a){var b=Object.create(null);if(!a)return b;for(var c;c=da.exec(a);){var d=x(c[1],c[1]);c=c[2]?x(c[2].replace(/\+/g," "),c[2]):"";b[d]=c}return b};var z="";
function A(){var a,b=a||self;if(b.__AMP_MODE)var c=b.__AMP_MODE;else{c=b;var d=self.AMP_CONFIG||{},e=!!d.test||!1,g=y(c.location.originalHash||c.location.hash);d=d.spt;var l=y(c.location.search);z||(z=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"012004172112280");c={localDev:!1,development:!!(0<=["1","actions","amp","amp4ads","amp4email"].indexOf(g.development)||c.AMP_DEV_MODE),examiner:"2"==g.development,esm:!1,geoOverride:g["amp-geo"],minified:!0,lite:void 0!=l.amp_lite,test:e,log:g.log,version:"2004172112280",
rtvVersion:z,singlePassType:d};c=b.__AMP_MODE=c}return c};var B=self.AMP_CONFIG||{},ha=("string"==typeof B.cdnProxyRegex?new RegExp(B.cdnProxyRegex):B.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function C(a){if(self.document&&self.document.head&&(!self.location||!ha.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}B.cdnUrl||C("runtime-host");B.geoApiUrl||C("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var D=self.__AMP_LOG;function F(){if(!D.user)throw Error("failed to call initLogConstructor");return D.user}function G(a,b){F().assert(a,b,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};var ia={type:!0,"rtc-config":!0};function H(a,b){if(!a[b])return{};if("[object Object]"!==ca.call(a[b])||Array.isArray(a[b]))return F().warn("amp-auto-ads",b+" property not an object"),{};b=a[b];var c={},d;for(d in b)if(ia[d]||v(d,"data-")){var e=typeof b[d];"number"!=e&&"string"!=e&&"boolean"!=e?F().warn("amp-auto-ads","Attribute type not supported: "+e):c[d]=String(b[d])}else F().warn("amp-auto-ads","Attribute not whitlisted: "+d);return c};function ja(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b}function ka(a){return new Promise(function(b){b(a())})};function I(){var a=100;this.M=a;this.B=this.D=0;this.A=Object.create(null)}I.prototype.has=function(a){return!!this.A[a]};I.prototype.get=function(a){var b=this.A[a];if(b)return b.access=++this.B,b.payload};
I.prototype.put=function(a,b){this.has(a)||this.D++;this.A[a]={payload:b,access:this.B};if(!(this.D<=this.M)){if(D.dev)a=D.dev;else throw Error("failed to call initLogConstructor");a.warn("lru-cache","Trimming LRU cache");a=this.A;var c=this.B+1,d;for(d in a){var e=a[d].access;if(e<c){c=e;var g=d}}void 0!==g&&(delete a[g],this.D--)}};t({c:!0,v:!0,a:!0,ad:!0,action:!0});var J,K;
function L(a){var b;J||(J=self.document.createElement("a"),K=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new I));var c=b?null:K,d=J;if(c&&c.has(a))a=c.get(a);else{d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;
e.origin=d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;d=A().test&&Object.freeze?Object.freeze(e):e;c&&c.put(a,d);a=d}return a};function M(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return N(a,b)}function P(a,b){var c=la(a);c=la(c);c=c.isSingleDoc()?c.win:c;return N(c,b)}function la(a){return a.nodeType?M((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function N(a,b){var c=a.__AMP_SERVICES;c||(c=a.__AMP_SERVICES={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var Q;function R(a,b,c){a=a.createElement(b);for(var d in c)a.setAttribute(d,c[d]);return a}function ma(a,b){for(var c;a&&a!==c;a=a.parentElement)if(b(a))return a;return null}function na(a,b){return a.closest?a.closest(b):ma(a,function(a){var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;return c?c.call(a,b):!1})}
function oa(a,b){if(void 0!==Q)var c=Q;else{try{var d=a.ownerDocument,e=d.createElement("div"),g=d.createElement("div");e.appendChild(g);c=e.querySelector(":scope div")===g}catch(l){c=!1}c=Q=c}c?a=a.querySelectorAll(b.replace(/^|,/g,"$&:scope ")):(a.classList.add("i-amphtml-scoped"),b=b.replace(/^|,/g,"$&.i-amphtml-scoped "),b=a.querySelectorAll(b),a.classList.remove("i-amphtml-scoped"),a=b);return a}
function pa(a){v(a.tagName,"AMP-");if(a.createdCallback)return Promise.resolve(a);if(!a.__AMP_UPG_PRM){var b=new ja;a.__AMP_UPG_PRM=b.promise;a.__AMP_UPG_RES=b.resolve}return a.__AMP_UPG_PRM};function S(a){return P(a,"documentInfo").get()}function T(a){return P(a,"viewport")};function qa(a){var b=P(a,"resources"),c=b.getResourceForElementOptional(a);if(c)return c.getPageLayoutBoxAsync();var d=M(a.ownerDocument.defaultView,"vsync");return d.measurePromise(function(){return T(a).getLayoutRect(a)})};var ra=["AMP-SIDEBAR","AMP-APP-BANNER"],sa={1:function(a,b){a.parentNode.insertBefore(b,a)},4:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},2:function(a,b){a.insertBefore(b,a.firstChild)},3:function(a,b){a.appendChild(b)}};function U(a,b,c,d,e,g){this.ampdoc=a;this.U=P(b,"mutator");this.H=b;this.V=c;this.P=d;this.I=e;this.S=g;this.F=null;this.l=0}U.prototype.getAdElement=function(){return this.F};
U.prototype.getEstimatedPosition=function(){var a=this;return qa(this.H).then(function(b){a:switch(a.V){case 1:case 2:b=b.top;break a;case 3:case 4:b=b.bottom;break a;default:throw Error("Unknown position");}return b})};
U.prototype.placeAd=function(a,b,c,d){var e=this;return this.getEstimatedPosition().then(function(g){return c.isTooNearAnAd(g).then(function(c){if(c)return e.l=3,e.l;e.F=d?ta(e,a):ua(e,a,b.width);e.P(e.H,e.getAdElement());return d?pa(e.getAdElement()).then(function(){return e.getAdElement().whenBuilt()}).then(function(){var a=!e.getAdElement().classList.contains("i-amphtml-layout-awaiting-size");e.l=a?2:1;return e.l}):Promise.resolve({height:b.height||250,margins:e.S}).then(function(a){return pa(e.getAdElement()).then(function(){return e.getAdElement().whenBuilt()}).then(function(){return e.U.requestChangeSize(e.getAdElement(),
a.height,a.width,a.margins)}).then(function(){e.l=2;return e.l},function(){e.l=1;return e.l})})})})};function ua(a,b,c){b=Object.assign(t({layout:c?"fixed":"fixed-height",height:"0",width:c?c:"auto","class":"i-amphtml-layout-awaiting-size"}),b,a.I);return R(a.ampdoc.win.document,"amp-ad",b)}
function ta(a,b){b=Object.assign(t({width:"100vw",height:"0",layout:"fixed","class":"i-amphtml-layout-awaiting-size","data-auto-format":"rspv","data-full-width":""}),b,a.I);return R(a.ampdoc.win.document,"amp-ad",b)}function va(a,b){var c=b.placements;if(!c)return F().info("amp-auto-ads","No placements in config"),[];var d=[];c.forEach(function(b){wa(a,b,d)});return d}
function wa(a,b,c){var d=sa[b.pos];if(d){var e=b.anchor;if(e){var g=xa(a.getRootNode(),e);if(g.length){var l=void 0;if(b.style){var w=parseInt(b.style.top_m,10),n=parseInt(b.style.bot_m,10);if(w||n)l={top:w||void 0,bottom:n||void 0}}g.forEach(function(e){if(ya(e,b.pos)){var g=H(b,"attributes");c.push(new U(a,e,b.pos,d,g,l))}})}else F().warn("amp-auto-ads","No anchor element found")}else F().warn("amp-auto-ads","No anchor in placement")}else F().warn("amp-auto-ads","No injector for position")}
function xa(a,b){var c=b.selector;if(!c)return F().warn("amp-auto-ads","No selector in anchor"),[];c=[].slice.call(oa(a.documentElement||a,c));var d=b.min_c||0;0<d&&(c=c.filter(function(a){return a.textContent.length>=d}));"number"!=typeof b.index&&b.all||(c=(c=c[b.index||0])?[c]:[]);if(0==c.length)return[];if(b.sub){var e=[];c.forEach(function(a){e=e.concat(xa(a,b.sub))});return e}return c}
function ya(a,b){var c=1==b||4==b?a.parentElement:a;if(!c)return F().warn("amp-auto-ads","Parentless anchor with BEFORE/AFTER position."),!1;var d=c;return!ra.some(function(a){return na(d,a)?(F().warn("amp-auto-ads","Placement inside blacklisted ancestor: "+a),!0):!1})};function V(a,b){var c=4096,d,e=[],g=d&&null!=d.value&&""!==d.value?encodeURIComponent(d.name)+"="+encodeURIComponent(String(d.value)):null,l=c-a.length;g&&(l-=g.length+1);for(var w=Object.keys(b),n=0;n<w.length;n++){var E=w[n],q=b[E];if(null!=q&&""!==q){var r=encodeURIComponent(E)+"=",O=encodeURIComponent(String(q)),ea=r.length+O.length+1;if(ea>l){var fa=O.substr(0,l-r.length-1).replace(/%\w?$/,"");fa&&e.push(r+fa);g&&e.push(g);break}e.push(r+O);l-=ea}}return e.length?a+"?"+e.join("&"):a};function za(a){this.j=a}f=za.prototype;f.isEnabled=function(){return!0};f.isResponsiveEnabled=function(){return!0};f.getConfigUrl=function(){var a=S(this.j),b=L(a.canonicalUrl).hostname,c=this.j.ownerDocument.defaultView;return V("//pagead2.googlesyndication.com/getconfig/ama",{client:this.j.getAttribute("data-ad-client"),plah:b,ama_t:"amp",url:a.canonicalUrl,debug_experiment_id:(/(?:#|,)deid=([\d,]+)/i.exec(c.location.hash)||[])[1]||null})};
f.getAttributes=function(){var a=t({type:"adsense","data-ad-client":this.j.getAttribute("data-ad-client")}),b=this.j.getAttribute("data-ad-host"),c=this.j.getAttribute("data-ad-host-channel");b&&(a["data-ad-host"]=b,c&&(a["data-ad-host-channel"]=c));return a};f.getDefaultAdConstraints=function(){var a=T(this.j).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};f.getSizing=function(){return{}};function Aa(a){this.j=a}f=Aa.prototype;f.isEnabled=function(){return!0};f.isResponsiveEnabled=function(){return!1};f.getConfigUrl=function(){var a=S(this.j),b=this.j.getAttribute("data-publisher-id"),c=this.j.getAttribute("data-tag-id");return V("//v2.denakop.com/ad-request/amp",{p:b,t:c,u:a.canonicalUrl,w:window.screen.width,h:window.screen.height})};f.getAttributes=function(){return t({layout:"fixed","data-multi-size-validation":"false",type:"doubleclick","data-ad":"denakop"})};
f.getDefaultAdConstraints=function(){var a=T(this.j).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};f.getSizing=function(){return{}};function Ba(a){this.j=a}f=Ba.prototype;f.isEnabled=function(){return!0};f.isResponsiveEnabled=function(){return!1};f.getConfigUrl=function(){var a=S(this.j),b=L(a.canonicalUrl).hostname;return V("//pagead2.googlesyndication.com/getconfig/ama",{client:this.j.getAttribute("data-ad-legacy-client"),plah:b,ama_t:"amp",url:a.canonicalUrl})};f.getAttributes=function(){return t({type:"doubleclick","data-slot":this.j.getAttribute("data-slot"),json:this.j.getAttribute("data-json")})};
f.getDefaultAdConstraints=function(){var a=T(this.j).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};f.getSizing=function(){var a=this.j.getAttribute("data-experiment");try{var b=JSON.parse(a)}catch(d){b=null}var c=b;return c?{height:c.height?Number(c.height):250,width:c.width?Number(c.width):void 0}:{}};function Ca(a){this.j=a}f=Ca.prototype;f.isEnabled=function(){return!0};f.isResponsiveEnabled=function(){return!0};f.getConfigUrl=function(){return V("//lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n",{})};f.getAttributes=function(){return t({type:"_ping_"})};f.getDefaultAdConstraints=function(){var a=T(this.j).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};f.getSizing=function(){return{}};function Da(a,b){return(A().test||A().localDev)&&"_ping_"==a?new Ca(b):"adsense"==a?new za(b):"denakop"==a?new Aa(b):"doubleclick"==a?new Ba(b):null};function Ea(a,b,c,d,e){e=void 0===e?!1:e;this.L=a.slice(0);this.C=b;this.W=c;this.m=d;this.G=0;this.R=e}Ea.prototype.run=function(){var a=this;return this.m.isMaxAdCountReached()?ka(function(){return Fa(a)}):Ga(this).then(function(b){return b?a.run():Fa(a)})};function Fa(a){return{adsPlaced:a.G,totalAdsOnPage:a.m.getAdCount()}}
function Ga(a){var b=a.L.shift();return b?b.placeAd(a.C,a.W,a.m,a.R).then(function(c){return 2==c?(a.m.addAd(b.getAdElement()),a.G++,!0):Ga(a)}):(F().info("amp-auto-ads","unable to fulfill ad strategy"),Promise.resolve(!1))};function W(a,b){this.o=a;this.O=b.initialMinSpacing;this.K=b.subsequentMinSpacing.slice(0).sort(function(a,b){return a.adCount-b.adCount});this.T=b.maxAdCount;this.J=Ha(this)}W.prototype.addAd=function(a){this.o.push(a);this.J=Ha(this)};W.prototype.getAdCount=function(){return this.o.length};W.prototype.isMaxAdCountReached=function(){return this.getAdCount()>=this.T};W.prototype.isTooNearAnAd=function(a){return Ia(this,a,0)};
function Ia(a,b,c){return c>=a.o.length?Promise.resolve(!1):Ja(b,a.o[c]).then(function(d){return d<a.J?!0:Ia(a,b,c+1)})}function Ja(a,b){return qa(b).then(function(b){return a>=b.top&&a<=b.bottom?0:Math.min(Math.abs(a-b.top),Math.abs(a-b.bottom))})}function Ha(a){for(var b=a.getAdCount(),c=a.O,d=0;d<a.K.length;d++){var e=a.K[d];e.adCount<=b&&(c=e.spacing)}return c}
function Ka(a){return[].slice.call(a.getRootNode().querySelectorAll("AMP-AD")).filter(function(a){return a.parentElement&&"AMP-STICKY-AD"==a.parentElement.tagName?!1:!0})}
function La(a,b){b=b.adConstraints;if(!b)return null;var c=T(a).getHeight(),d=Ma(b.initialMinSpacing,c);if(null==d)return F().warn("amp-auto-ads","Invalid initial min spacing"),null;var e=(b.subsequentMinSpacing||[]).map(function(a){var b=a.adCount;if(null==b)return F().warn("amp-auto-ads","No subsequentMinSpacing adCount specified"),null;a=Ma(a.spacing,c);return null==a?(F().warn("amp-auto-ads","Invalid subsequent min spacing"),null):{adCount:b,spacing:a}});return-1!=e.indexOf(null)?null:null==b.maxAdCount?
(F().warn("amp-auto-ads","No maxAdCount specified"),null):{initialMinSpacing:d,subsequentMinSpacing:e,maxAdCount:b.maxAdCount}}function Ma(a,b){if(!a)return null;var c=parseFloat(a);return isNaN(c)||0>c?null:u(a,"px")?c:u(a,"vp")?c*b:null};function Na(a,b,c){this.ampdoc=a;this.C=b;this.N=c}
Na.prototype.run=function(){if(this.ampdoc.getRootNode().querySelector("AMP-STICKY-AD"))return F().warn("amp-auto-ads","Auto ads may not work because of already existing <amp-sticky-ad>."),Promise.resolve(!1);if(!F().assertArray(this.N.optInStatus||[]).includes(2))return Promise.resolve(!1);M(this.ampdoc.win,"extensions").installExtensionForDoc(this.ampdoc,"amp-sticky-ad","1.0");var a=T(this.ampdoc).getWidth(),b=Object.assign({},this.C,t({width:String(a),height:"100"}));a=this.ampdoc.win.document;
b=R(a,"amp-ad",b);a=R(a,"amp-sticky-ad",t({layout:"nodisplay"}));a.appendChild(b);b=this.ampdoc.getBody();b.insertBefore(a,b.firstChild);return Promise.resolve(!0)};function X(){return AMP.BaseElement.apply(this,arguments)||this}var Y=AMP.BaseElement;X.prototype=aa(Y.prototype);X.prototype.constructor=X;if(p)p(X,Y);else for(var Z in Y)if("prototype"!=Z)if(Object.defineProperties){var Oa=Object.getOwnPropertyDescriptor(Y,Z);Oa&&Object.defineProperty(X,Z,Oa)}else X[Z]=Y[Z];X.X=Y.prototype;
X.prototype.buildCallback=function(){var a=this,b=this.element.getAttribute("type");G(b,"Missing type attribute");var c=Da(b,this.element);G(c,"No AdNetworkConfig for type: "+b);if(c.isEnabled(this.win)){var d=this.getAmpDoc();M(this.win,"extensions").installExtensionForDoc(d,"amp-ad");var e=this.getAmpDoc().whenFirstVisible();e.then(function(){return Pa(a,c.getConfigUrl())}).then(function(b){if(b){var e=b.noConfigReason;e&&a.user().warn("amp-auto-ads",e);var g=va(d,b),n=Object.assign(t({}),c.getAttributes(),
H(b,"attributes")),E=c.getSizing(),q=La(d,b)||c.getDefaultAdConstraints();q=new W(Ka(d),q);(new Ea(g,n,E,q,c.isResponsiveEnabled())).run();var r=Object.assign(t({}),n,H(b,"stickyAdAttributes"));(new Na(d,r,b)).run()}})}};X.prototype.isLayoutSupported=function(){return!0};
function Pa(a,b){var c={mode:"cors",method:"GET",credentials:"omit"};return M(a.win,"xhr").fetchJson(b,c).then(function(a){return a.json()}).catch(function(b){a.user().error("amp-auto-ads","amp-auto-ads config xhr failed: "+b);return null})}(function(a){a.registerElement("amp-auto-ads",X)})(self.AMP);
})});

//# sourceMappingURL=amp-auto-ads-0.1.js.map
