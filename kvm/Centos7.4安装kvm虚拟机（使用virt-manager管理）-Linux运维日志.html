<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
<title>Centos7.4安装kvm虚拟机（使用virt-manager管理）-Linux运维日志</title>
<link rel='dns-prefetch' href='//www.centos.bz' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Linux运维日志 &raquo; Centos7.4安装kvm虚拟机（使用virt-manager管理）评论Feed" href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/feed/" />
<link rel='stylesheet' id='dwqa-style-css'  href='https://www.centos.bz/wp-content/plugins/dw-question-answer/templates/assets/css/style.css?ver=180720161352' type='text/css' media='all' />
<link rel='stylesheet' id='dwqa-rtl-css'  href='https://www.centos.bz/wp-content/plugins/dw-question-answer/templates/assets/css/rtl.css?ver=180720161352' type='text/css' media='all' />
<link rel='stylesheet' id='main-css'  href='https://www.centos.bz/wp-content/themes/xiu/style.css?ver=5.3' type='text/css' media='all' />
<script type='text/javascript' src='https://www.centos.bz/wp-content/themes/xiu/js/jquery.js?ver=5.3'></script>
<link rel='https://api.w.org/' href='https://www.centos.bz/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.centos.bz/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.centos.bz/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='在kubernetes集群中创建redis主从多实例' href='https://www.centos.bz/2018/02/%e5%9c%a8kubernetes%e9%9b%86%e7%be%a4%e4%b8%ad%e5%88%9b%e5%bb%baredis%e4%b8%bb%e4%bb%8e%e5%a4%9a%e5%ae%9e%e4%be%8b/' />
<link rel='next' title='修改kvm虚拟机镜像文件大小' href='https://www.centos.bz/2018/02/%e4%bf%ae%e6%94%b9kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%e9%95%9c%e5%83%8f%e6%96%87%e4%bb%b6%e5%a4%a7%e5%b0%8f/' />
<meta name="generator" content="WordPress 4.9" />
<link rel="canonical" href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/" />
<link rel='shortlink' href='https://www.centos.bz/?p=18467' />
<link rel="alternate" type="application/json+oembed" href="https://www.centos.bz/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.centos.bz%2F2018%2F02%2Fcentos7-4%25e5%25ae%2589%25e8%25a3%2585kvm%25e8%2599%259a%25e6%258b%259f%25e6%259c%25ba%25ef%25bc%2588%25e4%25bd%25bf%25e7%2594%25a8virt-manager%25e7%25ae%25a1%25e7%2590%2586%25ef%25bc%2589%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.centos.bz/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.centos.bz%2F2018%2F02%2Fcentos7-4%25e5%25ae%2589%25e8%25a3%2585kvm%25e8%2599%259a%25e6%258b%259f%25e6%259c%25ba%25ef%25bc%2588%25e4%25bd%25bf%25e7%2594%25a8virt-manager%25e7%25ae%25a1%25e7%2590%2586%25ef%25bc%2589%2F&#038;format=xml" />
<link rel="stylesheet" href="https://www.centos.bz/wp-content/plugins/coolcode/coolcode.css" />
<script type="text/javascript" src="https://www.centos.bz/wp-content/plugins/coolcode/coolcode.js"></script>
<link rel="stylesheet" href="https://www.centos.bz/wp-content/plugins/wp-content-index/style.css" type="text/css" media="all" />
<meta name="keywords" content="CentOS, KVM, virt-manager, 未分类">
<meta name="description" content="之前介绍了使用WebVirtMgr或Openstack来部署及管理kvm虚拟机，下面简单介绍centos7.4下使用virt-manager部署及管理kvm虚拟">
<link rel="shortcut icon" href="https://www.centos.bz/favicon.ico">
<!--[if lt IE 9]><script src="https://www.centos.bz/wp-content/themes/xiu/js/html5.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-18467 single-format-standard post_p_indent excerpt_thumb_left ui-navtop">
<header class="header">
<div class="container">
	<div class="logo"><a href="https://www.centos.bz" title="Linux运维日志-关于CentOS和Ubuntu等系统的运维"><img src="https://www.centos.bz/wp-content/themes/xiu/images/logo.png" alt="Linux运维日志">Linux运维日志</a></div>	<ul class="nav"><li class="navmore"></li><li id="menu-item-16868" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16868"><a href="https://www.centos.bz/tag/docker/">Docker</a></li>
<li id="menu-item-16869" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16869"><a href="https://www.centos.bz/tag/nginx-2/">Nginx</a></li>
<li id="menu-item-17892" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17892"><a href="https://www.centos.bz/tag/apache/">Apache</a></li>
<li id="menu-item-16870" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16870"><a href="https://www.centos.bz/tag/mysql-2/">MySQL</a></li>
<li id="menu-item-16871" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16871"><a href="https://www.centos.bz/tag/zabbix/">Zabbix</a></li>
<li id="menu-item-16872" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16872"><a href="https://www.centos.bz/tag/saltstack/">SaltStack</a></li>
<li id="menu-item-16873" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16873"><a href="https://www.centos.bz/tag/kubernetes/">K8S</a></li>
<li id="menu-item-16876" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16876"><a href="https://www.centos.bz/tag/openresty/">OpenResty</a></li>
<li id="menu-item-17893" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17893"><a href="https://www.centos.bz/tag/wordpress/">WordPress</a></li>
</ul>	<form method="get" class="search-form" action="https://www.centos.bz/" ><input class="form-control" name="s" type="text" placeholder="输入关键字" value=""><input class="btn" type="submit" value="搜索"></form>		<div class="feeds">
			</div>
	<div class="slinks">
			</div>

	</div>
</header>
<section class="container">
<div class="content-wrap">
	<div class="content">
				<header class="article-header">
						<div class="breadcrumbs"><span class="text-muted">当前位置：</span><a href="https://www.centos.bz">Linux运维日志</a> <small>></small> <a href="https://www.centos.bz/category/undefine/">未分类</a> <small>></small> <span class="text-muted">正文</span></div>
						<h1 class="article-title"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/">Centos7.4安装kvm虚拟机（使用virt-manager管理）</a></h1>
			<ul class="article-meta">
								<li>sa 发布于 2018-02-05</li>
				<li>分类：<a href="https://www.centos.bz/category/undefine/" rel="category tag">未分类</a></li>
				<li><span class="post-views">阅读(12263)</span></li>
				<li>评论(0)</li>
				<li></li>
			</ul>
		</header>
				<article class="article-content">
		<!-- <blockquote><p>有运维或运维开发方面的需求，可以联系博主QQ 452336092或Email:admin#centos.bz(收费)</p></blockquote> -->

			<div id="content-index" class="content-index" style="margin:0 0 10px 10px;float:right;"><div class="content-index-title">文章目录</div><span class="content-index-toctoggle">[<a id="content-index-togglelink" href="javascript:content_index_toggleToc()">隐藏</a>]</span>
<script type="text/javascript" language="javascript">
window.content_index_showTocToggle=true;function content_index_toggleToc(){var tts="显示";var tth="隐藏";if(window.content_index_showTocToggle){window.content_index_showTocToggle=false;document.getElementById("content-index-contents").style.display="none";document.getElementById("content-index-togglelink").innerHTML=tts}else{window.content_index_showTocToggle=true;document.getElementById("content-index-contents").style.display="block";document.getElementById("content-index-togglelink").innerHTML=tth}}
</script>
<ul id="content-index-contents"><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#0）KVM是什么" title="0）KVM是什么"><span>0）KVM是什么</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#1）kvm相关安装包及其作用" title="1）kvm相关安装包及其作用"><span>1）kvm相关安装包及其作用</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#2）centos7安装VNC环境" title="2）centos7安装VNC环境"><span>2）centos7安装VNC环境</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#3）安装kvm" title="3）安装kvm"><span>3）安装kvm</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#4）使用virt-manager管理kvm（通过VNC连接服务器）" title="4）使用virt-manager管理kvm（通过VNC连接服务器）"><span>4）使用virt-manager管理kvm（通过VNC连接服务器）</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#5）解决KVM虚拟机在使用vnc连接时鼠标不同步的问题" title="5）解决KVM虚拟机在使用vnc连接时鼠标不同步的问题"><span>5）解决KVM虚拟机在使用vnc连接时鼠标不同步的问题</span></a></li><li class="content-index-level-1"><a href="https://www.centos.bz/2018/02/centos7-4%e5%ae%89%e8%a3%85kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%ef%bc%88%e4%bd%bf%e7%94%a8virt-manager%e7%ae%a1%e7%90%86%ef%bc%89/#6）重定向USB设备" title="6）重定向USB设备"><span>6）重定向USB设备</span></a></li></ul></div>
<p>之前介绍了使用WebVirtMgr或<a href="https://www.centos.bz/tag/openstack/">Openstack</a>来部署及管理kvm虚拟机，下面简单介绍<a href="https://www.centos.bz/tag/centos7/">centos7</a>.4下使用virt-manager部署及管理kvm虚拟机的做法：</p>
<h2 id="0）KVM是什么">0）KVM是什么</h2>
<p>KVM(Kernel-based Virtual <a href="https://www.centos.bz/tag/machine/">Machine</a>, 即内核级虚拟机) 是一个开源的系统虚拟化模块。它使用<a href="https://www.centos.bz/tag/linux/">Linux</a>自身的调度器进行管理，所以相对于Xen，其核心<br />
源码很少。目前KVM已成为学术界的主流VMM之一，它包含一个为处理器提供底层虚拟化 可加载的核心模块kvm.ko(kvm-intel.ko 或 kvm-amd.ko)。kvm<br />
还需要一个经过修改的QEMU 软件(<a href="https://www.centos.bz/tag/qemu-kvm/">qemu-kvm</a>)，作为虚拟机上层控制和界面。KVM的虚拟化需要硬件支持(如 Intel VT技术或者AMD V技术)。是基于硬件的<br />
完全虚拟化。 KVM可以运行多个其本身运行未改动的镜像的虚拟机，例如<a href="https://www.centos.bz/category/other-system/windows/">Windows</a>，Mac OS X ，每个虚拟机都有各自的虚拟硬件，比如网卡、硬盘核图形适配<br />
器等。</p>
<p>KVM和QEMU的关系<br />
QEMU是个独立的虚拟化解决方案，从这个角度它并不依赖KVM。而KVM是另一套虚拟化解决方案，不过因为这个方案实际上只实现了内核中对处理器（Intel VT）<br />
, AMD SVM)虚拟化特性的支持，换言之，它缺乏设备虚拟化以及相应的用户空间管理虚拟机的工具，所以它借用了QEMU的代码并加以精简，连同KVM一起构成了<br />
另一个独立的虚拟化解决方案：KVM+QEMU。</p>
<h2 id="1）kvm相关安装包及其作用">1）kvm相关安装包及其作用</h2>
<pre><code>qemu-kvm          主要的KVM程序包
<a href="https://www.centos.bz/category/python/">python</a>-virtinst   创建虚拟机所需要的命令行工具和程序库
virt-manager      GUI虚拟机管理工具
virt-top          虚拟机统计命令
virt-viewer       GUI连接程序，连接到已配置好的虚拟机
libvirt           C语言工具包，提供libvirt服务
libvirt-client    虚拟客户机提供的C语言工具包
virt-install      基于libvirt服务的虚拟机创建命令
bridge-utils      创建和管理桥接设备的工具
</code></pre>
<h2 id="2）centos7安装VNC环境">2）centos7安装VNC环境</h2>
<p>请参考：http://www.cnblogs.com/kevingrace/p/5821450.html</p>
<h2 id="3）安装kvm">3）安装kvm</h2>
<pre><code>1）检查cpu是否支持虚拟化
[root@kevin ~]# grep vmx /proc/cpuinfo
如果有vmx信息输出，就说明支持VT;如果没有任何的输出，说明你的cpu不支持，将无法使用KVM虚拟机。


2）确保BIOS里开启虚拟化功能，即查看是否加载KVM模块
[root@kevin ~]# lsmod | grep kvm
kvm_intel             170086  0
kvm                   566340  1 kvm_intel
irqbypass              13503  1 kvm
=========================================================
如果没有加载，运行以下命令：
[root@kevin ~]# modprobe kvm
[root@kevin ~]# modprobe kvm-intel
[root@kevin ~]# lsmod | grep kvm
kvm_intel             170086  0
kvm                   566340  1 kvm_intel
irqbypass              13503  1 kvm
=========================================================

内核模块导出了一个名为/dev/kvm的设备，这个设备将虚拟机的的地址空间独立于内核或者任何应用程序的地址空间。
[root@kevin ~]# ll /dev/kvm
crw-rw-rw-. 1 root kvm 10, 232 1月  29 11:56 /dev/kvm


3）桥接网络
如果没有brctl命令（用来管理网桥的工具），则需要安装bridge-utils ，
[root@kevin ~]# yum -y install bridge-utils
[root@kevin ~]# <a href="https://www.centos.bz/tag/systemctl/">systemctl</a> restart network

配置KVM的网桥模式
[root@kevin ~]# cd /etc/sysconfig/network-scripts/
[root@openstack network-scripts]# cp ifcfg-eno1 ifcfg-br0
[root@openstack network-scripts]# cat ifcfg-br0
TYPE="Bridge"                                        //这一行修改为Bridge
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="none"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="no"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="br0"                                           //修改设备名称为br0
#UUID="fdbad04f-dae3-440e-8a8b-01d6a7bc9fe0"         //这一行注释
DEVICE="br0"                                         //修改设备为br0
ONBOOT="yes"
IPADDR="192.168.10.210"
PREFIX="24"
GATEWAY="192.168.10.1"
DNS1="8.8.8.8"

[root@openstack network-scripts]# cat ifcfg-eno1
TYPE="Ethernet"
BRIDGE=br0                                           //添加这一行
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="none"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="no"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="eno1"
UUID="fdbad04f-dae3-440e-8a8b-01d6a7bc9fe0"
DEVICE="eno1"
ONBOOT="yes"
#IPADDR="192.168.10.210"                          //注释掉这几行
#PREFIX="24"
#GATEWAY="192.168.10.1"
#DNS1="8.8.8.8"

重启网卡服务
[root@openstack network-scripts]# systemctl restart network

查看网卡
[root@openstack network-scripts]# brctl show
bridge name bridge id   STP enabled interfaces
br0   8000.0894ef518b22 no    eno1
virbr0    8000.52540095d7c2 yes   virbr0-nic

查看ip信息
[root@openstack network-scripts]# ifconfig |head -20
br0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.10.210  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::a94:efff:fe51:8b22  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 08:94:ef:51:8b:22  txqueuelen 1000  (Ethernet)
        RX packets 856  bytes 52981 (51.7 KiB)
        RX errors 0  dropped 2  overruns 0  frame 0
        TX packets 120  bytes 23450 (22.9 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eno1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        ether 08:94:ef:51:8b:22  txqueuelen 1000  (Ethernet)
        RX packets 10077  bytes 793083 (774.4 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1184  bytes 228415 (223.0 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 16 

eno2: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        ether 08:94:ef:51:8b:23  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)


[root@openstack network-scripts]# ping www.baidu.com
PING www.a.shifen.com (61.135.169.121) 56(84) bytes of data.
64 bytes from 61.135.169.121 (61.135.169.121): icmp_seq=1 ttl=55 time=2.08 ms
64 bytes from 61.135.169.121 (61.135.169.121): icmp_seq=2 ttl=55 time=1.80 ms
........


4）安装libvirt及kvm
libvirt是管理虚拟机的API库，不仅支持KVM虚拟机，也可以管理Xen等方案下的虚拟机。
[root@kevin ~]#  yum -y install libcanberra-gtk2 qemu-kvm.x86_64 qemu-kvm-tools.x86_64  libvirt.x86_64 libvirt-cim.x86_64 libvirt-client.x86_64
libvirt-java.noarch  libvirt-<a href="https://www.centos.bz/tag/python-3/">python</a>.x86_64 libiscsi-1.7.0-5.el6.x86_64  dbus-devel  virt-clone tunctl virt-manager libvirt libvirt-python python-virtinst

由于要用virt-manager图形化安装虚拟机，所以还需要安装X-window（这个在前面部署VNC环境里就已经安装了）
[root@kevin ~]# yum groupinstall "X Window System"

安装中文字符，解决界面乱码问题
[root@kevin ~]# yum install -y dejavu-lgc-sans-fonts
[root@kevin ~]# yum groupinstall -y "Fonts"

启用libvirt
[root@kevin ~]# systemctl enable libvirtd
[root@kevin ~]# systemctl start libvirtd
</code></pre>
<h2 id="4）使用virt-manager管理kvm（通过VNC连接服务器）">4）使用virt-manager管理kvm（通过VNC连接服务器）</h2>
<p>提前将ISO系统镜像存放到服务器的一个目录里，比如/data/iso</p>
<pre><code>[root@openstack ~]# mkdir /data/iso
[root@openstack ios]# ll
总用量 3356384
-rw-r--r--. 1 qemu qemu 3436937216 1月  29 11:41 win-server2008_R2.iso
</code></pre>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/1-9.png" alt="" width="407" height="207" class="alignnone size-full wp-image-18468" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/2-9.png" alt="" width="1016" height="556" class="alignnone size-full wp-image-18469" srcset="https://www.centos.bz/wp-content/uploads/2018/02/2-9.png 1016w, https://www.centos.bz/wp-content/uploads/2018/02/2-9-768x420.png 768w" sizes="(max-width: 1016px) 100vw, 1016px" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/3-4.png" alt="" width="544" height="528" class="alignnone size-full wp-image-18470" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/4-3.png" alt="" width="544" height="526" class="alignnone size-full wp-image-18471" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/5-3.png" alt="" width="471" height="464" class="alignnone size-full wp-image-18472" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/6-3.png" alt="" width="791" height="663" class="alignnone size-full wp-image-18473" srcset="https://www.centos.bz/wp-content/uploads/2018/02/6-3.png 791w, https://www.centos.bz/wp-content/uploads/2018/02/6-3-768x644.png 768w" sizes="(max-width: 791px) 100vw, 791px" /></p>
<h2 id="5）解决KVM虚拟机在使用vnc连接时鼠标不同步的问题">5）解决KVM虚拟机在使用vnc连接时鼠标不同步的问题</h2>
<p>在VNC界面中感觉virt-manager管理的虚拟机界面总是鼠标跟不上，指到哪儿也看不出来，界面上一直显示press control_l+a/t_l来移动鼠标!十分郁闷！<br />
想要修改鼠标和宿主机界面同步方法如下：</p>
<pre><code>[root@openstack ~]# cd /etc/libvirt/qemu
[root@openstack qemu]# ls
networks  test-win2008.xml
[root@openstack qemu]# cp test-win2008.xml /opt/
[root@openstack qemu]# vim test-win2008.xml               //在&lt;devices&gt;标签中添加下面这段配置
&lt;devices&gt;   
......                                      
  &lt;input type='tablet' bus='usb'/&gt;                        //即添加这句话即可！
......    
&lt;/devices&gt;

[root@openstack qemu]# <a href="https://www.centos.bz/tag/virsh/">virsh</a> define /etc/libvirt/qemu/test-win2008.xml
定义域 test-win2008（从 /etc/libvirt/qemu/test-win2008.xml）
</code></pre>
<p>然后重启虚拟机后，发现虚拟机中的鼠标就会好事了，打开VNC查看虚拟机界面后默认情况下虚拟机中的鼠标指针和实体机的鼠标指针就是重合的，且两者运动速度也是同步的，<br />
这下就彻底解决了鼠标指针漂移/不同步的情况了！</p>
<h2 id="6）重定向USB设备">6）重定向USB设备</h2>
<p>（即将宿主机上的USB设备指定到目标虚拟机上）。适合挂载银行前置机设备！</p>
<p>先将USB设备插到宿主机上，接着在virt-manager界面里打开虚拟机，然后虚拟机界面上栏里打开&#8221;虚拟机&#8221;->&#8221;重定向USB设备（R）&#8221;。（特别注意：如下选择将usb设备挂载到虚拟机上后，不要关闭这个挂载界面，否则usb挂载动作就会结束！）</p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/7-3.png" alt="" width="852" height="338" class="alignnone size-full wp-image-18474" srcset="https://www.centos.bz/wp-content/uploads/2018/02/7-3.png 852w, https://www.centos.bz/wp-content/uploads/2018/02/7-3-768x305.png 768w" sizes="(max-width: 852px) 100vw, 852px" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/8-1.png" alt="" width="350" height="187" class="alignnone size-full wp-image-18475" /></p>
<p>查看虚拟机，发现指定的USB设备已经挂载到该虚拟机上了！</p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/9-1.png" alt="" width="800" height="504" class="alignnone size-full wp-image-18476" srcset="https://www.centos.bz/wp-content/uploads/2018/02/9-1.png 800w, https://www.centos.bz/wp-content/uploads/2018/02/9-1-768x484.png 768w" sizes="(max-width: 800px) 100vw, 800px" /></p>
<p>如果要卸载该虚拟机上挂载的这个USB设备，即在&#8221;重定向设备usb（R）&#8221;里将这个USB设备去掉，然后&#8221;确定&#8221;即可！</p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/10-1.png" alt="" width="360" height="203" class="alignnone size-full wp-image-18477" /></p>
<p><img src="https://www.centos.bz/wp-content/uploads/2018/02/11-1.png" alt="" width="793" height="495" class="alignnone size-full wp-image-18478" srcset="https://www.centos.bz/wp-content/uploads/2018/02/11-1.png 793w, https://www.centos.bz/wp-content/uploads/2018/02/11-1-768x479.png 768w" sizes="(max-width: 793px) 100vw, 793px" /></p>			        	<p class="post-copyright">原文出处：cnblogs -> <a rel="nofollow" href="http://www.cnblogs.com/kevingrace/p/8377645.html">http://www.cnblogs.com/kevingrace/p/8377645.html</a></p>		</article>
		           <div class="gave">
            <p><a href="javascript:;" id="gave">打赏</a></p>
<p>如果此文对你有所帮助，请随意打赏鼓励作者^_^</p>
            <div class="code" id="wechatCode" style="display: none;">
                <img src="https://www.centos.bz/wp-content/uploads/2016/11/weixin_reward.jpg" alt="微信扫一扫支付" data-tag="bdshare">
                <div><img src="https://www.centos.bz/wp-content/plugins/wechat-reward/assets/ico-wechat.jpg" alt="微信logo" class="ico-wechat" data-tag="bdshare">微信扫一扫，打赏作者吧～</div>
            </div>
        </div>
       
				
		<div class="article-tags">
			标签：<a href="https://www.centos.bz/tag/centos/" rel="tag">CentOS</a><a href="https://www.centos.bz/tag/kvm/" rel="tag">KVM</a><a href="https://www.centos.bz/tag/virt-manager/" rel="tag">virt-manager</a>		</div>
		<nav class="article-nav">
			<span class="article-nav-prev">上一篇<br><a href="https://www.centos.bz/2018/02/%e5%9c%a8kubernetes%e9%9b%86%e7%be%a4%e4%b8%ad%e5%88%9b%e5%bb%baredis%e4%b8%bb%e4%bb%8e%e5%a4%9a%e5%ae%9e%e4%be%8b/" rel="prev">在kubernetes集群中创建redis主从多实例</a></span>
			<span class="article-nav-next">下一篇<br><a href="https://www.centos.bz/2018/02/%e4%bf%ae%e6%94%b9kvm%e8%99%9a%e6%8b%9f%e6%9c%ba%e9%95%9c%e5%83%8f%e6%96%87%e4%bb%b6%e5%a4%a7%e5%b0%8f/" rel="next">修改kvm虚拟机镜像文件大小</a></span>
		</nav>
		<div class="ads ads-content ads-related"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 全站文章顶部728*90 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-7207924189700482"
     data-ad-slot="4668235082"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>		<div class="relates relates-model-thumb"><h3 class="title"><strong>相关推荐</strong></h3><ul><li><a href="https://www.centos.bz/2019/07/centos7%e4%b8%adlvm%e5%88%86%e5%8c%ba%e7%9a%84%e5%88%9b%e5%bb%ba%e4%b8%8e%e6%89%a9%e5%b1%95/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>centos7中lvm分区的创建与扩展</a></li><li><a href="https://www.centos.bz/2019/07/centos7-cacti-%e4%bd%bf%e7%94%a8%e7%ac%94%e8%ae%b0/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>Centos7 cacti 使用笔记</a></li><li><a href="https://www.centos.bz/2019/07/%e5%9c%a8centos%e4%b8%8a%e5%ae%89%e8%a3%85%e6%90%ad%e5%bb%baphpapachemysql%e7%9a%84%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%8e%af%e5%a2%83%e6%96%b9%e6%b3%95/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>在CentOS上安装搭建PHP+Apache+Mysql的服务器环境方法</a></li><li><a href="https://www.centos.bz/2019/06/centos7%e4%b8%8b%e4%bd%bf%e7%94%a8yum%e5%ae%89%e8%a3%85jenkins%e4%bb%a5%e5%8f%8a%e8%bf%90%e8%a1%8cjenkins/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>centOS7下使用yum安装jenkins以及运行jenkins</a></li><li><a href="https://www.centos.bz/2019/06/centos-7-6%e4%b8%8a%e9%83%a8%e7%bd%b2supervisor%e6%9d%a5%e7%9b%91%e6%8e%a7%e5%92%8c%e6%93%8d%e4%bd%9c%e5%90%84%e7%b1%bb%e6%9c%8d%e5%8a%a1/"><img data-original="https://www.centos.bz/wp-content/uploads/2019/06/1-11.png" class="thumb"/>CentOS 7.6上部署Supervisor来监控和操作各类服务</a></li><li><a href="https://www.centos.bz/2019/06/centos-debian-ubuntu%e7%b3%bb%e7%bb%9f%e4%b8%80%e9%94%ae%e9%94%90%e9%80%9f%e6%9b%b4%e6%8d%a2%e5%86%85%e6%a0%b8%e8%84%9a%e6%9c%ac/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>CentOS/Debian/Ubuntu系统一键锐速+更换内核脚本</a></li><li><a href="https://www.centos.bz/2019/02/centos%e9%83%a8%e7%bd%b2%e9%83%a8%e7%bd%b2edusoho/"><span><img data-original="https://www.centos.bz/wp-content/themes/xiu/images/thumbnail.png" class="thumb"/></span>CentOS部署部署Edusoho</a></li><li><a href="https://www.centos.bz/2019/02/centos-7%e5%ae%89%e8%a3%85deluge/"><img data-original="https://www.centos.bz/wp-content/uploads/2019/02/1-1-3.png" class="thumb"/>CentOS 7安装Deluge</a></li></ul></div>							</div>
</div>
<aside class="sidebar">	
<div class="widget widget_ads"><div class="widget_ads_inner"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 右侧300x250 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-7207924189700482"
     data-ad-slot="9461374684"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></div><div class="widget widget_tags"><h3 class="title"><strong>热门标签</strong></h3><ul class="widget_tags_inner"><li><a title="411个话题" href="https://www.centos.bz/tag/docker/">docker</a></li><li><a title="355个话题" href="https://www.centos.bz/tag/nginx-2/">nginx</a></li><li><a title="279个话题" href="https://www.centos.bz/tag/mysql-2/">mysql</a></li><li><a title="223个话题" href="https://www.centos.bz/tag/linux/">Linux</a></li><li><a title="212个话题" href="https://www.centos.bz/tag/centos/">CentOS</a></li><li><a title="130个话题" href="https://www.centos.bz/tag/ubuntu/">ubuntu</a></li><li><a title="112个话题" href="https://www.centos.bz/tag/zabbix/">zabbix</a></li><li><a title="103个话题" href="https://www.centos.bz/tag/python-3/">python</a></li><li><a title="97个话题" href="https://www.centos.bz/tag/apache/">apache</a></li><li><a title="95个话题" href="https://www.centos.bz/tag/redis/">redis</a></li><li><a title="91个话题" href="https://www.centos.bz/tag/git/">git</a></li><li><a title="88个话题" href="https://www.centos.bz/tag/kubernetes/">kubernetes</a></li><li><a title="83个话题" href="https://www.centos.bz/tag/mongodb/">mongodb</a></li><li><a title="79个话题" href="https://www.centos.bz/tag/wordpress/">wordpress</a></li><li><a title="79个话题" href="https://www.centos.bz/tag/jenkins/">Jenkins</a></li><li><a title="75个话题" href="https://www.centos.bz/tag/php/">PHP</a></li><li><a title="75个话题" href="https://www.centos.bz/tag/flask/">flask</a></li><li><a title="74个话题" href="https://www.centos.bz/tag/tomcat/">tomcat</a></li><li><a title="72个话题" href="https://www.centos.bz/tag/ansible/">ansible</a></li><li><a title="70个话题" href="https://www.centos.bz/tag/mariadb/">MariaDB</a></li><li><a title="69个话题" href="https://www.centos.bz/tag/ssh/">SSH</a></li><li><a title="61个话题" href="https://www.centos.bz/tag/saltstack/">saltstack</a></li><li><a title="53个话题" href="https://www.centos.bz/tag/iptables/">Iptables</a></li><li><a title="52个话题" href="https://www.centos.bz/tag/gitlab/">gitlab</a></li><li><a title="51个话题" href="https://www.centos.bz/tag/k8s/">k8s</a></li><li><a title="49个话题" href="https://www.centos.bz/tag/rsync/">rsync</a></li><li><a title="48个话题" href="https://www.centos.bz/tag/awk/">awk</a></li><li><a title="44个话题" href="https://www.centos.bz/tag/crontab/">crontab</a></li><li><a title="42个话题" href="https://www.centos.bz/tag/https/">https</a></li><li><a title="40个话题" href="https://www.centos.bz/tag/supervisor/">supervisor</a></li><li><a title="39个话题" href="https://www.centos.bz/tag/php-fpm/">php-fpm</a></li><li><a title="38个话题" href="https://www.centos.bz/tag/docker-compose/">docker compose</a></li><li><a title="35个话题" href="https://www.centos.bz/tag/haproxy/">haproxy</a></li><li><a title="35个话题" href="https://www.centos.bz/tag/postgresql/">PostgreSQL</a></li><li><a title="35个话题" href="https://www.centos.bz/tag/innodb/">innodb</a></li><li><a title="34个话题" href="https://www.centos.bz/tag/nfs/">NFS</a></li><li><a title="33个话题" href="https://www.centos.bz/tag/lua/">lua</a></li><li><a title="32个话题" href="https://www.centos.bz/tag/lvm/">LVM</a></li><li><a title="32个话题" href="https://www.centos.bz/tag/uwsgi/">uWSGI</a></li><li><a title="32个话题" href="https://www.centos.bz/tag/django/">Django</a></li><li><a title="31个话题" href="https://www.centos.bz/tag/openresty/">OpenResty</a></li><li><a title="30个话题" href="https://www.centos.bz/tag/memcached/">memcached</a></li><li><a title="30个话题" href="https://www.centos.bz/tag/kvm/">KVM</a></li><li><a title="28个话题" href="https://www.centos.bz/tag/keepalived/">keepalived</a></li><li><a title="27个话题" href="https://www.centos.bz/tag/yum/">yum</a></li></ul></div><div class="widget widget_postlist"><h3 class="title"><strong>随便看看</strong></h3><ul class="items-03">		<li><a href="https://www.centos.bz/2018/08/%e5%9f%ba%e4%ba%8edocker%e6%90%ad%e5%bb%bapercona-xtradb-cluster%e6%95%b0%e6%8d%ae%e5%ba%93%e9%9b%86%e7%be%a4/"><span class="text">基于Docker搭建Percona XtraDB Cluster数据库集群</span><span class="text-muted post-views">阅读(1389)</span></a></li>
				<li><a href="https://www.centos.bz/2017/03/virtualenv-create-virtual-python-env/"><span class="text">使用virtualenv创建一个虚拟,多版本和独立的python开发环境</span><span class="text-muted post-views">阅读(874)</span></a></li>
				<li><a href="https://www.centos.bz/2016/11/moving-docker-to-a-diffrent-partition/"><span class="text">Docker实践(3) – 移动docker到一个不同的分区</span><span class="text-muted post-views">阅读(1339)</span></a></li>
				<li><a href="https://www.centos.bz/2018/05/%e5%9f%ba%e4%ba%8e-keepalived-haproxy-%e7%9a%84-rabbitmq-%e9%ab%98%e5%8f%af%e7%94%a8%e9%85%8d%e7%bd%ae%e5%ae%9e%e8%b7%b5/"><span class="text">基于 Keepalived + HAproxy 的 RabbitMQ 高可用配置实践</span><span class="text-muted post-views">阅读(1950)</span></a></li>
				<li><a href="https://www.centos.bz/2018/06/nginx%e4%b8%8b%e7%a6%81%e6%ad%a2%e8%ae%bf%e9%97%ae-git%e7%ad%89%e9%9a%90%e8%97%8f%e6%96%87%e4%bb%b6%e5%a4%b9/"><span class="text">nginx下禁止访问.git等隐藏文件夹</span><span class="text-muted post-views">阅读(1790)</span></a></li>
				<li><a href="https://www.centos.bz/2018/04/%e4%bf%ae%e6%94%b9%e7%b3%bb%e7%bb%9f%e5%8f%8anginx%e7%a8%8b%e5%ba%8f%e6%9c%80%e5%a4%a7%e8%ae%bf%e9%97%ae%e6%95%b0%ef%bc%8c%e8%a7%a3%e5%86%b3%e9%ab%98%e5%b9%b6%e5%8f%91%e9%97%ae%e9%a2%98/"><span class="text">修改系统及nginx程序最大访问数，解决高并发问题</span><span class="text-muted post-views">阅读(1930)</span></a></li>
		</ul></div></aside></div>
</section>
<footer class="footer">
	    &copy; 2019 <a href="https://www.centos.bz">Linux运维日志</a> &nbsp;
<a href="https://www.centos.bz/sitemap.xml">网站地图</a> | <a href="https://www.centos.bz/tags/">所有标签</a> | <a href="http://www.miitbeian.gov.cn/">粤ICP备15110427号-1</a>    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?245337fe2a5eec764f81f87e3d0180a7";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</footer>

<script>
window.jui = {
	uri: 'https://www.centos.bz/wp-content/themes/xiu',
	roll: '1 2',
	ajaxpager: '0'
}
</script>
<link rel='stylesheet' id='wechat-reward-css'  href='https://www.centos.bz/wp-content/plugins/wechat-reward/assets/wechat-reward.css?ver=4.9' type='text/css' media='all' />
<script type='text/javascript' src='https://www.centos.bz/wp-content/themes/xiu/js/bootstrap.js?ver=5.3'></script>
<script type='text/javascript' src='https://www.centos.bz/wp-content/themes/xiu/js/custom.js?ver=5.3'></script>
<script type='text/javascript' src='https://www.centos.bz/wp-includes/js/wp-embed.min.js?ver=4.9'></script>
<script type='text/javascript' src='https://www.centos.bz/wp-content/plugins/wechat-reward/assets/wechat-reward.js?ver=4.9'></script>
</body>
</html>
