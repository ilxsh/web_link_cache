<!DOCTYPE html>
<html>
<head itemscope itemtype="http://schema.org/WebSite">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="theme-color" content="#ffffff" />
    <meta name="csrf-param" content="_csrf-frontend">
    <meta name="csrf-token" content="NdLHJGjMHYCiXZpSg5sWbMv74UP96GzQIonCHEQdl0xf46pgBIIv0vUU1BHP71c9gpXTO8S5FrVjz6xUd0XvDg==">
    <title>将物理磁盘添加到KVM虚拟机 - ChUbuntu</title>
    <link href="/assets/49d3cefc/css/bootstrap.css" rel="stylesheet">
<link href="/assets/a6874236/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/prettify.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">    <script>
        window.__gcse = {
            callback: function() {
                $('#___gcse_0 .gsc-clear-button').remove();
                $('#___gcse_0 .gsc-search-button').remove();
                $('#___gcse_0 .gsib_b').remove();
                $('#___gcse_0 .gsc-input input').attr('placeholder', '正在搜索......');
            }
        };
        (function() {
            var cx = '016639304537431400788:ontqwakqapm';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
        })();
    </script>
</head>
<body onload="prettyPrint()">

<div class="wrap">
    <nav id="w0" class="navbar navbar-default"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w0-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button></div><div id="w0-collapse" class="collapse navbar-collapse"><a class="navbar-brand" href="/"><div class="name"><img src="/logo.png"/>Ch<span class="cl-orange">Ubuntu</span></div></a><ul id="w1" class="navbar-nav navbar-right nav"><li><a href="/">主</a></li>
<li class="active"><a href="/questions">你的问题</a></li>
<li><a href="/tags">标签</a></li></ul><div class="search">
                <gcse:searchbox-only resultsUrl="/s.html" filter="0" sort_by=""></gcse:searchbox-only>
          </div></div></div></nav>
    <div class="container">
                        
<div class="m-t-10" itemscope="" itemtype="http://schema.org/Question">
    <div class="question-header">
        <h1 itemprop="name">将物理磁盘添加到KVM虚拟机</h1>
    </div>

    <div class="col-sm-9" style="padding-bottom:10px">
    <div class="row">
        <a data-toggle="collapse" data-target="#navig" href="#">导航你的答案</a> 

        <div id="navig" class="collapse">

                                                <a href="#159323">#1 - smccloud (10 票)</a> <br>                            <a href="#663518">#2 - dethegeek (6 票)</a> <br>             
         
        </div>
    </div>
    </div>

    <div class="col-sm-3 pull-right">
        <div class="row hidden-xs right-col sidebar">
            <!-- Сайдбар -->
            <div class="awrap" style="top: 16px; opacity: 1;">
                <ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px;margin-top: -5px;" data-ad-client="" data-ad-slot="">
                </ins>
            </div>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                document.addEventListener('DOMContentLoaded', function(){
                    var awrap = $('.awrap');
                    setTimeout(function(){
                        awrap.fadeIn();
                        awrap.animate({opacity: 1}, 200);
                    }, 1000);
                    $(window).on('scroll', function () {
                        if ($(window).scrollTop() >= 109) {
                            awrap.css({position : 'fixed'});
                        } else {
                            awrap.css({position : 'initial'});
                        }
                    });
                });
            </script>
            <!-- Сайдбар -->
        </div>
    </div>

    <div class="col-sm-9 main-col">
        <div class="row question">
            <div class="left-row">
                <div class="votes">
                    <i class="fa fa-caret-up vote"></i>
                    <div class="vote-count" itemprop="upvoteCount">9</div>
                    <i class="fa fa-caret-down vote"></i>
                    <i class="fa fa-star star"></i>
                </div>
            </div>
            <div class="question-row">
                <div class="question-text">
                    <div class="description" itemprop="text">
                        <div class ="post-text"itemprop ="text">

<p>我在Ubuntu Server 12.04系统上将文件服务器（nas4free）设置为KVM虚拟机。</p>

<p>如何将物理硬盘直接添加到VM，以便guest虚拟机（nas4free）可以使用它们，而不是主机？</p>

<p>具体来说，我要挂载的硬盘是/ dev / sda（当前没有安装在服务器上。）</p>

<p>到目前为止，我找到了两种解决方案，但我还没有找到工作。</p>

<p>第一个来自服务器故障，建议使用virt-经理。我没有强有力的工作，因为当我尝试选择现有的驱动器时，没有列出任何内容。我最好猜测为什么会这样，是因为我在ssh上使用virt-manager而不是以root身份连接，是否会产生影响呢？</p>

<p>我找到的第二个解决方案<a href="http://forum.proxmox.com/threads/3035-add-physical-disks-to-linux-guest-%28kvm%29">此处</a>只是运行命令（为我的系统修改）</p>

 <pre><code>qm set nas4free -virtio /dev/sda
</code></pre> 

<p>但这似乎需要我没有安装的proxmox，似乎不在默认存储库中？ </p>

<p>最后，一旦完成上述操作并且我可以将驱动器直接安装到VM，是否有人有关于是否应该将驱动器作为scsi，ide或virtio安装到VM的经验？ （我知道在链接的ServerFault页面中建议使用virtio，但我之前没有听说过它，因为我主要使用VMWare）。</p>

<p>感谢您的帮助！ </p>
    </DIV>                    </div>
                                            <div class="tags">
                                                            <a href="/tags/tag/virtualization" class="tag" title="用标记显示问题 'virtualization'" rel="tag">virtualization</a>
                                                            <a href="/tags/tag/kvm" class="tag" title="用标记显示问题 'kvm'" rel="tag">kvm</a>
                                                    </div>
                                        <div class="clearfix"></div>
                    <div class="action-time">
                        集 <a href="https://askubuntu.com/users/67618/evan" rel="noopener" target="_blank">evan</a>
                        <span class="relativetime"> 01.06.2012 - 06:15</span>
                    </div>
                    <a class="a-link" href="https://askubuntu.com/questions/144894/add-physical-disk-to-kvm-virtual-machine.html" target="_blank" rel="noopener">源</a>
                </div>
            </div>
        </div>

        <div class="row answers" id="answers">
            <div class="answers-header">
                <h2 class="pull-left"><span itemprop="answerCount">2</span> 答案</h2>
                <div class="clearfix"></div>
            </div>
            <div class="answer-pager">
                            </div>

                                                                                                                
                                                                        <div class="answer" id="159323" itemscope="" itemtype="http://schema.org/Answer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">10</div>
                                    <i class="fa fa-caret-down vote"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
<p>虽然已经回答了这个问题，但是你应该使用/ dev / disk / by-id /而不是使用/ dev / sda </p>

 <pre><code>    ls -l /dev/disk/by-id
</code></pre> 

<p>这样就可以防止磁盘从/ dev / sda更改为/ dev / sdb。</p>
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案
                                                                                    <a href="https://askubuntu.com/users/74883/smccloud" rel="noopener" target="_blank">
                                                                                    smccloud                                                                                    </a>
                                                                                <span title="159323" class="relativetime"> 04.07.2012 - 03:11</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/144894/add-physical-disk-to-kvm-virtual-machine.html/159323#159323" target="_blank" rel="noopener">源</a>
                                </div>
                            </div>
                        </div>
                                                                                <div class="answer" id="663518" itemscope="" itemtype="http://schema.org/Answer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">6</div>
                                    <i class="fa fa-caret-down vote"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
<p>有完全相同的需求，我发现了以下内容：</p>

<p> <a href="http://ronaldevers.nl/2012/10/14/adding-a-physical-disk-kvm-libvirt.html">链接</a> </p>

<p>（以下全文来自上述来源）</p>

<BLOCKQUOTE>
  <p>使用virt-manager无法完成。那一个花了我一段时间才弄明白。据我所知，virt-manager适用于存储池。您可以将磁盘设置为存储池，但不能将现有磁盘直接添加到VM。</p>
  
  <p>幸运的是，修复很容易：您手动将磁盘添加到域的xml配置文件中。所以在您喜欢的编辑器中打开/etc/libvirt/qemu/.xml并在该部分添加一个部分：</p>
</BLOCKQUOTE>

 <pre><code>&lt;disk type='block' device='disk'&gt;
  &lt;driver name='qemu' type='raw'/&gt;
  &lt;source dev='/dev/md/storage'/&gt;
  &lt;target dev='vdb' bus='virtio'/&gt;
&lt;/disk&gt;
</code></pre> 

<BLOCKQUOTE>
  <p>这将使guest虚拟机中的/ dev / md / storage可用作/ dev / vdb。手动更改域的配置后，您必须手动重新加载配置。登录到您的主机并发出以下命令：</p>
</BLOCKQUOTE>

 <pre><code># virsh define /etc/libvirt/qemu/jetsetetser.xml
Domain jetser defined from /etc/libvirt/qemu/jetsetetser.xml
</code></pre> 

<BLOCKQUOTE>
  <p>这是一个很好的资源，其中包含有关使用libvirt管理虚拟机的更多信息：<a href="https://help.ubuntu.com/community/KVM/Managing">链接</a> </p>
</BLOCKQUOTE>

<p>我强烈建议您遵循smccloud提供的建议。这对我来说就像一个炭。请注意<strong>不</strong>在您的访客中使用的物理驱动器中安装任何卷，否则您将严重损坏其文件系统！</p>
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案
                                                                                    <a href="https://askubuntu.com/users/441380/dethegeek" rel="noopener" target="_blank">
                                                                                    dethegeek                                                                                    </a>
                                                                                <span title="663518" class="relativetime"> 19.08.2015 - 23:16</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/144894/add-physical-disk-to-kvm-virtual-machine.html/663518#663518" target="_blank" rel="noopener">源</a>
                                </div>
                            </div>
                        </div>
                                                            <div class="answer-pager">
                            </div>
        </div>

                    <div class="row bottom-notice">
                <p>阅读有关标签的其他问题
                                            <a href="/tags/tag/virtualization" class="tag" title="用标记显示问题 'virtualization'" rel="tag">virtualization</a>
                                            <a href="/tags/tag/kvm" class="tag" title="用标记显示问题 'kvm'" rel="tag">kvm</a>
                                    </p>
            </div>
        

         <div class="row">
                            <a href="/questions/15901/how-to-mount-ext4-partition.html">如何挂载ext4分区？</a>
                                        <a href="/questions/15903/im-getting-fsync-failed-error-why.html">我收到Fsync失败错误。为什么？</a>
                    </div>

        
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <div class="container">
        <div class="pull-left">
            <div class="license">
                用户贡献许可 <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="nofollow license">cc by-sa 3.0</a>
                需要归属。
            </div>
        </div>

        <div class="pull-right logo">
            <a href="#">
                <!-- <img src="/img/logo-dark.svg"> -->
                <div class="name">Ch<span class="cl-orange">Ubuntu</span></div>
            </a>
        </div>
    </div>
</footer>



<script src="/assets/c052535f/jquery.js"></script>
<script src="/assets/f2670525/yii.js"></script>
<script src="/js/code-prettify/prettify.js"></script>
<script src="/js/site.js"></script>
<script src="/assets/49d3cefc/js/bootstrap.js"></script></body>
</html>
<!-- 0.041631937026978 -->