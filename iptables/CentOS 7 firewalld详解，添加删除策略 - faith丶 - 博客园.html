<!DOCTYPE html>
<html lang="zh-cn"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin">
    <meta property="og:description" content="一、CentOS7中firewall防火墙 修改防火墙配置文件之前，需要对之前防火墙【/etc/firewalld/zones/public.xml】做好备份 重启防火墙后，需要确认防火墙状态和防火墙">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CentOS 7  firewalld详解，添加删除策略 - faith丶 - 博客园</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.ico?v=20200522" type="image/x-icon">
    
    <link rel="stylesheet" href="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.css">
    <link id="MainCss" rel="stylesheet" href="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-mttrendy.css">
    <link type="text/css" rel="stylesheet" href="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/custom.css">
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-mttrendy-mobile.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/faithH/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/faithH/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/faithH/wlwmanifest.xml">
    <script src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/osd.js"></script><script async="" src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/analytics.js"></script><script type="text/javascript" src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/encoder.js"></script><script src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/jquery-2.js"></script>
    <script src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.js"></script>
    <script>
        var currentBlogId = 558388;
        var currentBlogApp = 'faithH';
        var cb_enable_mathjax = false;
        var isLogined = false;
        var skinName = 'MTTrendy';
    </script>
    
    
    
<style type="text/css">.heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}</style><link rel="preload" href="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/integrator.js" as="script"><script type="text/javascript" src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/integrator.js"></script><script src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/pubads_impl_2020062201.js" async=""></script></head>
<body>
    <a name="top"></a>
    
    
<div id="top">

<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/faithH/">faith丶</a>
</h1>
<p id="tagline">

</p>


</div>

<div id="rightmenu">

	
<h3>My Links</h3>
<ul>
			<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
</li>
			<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/faithH/">
首页</a>
</li>
			<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/faith%E4%B8%B6">
联系</a></li>
			<li>
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/faithH/rss/">
订阅</a> 
<a id="blog_nav_rss_image" href="https://www.cnblogs.com/faithH/rss/">
    <img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/xml.gif" alt="订阅">
</a></li>
			<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>


	<h3>Blog Stats</h3>
	<ul>
		<li>Posts - 
39</li>
		<li>Stories - 
0</li>
		<li>Comments - 
1</li>
		<li>Trackbacks - 
0
	</li>
</ul>


	
<div id="sidebar_news" class="newsItem"><h3>News</h3>
	<ul>
	  <li>
<div id="blog-news">
    <!-- 为页面添加爱心特效 -->
<script type="text/javascript">window['__document_write_ajax_callbacks__']['4']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['1']();</script>





<!-- 添加公告栏时钟 -->
<div id="clockdiv">
    <canvas id="dom" width="120" height="120">时钟canvas</canvas>
</div>
<script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['6']();</script><script type="text/javascript" defer="defer">window['__document_write_ajax_callbacks__']['2']();</script>
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/faithH/">
            faith丶
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/faithH/" title="入园时间：2017-11-08">
            2年7个月
        </a>
        <br>
        粉丝：
        <a href="https://home.cnblogs.com/u/faithH/followers/">
            1
        </a>
        <br>
        关注：
        <a href="https://home.cnblogs.com/u/faithH/followees/">
            0
        </a>
        <div id="p_b_follow">
<a href="javascript:void(0)" onclick="follow('6c941d9f-7352-4922-af77-08d523685c8c')">+加关注</a></div>
        <script type="text/javascript">window['__document_write_ajax_callbacks__']['7']();</script><script>window['__document_write_ajax_callbacks__']['3']();</script>
    </div>
</div></li>
	</ul>

</div>

<div id="sidebar_ad"></div>
	<div id="blog-sidecolumn">
<!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block">
    
<h3 class="catListTitle">
常用链接
</h3>
<ul>
        <li>

<a href="https://www.cnblogs.com/faithH/p/" title="我的博客的随笔列表">我的随笔</a>
</li>
        <li>

<a href="https://www.cnblogs.com/faithH/MyComments.html" title="我的发表过的评论列表">我的评论</a>
</li>
        <li>

<a href="https://www.cnblogs.com/faithH/OtherPosts.html" title="我评论过的随笔列表">我的参与</a>
</li>
        <li>

<a href="https://www.cnblogs.com/faithH/RecentComments.html" title="我的博客的评论列表">最新评论</a>
</li>
        <li>

<a href="https://www.cnblogs.com/faithH/tag/" title="我的博客的标签列表">我的标签</a>
</li>
</ul>

<!-- TODO: 检查是否有使用这一部分的控件，如果没有则应该删除。 -->
<div id="itemListLin_con" style="display:none">
    <ul>

    </ul>
</div>

</div>

<!-- 最新随笔 -->



<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block">
    
</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">
    
		<h3>

随笔分类


</h3>
				<ul>
			
				<li>
<a href="https://www.cnblogs.com/faithH/category/1601123.html" rel="" target="">
    docker(6)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1584215.html" rel="" target="">
    firewalld(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1749839.html" rel="" target="">
    gitlab(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1584341.html" rel="" target="">
    git环境(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1585410.html" rel="" target="">
    jenkins(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1595194.html" rel="" target="">
    jumpserver(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1585879.html" rel="" target="">
    Kubernetes(7)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1683504.html" rel="" target="">
    linux开机时间同步(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1584318.html" rel="" target="">
    Maven环境(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1585781.html" rel="" target="">
    mysql(3)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1584256.html" rel="" target="">
    nginx(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1600167.html" rel="" target="">
    node(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1595193.html" rel="" target="">
    npm or  yarn(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1627359.html" rel="" target="">
    rsync(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1584213.html" rel="" target="">
    ssh(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1626000.html" rel="" target="">
    vi/vim(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1715447.html" rel="" target="">
    VMware(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1599584.html" rel="" target="">
    vpn(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1686409.html" rel="" target="">
    zabbix(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1607803.html" rel="" target="">
    阿里云网络配置互通(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/category/1629514.html" rel="" target="">
    磁盘空间管理(1)
</a>
 
</li>
			
				</ul>
		<h3>

随笔档案


</h3>
				<ul>
			
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2020/05.html" rel="" target="">
    2020年5月(1)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2020/04.html" rel="" target="">
    2020年4月(7)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2020/03.html" rel="" target="">
    2020年3月(2)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2020/01.html" rel="" target="">
    2020年1月(7)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2019/12.html" rel="" target="">
    2019年12月(6)
</a>
 
</li>
				<li>
<a href="https://www.cnblogs.com/faithH/archive/2019/11.html" rel="" target="">
    2019年11月(16)
</a>
 
</li>
			
				</ul>


</div>

<!-- 最新评论 -->
<div id="sidebar_recentcomments" class="sidebar-block">
    <div id="recent_comments_wrap" class="RecentComment">
    <h3 class="catListTitle">最新评论</h3>
    <div class="RecentCommentBlock">
        <ul>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/faithH/p/12103713.html">1. Re:kubernetes nodePort、targetPort、port、containerPort图解</a></li>
                    <li class="recent_comment_body">图中target的解释是错误的</li>
                    <li class="recent_comment_author">--xiaolixi</li>
        </ul>
    </div>
</div>
</div>



<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block">
    
<div id="topview_posts_wrap">
    <h3 class="catListTitle">阅读排行榜</h3>
    <div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/11821114.html">
                            1. 【mysql】You must reset your password using
 ALTER USER statement before executing this statement. 报错处理(5393)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/11811286.html">
                            2. CentOS 7  firewalld详解，添加删除策略(4206)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/11881110.html">
                            3. jumpserver 资产管理及授权(1126)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/11940155.html">
                            4. 对于jenkins上前端项目 npm 或 yarn 打包 及 部署 使用(1121)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/12103713.html">
                            5. kubernetes nodePort、targetPort、port、containerPort图解(1029)
                        </a>
                    </li>
        </ul>
    </div>
</div>
</div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block">
    
<div id="topfeedback_posts_wrap">
    <h3 class="catListTitle">评论排行榜</h3>
    <div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/faithH/p/12103713.html">
                            1. kubernetes nodePort、targetPort、port、containerPort图解(1)
                        </a>
                    </li>
        </ul>
    </div>
</div>
</div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
    
</div></div>
                    <script>loadBlogSideColumn();</script>

</div>

<div id="main">
	<div id="post_detail">
	<div class="post">
		<h2>
			
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/faithH/p/11811286.html">
    <span>CentOS 7  firewalld详解，添加删除策略</span>
    


</a>

		</h2>
		
<div id="cnblogs_post_body" class="blogpost-body ">
    <h2 id="blogTitle0">一、CentOS7中firewall防火墙</h2>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_432356" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">修改防火墙配置文件之前，需要对之前防火墙【</code><code class="bash plain">/etc/firewalld/zones/public</code><code class="bash plain">.xml】做好备份</code></div><div class="line number2 index1 alt1"><code class="bash plain">重启防火墙后，需要确认防火墙状态和防火墙规则是否加载，若重启失败或规则加载失败，则所有请求都会被防火墙。</code></div><div class="line number3 index2 alt2"><code class="bash plain">1.firewall-cmd --state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#查看firewall的状态</code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --list-all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#查看防火墙规则（只显示/etc/firewalld/zones/public.xml中防火墙策略）</code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --list-all-zones&nbsp; </code><code class="bash comments">#查看所有的防火墙策略（即显示/etc/firewalld/zones/下的所有策略）</code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --reload&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#重新加载配置文件</code></div><div class="line number7 index6 alt2"><code class="bash plain">2、关闭firewall： </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">systemctl stop firewalld.service&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#停止firewall</code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">systemctl disable firewalld.service&nbsp;&nbsp; </code><code class="bash comments">#禁止firewall开机启动</code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#查看默认防火墙状态（关闭后显示notrunning，开启后显示running） </code></div><div class="line number11 index10 alt2"><code class="bash plain">3、firewalld的基本使用</code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">启动： systemctl start firewalld</code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看状态： systemctl status firewalld </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">停止： systemctl disable firewalld</code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">禁用： systemctl stop firewalld</code></div><div class="line number16 index15 alt1"><code class="bash plain">4.systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。</code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">启动一个服务：systemctl start firewalld.service</code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">关闭一个服务：systemctl stop firewalld.service</code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">重启一个服务：systemctl restart firewalld.service</code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">显示一个服务的状态：systemctl status firewalld.service</code></div><div class="line number21 index20 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">在开机时启用一个服务：systemctl </code><code class="bash functions">enable</code> <code class="bash plain">firewalld.service</code></div><div class="line number22 index21 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">在开机时禁用一个服务：systemctl disable firewalld.service</code></div><div class="line number23 index22 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看服务是否开机启动：systemctl is-enabled firewalld.service</code></div><div class="line number24 index23 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看已启动的服务列表：systemctl list-unit-files|</code><code class="bash functions">grep</code> <code class="bash plain">enabled</code></div><div class="line number25 index24 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看启动失败的服务列表：systemctl --failed</code></div><div class="line number26 index25 alt1"><code class="bash plain">5.配置firewalld-cmd</code></div><div class="line number27 index26 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看版本： firewall-cmd --version</code></div><div class="line number28 index27 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看帮助： firewall-cmd --help</code></div><div class="line number29 index28 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">显示状态： firewall-cmd --state</code></div><div class="line number30 index29 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看所有打开的端口： firewall-cmd --zone=public --list-ports</code></div><div class="line number31 index30 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">更新防火墙规则： firewall-cmd --reload</code></div><div class="line number32 index31 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看区域信息:&nbsp; firewall-cmd --get-active-zones</code></div><div class="line number33 index32 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看指定接口所属区域： firewall-cmd --get-zone-of-interface=eth0</code></div><div class="line number34 index33 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">拒绝所有包：firewall-cmd --panic-on</code></div><div class="line number35 index34 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">取消拒绝状态： firewall-cmd --panic-off</code></div><div class="line number36 index35 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">查看是否拒绝： firewall-cmd --query-panic</code></div></div></td></tr></tbody></table></div></div>
</div>
<h2 id="blogTitle1">二、防火墙配置文件</h2>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>[root@node ~]# <span style="background-color: #99cc00;">iptables -L -</span><span style="color: #000000;"><span style="background-color: #99cc00;">n</span>
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">            ctstate RELATED,ESTABLISHED
ACCEPT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
INPUT_direct  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
INPUT_ZONES_SOURCE  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
INPUT_ZONES  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
DROP       all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">            ctstate INVALID
REJECT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            reject-with icmp-host-<span style="color: #000000;">prohibited

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">            ctstate RELATED,ESTABLISHED
ACCEPT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FORWARD_direct  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FORWARD_IN_ZONES_SOURCE  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FORWARD_IN_ZONES  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FORWARD_OUT_ZONES_SOURCE  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FORWARD_OUT_ZONES  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
DROP       all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">            ctstate INVALID
REJECT     all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            reject-with icmp-host-<span style="color: #000000;">prohibited

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
OUTPUT_direct  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           

Chain FORWARD_IN_ZONES (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         
FWDI_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 
FWDI_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 

Chain FORWARD_IN_ZONES_SOURCE (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FORWARD_OUT_ZONES (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         
FWDO_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 
FWDO_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 

Chain FORWARD_OUT_ZONES_SOURCE (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FORWARD_direct (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDI_public (</span><span style="color: #800080;">2</span><span style="color: #000000;"> references)
target     prot opt source               destination         
FWDI_public_log  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FWDI_public_deny  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FWDI_public_allow  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
ACCEPT     icmp </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           

Chain FWDI_public_allow (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDI_public_deny (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDI_public_log (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDO_public (</span><span style="color: #800080;">2</span><span style="color: #000000;"> references)
target     prot opt source               destination         
FWDO_public_log  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FWDO_public_deny  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
FWDO_public_allow  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           

Chain FWDO_public_allow (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDO_public_deny (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain FWDO_public_log (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain INPUT_ZONES (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         
IN_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 
IN_public  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>           [<span style="color: #0000ff;">goto</span><span style="color: #000000;">] 

Chain INPUT_ZONES_SOURCE (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain INPUT_direct (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain IN_public (</span><span style="color: #800080;">2</span><span style="color: #000000;"> references)
target     prot opt source               destination         
IN_public_log  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
IN_public_deny  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
IN_public_allow  all  </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           
ACCEPT     icmp </span>--  <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span>            <span style="color: #800080;">0.0</span>.<span style="color: #800080;">0.0</span>/<span style="color: #800080;">0</span><span style="color: #000000;">           

Chain IN_public_allow (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         
<span style="color: #99cc00;">ACCEPT     tcp  </span></span><span style="color: #99cc00;">--  172.17.134.13        0.0.0.0/0            tcp dpt:2181 ctstate NEW
ACCEPT     all  --  172.17.134.13        0.0.0.0/0           
ACCEPT     all  --  172.17.172.236       0.0.0.0/0         
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:22 ctstate NEW
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:8715 ctstate NEW
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:80</span><span style="color: #000000;"><span style="color: #99cc00;"> ctstate NEW</span>

Chain IN_public_deny (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain IN_public_log (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination         

Chain OUTPUT_direct (</span><span style="color: #800080;">1</span><span style="color: #000000;"> references)
target     prot opt source               destination 

[root@node </span>~]# <span style="background-color: #99cc00;">cat /etc/firewalld/zones/<span style="color: #0000ff;">public</span><span style="color: #000000;">.xml
</span></span>&lt;?xml version=<span style="color: #800000;">"</span><span style="color: #800000;">1.0</span><span style="color: #800000;">"</span> encoding=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span>?&gt;
&lt;zone&gt;
  <span style="color: #000000;">&lt;short&gt;Public&lt;/short&gt;</span>
  &lt;description&gt;For use <span style="color: #000000;">in public</span> areas. You <span style="color: #000000;">do</span> not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.&lt;/description&gt;
<span style="color: #0000ff;">  &lt;service name="ssh"/&gt;
  &lt;service name="dhcpv6-client"/&gt;
  &lt;port protocol="tcp" port="8715"/&gt;
  &lt;port protocol="tcp" port="80"/&gt;</span>
<span style="color: #99cc00;">  &lt;rule family="ipv4"&gt;
    &lt;source address="172.17.134.13"/&gt;
    &lt;port protocol="tcp" port="2181"/&gt;
    &lt;accept/&gt;
  &lt;/rule&gt;</span>
<span style="color: #0000ff;">  &lt;rule family="ipv4"&gt;
    &lt;source address="172.17.134.13"/&gt;
    &lt;accept/&gt;
  &lt;/rule&gt;
  &lt;rule family="ipv4"&gt;
    &lt;source address="172.17.172.236"/&gt;
    &lt;accept/&gt;
  &lt;/rule&gt;</span>
&lt;/zone&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/copycode.gif" alt="复制代码"></a></span></div></div>
<h2 id="blogTitle2"><span style="font-size: 1.17em;">三、Centos7的firewalld开启端口/IP、屏蔽IP</span></h2>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_129427" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">开启防火墙：systemctl start firewalld</code></div><div class="line number2 index1 alt1"><code class="bash plain">查看开放的端口和服务以及屏蔽的IP：firewall-cmd --zone=public --list-all</code></div><div class="line number3 index2 alt2"><code class="bash plain">查看系统中查看系统中可用的服务：firewall-cmd --get-services</code></div><div class="line number4 index3 alt1"><code class="bash plain">添加端口：firewall-cmd --zone=public --add-port=8080</code><code class="bash plain">/tcp</code> <code class="bash plain">--permanent (--permanent永久生效，没有此参数重启后失效)</code></div><div class="line number5 index4 alt2"><code class="bash plain">查看：firewall-cmd --zone= public --query-port=80</code><code class="bash plain">/tcp</code></div><div class="line number6 index5 alt1"><code class="bash plain">添加端口段：firewall-cmd --zone=public --add-port=5060-5061</code><code class="bash plain">/udp</code> <code class="bash plain">--permanent </code></div><div class="line number7 index6 alt2"><code class="bash plain">添加IP+端口：firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family="</code><code class="bash plain">ipv4</code><code class="bash string">" source address="</code><code class="bash plain">0.0.0.0</code><code class="bash plain">/24</code><code class="bash string">" port protocol="</code><code class="bash plain">tcp</code><code class="bash string">" port="</code><code class="bash plain">10050</code><code class="bash string">" accept"</code></div><div class="line number8 index7 alt1"><code class="bash plain">删除端口：firewall-cmd --permanent --zone=public --remove-port=8080</code><code class="bash plain">/tcp</code></div><div class="line number9 index8 alt2"><code class="bash plain">删除IP+端口：firewall-cmd --permanent --zone=public --remove-rich-rule=</code><code class="bash string">"rule family="</code><code class="bash plain">ipv4</code><code class="bash string">" source address="</code><code class="bash plain">10.0.5.0</code><code class="bash plain">/24</code><code class="bash string">" port protocol="</code><code class="bash plain">tcp</code><code class="bash string">" port="</code><code class="bash plain">10050</code><code class="bash string">" accept"</code></div><div class="line number10 index9 alt1"><code class="bash plain">屏蔽IP(reject)：firewall-cmd --permanent --add-rich-rule=</code><code class="bash string">"rule family=ipv4 source address=43.229.53.61 reject"</code></div><div class="line number11 index10 alt2"><code class="bash plain">屏蔽IP(drop)&nbsp; : firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family=ipv4 source address='x.x.x.x/24'&nbsp; drop"</code></div><div class="line number12 index11 alt1"><code class="bash plain">热加载才能生效：firewall-cmd --reload</code></div><div class="line number13 index12 alt2"><code class="bash plain">查看屏蔽结果：firewall-cmd --list-rich-rules</code></div><div class="line number14 index13 alt1"><code class="bash plain">因为在</code><code class="bash plain">/usr/lib/firewalld/services/</code><code class="bash plain">中事先定义了</code><code class="bash functions">ssh</code><code class="bash plain">.xml的相应的规则</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="line number10 index9 alt1">
<h2 id="blogTitle3"><span style="font-size: 1.17em;">四、firewalld防火墙 禁止/限制 特定用户的IP访问，drop和reject区别</span></h2>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_420878" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">1.drop禁止特定ip连接</code><code class="bash functions">ssh</code><code class="bash plain">/22</code><code class="bash plain">服务</code></div><div class="line number2 index1 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family=ipv4 source address='x.x.x.x/24' service name='ssh' drop"</code></div><div class="line number3 index2 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --reload </code><code class="bash comments">##重新加载防火墙配置，不然firewall-cmd --list-all-zones不会显示刚加上的规则</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="bash plain">2.reject禁止特定ip连接</code><code class="bash functions">ssh</code><code class="bash plain">/22</code><code class="bash plain">服务</code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family='ipv4' source address='x.x.x.x/24' service name='ssh' reject"</code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family='ipv4' source address='x.x.x.x/24' port port=22 protocol=tcp reject"</code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --reload </code></div><div class="line number9 index8 alt2"><code class="bash plain">3.accept运行特定ip连接</code><code class="bash functions">ssh</code><code class="bash plain">/22</code><code class="bash plain">服务</code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --permanent --zone=public --add-rich-rule=</code><code class="bash string">"rule family=ipv4 source address='x.x.x.x/24' port port=22 procotol=tcp accept"</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">firewall-cmd --reload</code></div><div class="line number12 index11 alt1"><code class="bash plain">防火墙内的策略动作有DROP和REJECT两种，区别如下：</code></div><div class="line number13 index12 alt2"><code class="bash plain">1、DROP动作只是简单的直接丢弃数据，并不反馈任何回应。需要Client等待超时，Client容易发现自己被防火墙所阻挡。</code></div><div class="line number14 index13 alt1"><code class="bash plain">2、
REJECT动作则会更为礼貌的返回一个拒绝(终止)数据包(TCP 
FIN或UDP-ICMP-PORT-UNREACHABLE)，明确的拒绝对方的连接动作。连接马上断开，Client会认为访问的主机不存在。
REJECT在IPTABLES里面有一些返回参数，参数如下：ICMP port-unreachable、ICMP </code><code class="bash functions">echo</code><code class="bash plain">-reply 或是 tcp-reset（这个封包会要求对方关闭联机），进行完此处理动作后，将不再比对其它规则，直接中断过滤程序。</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">至
于使用DROP还是REJECT更合适一直未有定论，因为的确二者都有适用的场合。REJECT是一种更符合规范的处理方式，并且在可控的网络环境中，更
易于诊断和调试网络/防火墙所产生的问题；而DROP则提供了更高的防火墙安全性和稍许的效率提高，但是由于DROP不很规范(不很符合TCP连接规范)
的处理方式，可能会对你的网络造成一些不可预期或难以诊断的问题。因为DROP虽然单方面的中断了连接，但是并不返回任何拒绝信息，因此连接客户端将被动
的等到tcp session超时才能判断连接是否成功，这样早企业内部网络中会有一些问题，例如某些客户端程序或应用需要IDENT协议支持(TCP 
Port 113, RFC 
1413)，如果防火墙未经通知的应用了DROP规则的话，所有的同类连接都会失败，并且由于超时时间，将导致难以判断是由于防火墙引起的问题还是网络设
备/线路 故障。</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">一点个人经验，在部署防火墙时，如果是面向企业内部(或部分可信任网络)，那么最好使用更绅士REJECT方法，对于需要经常变更或调试规则的网络也是如此；而对于面向危险的Internet</code><code class="bash plain">/Extranet</code><code class="bash plain">的防火墙，则有必要使用更为粗暴但是安全的DROP方法，可以在一定程度上延缓******的进度(和难度，至少，DROP可以使他们进行TCP-Connect方式端口扫描时间更长)。</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>&nbsp;</p>
<p>　　</p>
<p>&nbsp;</p>
</div>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/faithH/category/1584215.html" target="_blank">firewalld</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(11811286,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
        <a id="green_channel_follow" onclick="follow('6c941d9f-7352-4922-af77-08d523685c8c');" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/faithH/" target="_blank"><img src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/20191125134549.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/faithH/">faith丶</a><br>
            <a href="https://home.cnblogs.com/u/faithH/followees/">关注 - 0</a><br>
            <a href="https://home.cnblogs.com/u/faithH/followers/">粉丝 - 1</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow('6c941d9f-7352-4922-af77-08d523685c8c');return false;">+加关注</a>
    </div>
</div>
<div id="div_digg"><div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px"></span><a onclick="cnblogs.UserManager.FollowBlogger('9a35f2c7-18ab-e111-aa3f-842b2b196315');" href="javascript:void(0);" style="font-weight: bold; padding-left:5px;">关注一下楼主吧</a> </div>
    <div class="diggit" onclick="votePost(11811286,'Digg')">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(11811286,'Bury')">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/faithH/p/11810651.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/faithH/p/11810651.html" title="发布于 2019-11-07 10:49">centos7系统root无法通过su切换到某个普通用户</a>
    <br>
    <a href="https://www.cnblogs.com/faithH/p/11811600.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/faithH/p/11811600.html" title="发布于 2019-11-07 13:50">SLB外部端口非80时---》转发到nginx---》URL跳转丢失端口的解决方案</a>

</div>
</div>
		<p class="postfoot">
			posted on 
<span id="post-date">2019-11-07 12:07</span>&nbsp;
<a href="https://www.cnblogs.com/faithH/">faith丶</a>&nbsp;
阅读(<span id="post_view_count">4206</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=11811286" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(11811286);return false;">收藏</a>
		</p>
	</div>
	
	
<script src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/highlight.js"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 558388, cb_blogApp = 'faithH', cb_blogUserGuid = '6c941d9f-7352-4922-af77-08d523685c8c';
    var cb_entryId = 11811286, cb_entryCreatedDate = '2019-11-07 12:07', cb_postType = 1; 
    loadViewCount(cb_entryId);
    loadSideColumnAd();
</script><a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    注册用户登录后才能发表评论，请 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login('commentform');">登录</a>
     或 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，
    <a href="https://www.cnblogs.com/">访问</a> 网站首页。
</div></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"><a href="https://www.wenjuan.com/s/3uIjeq0/" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-博客园问卷调查')">【推荐】了解你才能更懂你，博客园首发问卷调查，助力社区新升级</a><br><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-ucancode')">【推荐】超50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://developer.aliyun.com/article/758263?utm_content=g_1000133217" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-阿里云开发者社区')">【推荐】独家下载！《Java开发手册》灵魂13问，深度剖析一线大厂开发思维</a><br></div>
    <div id="opt_under_post"></div>
    <script async="" src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/gpt.js"></script>
    <script>
        var mobileVisit = screen.width < 500;
        window.googletag = window.googletag || { cmd: [] };
        googletag.cmd.push(function () {
            googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1592365906576-0').addService(googletag.pubads());
            if (!mobileVisit) {
                googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1592366332455-0').addService(googletag.pubads());
            }
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block">
        <div id="div-gpt-ad-1592365906576-0" style="width: 300px; height: 250px;" data-google-query-id="CMiu9ebqpuoCFQ6blgodpjYOqA">
            
        <div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 250px;"><iframe style="border: 0px none; vertical-align: bottom;" src="CentOS%207%20firewalld%E8%AF%A6%E8%A7%A3%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%20-%20faith%E4%B8%B6%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/container.html" id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" data-is-safeframe="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" data-load-complete="true" width="300" height="250" frameborder="0"></iframe></div></div>
    </div>
    <div id="under_post_news"><div class="recomm-block"><b>相关博文：</b><br>·  <a title="CentOS7--Firewalld防火墙" href="https://www.cnblogs.com/zydev/p/6290110.html" target="_blank" onclick="clickRecomItmem(6290110)">CentOS7--Firewalld防火墙</a><br>·  <a title="Centos7防火墙firewalld实用操作" href="https://www.cnblogs.com/stulzq/p/9808504.html" target="_blank" onclick="clickRecomItmem(9808504)">Centos7防火墙firewalld实用操作</a><br>·  <a title="centos8用firewalld搭建防火墙" href="https://www.cnblogs.com/architectforest/p/12304219.html" target="_blank" onclick="clickRecomItmem(12304219)">centos8用firewalld搭建防火墙</a><br>·  <a title="CentOS下firewalld添加开放端口" href="https://www.cnblogs.com/jugglee/p/8987000.html" target="_blank" onclick="clickRecomItmem(8987000)">CentOS下firewalld添加开放端口</a><br>·  <a title="centos7下iptables参数详解" href="https://www.cnblogs.com/zhangshengxiang/p/10216323.html" target="_blank" onclick="clickRecomItmem(10216323)">centos7下iptables参数详解</a><br>»  <a target="_blank" href="https://recomm.cnblogs.com/blogpost/11811286">更多推荐...</a></div></div>
    <div id="cnblogs_c2" class="c_ad_block" style="display: none;">
        <div id="div-gpt-ad-1592366332455-0" style="width: 468px; height: 60px;" data-google-query-id="CP_M9ObqpuoCFQ6blgodpjYOqA">
            <script>
                if (!mobileVisit) {
                    if (canShowAdsense()) {
                        googletag.cmd.push(function () { googletag.display('div-gpt-ad-1592366332455-0'); });
                    } else {
                        $('#cnblogs_c2').hide();
                    }
                }
            </script>
        <div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none; width: 468px; height: 60px;"></div></div>
    </div>
    <div id="under_post_kb">
<div class="itnews c_ad_block">
    <b>最新 IT 新闻</b>:
    <br>
 ·              <a href="https://news.cnblogs.com/n/666037/" target="_blank">百度为什么那么喜欢卖公司？</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/666035/" target="_blank">超4900万用户、年入7.59亿 赴美IPO的Blued价值几许？</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/666034/" target="_blank">单季度亏损7.9亿美元，耐克的王座松动了吗？</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/666033/" target="_blank">格力董明珠，黄章最后一根救命稻草？</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/666032/" target="_blank">起底微信“养号”产业链：有人身家千万，赚了几套房</a>
            <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        deliverBigBanner();
setTimeout(function() { incrementViewCount(cb_entryId); }, 50);        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div></div>


</div>

<p id="footer">
	Powered by: 
	<br>
	
	<a href="https://www.cnblogs.com/" id="footer_site_link">博客园</a>
	<br>
	Copyright © 2020 faith丶
<br><span id="poweredby">Powered by .NET Core on Kubernetes</span>

</p>




    <div id="page_end_html">
        <!-- 生成博客目录的JS代码，两级目录 -->
<script type="text/javascript">

var BlogDirectory = {
    /* 获取元素位置，距浏览器左边界的距离（left）和距浏览器上边界的距离（top）*/
    getElementPosition:function (ele) {
        var topPosition = 0;
        var leftPosition = 0;
        while (ele){
            topPosition += ele.offsetTop;
            leftPosition += ele.offsetLeft;
            ele = ele.offsetParent;
        }
        return {top:topPosition, left:leftPosition};
    },
    /*获取滚动条当前位置 */
    getScrollBarPosition:function () {
        var scrollBarPosition = document.body.scrollTop || document.documentElement.scrollTop;
        return  scrollBarPosition;
    },
    /* 移动滚动条，finalPos 为目的位置，internal 为移动速度 */
    moveScrollBar:function(finalpos, interval) {
        //若不支持此方法，则退出
        if(!window.scrollTo) {
            return false;
        }
        
        //窗体滚动时，禁用鼠标滚轮
        window.onmousewheel = function(){
            return false;
        };
        
        //清除计时
        if (document.body.movement) {
            clearTimeout(document.body.movement);
        }
        
        //获取滚动条当前位置
        var currentpos =BlogDirectory.getScrollBarPosition();

        var dist = 0;
        //到达预定位置，则解禁鼠标滚轮，并退出
        if (currentpos == finalpos) {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }
        //未到达，则计算下一步所要移动的距离
        if (currentpos < finalpos) {
            dist = Math.ceil((finalpos - currentpos)/10);
            currentpos += dist;
        }
        if (currentpos > finalpos) {
            dist = Math.ceil((currentpos - finalpos)/10);
            currentpos -= dist;
        }

        var scrTop = BlogDirectory.getScrollBarPosition();//获取滚动条当前位置
        window.scrollTo(0, currentpos);//移动窗口
        if(BlogDirectory.getScrollBarPosition() == scrTop)//若已到底部，则解禁鼠标滚轮，并退出
        {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }

        //进行下一步移动
        var repeat = "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")";
        document.body.movement = setTimeout(repeat, interval);
    },

    htmlDecode:function (text){
        var temp = document.createElement("div");
        temp.innerHTML = text;
        var output = temp.innerText || temp.textContent;
        temp = null;
        return output;
    },
    
    /*
    创建博客目录，id表示包含博文正文的 div 容器的 id，
    mt 和 st 分别表示主标题和次级标题的标签名称（如 H2、H3，大写或小写都可以！），
    interval 表示移动的速度
    */
    createBlogDirectory:function (id, mt, st, interval){
        //获取博文正文div容器
        var elem = document.getElementById(id);
        if(!elem) return false;
        //获取div中所有元素结点
        var nodes = elem.getElementsByTagName("*");
        //创建博客目录的div容器
        var divSideBar = document.createElement('DIV');
        divSideBar.className = 'uprightsideBar';
        divSideBar.setAttribute('id', 'uprightsideBar');
        var divSideBarTab = document.createElement('DIV');
        divSideBarTab.setAttribute('id', 'sideBarTab');
        divSideBar.appendChild(divSideBarTab);
        var h2 = document.createElement('H2');
        divSideBarTab.appendChild(h2);
        var txt = document.createTextNode('目录导航');
        h2.appendChild(txt);
        var divSideBarContents = document.createElement('DIV');
        divSideBarContents.style.display = 'none';
        divSideBarContents.setAttribute('id', 'sideBarContents');
        divSideBar.appendChild(divSideBarContents);
        //创建自定义列表
        var dlist = document.createElement("dl");
        divSideBarContents.appendChild(dlist);
        var num = 0;//统计找到的mt和st
        mt = mt.toUpperCase();//转化成大写
        st = st.toUpperCase();//转化成大写
        //遍历所有元素结点
        for(var i=0; i<nodes.length; i++)
        {
            if(nodes[i].nodeName == mt|| nodes[i].nodeName == st)
            {
                //获取标题文本
                var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g,"");//innerHTML里面的内容可能有HTML标签，所以用正则表达式去除HTML的标签
                nodetext = nodetext.replace(/ /ig, "");//替换掉所有的
                nodetext = BlogDirectory.htmlDecode(nodetext);
                //插入锚
                nodes[i].setAttribute("id", "blogTitle" + num);
                var item;
                switch(nodes[i].nodeName)
                {
                    case mt:    //若为主标题
                        item = document.createElement("dt");
                        break;
                    case st:    //若为子标题
                        item = document.createElement("dd");
                        break;
                }

                //创建锚链接
                var itemtext = document.createTextNode(nodetext);
                item.appendChild(itemtext);
                item.setAttribute("name", num);
                //添加鼠标点击触发函数
                item.onclick = function(){        
                var pos = BlogDirectory.getElementPosition(document.getElementById("blogTitle" + this.getAttribute("name")));
                    if(!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
                };
                //将自定义表项加入自定义列表中
                dlist.appendChild(item);
                num++;
            }
        }

        if(num == 0) return false;
        /* 鼠标进入时的事件处理 */
        divSideBarTab.onmouseenter = function(){
            divSideBarContents.style.display = 'block';
        }
        /* 鼠标离开时的事件处理 */
        divSideBar.onmouseleave = function() {
            divSideBarContents.style.display = 'none';
        }

        document.body.appendChild(divSideBar);
    }

};

window.onload=function(){
    /* 页面加载完成之后生成博客目录 */
    BlogDirectory.createBlogDirectory("cnblogs_post_body","h2","h3",20);
    
    //为右下角推荐推荐区域添加关注按钮
    $('#div_digg').prepend('<div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px"></span><a onclick="cnblogs.UserManager.FollowBlogger(\'9a35f2c7-18ab-e111-aa3f-842b2b196315\');" href="javascript:void(0);" style="font-weight: bold; padding-left:5px;">关注一下楼主吧</a> </div>');
}
</script>
    </div>


<script type="text/javascript">

(function(window,document,undefined){
    var hearts = [];
    
    window.requestAnimationFrame = (function(){
        return window.requestAnimationFrame || 
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
         window.oRequestAnimationFrame ||
         window.msRequestAnimationFrame ||
         function (callback){
             setTimeout(callback,1000/60);
         }
    })();
    
    init();

    function init(){
        css(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
        attachEvent();
        gameloop();
    }

    function gameloop(){
        for(var i=0;i<hearts.length;i++){
            if(hearts[i].alpha <=0){
                document.body.removeChild(hearts[i].el);
                hearts.splice(i,1);
                continue;
             }

             hearts[i].y--;
             hearts[i].scale += 0.004;
             hearts[i].alpha -= 0.013;
             hearts[i].el.style.cssText = "left:"+hearts[i].x+"px;top:"+hearts[i].y+"px;opacity:"+hearts[i].alpha+";transform:scale("+hearts[i].scale+","+hearts[i].scale+") rotate(45deg);background:"+hearts[i].color;
        }

        requestAnimationFrame(gameloop);
    }

    function attachEvent(){
        var old = typeof window.onclick==="function" && window.onclick;
        window.onclick = function(event){
            old && old();
            createHeart(event);
        }
    }

    function createHeart(event){
        var d = document.createElement("div");
        d.className = "heart";
        hearts.push({
            el : d,
            x : event.clientX - 5,
            y : event.clientY - 5,
            scale : 1,
            alpha : 1,
            color : randomColor()
        });

        document.body.appendChild(d);
    }

    function css(css){
        var style = document.createElement("style");
        style.type="text/css";
        try{
            style.appendChild(document.createTextNode(css));
        }
        catch(ex){
            style.styleSheet.cssText = css;
        }

        document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor(){
        return "rgb("+(~~(Math.random()*255))+","+(~~(Math.random()*255))+","+(~~(Math.random()*255))+")";
    }
    
})(window,document);
</script><script type="text/javascript">getFollowStatus('6c941d9f-7352-4922-af77-08d523685c8c');</script><div class="uprightsideBar" id="uprightsideBar"><div id="sideBarTab"><h2>目录导航</h2></div><div style="display: none;" id="sideBarContents"><dl><dt name="0">一、CentOS7中firewall防火墙</dt><dt name="1">二、防火墙配置文件</dt><dt name="2">三、Centos7的firewalld开启端口/IP、屏蔽IP</dt><dt name="3">四、firewalld防火墙禁止/限制特定用户的IP访问，drop和reject区别</dt></dl></div></div><iframe id="google_osd_static_frame_2371073789498" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe></body></html>