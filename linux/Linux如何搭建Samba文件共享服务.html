<!Doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><meta name="referrer" content="always"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><link rel="shortcut icon" href="https://gss0.bdstatic.com/5bd1bjqh_Q23odCf/static/wiseindex/img/favicon64.ico" type="image/x-icon"><link rel="apple-touch-icon-precomposed" href="https://gss0.bdstatic.com/5bd1bjqh_Q23odCf/static/wiseindex/img/screen_icon_new.png"><title>Linux如何搭建Samba文件共享服务</title><link rel="stylesheet" href="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/css/land_min_pack_b64f440.css"><meta itemprop="dateUpdate" content="2018-12-06 13:23:21" /></head><body><script >/* eslint-disable */var s_domain = {"protocol":"https:","staticUrl":"https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/","base":"","baseuri":"","passconf":"http://passport.baidu.com/ubrwsbas","logout":"https://passport.baidu.com/?logout&u=","bs":"https://www.baidu.com","sp":"http://hi.baidu.com/","ssllist":{"a.hiphotos.baidu.com":"ss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy","b.hiphotos.baidu.com":"ss1.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy","c.hiphotos.baidu.com":"ss3.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy","d.hiphotos.baidu.com":"ss0.baidu.com/-Po3dSag_xI4khGko9WTAnF6hhy","e.hiphotos.baidu.com":"ss1.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy","f.hiphotos.baidu.com":"ss2.baidu.com/-vo3dSag_xI4khGko9WTAnF6hhy","g.hiphotos.baidu.com":"ss3.baidu.com/-fo3dSag_xI4khGko9WTAnF6hhy","h.hiphotos.baidu.com":"ss0.baidu.com/7Po3dSag_xI4khGko9WTAnF6hhy","1.su.bdimg.com":"ss0.bdstatic.com/k4oZeXSm1A5BphGlnYG","t10.baidu.com":"ss0.baidu.com/6ONWsjip0QIZ8tyhnq","t11.baidu.com":"ss1.baidu.com/6ONXsjip0QIZ8tyhnq","t12.baidu.com":"ss2.baidu.com/6ONYsjip0QIZ8tyhnq","himg.bdimg.com":"ss1.bdstatic.com/7Ls0a8Sm1A5BphGlnYG","cdn00.baidu-img.cn":"ss0.bdstatic.com/9bA1vGba2gU2pMbfm9GUKT-w","cdn01.baidu-img.cn":"ss0.bdstatic.com/9bA1vGfa2gU2pMbfm9GUKT-w"}};var s_session = {"ssid":"5153b20a","logid":"","sid":"1435_21085_29567_29220_26350","nid":"9665105093917155018","qid":""};var s_advert = {"isBjh":"1","contentUrl":"http://baijiahao.baidu.com/s?id=1619078525576466832","contentPlatformId":"3","contentType":"1","pvid":"4342ca61cc34f3c4","time":"2019-10-14 14:38:08","contentAccType":"1","ctk":"6a54ad08d87e6190","contentAccId":"JQtfGJS5tG_OeRY4B","ctk_b":"a2994f628d381b1c","logid":"2288598110","dtime":"1571035088","grade":"2","createTimeAccLevel":"1"};</script><script>/* eslint-disable */var bds={se:{},su:{urdata:[],urSendClick:function(){},urStatic:"https://ss.bdimg.com"},util:{},use:{},comm:{domain:"",ubsurl:"",tn:"",queryEnc:"",queryId:"",inter:"",sugHost:"",query:"",qid:"",cid:"",sid:"",stoken:"",serverTime:"",user:"",username:"",loginAction:[],useFavo:"",pinyin:"",favoOn:"",curResultNum:"0",rightResultExist:false,protectNum:0,zxlNum:0,pageNum:1,pageSize:10,ishome:1,newindex:1}};var name,navigate,al_arr=[];var selfOpen=window.open;eval("var open = selfOpen;");var isIE=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera;var E=bds.ecom={};bds.se.mon={loadedItems:[],load:function(){},srvt:-1};try{bds.se.mon.srvt=parseInt(document.cookie.match(new RegExp("(^| )BDSVRTM=([^;]*)(;|$)"))[2]);document.cookie="BDSVRTM=;expires=Sat, 01 Jan 2000 00:00:00 GMT"}catch(e){}var bdUser=bds.comm.user?bds.comm.user:null,bdQuery=bds.comm.query,bdUseFavo=bds.comm.useFavo,bdFavoOn=bds.comm.favoOn,bdCid=bds.comm.cid,bdSid=bds.comm.sid,bdServerTime=bds.comm.serverTime,bdQid=bds.comm.queryId,bdstoken=bds.comm.stoken,login_success=[];</script><div id="detail-page"><div class="line-shadow"></div><div class="item-wrap"><div id="header_wrap" class="header_wrap"><div class="header_content"><div class="header_logo"><a href="https://www.baidu.com" id="result_logo" data-clklog="tid:139;cst:2;logInfo:head_logo;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" data-rid="head_0"><img src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/img/logo_top.png" alt="到百度首页" title="到百度首页"></a></div><div class="header_menu" data-rid="header_menu"><a href="https://www.baidu.com" class="index" data-clklog="tid:142;cst:2;logInfo:head_menu" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:backindex" data-rid="head_1">百度首页</a><span class="line"></span><div id="userBlock"><a href="https://passport.baidu.com/v2/?login&tpl=mn&u=http://www.baidu.com" class="login" data-clklog="tid:142;cst:2;logInfo:head_menu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:login" data-rid="head_2">登录</a><a href="http://i.baidu.com/" id="usrname" class="usrname" data-clklog="tid:142;cst:2;logInfo:head_menu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:usrname;" data-rid="head_2"><span id="nametxt">后知后觉后觉醒</span><div id="user_menu" data-showlog="tid:131;cst:1;logInfo:usrmenu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" class="s-isindex-wrap s-user-set-menu menu-top" style="display: none;"><div><a href="http://i.baidu.com/center" target="_blank" data-tid="1000" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:center;" data-rid="usr_menu_1">个人中心</a><a href="http://passport.baidu.com/" data-tid="1001" target="_blank" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:passport;" data-rid="usr_menu_2">帐号设置</a><a class="s-feedback" style="overflow:hidden" href="#" onclick="return false;" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:feedback;" data-rid="header_menu_3">意见反馈</a><a class="quit" style="overflow:hidden" href="https://passport.baidu.com/?logout&u=https://www.baidu.com" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:quit;" data-rid="usr_menu_4">退出</a></div><span class="menu-arrow"><em></em></span></div></div></div></div></div></div><div class="title_border"><div class="anci_header_content"><div class="article-title"><h2>Linux如何搭建Samba文件共享服务</h2></div><div class="article-desc clearfix"><div class="author-icon"><img src="https://timg01.bdimg.com/timg?pacompress&amp;imgtype=1&amp;sec=1439619614&amp;autorotate=1&amp;di=1bcdf79230816fe70c913db259c67f5b&amp;quality=100&amp;size=b640_10049&amp;cut_x=0&amp;cut_y=0&amp;cut_w=640&amp;cut_h=640&amp;src=http%3A%2F%2Fpic.rmb.bdstatic.com%2F891c82e9097852ac7c37fa4466669068.jpeg"></div><div class="author-txt"><p class="author-name">一米八是我呀</p><div class="article-source article-source-bjh"><span class="date">发布时间：18-12-06</span><span class="time">13:23</span><span class="account-authentication"></span></div></div></div></div></div><div id="content-container" class="content-container clearfix" data-showlog="tid:126;cst:1;logInfo:landing;" data-extralog="flow:2;st:news;rid:9665105093917155018;pos:0;extra:;source:1;isBaijiahao:1;login:1;appId:1614111541867413;" data-ratio="1" data-rid="page"><div id="left-container" class="left-container"><div class="item-wrap"><div class="article " id="article" data-islow-browser="0"><div class="article-content"><p><span class="bjh-p"><span class="bjh-strong">Linux如何搭建Samba文件共享服务</span></span></p><p><span class="bjh-p">最近由于学习方面的原因，时间比较紧，只能用零碎时间来整理文档，所以发文章的频率可能会没那么快了，希望亲爱的你们多多体谅。然后，因为发文慢了，我有个想法就是把我上课的笔记分享给你们看，但我不知道你们会不会不喜欢，所以想征求一下你们的意见，欢迎给我留言哦。</span></p><p><span class="bjh-p"><span class="bjh-br"></span></span></p><p><span class="bjh-p">前言：随着计算机网络的出现，各种各样的服务器和主机不再是一个单独的个体。网络给我们带来的最直接的好处，就是可以在主机之间快速分享资源及相互通信。接下来就让我们一起来了解一下跨平台的文件共享解决方案——Samba服务器的构建。</span></p><p><span class="bjh-p"><span class="bjh-strong">一、Samba服务基础</span></span></p><p><span class="bjh-p">在windows网络环境中，主机之间进行文件和打印机共享是通过微软公司自己的SMB/CIFS网络协议实现的。SMB（Server Message Block，服务消息块）和CIFS（Common Internet File System，通用互联网文件系统）协议是微软的私有协议，在Samba项目出现之前，并不能直接与Linux/UNIX系统进行通信。</span></p><p><span class="bjh-p">Samba是著名的开源软件项目之一，它在Linux/UNIX系统中实现了微软的SMB/CIFS网络协议，从而使得跨平台的文件共享变得更加容易。在部署Windows、Linux/UNIX混合平台的企业环境时，选用Samba可以很好地解决不同系统之间的文件互访问题。</span></p><p><span class="bjh-p"><span class="bjh-strong">1.Samba软件的组成</span></span></p><p><span class="bjh-p"><span class="bjh-strong">（1）Samba软件包的构成</span></span></p><p><span class="bjh-p">在系统的安装光盘中可以找到与Samba相关的几个软件包，主要包括服务端软件samba、客户端软件samba-client，用于提供服务端和客户端程序的公共组件samba-common。大部分软件包已经随系统默认安装好了，用户可以查询系统中samba相关软件包的安装情况。</span></p><p><span class="bjh-p">图示：查看与samba相关的软件包</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=3334867374,4105301797&amp;fm=173&amp;app=49&amp;f=JPEG?w=621&amp;h=301&amp;s=4150C53211D049C80E71C4DF000080B1" data-loaded=0 /></div><p><span class="bjh-p">只需要从光盘中找到安装包文件samba-4.4.4-9.el7.x86_64.rpm，并进行安装即可。（可以搭建本地yum安装，有网的话可以直接yum安装）</span></p><p><span class="bjh-p"><span class="bjh-strong">（2）Samba服务的程序组件</span></span></p><p><span class="bjh-p">Samba服务器提供smbd、nmbd两个服务程序，分别完成不同的功能。其中，<span class="bjh-strong">smbd负责为客户机提供服务器中共享资源（目录和文件等）的访问；nmbd负责提供基于NetBIOS协议的主机名称解析，以便为Windows网络中的主机进行查询服务。</span></span></p><p><span class="bjh-p">安装好samba软件包以后，在系统中会添加名为smb和nmb的标准系统服务，管理员可以通过service（centos6）或systemctl（centos7）工具来控制Samba服务的启动与终止。</span></p><p><span class="bjh-p">图示：</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2292276889,317060948&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=245&amp;s=559A4D3A9B904C4346C9B0DA000070B2" data-loaded=0 /></div><p><span class="bjh-p">其中smbd程序负责监听TCP协议的139端口（SMB协议）、445端口（CIFS协议），而nmbd服务程序负责监听UDP协议的137、138端口（NetBIOS协议）。<span class="bjh-br"></span></span></p><p><span class="bjh-p"><span class="bjh-strong">2.主配置文件smb.conf</span></span></p><p><span class="bjh-p"><span class="bjh-strong">Samba服务的配置文件位于/etc/samba/目录，</span>其中smb.conf是主配置文件。其中，以“#”号开始的行表示注释性的文字，在配置共享文件夹时，用户可以参考文件中提供的样例进行设置。</span></p><p><span class="bjh-p">图示：</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=559219269,4010303320&amp;fm=173&amp;app=49&amp;f=JPEG?w=626&amp;h=381&amp;s=85985C30119841CC5C5504DA0000C0B2" data-loaded=0 /></div><p><span class="bjh-p">如上图所示，smb.conf文件中的配置内容默认包括三个部分<span class="bjh-br"></span></span></p><p><span class="bjh-ul"><span class="bjh-li"><span class="bjh-p">[global]全局设置：这部分配置项的内容对整个samba服务器都有效。</span></span><span class="bjh-li"><span class="bjh-p">[homes]宿主目录共享设置：设置Linux用户的默认共享，对应用户的宿主目录。当用户访问服务器中与自己用户名同名的共享目录时，通过验证后将会自动映射到该用户的宿主文件夹中。</span></span><span class="bjh-li"><span class="bjh-p">[printers]打印机共享设置：若需要共享打印机设备，可以在这部分进行配置。</span></span></span><span class="bjh-p">若需要在smb.conf文件中设置新的共享文件名，只需要增加一段如“[myshare]”开始共享设置即可，其中“myshare”为用户自定义的共享名。新的共享文件夹设置可以参考“[homes]”和“[printers]”部分的内容。</span></p><p><span class="bjh-p">下面我们一起了解一下smb.conf文件中常见的一些配置项及其含义说明。</span></p><p><span class="bjh-ul"><span class="bjh-li"><span class="bjh-p">workgroup：所在工作组名称</span></span><span class="bjh-li"><span class="bjh-p">security：安全级别，centos6之前可用值有share、user、server、domain，centos7之后不再支持share，如果配置匿名共享时，需要在全局参数中添加“map to guest = bad user”这一行内容。</span></span><span class="bjh-li"><span class="bjh-p">passwd backend：设置共享账户文件的类型，默认使用tdbsam（TDB数据库文件）</span></span><span class="bjh-li"><span class="bjh-p">comment：对共享目录的注释、说明信息</span></span><span class="bjh-li"><span class="bjh-p">valid users:有效用户</span></span><span class="bjh-li"><span class="bjh-p">path：共享目录在服务器中对应的实际路径</span></span><span class="bjh-li"><span class="bjh-p">browseable：该共享目录在“网上邻居”中是否可见</span></span><span class="bjh-li"><span class="bjh-p">guest ok：是否允许所有人访问，等效于“public”</span></span><span class="bjh-li"><span class="bjh-p">writable：是否可写，与 read only 的作用相反</span></span><span class="bjh-li"><span class="bjh-p">inherit acls：是否继承acl（访问控制列表）</span></span></span><span class="bjh-p"><span class="bjh-strong">注：Samba 服务设置的读取、写入权限，优先级要低于文件系统中设置的权限</span></span></p><p><span class="bjh-p">Samba服务器提供了一个配置文件检查工具——testparm程序，使用testparm工具对smb.conf配置文件的正确性进行检查，如果发现错误将会进行提醒。</span></p><p><span class="bjh-p">图示：使用testparm工具检查smb.conf配置文件</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=4274554588,1478222731&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=220&amp;s=88E3DF1087E459035474845C030050F3" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-strong">二、构建文件共享服务器</span></span></p><p><span class="bjh-p">上面我们了解了samba服务的基本知识，并了解了主配置文件smb.conf文件中常用的一些配置项。接下来我们一起了解如何设置文件夹共享，包括匿名访问和用户验证的共享设置，以及账户映射和客户机访问控制等常见配置。</span></p><p><span class="bjh-p"><span class="bjh-strong">1.可匿名访问的共享</span></span></p><p><span class="bjh-p">设置匿名访问共享文件夹时，在主配置文件中主要调整两个地方即可：其一，由于centos7之后不再支持share，所以，需要在全局参数中添加“map to guest = bad user”这一行内容，表示允许匿名访问（如下图所示）；其二，添加一段共享目录配置。其他配置项可根据实际需要进行更改（如下图所示）。</span></p><p><span class="bjh-p">图示：</span></p><div class="img-container"><img class="normal" width="498px" data-loadfunc=0 src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=974464572,971389635&amp;fm=173&amp;app=49&amp;f=JPEG?w=498&amp;h=85&amp;s=CEE0A0564D22EF2052FCC1CA0000E0B3" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-br"></span></span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2042445334,3770568796&amp;fm=173&amp;app=49&amp;f=JPEG?w=553&amp;h=123&amp;s=8FE0E412C9E4F00358DC80CF0000A0B3" data-loaded=0 /></div><p><span class="bjh-p">配置完成后，重启smb服务就可以从Windows客户机或Linux客户机匿名访问此共享了，关于在Linux主机中访问共享文件夹的方法，将在下文中讲解。<span class="bjh-br"></span></span></p><p><span class="bjh-p"><span class="bjh-strong">千万注意共享文件在系统本地的权限，不然会拒绝访问，本地权限规则优先于共享权限。</span></span></p><p><span class="bjh-p"><span class="bjh-strong">2.需要用户验证的共享</span></span></p><p><span class="bjh-p">匿名共享虽然用起来非常方便，但因为任何人都可以访问到共享的文件数据，在某些时候可能会导致信息的泄露。</span></p><p><span class="bjh-p">设置用户验证的共享文件时，只需在添加共享目录配置时，指定用户权限，在此之前，还需要先创建授权的共享账户。</span></p><p><span class="bjh-p"><span class="bjh-strong">（1）建立samba用户数据库</span></span></p><p><span class="bjh-p">为了区别于Linux主机中的系统用户，通常将用于访问samba共享资源的用户称为共享用户。Samba服务器使用独立的共享账号数据库文件，其中的账号名称必须有与它同名的系统用户想对应，以便主机对共享访问的读写权限进行控制，但共享用户的密码是额外设置的，可以与系统用户的密码不一样。</span></p><p><span class="bjh-p">Samba共享用户的账号数据库文件默认位于/var/lib/samba/private/passdb.tdb，是一个经过加密的文件，其中保存了samba用户的账号名称、登录密码、账号可用状态等信息。使用pdbedit工具可以对共享用户进行管理。如下图</span></p><p><span class="bjh-p">图示：</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=3330767847,1694369111&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=234&amp;s=0C0A55309F604C031AC5F4CB000080B2" data-loaded=0 /></div><p><span class="bjh-p">然后执行“pdbedit  -L”命令可以列出所有的samba共享用户，若只想查看某个用户的信息，可以指定用户名称作为参数，结合“-v”选项可以输出更详细的内容。如下图<span class="bjh-br"></span></span></p><p><span class="bjh-p">图示：</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=1056903798,3236794796&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=232&amp;s=0C0A553097784C210E7D40DE000080B2" data-loaded=0 /></div><p><span class="bjh-p">当指定的samba用户不再需要时，可以通过pdbedit工具进行删除，只要结合“-x”选项并指定samba用户名称即可。例如：执行“pdbedit -x -u zhangsan”命令可以删除名为张三的samba账号。<span class="bjh-br"></span></span></p><p><span class="bjh-p"><span class="bjh-strong">（2）设置用户访问授权</span></span></p><p><span class="bjh-p">若要使用用户验证的samba共享，security安全级别设为“user”。共享目录的用户授权设置主要由“valid users”和“write list”配置项指定。当需要授权多个共享用户时，以逗号或空格进行分隔。如果需要授权一个用户组，可以使用“@组名”的形式，但需要为组内的每个系统用户都创建对应的samba共享用户。</span></p><p><span class="bjh-p">示例：将本地目录/opt/mytools/发布为共享文件夹，共享名为tools，要求只有共享用户wangwu、zhaoliu能够访问，其中wangwu用户具有写入的权限。</span></p><p><span class="bjh-p">a.创建共享用户wangwu、zhaoliu，确认共享目录。如下图</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=3194807468,3828672709&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=143&amp;s=80735D90C4A4FD130C7DD058030080F3" data-loaded=0 /></div><p><span class="bjh-p">b.修改smb.conf配置文件，添加名为tools的共享目录配置段。如下图</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=2894868170,3403311245&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=255&amp;s=8263DD1087E85D015E452CDC020080F3" data-loaded=0 /></div><p><span class="bjh-p">c.重新加载smb.conf文件中的配置，或重启smb服务。</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=1160082217,4092594046&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=68" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-strong">（3）确定目录访问授权</span></span></p><p><span class="bjh-p">通过samba服务器共享本地的文件时，用户最终是否拥有读取、写入权限，除了需要设置用户授权以外，还要满足一个前提条件——即在本地与共享用户同名的系统用户对发布为共享的本地文件夹必须有相应的读取和写入的权限。（上面也有提及到）</span></p><p><span class="bjh-p">设置目录权限：chmod  777  /opt/mytools</span></p><p><span class="bjh-p">另外，当通过共享目录上传文档时，对于共享用户所上传的文件，创建子目录的默认权限可以分别使用配置项“directory mask”、“create mask”进行指定。</span></p><p><span class="bjh-p">示例：若要用户访问tools共享文件时，所上传的目录的默认权限为755，文件的默认权限为644，可在配置文件中添加如下图所示的内容。</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=454680905,325760876&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=168&amp;s=86E3DD14D57CCC23567DB558020040F1" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-strong">三、访问共享文件夹</span></span></p><p><span class="bjh-p"><span class="bjh-strong">1.使用smbclient访问共享文件夹</span></span></p><p><span class="bjh-p">在系统中，samba-client软件包提供的smbclient工具可以用于查询、访问共享资源。</span></p><p><span class="bjh-p"><span class="bjh-strong">（1）查询目标主机的共享资源列表</span></span></p><p><span class="bjh-p">使用smbclient命令查询共享资源时，添加“-L”选项，并指定目标主机的IP地址或主机名，添加“-U”选项，并指定用户名称，在工作组环境中查询共享资源时，一般不需要用户验证，提示输入密码时直接按Enter即可。如下图</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2269806370,3333172671&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=214&amp;s=8863DD1097EC4D0352555459030050F3" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-strong">（2）登录并访问共享资源</span></span></p><p><span class="bjh-p">通过“//主机地址/共享名”的形式指定共享文件夹的位置。对于允许匿名用户访问的共享文件夹，提示输入密码时直接按Enter键即可。对于需要用户验证的共享文件夹，则输入对应的密码即可。如下图</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=4115279294,174990798&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=98" data-loaded=0 /></div><p><span class="bjh-p">成功登录samba服务器后，会出现“smb：\&gt;”提示符，提供一个类似于ftp命令程序的环境。在“smb：\&gt;”环境中，使用特定的命令可以对共享目录进行列表、上传、下载等操作。例如：ls用于列表目录，pwd查看当前路径，get和mget用于下载文件，put和mput用于上传文件，使用“？”或“help”命令可以查看各种交互命令在线帮助信息。</span></p><p><span class="bjh-p"><span class="bjh-strong">2.使用mount挂载共享文件夹</span></span></p><p><span class="bjh-p">Smbclient客户端工具可以非常方便地登录到samba服务器，但是只有将文件下载到本地以后才能查看文件内容，若使用mount工具将共享文件夹挂载到本地，则通过本地的挂载点目录即可直接使用共享文件夹的内容，使文件共享更加方便。</span></p><p><span class="bjh-p">使用mount命令挂载共享资源时，只需通过“//主机地址/共享名”的形式指定共享文件夹的位置（视为设备资源），并指定本地的挂载点目录即可。</span></p><p><span class="bjh-p">示例：将samba服务器192.168.4.11中的tools共享目录挂载到本地的/media/smbdir/文件夹，以共享用户wangwu进行验证，可以在客户机中执行如下图的操作。</span></p><div class="img-container"><img class="large" data-loadfunc=0 src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=43312096,1954749841&amp;fm=173&amp;app=49&amp;f=JPEG?w=640&amp;h=187&amp;s=8063DD10C5645D015045A0D9030010F0" data-loaded=0 /></div><p><span class="bjh-p"><span class="bjh-br"></span></span></p><p><span class="bjh-p">#########   本节完   ########</span></p><p><span class="bjh-p">因为文章有点长我怕好多人都不看完就划过去了，所以文章开头啰嗦一遍，在这再啰嗦一遍。由于最近学习方面的问题，几乎没时间总结文档了，所以只能用零碎时间去整理文档，这样发文章的频率可能就没那么快了，希望亲爱的你们多多体谅。改天有时间我想发一下我上课时的笔记，不知道你们会不会想看，可以给我留言哦。</span></p><p><span class="bjh-p"><span class="bjh-br"></span></span></p></div><audio height="0" width="0" id="musicAudio" data-play-index><source></source></audio></div></div></div><div id="right-container" class="right-container"><div class="item-wrap"><div class="recent-article" data-pos=""><h2>作者最新文章</h><ul><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_0"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9042015268851067140%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;" target="_blank">实验报告——MySQL的安装</a></h3><div class="item-desc hide"><span class="info-date">04-17</span><span class="info-time">13:20</span></div></li><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_1"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9443806551762297461%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;" target="_blank">Shell脚本应用——条件测试操作</a></h3><div class="item-desc hide"><span class="info-date">03-25</span><span class="info-time">17:52</span></div></li><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_2"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9701113863454065978%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;" target="_blank">shell脚本与计划任务</a></h3><div class="item-desc hide"><span class="info-date">03-21</span><span class="info-time">14:50</span></div></li></ul></div></div><div class="item-wrap"><div class="related-news"><div class="news-content "><h2>相关文章</h2><ul><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:0;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_0"><div class="item-content clearfix"><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9953404133773939666%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">写Java的都是基础差么？Linux中的零拷贝，Java如何实现</a></h3></div></div><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9953404133773939666%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=2563887488,3384863035&amp;fm=173&amp;app=49&amp;f=JPEG?w=218&amp;h=146&amp;s=4C823C72C7A1610354F9A8C70200B0B1"></a></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:1;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_1"><div class="item-content clearfix"><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9256807021419253154%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">8个原因让我选择Typora作为我的Markdown标记语言文档编辑器</a></h3></div></div><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9256807021419253154%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=3699880427,1507702924&amp;fm=173&amp;app=49&amp;f=JPEG?w=218&amp;h=146&amp;s=F012759C142B550952E158D50300C0B1"></a></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:2;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_2"><div class="item-content clearfix"><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9171880232107410793%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">运维小白成神之路2-什么是Linux操作系统</a></h3></div></div><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9171880232107410793%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=987119062,2499478919&amp;fm=173&amp;app=49&amp;f=JPEG?w=218&amp;h=146&amp;s=3805C514C46531011B24C9E7030060B3"></a></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:3;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_3"><div class="item-content clearfix"><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9099985601990847180%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">开源社区全球化的惊险一跃</a></h3></div></div><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9099985601990847180%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=1827368231,126528987&amp;fm=173&amp;app=49&amp;f=JPEG?w=218&amp;h=146&amp;s=99300798481048CA107CFCC90300C0B8"></a></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:4;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_4"><div class="item-content clearfix"><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9526262244445980693%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">微软的股价还会继续上涨吗？</a></h3></div></div><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:5;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9526262244445980693%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=2968934714,2593189310&amp;fm=173&amp;app=49&amp;f=JPEG?w=218&amp;h=146&amp;s=9C285D324B624D24087DD9CA0000C0B1"></a></div></div></li></ul></div></div><div id="relateAd" ad-id="relate-js" class="wangmeng-ad" data-showlog="tid:369;cst:1;logInfo:adsjs;" data-clklog="tid:370;cst:2;logInfo:adsjs;" data-extralog="rid:;pos:5;extra:;baijiahao:1;login:1;"></div></div></div></div><div id="bottom-container" class="bottom-container "><div class="copy-right"><div class="baidu-info"><a class="sethome" href="//www.baidu.com/cache/sethelp/index.html" target="_blank"><span>设为首页</span></a><span class="copyright-text"><span>&#169;&nbsp;Baidu&nbsp;</span><a href="//www.baidu.com/duty/" target="_blank">使用百度前必读</a>&nbsp;<a href="http://jianyi.baidu.com" target="_blank">意见反馈</a>&nbsp;<span>京ICP证030173号&nbsp;</span><img width=13 height=16 src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/copy_rignt_24.png" /></span></div><div class="recordcode"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11000002000001"  target="_blank"><i></i>京公网安备11000002000001号</a></div></div><div class="back-to-top" data-showlog="tid:133;cst:1;logInfo:back_to_top;" data-clklog="tid:138;cst:2;logInfo:back_to_top;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" data-rid="back_to_top"><div class="icon-text"><span>返回顶部</span></div><div class="icon-arrow"><span></span></div></div></div></div><script type="text/javascript">window.onload = function () {var contentContainer = document.getElementById('content-container');var bottomContainer = document.getElementById('bottom-container');var rightContainer = document.getElementById('right-container');var minContentHeight = window.innerHeight - bottomContainer.offsetHeight;if (contentContainer.offsetHeight < minContentHeight) {contentContainer.style.height = minContentHeight + 'px';bottomContainer.className += ' fixed';}if (rightContainer.children.length === 0) {rightContainer.style.width = parseInt(rightContainer.offsetWidth + 1, 10) + 'px';}};</script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/lib/jquery_0affbc1.js"></script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/land_min_pack_8e22d87.js"></script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/article/index_bd58962.js"></script></body></html>