define("wkview:widget/common_toc/reader_txt/page_main/main.js",function(e,o,n){var i=e("wkcommon:widget/lib/tangram/base/base.js"),t=e("wkview:widget/ui/view/reader_pace/reader_pace.js"),r=e("wkcommon:widget/ui/payCheck/payCheck.js"),d=e("wkcommon:widget/ui/lib/jquery/jquery.js"),a=e("wkview:widget/ui/view/pay_org_vip/pay_org_vip.js"),c=e("wkview:widget/ui/view/down_doc/down_doc.js").downDocCreate(),s=e("wkcommon:widget/ui/reader_plugin/copy.js").copy,g=e("wkcommon:widget/ui/js_core/login/login.js"),w=function(e){d.extend(!0,this.ops,e),this.bindEvent().addCopyPrevilege().run()};w.prototype={constructor:w,ops:{docId:"",newMark:i.cookie.get("newMark"),bPage:0,bOffset:0,rPage:0,rOffset:0,sendCondition:!0,isOrgvipBuyMember:1,needShowPay:1,isLogin:0,copyable:0},bindEvent:function(){return i.lang.eventCenter.addEventListener("download.doc",function(e,o){o=o||{};var n=o.from||!1;"payDialog"===n?c.getFile():c.start()}),this},addCopyPrevilege:function(){var e=this,o=this.ops;return e.config={},e.config.container=i.dom.g("txt-reader-container"),e.config.copyable=o.copyable,e.config.isLogin=o.isLogin,i.lang.eventCenter.addEventListener("do-login",function(){g.login.verlogin(function(){location.reload()})}),i.lang.eventCenter.addEventListener("v:renderAfter",function(){s(e)}),this},run:function(){var e=this,o=this.ops,n=i.lang.eventCenter;if(o.newMark!==o.docId&&(o.bPage=o.bOffset=0),(o.bPage||o.rPage)&&o.bOffset){var c=[o.docId,o.bPage||o.rPage,o.bOffset||o.rOffset].join("|");i.cookie.set("newMark",c,{path:"/view/"})}o.sendCondition&&n.addEventListener("loadComplete",function(o,i){var r=t.readerPace;e.readerPace=new r(i.reader),e.readerPace.sendPaceInRate(),n.removeEventListener("loadComplete","RP")},"RP"),+o.needShowPay&&(o.isOrgvipBuyMember&&(d(".org-pay-hide").css("display","none"),d(".goods-price-wrap").removeClass("mr20")),this.pay=new r({goods_type:1,goods_id:o.docId}),this.payorg=a({goods_type:1,goods_id:o.docId}),d(".btn-payDoc").on("click",function(){e.payorg.init({query:{click_type:"13011003"}})}),window.wenku=window.wenku||{},window.wenku.purchase=function(){});var s=[];return s.push({url:"/browse/widget/viewrecom?pagelets[]=view-like-recom&doc_id="+o.docId,id:"view-like-recom"}),this}},n.exports=w});