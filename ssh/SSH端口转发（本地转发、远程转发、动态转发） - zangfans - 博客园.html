<!DOCTYPE html>
<html lang="zh-cn"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="referrer" content="origin">
    <title>SSH端口转发（本地转发、远程转发、动态转发） - zangfans - 博客园</title>
<meta property="og:description" content="一：什么是端口转发？ &lt;!--more--&gt; SSH 会自动加密和解密所有SSH 客户端与服务端之间的网络数据。但是，SSH 还能够将其他TCP 端口的网络数据通过SSH 链接来转发，并且">
    <link type="text/css" rel="stylesheet" href="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-AnotherEon001.css">
<link type="text/css" rel="stylesheet" href="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/392110.css">
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-AnotherEon001-mobile.css">
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/zangfans/rss">
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/zangfans/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/zangfans/wlwmanifest.xml">
    <script src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/amp4ads-host-v0.js"></script><script src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/pubads_impl_rendering_2019050701.js"></script><script async="" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/analytics.js"></script><script src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/jquery-2.js"></script>
    <script>var currentBlogId=392110;var currentBlogApp='zangfans',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.js" type="text/javascript"></script>
<script src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=432686"></script><link rel="preload" href="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/integrator.js" as="script"><script type="text/javascript" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/integrator.js"></script><script src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/pubads_impl_2019050701.js" async=""></script><style type="text/css">.heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}</style></head>
<body>
<a name="top"></a>

<!--PageBeginHtml Block Begin-->
<!-- 添加博客顶部博主信息-->
<p style="text-align: center;font-size:35px;margin-bottom:5px;margin-top:20px;opacity: 0.5">欢迎来到zangfans的博客</p>
<!-- 创建新的导航栏，内容可更改为你自己的-->
<div id="shwtop">
    <ul style="margin-left:0px;margin-right: 0px;" class="test11">
        <div class="dropdown">
            <a href="https://www.cnblogs.com/" class="dropbtn">博客园首页</a>
            <div class="dropdown-content">

            </div>
        </div>

        <div class="dropdown">
            <a href="http://www.cnblogs.com/zangfans/" class="dropbtn">我的首页</a>
            <div class="dropdown-content">

            </div>
        </div>

        <div class="dropdown">
            <a href="#" class="dropbtn">全部分类</a>
            <div class="dropdown-content">
                <!-- <a class="menu" href="这里是你文章或随笔分类的链接地址，自己修改下面同理"> 这里更改下拉具体内容 </a> -->
                <a class="menu" href="http://www.cnblogs.com/zangfans">1.Linux基础</a>
                <a class="menu" href="http://www.cnblogs.com/zangfans">2.Python基础</a>
            </div>
        </div>


        <div class="dropdown">
            <a href="#" class="dropbtn">Linux基础</a>
            <div class="dropdown-content">
                <a class="menu" href="http://www.cnblogs.com/zangfans">1.基础知识</a>
                <a class="menu" href="http://www.cnblogs.com/zangfans">2.Linux发行版本</a>
                <a class="menu" href="http://www.cnblogs.com/zangfans">3.Linux命令行操作</a>
            </div>
        </div>


        <div class="dropdown">
            <a href="#" class="dropbtn">Python基础</a>
            <div class="dropdown-content">
                <a class="menu" href="http://www.cnblogs.com/zangfans" target="_Blank">1.认识Python</a>
                <a class="menu" href="http://www.cnblogs.com/zangfans" target="_Blank">更多...</a>
            </div>
        </div>
    </ul>
</div>

<!-- 为页面添加分享功能按键 -->
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"6","bdPos":"right","bdTop":"340"},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 指定返回顶部位置#shwtop -->
<a href="#shwtop"><div id="toTop" style="zoom:0;"></div></a>

<!-- 添加页面放大和缩小功能按键 -->
<div id="divExpandViewArea" onclick="$('#main_container').css({'margin-left':'-195px'});$('#leftmenu').css({'display':'none'});">扩大</div>
<div id="divCollapseViewArea" onclick="$('#main_container').css({'margin-left':'0px'});$('#leftmenu').css({'display':'block'});">缩小</div>

<!-- 博客页面脚添加Github链接或其他链接 -->
<!-- 页面左上角 -->
<a href="https://www.cnblogs.com/zangfans/" title="我的站点" target="_Blank" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<!-- 页面右上角 -->
<a href="https://github.com/zangfans/" title="我的github地址" target="_Blank" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<!--PageBeginHtml Block End-->

<div id="wrapper">
<div id="header">

<div id="top">
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/zangfans/">zangfans</a></h1>
<div id="subtitle"></div>
</div>
<div id="sub"><div id="blog_stats">
<div class="BlogStats">随笔 - 15, 文章 - 16, 评论 - 7, 引用 - 0</div>
</div></div>



</div>
<div id="main_container">
<div id="main_content">
<div id="content">
	
        <div id="post_detail">
	<div class="post">
		<h2>
			<a id="cb_post_title_url" href="https://www.cnblogs.com/zangfans/p/8848279.html">SSH端口转发（本地转发、远程转发、动态转发）</a>
		</h2>
		<div class="postbody">
		<div id="cnblogs_post_body" class="blogpost-body"><div>
<p style="font-size: 0.875rem;"><strong><span style="background-color: #ffffff; color: #ff0000;">&nbsp;</span></strong></p>
<h3 style="font-size: 0.875rem;" id="blogTitle0">一：什么是端口转发？</h3>
<!--more-->
<div style="text-align: left; font-size: 0.875rem;">&nbsp; 
&nbsp;&nbsp;SSH 会自动加密和解密所有SSH 客户端与服务端之间的网络数据。但是，SSH 还能够将其他TCP 
端口的网络数据通过SSH 链接来转发，并且自动提供了相应的加密及解密服务。这一过程也被叫做“隧道”（tunneling），这是因为SSH 
为其他TCP 链接提供了一个安全的通道来进行传输而得名。例如，Telnet，SMTP，LDAP 这些TCP 
应用均能够从中得益，避免了用户名，密码以及隐私信息的明文传输。而与此同时，如果工作环境中的防火墙限制了一些网络端口的使用，但是允许SSH 
的连接，也能够通过将TCP 端口转发来使用SSH 进行通讯。</div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<h3 style="text-align: left; font-size: 0.875rem;" id="blogTitle1">二：SSH 端口转发能够提供两大功能：</h3>
</div>
<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">
<div>
<div style="text-align: left; font-size: 0.875rem;">1.加密SSH Client 端至SSH Server 端之间的通讯数据</div>
</div>
<div>
<div style="text-align: left; font-size: 0.875rem;">2.突破防火墙的限制完成一些之前无法建立的TCP 连接</div>
</div>
</blockquote>
<div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<h3 style="font-size: 0.875rem;" id="blogTitle2">三：SSH端口本地转发</h3>
<div style="font-size: 0.875rem;">本地转发机制：</div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp; &nbsp;&nbsp;-L localport:remotehost:remotehostportsshserver</div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">选项：</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">-f 后台启用</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">-N 不打开远程shell，处于等待状态</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">-g 启用网关功能</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">举例：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">ssh–L 9527:telnetsrv:23 -N sshsrv</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">telnet 127.0.0.1 9527</div>
<div style="text-align: left; font-size: 0.875rem;">当访问本机的9527的端口时，被加密后转发到sshsrv的ssh服务，再解密被转发到telnetsrv:23</div>
<div style="text-align: left; font-size: 0.875rem;">data &lt; &gt;localhost:9527 &lt; &gt; localhost:XXXXX &lt; &gt; sshsrv:22 &lt; &gt; sshrv:yyyyy &lt; &gt; telnetsrv:23</div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;"><span style="color: #df402a;">流程解释：</span></div>
<div style="font-size: 0.875rem;">&nbsp; 
&nbsp;&nbsp;数据一旦telnet以后，数据会发送到本机9527端口，再在本机开一个随机端口，充当ssh客户端，再把数据流量发送到22
端口的ssh服务端，收到数据以后，解密数据，临时开一个随机端口充当客户端，再把流量发送到23端口telnet服务端</div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171322621-871388173.jpg" target="_blank"><img style="width: 620px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171322621-871388173.jpg" alt="" data-media-type="image" data-attr-org-src-id="CC062061FF514088AED7554396FF87D3" width="800" height="319"></a></div>
<div style="font-size: 0.875rem;">ssh协议里面封装了telnet，一旦A连接了B主机，立即使用telnet连接C主机，此过程可以<span style="color: #ff0000;" data-wiz-span="data-wiz-span">突破防火墙的限制</span></div>
<div style="font-size: 0.875rem;">&nbsp;<span style="color: #0000ff;">#实验</span></div>
<div style="font-size: 0.875rem;"><span style="color: #0000ff;">　 A-&gt;C&nbsp; &nbsp; 访问被限制</span></div>
<div style="font-size: 0.875rem;"><span style="color: #0000ff;">&nbsp; &nbsp; A-B-&gt;C　　使用B主机作为跳板突破访问限制</span></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">选项回顾</div>
<div style="margin-left: 28px; font-size: 0.875rem;">-L 本机端口</div>
<div style="margin-left: 28px; font-size: 0.875rem;">-f 后台启用，可以在本机直接执行命令，无需另开新终端</div>
<div style="margin-left: 28px; font-size: 0.875rem;">-N 不打开远程shell，处于等待状态，不跳到远程主机，还在主机上，只是搭好了隧道，桥搭好，不ssh上去</div>
<div style="margin-left: 28px; font-size: 0.875rem;">-g 启用网关功能</div>
<div style="margin-left: 28px; font-size: 0.875rem;">-R 服务端口</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">环境：</div>
<div style="margin-left: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_594152" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># vim /etc/hosts</code></div><div class="line number2 index1 alt1"><code class="bash plain">A:Centos7&nbsp; 172.18.254.173</code></div><div class="line number3 index2 alt2"><code class="bash plain">B:Centos6&nbsp; 172.18.253.175</code></div><div class="line number4 index3 alt1"><code class="bash plain">C:Centos6-1 172.18.253.192</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
<div style="font-size: 0.875rem;">&nbsp; &nbsp; <span style="color: #ff0000;">注：每个机器都添加hosts</span></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">条件：设置防火墙策略不让Centos7直连Centos6-1</div>
<div style="margin-left: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_255489" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># iptables -A INPUT -s centos7 -j REJECT</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">操作：</div>
<div style="text-indent: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_338645" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ssh -L 9527:centos6-1:23 -Nf centos6</code></div><div class="line number2 index1 alt1"><code class="bash comments">#通过本地9527端口访问centos6-1服务器IP地址使用telnet协议23端口，跳板机ip地址</code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ss -tn</code></div><div class="line number4 index3 alt1"><code class="bash plain">State&nbsp;&nbsp;&nbsp;&nbsp;
 Recv-Q Send-Q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Local 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Peer 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 </code></div><div class="line number5 index4 alt2"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
172.18.254.173:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.0.100:57618&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 </code></div><div class="line number6 index5 alt1"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.254.173:35024&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.253.175:22</code></div><div class="line number7 index6 alt2"><code class="bash comments">#隧道已经搭建好了，此时A主机可以通过telnet访问C主机</code></div><div class="line number8 index7 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># telnet 127.0.0.1 9527&nbsp;&nbsp;&nbsp; #访问成功</code></div><div class="line number9 index8 alt2"><code class="bash plain">Trying 127.0.0.1...</code></div><div class="line number10 index9 alt1"><code class="bash plain">Connected to 127.0.0.1.</code></div><div class="line number11 index10 alt2"><code class="bash plain">Escape character is </code><code class="bash string">'^]'</code><code class="bash plain">.</code></div><div class="line number12 index11 alt1"><code class="bash plain">CentOS release 6.9 (Final)</code></div><div class="line number13 index12 alt2"><code class="bash plain">Kernel 2.6.32-696.el6.x86_64 on an x86_64</code></div><div class="line number14 index13 alt1"><code class="bash plain">Centos6-1 login: docker&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">Password:</code></div><div class="line number16 index15 alt1"><code class="bash plain">Last login: Mon Apr&nbsp; 9 21:33:43 from centos7</code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="bash comments">#删除ssh端口本地装发</code></div><div class="line number19 index18 alt2"><code class="bash plain">[docker@centos6-1 ~]$ </code><code class="bash functions">exit</code>&nbsp;&nbsp;&nbsp; <code class="bash comments">#退出telnet但是隧道还是搭着可以使用ps aux查看到</code></div><div class="line number20 index19 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ps aux</code></div><div class="line number21 index20 alt2"><code class="bash plain">root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 6624&nbsp; 0.0&nbsp; 0.1 180392&nbsp; 1392 
?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ss&nbsp;&nbsp; 21:59&nbsp;&nbsp; 
0:00 </code><code class="bash functions">ssh</code> <code class="bash plain">-L 9527:centos6-1:23 -Nf centos6</code></div><div class="line number22 index21 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># killall ssh&nbsp;&nbsp; #删除搭建的桥</code></div><div class="line number23 index22 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># telnet centos6-1 #此时可以说明清除成功</code></div><div class="line number24 index23 alt1"><code class="bash plain">Trying 172.18.253.192...</code></div><div class="line number25 index24 alt2"><code class="bash plain">telnet: connect to address 172.18.253.192: Connection refused</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>&nbsp;</p>
</div>
<div style="font-size: 0.875rem;"><span style="color: #df402a;">总结：</span></div>
<div style="font-size: 0.875rem;">Centos6上面实现代理***不能用1080端口</div>
<div style="font-size: 0.875rem;">有的公司管理的比较严格，指向外面开放80端口，如果想从我外面连接主机可以改ssh接口，在连接指定端口-p</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<h3 style="font-size: 0.875rem;" id="blogTitle3">四：SSH端口远程装发</h3>
<div style="font-size: 0.875rem;">远程转发机制：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">-R sshserverport:remotehost:remotehostportsshserver</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">举例：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">ssh–R 9527:telnetsrv:23 –N sshsrv</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">让sshsrv侦听9527端口的访问，如有访问，就加密后通过ssh服务转发请求到本机ssh客户端，再由本机解密后转发到telnetsrv:23</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">Data &lt; &gt; sshsrv:9527 &lt; &gt; sshsrv:22 &lt; &gt; localhost:XXXXX &lt; &gt; localhost:YYYYY&lt; &gt;telnetsrv:23</div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">需求：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">在A(Centos7)上开启smtp服务（postfix)，B(Centos6)做跳板，C(Centos6-1)客户端给Centos7发送邮件</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">流程解析：</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">C-x-&gt;A &nbsp; &nbsp;（拒绝访问）</div>
<div style="text-align: left; margin-left: 28px; font-size: 0.875rem;">C-B-&gt;A &nbsp; &nbsp; &nbsp;（通过远程代理，接受访问） &nbsp;&nbsp;</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">查看环境：&nbsp;</div>
</div>
<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">
<div style="font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_926127" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ss -ntl&nbsp;&nbsp; #查看25端口有没有开启</code></div><div class="line number2 index1 alt1"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
127.0.0.1:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 *:*&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># vim /etc/postfix/main.cf&nbsp;&nbsp; #对文件配置文件进行修改，Centos7已经不同早期系统使用sendmail作为默认邮件服务器</code></div><div class="line number4 index3 alt1"><code class="bash comments">#目的：修改绑定接口配置</code></div><div class="line number5 index4 alt2"><code class="bash comments"># 不同文件有些localhost意思完全相反，此处localhost再邮件是127，而DNS中是表示的是本地的所有IP,相当于此处的all</code></div><div class="line number6 index5 alt1"><code class="bash comments">#inet_interfaces = all&nbsp;&nbsp; #此行不是所有主机而是所有ip意思&nbsp;&nbsp; #此处去掉注释</code></div><div class="line number7 index6 alt2"><code class="bash comments">#inet_interfaces = $myhostname</code></div><div class="line number8 index7 alt1"><code class="bash comments">#inet_interfaces = $myhostname, localhost</code></div><div class="line number9 index8 alt2"><code class="bash plain">inet_interfaces = localhost&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#这一行说明接口是绑定在127.0.0.1上&nbsp;&nbsp; #加上注释</code></div><div class="line number10 index9 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ss -ntl</code></div><div class="line number11 index10 alt2"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
*:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 *:*</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</blockquote>
<div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">环境配置：</div>
<div style="margin-left: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_585503" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># systemctl start telnet.socket&nbsp;&nbsp; #开启telnet-server</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># systemctl status telnet.socket&nbsp;&nbsp; #查看一下是否已经开启</code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># iptables -nvL&nbsp;&nbsp; #查看一下防火墙策略</code></div><div class="line number4 index3 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># systemctl stop firewalld.service&nbsp;&nbsp;&nbsp;&nbsp; #关闭防火墙</code></div><div class="line number5 index4 alt2"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># chkconfig --list iptables&nbsp;&nbsp; #查看各运行级别防火墙开机运行状态&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">iptables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0:off&nbsp;&nbsp; 1:off&nbsp;&nbsp; 2:on&nbsp;&nbsp;&nbsp; 
3:on&nbsp;&nbsp;&nbsp; 4:on&nbsp;&nbsp;&nbsp; 5:on&nbsp;&nbsp;&nbsp; 
6:off</code></div><div class="line number7 index6 alt2"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># chkconfig iptables off&nbsp;&nbsp; #关闭防火墙</code></div><div class="line number8 index7 alt1"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># chkconfig --list iptables&nbsp;&nbsp; #所有运行级别防火墙都关闭</code></div><div class="line number9 index8 alt2"><code class="bash plain">iptables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0:off&nbsp;&nbsp; 1:off&nbsp;&nbsp; 2:off&nbsp;&nbsp; 3:off&nbsp;&nbsp;
 4:off&nbsp;&nbsp; 5:off&nbsp;&nbsp; 6:off</code></div><div class="line number10 index9 alt1"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># chkconfig --del iptables&nbsp;&nbsp; #移除开机自动启动防火墙</code></div><div class="line number11 index10 alt2"><code class="bash plain">[root@Centos6-1 ~]</code><code class="bash comments"># telnet centos7 25&nbsp;&nbsp; #测试centos6-1可以通过telnet 25端口连接Centos7</code></div><div class="line number12 index11 alt1"><code class="bash plain">Trying 172.18.254.173...</code></div><div class="line number13 index12 alt2"><code class="bash plain">Connected to centos7.</code></div><div class="line number14 index13 alt1"><code class="bash plain">Escape character is </code><code class="bash string">'^]'</code><code class="bash plain">.</code></div><div class="line number15 index14 alt2"><code class="bash plain">220 centos7.localdomain ESMTP Postfix&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#测试成功，25端口可以连接</code></div><div class="line number16 index15 alt1"><code class="bash comments">#关闭跳板机(Centos6)和远程服务器(Centos7)上的SELINUX</code></div><div class="line number17 index16 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># vim /etc/selinux/config</code></div><div class="line number18 index17 alt1"><code class="bash plain">SELINUX=disabled</code></div><div class="line number19 index18 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># setenforce 0</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　</p>
</div>
</div>
<div>
<div style="text-align: left; font-size: 0.875rem;">创建目标条件：</div>
</div>
<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">
<div style="font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_987990" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># iptables -A INPUT -s centos6-1 -j REJECT&nbsp;&nbsp; #设置防火墙策略，使Centos7不接受Centos6一切请求</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># telnet centos7 25</code></div><div class="line number3 index2 alt2"><code class="bash plain">Trying 172.18.254.173...</code></div><div class="line number4 index3 alt1"><code class="bash plain">telnet: connect to address 172.18.254.173: Connection refused</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</blockquote>
<div>
<div style="text-align: left; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">操作：Centos6-1使用远程转发，发送邮件给Centos7</div>
<div style="font-size: 0.875rem;">&nbsp;　　
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_531320" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># ssh -R 9527:centos7:25 -fN centos6-1&nbsp;&nbsp; #建立隧道,此过程确保Centos6可以公钥连接centos6-1，否则需要手动口令验证</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># ss -ntl&nbsp;&nbsp;&nbsp; #检查邮件服务，可以知道服务已经开启</code></div><div class="line number3 index2 alt2"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
::1:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 :::*&nbsp;&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
127.0.0.1:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 *:*&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">[root@centos6-1 .</code><code class="bash functions">ssh</code><code class="bash plain">]</code><code class="bash comments"># ss -ntl&nbsp;&nbsp; #此时也可以看到跳板机Centos6-1上9527端口已经在监听</code></div><div class="line number6 index5 alt1"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
127.0.0.1:9527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 *:*&nbsp;&nbsp;&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
::1:9527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 :::*&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># ps -ef |grep ssh&nbsp;&nbsp; #查看一下ssh运行的进程</code></div><div class="line number9 index8 alt2"><code class="bash plain">root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 2288&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp; 0 09:58 
?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00:00:00 </code><code class="bash functions">ssh</code> <code class="bash plain">-R 9527:centos7:25 -fN centos6-1</code></div><div class="line number10 index9 alt1"><code class="bash plain">[root@centos6-1 .</code><code class="bash functions">ssh</code><code class="bash plain">]</code><code class="bash comments"># telnet 127.0.0.1 9527&nbsp;&nbsp; #此时可以通过telnet连接Cetnos7绕过了防火墙</code></div><div class="line number11 index10 alt2"><code class="bash plain">Trying 127.0.0.1...</code></div><div class="line number12 index11 alt1"><code class="bash plain">Connected to 127.0.0.1.</code></div><div class="line number13 index12 alt2"><code class="bash plain">Escape character is </code><code class="bash string">'^]'</code><code class="bash plain">.</code></div><div class="line number14 index13 alt1"><code class="bash plain">220 centos7.localdomain ESMTP Postfix&nbsp;&nbsp;&nbsp; </code><code class="bash comments">#如果想退出进入telnet&gt;&nbsp;&nbsp; 快捷键ctrl + ]</code></div><div class="line number15 index14 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># ss -nt</code></div><div class="line number16 index15 alt1"><code class="bash plain">State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Recv-Q 
Send-Q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Local 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Peer 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 </code></div><div class="line number17 index16 alt2"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.254.173:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.175:32898&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 </code></div><div class="line number18 index17 alt1"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.254.173:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.0.100:58652</code></div><div class="line number19 index18 alt2"><code class="bash comments">#此时在Centos7上发现有IP尾号为100的机子在连接实际上是Centos6-1在连接</code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;</code>&nbsp;</div><div class="line number21 index20 alt2"><code class="bash comments">#最后验证是否能成功发送邮件</code></div><div class="line number22 index21 alt1"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># telnet localhost 9527&nbsp;&nbsp; #给Centos7发送邮件</code></div><div class="line number23 index22 alt2"><code class="bash plain">Trying ::1...</code></div><div class="line number24 index23 alt1"><code class="bash plain">Connected to localhost.</code></div><div class="line number25 index24 alt2"><code class="bash plain">Escape character is </code><code class="bash string">'^]'</code><code class="bash plain">.</code></div><div class="line number26 index25 alt1"><code class="bash plain">220 centos7.localdomain ESMTP Postfix</code></div><div class="line number27 index26 alt2"><code class="bash plain">mail from:ceo@app.com</code></div><div class="line number28 index27 alt1"><code class="bash plain">250 2.1.0 Ok</code></div><div class="line number29 index28 alt2"><code class="bash plain">rcpt to:root@centos7</code></div><div class="line number30 index29 alt1"><code class="bash plain">250 2.1.5 Ok</code></div><div class="line number31 index30 alt2"><code class="bash plain">data</code></div><div class="line number32 index31 alt1"><code class="bash plain">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</code></div><div class="line number33 index32 alt2"><code class="bash plain">hello</code></div><div class="line number34 index33 alt1"><code class="bash plain">.</code></div><div class="line number35 index34 alt2"><code class="bash plain">250 2.0.0 Ok: queued as 86A5411EA866</code></div><div class="line number36 index35 alt1"><code class="bash plain">quit</code></div><div class="line number37 index36 alt2"><code class="bash plain">221 2.0.0 Bye</code></div><div class="line number38 index37 alt1"><code class="bash plain">Connection closed by foreign host.</code></div><div class="line number39 index38 alt2"><code class="bash spaces">&nbsp;</code>&nbsp;</div><div class="line number40 index39 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># mail&nbsp;&nbsp;&nbsp; #可以收到邮件信息</code></div><div class="line number41 index40 alt2"><code class="bash plain">Heirloom Mail version 12.5 7</code><code class="bash plain">/5/10</code><code class="bash plain">. Type ? </code><code class="bash keyword">for</code> <code class="bash plain">help.</code></div><div class="line number42 index41 alt1"><code class="bash string">"/var/spool/mail/root"</code><code class="bash plain">: 12 messages 12 new</code></div><div class="line number43 index42 alt2"><code class="bash plain">&gt;N&nbsp;
 1 
root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Fri Mar 16 10:31&nbsp; 14</code><code class="bash plain">/496</code>&nbsp;&nbsp; <code class="bash string">"Output from your job&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4"</code></div><div class="line number44 index43 alt1"><code class="bash plain">N&nbsp; 2 (Cron Daemon)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sat Mar 17 08:00&nbsp; 25</code><code class="bash plain">/886</code>&nbsp;&nbsp; <code class="bash string">"Cron &lt;root@zangfans&gt; /root/bin/etcback.sh"</code></div><div class="line number45 index44 alt2"><code class="bash plain">N&nbsp;
 3 
root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Sat Mar 17 10:20&nbsp; 14</code><code class="bash plain">/506</code>&nbsp;&nbsp; <code class="bash string">"Output from your job&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2"</code></div><div class="line number46 index45 alt1"><code class="bash plain">N&nbsp; 4 (Cron Daemon)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tue Mar 20 08:00&nbsp; 25</code><code class="bash plain">/886</code>&nbsp;&nbsp; <code class="bash string">"Cron &lt;root@zangfans&gt; /root/bin/etcback.sh"</code></div><div class="line number47 index46 alt2"><code class="bash plain">N&nbsp; 5 user@localhost.</code><code class="bash functions">local</code> <code class="bash plain">Wed Mar 28 08:19 2129</code><code class="bash plain">/142373</code> <code class="bash string">"[abrt] kernel: WARNING: CPU: 1 PID: 0 at net/sched/sch_generic.c:300 dev"</code></div><div class="line number48 index47 alt1"><code class="bash plain">N&nbsp; 6 user@localhost.</code><code class="bash functions">local</code> <code class="bash plain">Fri Apr&nbsp; 6 19:41 1151</code><code class="bash plain">/90323</code> <code class="bash string">"[abrt] nautilus: nautilus-desktop killed by SIGSEGV"</code></div><div class="line number49 index48 alt2"><code class="bash plain">N&nbsp; 7 HR@centos7.localdoma Tue Apr 10 14:44&nbsp; 16</code><code class="bash plain">/633</code>&nbsp;&nbsp; <code class="bash string">"*** SECURITY information for centos7 ***"</code></div><div class="line number50 index49 alt1"><code class="bash plain">N&nbsp; 8 HR@centos7.localdoma Tue Apr 10 16:38&nbsp; 16</code><code class="bash plain">/637</code>&nbsp;&nbsp; <code class="bash string">"*** SECURITY information for centos7 ***"</code></div><div class="line number51 index50 alt2"><code class="bash plain">N&nbsp; 9 HR@centos7.localdoma Tue Apr 10 16:38&nbsp; 16</code><code class="bash plain">/641</code>&nbsp;&nbsp; <code class="bash string">"*** SECURITY information for centos7 ***"</code></div><div class="line number52 index51 alt1"><code class="bash plain">N 10 HR@centos7.localdoma Tue Apr 10 16:39&nbsp; 16</code><code class="bash plain">/637</code>&nbsp;&nbsp; <code class="bash string">"*** SECURITY information for centos7 ***"</code></div><div class="line number53 index52 alt2"><code class="bash plain">N 11 HR@centos7.localdoma Tue Apr 10 16:39&nbsp; 16</code><code class="bash plain">/641</code>&nbsp;&nbsp; <code class="bash string">"*** SECURITY information for centos7 ***"</code></div><div class="line number54 index53 alt1"><code class="bash plain">N 12 ceo@app.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Wed Apr 11 10:20&nbsp; 10</code><code class="bash plain">/314</code>&nbsp;</div><div class="line number55 index54 alt2"><code class="bash plain">&amp; 12</code></div><div class="line number56 index55 alt1"><code class="bash plain">Message 12:</code></div><div class="line number57 index56 alt2"><code class="bash plain">From ceo@app.com Wed Apr 11 10:20:29 2018</code></div><div class="line number58 index57 alt1"><code class="bash plain">Return-Path: &lt;ceo@app.com&gt;</code></div><div class="line number59 index58 alt2"><code class="bash plain">X-Original-To: root@centos7</code></div><div class="line number60 index59 alt1"><code class="bash plain">Delivered-To: root@centos7.localdomain</code></div><div class="line number61 index60 alt2"><code class="bash plain">Status: R</code></div><div class="line number62 index61 alt1"><code class="bash spaces">&nbsp;</code>&nbsp;</div><div class="line number63 index62 alt2"><code class="bash plain">hello</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
</div>
<h3 style="font-size: 0.875rem;" id="blogTitle4">五：动态端口转发</h3>
<div style="text-align: left; font-size: 0.875rem;">原理：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">当用firefox访问internet时，本机的1080端口做为代理服务器，firefox的访问请求被转发到sshserver上，由sshserver替之访问internet</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">动态转发机制：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">ssh-D 1080 root@sshserver</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">在本机firefox设置代理socket proxy:127.0.0.1:1080</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">测试：</div>
<div style="text-align: left; text-indent: 28px; font-size: 0.875rem;">curl --socks5 127.0.0.1:1080 http://zangfans.com</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">在企业内部或者网络中，基于安全策略不能随便访问互联网某些站点</div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171323061-1702527990.png" target="_blank"><img style="width: 620px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171323061-1702527990.png" alt="" data-media-type="image" data-attr-org-src-id="9A87F7D73C2B4DDAB961A0557DBE4021" width="800" height="286"></a></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">需求:</div>
<div style="margin-left: 28px; font-size: 0.875rem;">访问站点：Centos7</div>
<div style="margin-left: 28px; font-size: 0.875rem;">代理服务：centos6</div>
<div style="margin-left: 28px; font-size: 0.875rem;">企业内部主机：Centos6-1</div>
<div style="margin-left: 28px; font-size: 0.875rem;">&nbsp;</div>
<div style="text-align: left; font-size: 0.875rem;">环境配置:</div>
<div style="margin-left: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_874902" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># systemctl status httpd&nbsp;&nbsp; #查看Cetnos7上httpd服务有没有开启</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@centos7 ~]</code><code class="bash comments"># iptables -A INPUT -s centos6-1 -j REJECT&nbsp;&nbsp; #设置防火墙策略，使Centos7不接受Centos6一切请求</code></div><div class="line number3 index2 alt2"><code class="bash comments">#确保Centos6,Centos6-1开启了防火墙都关闭了</code></div><div class="line number4 index3 alt1"><code class="bash comments">#设置Centos7网页显示内容</code></div><div class="line number5 index4 alt2"><code class="bash plain">[root@centos7 html]</code><code class="bash comments"># vim index.html</code></div><div class="line number6 index5 alt1"><code class="bash plain">&lt;h1&gt;www.google.com&lt;</code><code class="bash plain">/h1</code><code class="bash plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">#虚拟机上此时是否能够访问Centos7站点</div>
<div style="font-size: 0.875rem;">#在此处需要多加，主机自己现在init如果从runlevel 3到5可能会出现重启防火墙策略，开启则关闭策略，对Centos7的策略重置</div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171323480-1118140619.png" target="_blank"><img style="width: 543px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171323480-1118140619.png" alt="" data-media-type="image" data-attr-org-src-id="03628A4DD45647878941C08E4274BD3E" width="800" height="430"></a></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;">操作：</div>
<div style="margin-left: 28px; font-size: 0.875rem;">选项： &nbsp;-D &nbsp; 本地端口号</div>
<div style="margin-left: 28px; font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_427636" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># ssh -D 1080 centos6&nbsp;&nbsp; #无秘钥登录，则需要密码验证</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@Centos6 ~]</code><code class="bash comments"># ss -nt</code></div><div class="line number3 index2 alt2"><code class="bash plain">State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Recv-Q 
Send-Q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Local 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Peer Address:Port</code></div><div class="line number4 index3 alt1"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.175:47618&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.253.192:22&nbsp;&nbsp;&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.175:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.253.192:45114</code></div><div class="line number6 index5 alt1"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.175:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.0.100:58896</code></div><div class="line number7 index6 alt2"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># ss -nt</code></div><div class="line number8 index7 alt1"><code class="bash plain">State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Recv-Q 
Send-Q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Local 
Address:Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Peer Address:Port</code></div><div class="line number9 index8 alt2"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.192:45172&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.253.175:22&nbsp;&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.192:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.0.100:58868</code></div><div class="line number11 index10 alt2"><code class="bash plain">ESTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
172.18.253.192:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 172.18.253.175:47618</code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;</code>&nbsp;</div><div class="line number13 index12 alt2"><code class="bash comments">#最后通过curl命令页面验证</code></div><div class="line number14 index13 alt1"><code class="bash plain">[root@centos6-1 ~]</code><code class="bash comments"># curl --socks5 127.0.0.1 centos7&nbsp;&nbsp; #默认端口就是1080</code></div><div class="line number15 index14 alt2"><code class="bash plain">&lt;h1&gt;www.google.com&lt;</code><code class="bash plain">/h1</code><code class="bash plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
<div style="font-size: 0.875rem;">　<span style="background-color: #0000ff;">　#此方法也只能通过linux机器才进行互联网访问，windows机器暂不支持</span></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
<div style="font-size: 0.875rem;"><span style="background-color: #ff0000;">知识补充</span></div>
<div style="font-size: 0.875rem;">curl里面--socks5选项</div>
<div style="font-size: 0.875rem;">
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_214516" class="syntaxhighlighter  bash"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">--socks5 &lt;host[:port]&gt;</code></div><div class="line number2 index1 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">Use the specified SOCKS5 proxy&nbsp; - but resolve the host name locally. If the port number is not specified, it is</code></div><div class="line number3 index2 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">assumed at port 1080.</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">This option overrides any previous use of -x, --proxy, as they are mutually exclusive.</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">Since 7.21.7, this option is superfluous since you can specify a socks5 proxy with -x, --proxy using a socks5:</code><code class="bash plain">//</code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">protocol prefix.</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">If this option is used several </code><code class="bash functions">times</code><code class="bash plain">, the last one will be used. (This option was previously wrongly documented and</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">used as --socks without the number appended.)</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">This option (as well as --socks4) does not work with IPV6, FTPS or LDAP.</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
</div>
<div style="font-size: 0.875rem;"><span style="color: #ff0000;">基于网页验证</span></div>
<div style="font-size: 0.875rem;">此时虚拟机任不能直接访问Centos7，下面设置socks代理</div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171324105-469603903.png" target="_blank"><img style="width: 586px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171324105-469603903.png" alt="" data-media-type="image" data-attr-org-src-id="F2D187D147BE4D45A7B0FAECE3F18126" width="800" height="599"></a></div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171324934-1602967774.png" target="_blank"><img style="width: 601px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171324934-1602967774.png" alt="" data-media-type="image" data-attr-org-src-id="1031574B2CB24B42B4EC86B5C2A9AEF7" width="800" height="573"></a></div>
<div><a href="https://images2018.cnblogs.com/blog/1270435/201804/1270435-20180415171325360-1299710675.png" target="_blank"><img style="width: 605px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171325360-1299710675.png" alt="" data-media-type="image" data-attr-org-src-id="7CCEEEE13C9A4D54BC781F5CBB06AA47" width="800" height="605"></a></div>
<div><img style="width: 337px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171325672-468424161.png" alt="" data-media-type="image" data-attr-org-src-id="F78E9FC97BD44CADB79B275F0CFC7105"></div>
<div style="font-size: 0.875rem;">当本地1080端口受到外部网站请求会转发到外部服务器上面去，代理服务器通过1080端口把请求转发到站点服务器上面去</div>
<div style="font-size: 0.875rem;">此时方可正常访问外部站点</div>
<div><img style="width: 412px;" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1270435-20180415171325972-1151616025.png" alt="" data-media-type="image" data-attr-org-src-id="EBDCCDD08B6240BE8234CD2D98841CBB"></div>
<div style="font-size: 0.875rem;">&nbsp;</div>
</div>
<p>&nbsp;</p></div><div id="MySignature" style="display: block;"><div>作者：<a href="http://www.cnblogs.com/zangfans/">zangfans</a></div>
<div>出处：<a href="http://www.cnblogs.com/zangfans/">http://www.cnblogs.com/zangfans/
</a></div>
<p>-------------------------------------------</p>
<p>个性签名：独学而无友，则孤陋而寡闻。做一个灵魂有趣的人！</p>
<p>如果觉得这篇文章对你有小小的帮助的话，记得在右下角点个<span>“推荐”</span>哦，博主在此感谢！</p>
<p></p></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="https://www.cnblogs.com/zangfans/category/1176956.html" target="_blank">linux运维进阶之路</a></div>
<div id="EntryTag">标签: <a href="https://www.cnblogs.com/zangfans/tag/SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89/">SSH端口转发（本地转发、远程转发、动态转发）</a></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(8848279,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
            <a id="green_channel_follow" onclick="follow('b368ffb3-fa6b-448b-56c9-08d4ef52ecb6');" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/zangfans/" target="_blank"><img src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/20171202180322.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/zangfans/">zangfans</a><br>
            <a href="http://home.cnblogs.com/u/zangfans/followees">关注 - 93</a><br>
            <a href="http://home.cnblogs.com/u/zangfans/followers">粉丝 - 11</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow('b368ffb3-fa6b-448b-56c9-08d4ef52ecb6');return false;">+加关注</a>
    </div>
</div>
<div id="div_digg"><div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px"></span><a onclick="cnblogs.UserManager.FollowBlogger('9a35f2c7-18ab-e111-aa3f-842b2b196315');" href="javascript:void(0);" style="font-weight: bold; padding-left:5px;">关注一下楼主吧</a> </div>
    <div class="diggit" onclick="votePost(8848279,'Digg')">
        <span class="diggnum" id="digg_count">5</span>
    </div>
    <div class="buryit" onclick="votePost(8848279,'Bury')">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/zangfans/p/8672155.html" class="p_n_p_prefix">« </a> 上一篇：<a href="https://www.cnblogs.com/zangfans/p/8672155.html" title="发布于2018-03-29 20:18">linux系统无法正常启动，故障排查恢复</a><br><a href="https://www.cnblogs.com/zangfans/p/9140805.html" class="p_n_p_prefix">» </a> 下一篇：<a href="https://www.cnblogs.com/zangfans/p/9140805.html" title="发布于2018-06-05 17:15">MySQL主从复制，主主复制，半同步复制</a><br></div>
</div>


		</div>
		<p class="postfoot">
			posted on <span id="post-date">2018-04-15 20:57</span> <a href="https://www.cnblogs.com/zangfans/">zangfans</a> 阅读(<span id="post_view_count">14497</span>) 评论(<span id="post_comment_count">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=8848279" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(8848279);return false;">收藏</a>
		</p>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=392110,cb_entryId=8848279,cb_blogApp=currentBlogApp,cb_blogUserGuid='b368ffb3-fa6b-448b-56c9-08d4ef52ecb6',cb_entryCreatedDate='2018/4/15 20:57:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
	
	</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login('commentform');">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-工控')">【推荐】超50万C++/C#源码: 大型实时仿真组态图形源码</a><br><a href="https://www.bagevent.com/event/2195041?bag_track=13072958" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-看雪')">【活动】看雪2019安全开发者峰会，共话安全领域焦点</a><br></div>
<div id="opt_under_post"></div>
<script async="async" src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/gpt.js"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id="cnblogs_c1" class="c_ad_block">
    <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;" data-google-query-id="COyvx7GjluICFRi8vQod2FMAgA"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C1_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="1" data-load-complete="true" width="300" height="250" frameborder="0"></iframe></div></div>
</div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>相关博文：</b><br>·  <a href="https://www.cnblogs.com/liuwentaolaji/p/9608255.html" target="_blank" onclick="clickRecomItmem(9608255)">ssh端口转发详解</a><br>·  <a href="https://www.cnblogs.com/bailandecheng/p/9609316.html" target="_blank" onclick="clickRecomItmem(9609316)">ssh的端口转发</a><br>·  <a href="https://www.cnblogs.com/sign-ptk/p/6116389.html" target="_blank" onclick="clickRecomItmem(6116389)">SSH的端口转发</a><br>·  <a href="https://www.cnblogs.com/Hi-blog/p/7473752.html" target="_blank" onclick="clickRecomItmem(7473752)">【译】SSH隧道：本地和远程端口转发</a><br>·  <a href="https://www.cnblogs.com/keerya/p/7612715.html" target="_blank" onclick="clickRecomItmem(7612715)">SSH端口转发详解及实例</a><br></div></div>
<div id="cnblogs_c2" class="c_ad_block">
    <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;" data-google-query-id="CO2vx7GjluICFRi8vQod2FMAgA"><div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C2_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C2_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="2" data-load-complete="true" width="468" height="60" frameborder="0"></iframe></div></div>
</div>
<div id="under_post_kb"><div class="itnews c_ad_block"><b>最新新闻</b>：<br> ·  <a href="https://news.cnblogs.com/n/625158/" target="_blank">谷歌"羞辱"苹果：iPhone XS贵 夜拍还没Pixel 3a好</a><br> ·  <a href="https://news.cnblogs.com/n/625157/" target="_blank">超高ppi警告：剑桥大学研究出了像素仅有主流百万分之一大的柔性彩色显示屏</a><br> ·  <a href="https://news.cnblogs.com/n/625156/" target="_blank">腾讯最新手游《和平精英》上线吸金 3天狂揽近亿</a><br> ·  <a href="https://news.cnblogs.com/n/625155/" target="_blank">ICML 2019论文录取Top100：谷歌霸榜</a><br> ·  <a href="https://news.cnblogs.com/n/625154/" target="_blank">女子买18件衣服旅游后退货引热议 淘宝官方回应：相信人性的美好</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
</div>
</div>
<div id="leftmenu">


<h3>导航</h3>
<ul>
<li>
<a id="blog_nav_sitehome" href="https://www.cnblogs.com/">博客园</a></li>
<li>
<a id="blog_nav_myhome" class="two_words" href="https://www.cnblogs.com/zangfans/">首页</a></li>
<li>
<a id="blog_nav_newpost" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li>
<a id="blog_nav_contact" accesskey="9" class="two_words" rel="nofollow" href="https://msg.cnblogs.com/send/zangfans">联系</a></li>
<li>
<a id="blog_nav_rss" class="two_words" href="https://www.cnblogs.com/zangfans/rss">订阅</a>
<a id="blog_nav_rss_image" href="https://www.cnblogs.com/zangfans/rss"><img src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/xml.gif" alt="订阅"></a>
</li>
<li>
<a id="blog_nav_admin" class="two_words" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>

<div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" title="Calendar" cellspacing="0" cellpadding="0">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar('2019/04/01');return false;">&lt;</a></td><td align="center">2019年5月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar('2019/06/01');return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" abbr="日" scope="col" align="center">日</th><th class="CalDayHeader" abbr="一" scope="col" align="center">一</th><th class="CalDayHeader" abbr="二" scope="col" align="center">二</th><th class="CalDayHeader" abbr="三" scope="col" align="center">三</th><th class="CalDayHeader" abbr="四" scope="col" align="center">四</th><th class="CalDayHeader" abbr="五" scope="col" align="center">五</th><th class="CalDayHeader" abbr="六" scope="col" align="center">六</th></tr><tr><td class="CalOtherMonthDay" align="center">28</td><td class="CalOtherMonthDay" align="center">29</td><td class="CalOtherMonthDay" align="center">30</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td class="CalWeekendDay" align="center">4</td></tr><tr><td class="CalWeekendDay" align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">10</td><td class="CalWeekendDay" align="center">11</td></tr><tr><td class="CalTodayDay" align="center">12</td><td align="center">13</td><td align="center">14</td><td align="center">15</td><td align="center">16</td><td align="center">17</td><td class="CalWeekendDay" align="center">18</td></tr><tr><td class="CalWeekendDay" align="center">19</td><td align="center">20</td><td align="center">21</td><td align="center">22</td><td align="center">23</td><td align="center">24</td><td class="CalWeekendDay" align="center">25</td></tr><tr><td class="CalWeekendDay" align="center">26</td><td align="center">27</td><td align="center">28</td><td align="center">29</td><td align="center">30</td><td align="center">31</td><td class="CalOtherMonthDay" align="center">1</td></tr><tr><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td><td class="CalOtherMonthDay" align="center">7</td><td class="CalOtherMonthDay" align="center">8</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
<meta name="vs_showGrid" content="False">

<h3>公告</h3>
<div id="blog-news"><!-- 添加公告栏图片并指向首页链接 -->
<div align="center">
    <a href="http://www.cnblogs.com/zangfans/">
    <img src="SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88%E6%9C%AC%E5%9C%B0%E8%BD%AC%E5%8F%91%E3%80%81%E8%BF%9C%E7%A8%8B%E8%BD%AC%E5%8F%91%E3%80%81%E5%8A%A8%E6%80%81%E8%BD%AC%E5%8F%91%EF%BC%89%20-%20zangfans%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/11_avatar_middle.bmp"></a> 
</div>

<p class="gonggao"><a style="color: blue;font-weight: bold;" href="https://www.cnblogs.com/zangfans/p/8848279.html">我的置顶目录</a></p>
<p class="wenzi">不背锅，不运维</p>

<p>-----------------------------</p>

<!-- 添加公告栏时钟 -->
<div id="clockdiv">
    <canvas id="dom" width="120" height="120">时钟canvas</canvas>
</div>
<script type="text/javascript">window['__document_write_ajax_callbacks__']['4']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['1']();</script>

<!-- 为页面添加爱心特效 -->
<script type="text/javascript">window['__document_write_ajax_callbacks__']['6']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['2']();</script><div id="profile_block">昵称：<a href="https://home.cnblogs.com/u/zangfans/">zangfans</a><br>园龄：<a href="https://home.cnblogs.com/u/zangfans/" title="入园时间：2017-11-01">1年6个月</a><br>粉丝：<a href="https://home.cnblogs.com/u/zangfans/followers/">11</a><br>关注：<a href="https://home.cnblogs.com/u/zangfans/followees/">93</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow('b368ffb3-fa6b-448b-56c9-08d4ef52ecb6')">+加关注</a></div><script type="text/javascript">window['__document_write_ajax_callbacks__']['7']();</script><script>window['__document_write_ajax_callbacks__']['3']();</script></div></div><script type="text/javascript">loadBlogNews();</script>

<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>

</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="https://www.cnblogs.com/zangfans/p/" title="我的博客的随笔列表">我的随笔</a></li><li><a href="https://www.cnblogs.com/zangfans/MyComments.html" title="我发表过的评论列表">我的评论</a></li><li><a href="https://www.cnblogs.com/zangfans/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li><li><a href="https://www.cnblogs.com/zangfans/RecentComments.html" title="我的博客的评论列表">最新评论</a></li><li><a href="https://www.cnblogs.com/zangfans/tag/" title="我的博客的标签列表">我的标签</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">

</div></div><div id="sidebar_recentposts" class="sidebar-block">
<h3 class="catListTitle">最新随笔</h3>
<div class="RecentComment" id="RecentPosts">
<ul style="word-break:break-all">
<li><a href="https://www.cnblogs.com/zangfans/p/9217131.html">1. ELK架构</a></li><li><a href="https://www.cnblogs.com/zangfans/p/9140805.html">2. MySQL主从复制，主主复制，半同步复制</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8848279.html">3. SSH端口转发（本地转发、远程转发、动态转发）</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8672155.html">4. linux系统无法正常启动，故障排查恢复</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8646013.html">5. linux内核管理</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8595000.html">6. htop命令使用详解</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8545558.html">7. 网络管理学习中解决的几个问题</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8526304.html">8. 三月江南</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8413570.html">9. linux下文本三剑客之sed</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8371794.html">10. linux下五种查找命令</a></li>
</ul>
</div>
</div><div id="sidebar_toptags" class="sidebar-block">
<h3 class="catListTitle">我的标签</h3>
<div id="MyTag">
<ul>
<li><a href="https://www.cnblogs.com/zangfans/tag/htop%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/">htop命令详解</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E6%9F%A5%E6%89%BE%E5%91%BD%E4%BB%A4/">linux查找命令</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E5%91%BD%E4%BB%A4%E7%B1%BB%E5%9E%8B%E5%8F%8A%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F/">linux命令类型及执行顺序</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E5%86%85%E6%A0%B8/">linux内核</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E5%86%85%E6%A0%B8%E7%AE%A1%E7%90%86/">linux内核管理</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8B%E4%B8%80grep/">linux三剑客之一grep</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/Linux%E7%BD%91%E5%8D%A1bond%E7%9A%84%E4%B8%83%E7%A7%8D%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3/">Linux网卡bond的七种模式详解</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E5%90%AF%E5%8A%A8/">linux系统无法正常启动</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E4%B8%8Brpm%E7%9A%84%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99/">linux下rpm的命名规则</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/linux%E4%B8%8B%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bsed/">linux下文本三剑客之sed</a>(1)</li><li><a href="https://www.cnblogs.com/zangfans/tag/">更多</a></li>
</ul>
</div></div><div id="sidebar_categories">
		<h3>随笔分类</h3>
		
				<ul>
			
				<li><a id="CatList_LinkList_0_Link_0" href="https://www.cnblogs.com/zangfans/category/1237387.html">DBA之路</a></li>
			
				<li><a id="CatList_LinkList_0_Link_1" href="https://www.cnblogs.com/zangfans/category/1176956.html">linux运维进阶之路(8)</a></li>
			
				</ul>
			
	
		<h3>随笔档案</h3>
		
				<ul>
			
				<li><a id="CatList_LinkList_1_Link_0" href="https://www.cnblogs.com/zangfans/archive/2018/06.html">2018年6月 (2)</a></li>
			
				<li><a id="CatList_LinkList_1_Link_1" href="https://www.cnblogs.com/zangfans/archive/2018/04.html">2018年4月 (1)</a></li>
			
				<li><a id="CatList_LinkList_1_Link_2" href="https://www.cnblogs.com/zangfans/archive/2018/03.html">2018年3月 (6)</a></li>
			
				<li><a id="CatList_LinkList_1_Link_3" href="https://www.cnblogs.com/zangfans/archive/2018/02.html">2018年2月 (1)</a></li>
			
				<li><a id="CatList_LinkList_1_Link_4" href="https://www.cnblogs.com/zangfans/archive/2018/01.html">2018年1月 (5)</a></li>
			
				</ul>
			
	
		<h3>文章分类</h3>
		
				<ul>
			
				<li><a id="CatList_LinkList_2_Link_0" href="https://www.cnblogs.com/zangfans/category/1107322.html">Django</a></li>
			
				<li><a id="CatList_LinkList_2_Link_1" href="https://www.cnblogs.com/zangfans/category/1107321.html">java</a></li>
			
				<li><a id="CatList_LinkList_2_Link_2" href="https://www.cnblogs.com/zangfans/category/1107320.html">Linux(4)</a></li>
			
				<li><a id="CatList_LinkList_2_Link_3" href="https://www.cnblogs.com/zangfans/category/1148509.html">Mysql(1)</a></li>
			
				<li><a id="CatList_LinkList_2_Link_4" href="https://www.cnblogs.com/zangfans/category/1107318.html">python之路(5)</a></li>
			
				</ul>
			
	</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<h3 class="catListTitle">最新评论</h3>
<div class="RecentComment" id="RecentComments">
	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/zangfans/p/8672155.html#4118137">1. Re:linux系统无法正常启动，故障排查恢复</a></li>
        <li class="recent_comment_body">哇，太厉害了！正好有一个问题请教，我系统进不去，卡在一个界面不动了：[ 3.041055] i8024：No controller found[ 3.604025] megaraid_as......</li>
        <li class="recent_comment_author">--一路唱着歌谣</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/zangfans/p/8672155.html#3937472">2. Re:linux系统无法正常启动，故障排查恢复</a></li>
        <li class="recent_comment_body">好厉害。</li>
        <li class="recent_comment_author">--fsckzy</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/zangfans/p/8672155.html#3937309">3. Re:linux系统无法正常启动，故障排查恢复</a></li>
        <li class="recent_comment_body">@JeffD大佬抬举了，好好努力吧！学习总结，希望对你有帮助...</li>
        <li class="recent_comment_author">--zangfans</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/zangfans/p/8672155.html#3937255">4. Re:linux系统无法正常启动，故障排查恢复</a></li>
        <li class="recent_comment_body">mark，收徒吗，我想学linux</li>
        <li class="recent_comment_author">--JeffD</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/zangfans/p/8672155.html#3937247">5. Re:linux系统无法正常启动，故障排查恢复</a></li>
        <li class="recent_comment_body">@波波2018希望你永远没有需要的时候...</li>
        <li class="recent_comment_author">--zangfans</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<h3 class="catListTitle">阅读排行榜</h3>
<div class="RecentComment" id="TopViewPosts"> 
	<div id="TopViewPostsBlock"><ul><li><a href="https://www.cnblogs.com/zangfans/p/8848279.html">1. SSH端口转发（本地转发、远程转发、动态转发）(14496)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8672155.html">2. linux系统无法正常启动，故障排查恢复(10856)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8371794.html">3. linux下五种查找命令(4989)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8595000.html">4. htop命令使用详解(1574)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8270315.html">5. linux命令类型及执行顺序(918)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<h3 class="catListTitle">评论排行榜</h3>
<div class="RecentComment" id="TopCommentsPosts">
	<div id="TopFeedbackPostsBlock"><ul><li><a href="https://www.cnblogs.com/zangfans/p/8672155.html">1. linux系统无法正常启动，故障排查恢复(6)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8270315.html">2. linux命令类型及执行顺序(1)</a></li></ul></div>
</div></div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<h3 class="catListTitle">推荐排行榜</h3>
<div class="RecentComment">
	<div id="TopDiggPostsBlock"><ul><li><a href="https://www.cnblogs.com/zangfans/p/8848279.html">1. SSH端口转发（本地转发、远程转发、动态转发）(5)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8672155.html">2. linux系统无法正常启动，故障排查恢复(2)</a></li><li><a href="https://www.cnblogs.com/zangfans/p/8646013.html">3. linux内核管理(1)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>

</div>
</div>
<div class="clear"></div>
<div id="footer">

<p id="footer">
	Powered by: 
	<br>
	
	<a id="Footer1_Hyperlink3" name="Hyperlink1" href="https://www.cnblogs.com/" style="font-family:Verdana;font-size:12px;">博客园</a>
	<br>
	Copyright © zangfans
</p>
</div>
</div>


<!--PageEndHtml Block Begin-->
<!-- 生成博客目录的JS代码，两级目录 -->
<script type="text/javascript">
/*  
    这段代码按H2、H3格式生成两级菜单
    写博客按H2、H3格式写，不然生成不了
    Markdown写作按##、###两级目录写
    当然你也可以改写代码成三级菜单
*/
var BlogDirectory = {
    /* 获取元素位置，距浏览器左边界的距离（left）和距浏览器上边界的距离（top）*/
    getElementPosition:function (ele) {
        var topPosition = 0;
        var leftPosition = 0;
        while (ele){
            topPosition += ele.offsetTop;
            leftPosition += ele.offsetLeft;
            ele = ele.offsetParent;
        }
        return {top:topPosition, left:leftPosition};
    },
    /*获取滚动条当前位置 */
    getScrollBarPosition:function () {
        var scrollBarPosition = document.body.scrollTop || document.documentElement.scrollTop;
        return  scrollBarPosition;
    },
    /* 移动滚动条，finalPos 为目的位置，internal 为移动速度 */
    moveScrollBar:function(finalpos, interval) {
        //若不支持此方法，则退出
        if(!window.scrollTo) {
            return false;
        }
        
        //窗体滚动时，禁用鼠标滚轮
        window.onmousewheel = function(){
            return false;
        };
        
        //清除计时
        if (document.body.movement) {
            clearTimeout(document.body.movement);
        }
        
        //获取滚动条当前位置
        var currentpos =BlogDirectory.getScrollBarPosition();

        var dist = 0;
        //到达预定位置，则解禁鼠标滚轮，并退出
        if (currentpos == finalpos) {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }
        //未到达，则计算下一步所要移动的距离
        if (currentpos < finalpos) {
            dist = Math.ceil((finalpos - currentpos)/10);
            currentpos += dist;
        }
        if (currentpos > finalpos) {
            dist = Math.ceil((currentpos - finalpos)/10);
            currentpos -= dist;
        }

        var scrTop = BlogDirectory.getScrollBarPosition();//获取滚动条当前位置
        window.scrollTo(0, currentpos);//移动窗口
        if(BlogDirectory.getScrollBarPosition() == scrTop)//若已到底部，则解禁鼠标滚轮，并退出
        {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }

        //进行下一步移动
        var repeat = "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")";
        document.body.movement = setTimeout(repeat, interval);
    },

    htmlDecode:function (text){
        var temp = document.createElement("div");
        temp.innerHTML = text;
        var output = temp.innerText || temp.textContent;
        temp = null;
        return output;
    },
    
    /*
    创建博客目录，id表示包含博文正文的 div 容器的 id，
    mt 和 st 分别表示主标题和次级标题的标签名称（如 H2、H3，大写或小写都可以！），
    interval 表示移动的速度
    */
    createBlogDirectory:function (id, mt, st, interval){
        //获取博文正文div容器
        var elem = document.getElementById(id);
        if(!elem) return false;
        //获取div中所有元素结点
        var nodes = elem.getElementsByTagName("*");
        //创建博客目录的div容器
        var divSideBar = document.createElement('DIV');
        divSideBar.className = 'uprightsideBar';
        divSideBar.setAttribute('id', 'uprightsideBar');
        var divSideBarTab = document.createElement('DIV');
        divSideBarTab.setAttribute('id', 'sideBarTab');
        divSideBar.appendChild(divSideBarTab);
        var h2 = document.createElement('H2');
        divSideBarTab.appendChild(h2);
        var txt = document.createTextNode('目录导航');
        h2.appendChild(txt);
        var divSideBarContents = document.createElement('DIV');
        divSideBarContents.style.display = 'none';
        divSideBarContents.setAttribute('id', 'sideBarContents');
        divSideBar.appendChild(divSideBarContents);
        //创建自定义列表
        var dlist = document.createElement("dl");
        divSideBarContents.appendChild(dlist);
        var num = 0;//统计找到的mt和st
        mt = mt.toUpperCase();//转化成大写
        st = st.toUpperCase();//转化成大写
        //遍历所有元素结点
        for(var i=0; i<nodes.length; i++)
        {
            if(nodes[i].nodeName == mt|| nodes[i].nodeName == st)
            {
                //获取标题文本
                var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g,"");//innerHTML里面的内容可能有HTML标签，所以用正则表达式去除HTML的标签
                nodetext = nodetext.replace(/ /ig, "");//替换掉所有的
                nodetext = BlogDirectory.htmlDecode(nodetext);
                //插入锚
                nodes[i].setAttribute("id", "blogTitle" + num);
                var item;
                switch(nodes[i].nodeName)
                {
                    case mt:    //若为主标题
                        item = document.createElement("dt");
                        break;
                    case st:    //若为子标题
                        item = document.createElement("dd");
                        break;
                }

                //创建锚链接
                var itemtext = document.createTextNode(nodetext);
                item.appendChild(itemtext);
                item.setAttribute("name", num);
                //添加鼠标点击触发函数
                item.onclick = function(){        
                var pos = BlogDirectory.getElementPosition(document.getElementById("blogTitle" + this.getAttribute("name")));
                    if(!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
                };
                //将自定义表项加入自定义列表中
                dlist.appendChild(item);
                num++;
            }
        }

        if(num == 0) return false;
        /* 鼠标进入时的事件处理 */
        divSideBarTab.onmouseenter = function(){
            divSideBarContents.style.display = 'block';
        }
        /* 鼠标离开时的事件处理 */
        divSideBar.onmouseleave = function() {
            divSideBarContents.style.display = 'none';
        }

        document.body.appendChild(divSideBar);
    }

};

window.onload=function(){
    /* 页面加载完成之后生成博客目录 */
    BlogDirectory.createBlogDirectory("cnblogs_post_body","h2","h3",20);
    
    //为右下角推荐推荐区域添加关注按钮
    $('#div_digg').prepend('<div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px"></span><a onclick="cnblogs.UserManager.FollowBlogger(\'9a35f2c7-18ab-e111-aa3f-842b2b196315\');" href="javascript:void(0);" style="font-weight: bold; padding-left:5px;">关注一下楼主吧</a> </div>');
}
</script>
<!--PageEndHtml Block End-->


<script type="text/javascript">

(function(window,document,undefined){
    var hearts = [];
    
    window.requestAnimationFrame = (function(){
        return window.requestAnimationFrame || 
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
         window.oRequestAnimationFrame ||
         window.msRequestAnimationFrame ||
         function (callback){
             setTimeout(callback,1000/60);
         }
    })();
    
    init();

    function init(){
        css(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
        attachEvent();
        gameloop();
    }

    function gameloop(){
        for(var i=0;i<hearts.length;i++){
            if(hearts[i].alpha <=0){
                document.body.removeChild(hearts[i].el);
                hearts.splice(i,1);
                continue;
             }

             hearts[i].y--;
             hearts[i].scale += 0.004;
             hearts[i].alpha -= 0.013;
             hearts[i].el.style.cssText = "left:"+hearts[i].x+"px;top:"+hearts[i].y+"px;opacity:"+hearts[i].alpha+";transform:scale("+hearts[i].scale+","+hearts[i].scale+") rotate(45deg);background:"+hearts[i].color;
        }

        requestAnimationFrame(gameloop);
    }

    function attachEvent(){
        var old = typeof window.onclick==="function" && window.onclick;
        window.onclick = function(event){
            old && old();
            createHeart(event);
        }
    }

    function createHeart(event){
        var d = document.createElement("div");
        d.className = "heart";
        hearts.push({
            el : d,
            x : event.clientX - 5,
            y : event.clientY - 5,
            scale : 1,
            alpha : 1,
            color : randomColor()
        });

        document.body.appendChild(d);
    }

    function css(css){
        var style = document.createElement("style");
        style.type="text/css";
        try{
            style.appendChild(document.createTextNode(css));
        }
        catch(ex){
            style.styleSheet.cssText = css;
        }

        document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor(){
        return "rgb("+(~~(Math.random()*255))+","+(~~(Math.random()*255))+","+(~~(Math.random()*255))+")";
    }
    
})(window,document);
</script><script type="text/javascript">getFollowStatus('b368ffb3-fa6b-448b-56c9-08d4ef52ecb6')</script><div class="uprightsideBar" id="uprightsideBar"><div id="sideBarTab"><h2>目录导航</h2></div><div style="display: none;" id="sideBarContents"><dl><dd name="0">一：什么是端口转发？</dd><dd name="1">二：SSH端口转发能够提供两大功能：</dd><dd name="2">三：SSH端口本地转发</dd><dd name="3">四：SSH端口远程装发</dd><dd name="4">五：动态端口转发</dd></dl></div></div></body></html>