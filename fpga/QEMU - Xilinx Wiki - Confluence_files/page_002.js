(window.webpackJsonp=window.webpackJsonp||[]).push([[345],{Cy2Q:function(t,e,n){"use strict";n.r(e);var o=n("97Jx"),a=n.n(o),r=n("ERkP"),i=n.n(r),c=n("uDfI"),s=n("Bud6"),l=n("kR5U"),u=n("/FQd"),d=n("VrFO"),f=n.n(d),p=n("Y9Ll"),m=n.n(p),h=n("N+ot"),g=n.n(h),b=n("AuHH"),y=n.n(b),_=n("1Pcy"),v=n.n(_),k=n("5Yy7"),E=n.n(k),C=n("KEM+"),w=n.n(C),j=(n("aWzz"),n("nnRT")),O=n.n(j),I=n("Jygk"),P=n.n(I),T=n("L21V"),x=n("M2LZ"),A=n("5PxA"),H=n("WHVE"),S=n("T0aG"),F=n.n(S),B=n("bfgX"),L=n("bQlP"),R=n("Zf7T"),N=n("JGxT"),D=n("7LQG"),U=n("w19e"),q=n("mbB6"),M=n.n(q),G=n("mGvo"),z=n.n(G),J=n("h4um"),W=n.n(J),V=n("+DnP"),Q=n.n(V),Z=n("u6DZ"),Y=n.n(Z),K=n("xeH2"),X=n.n(K),$=function(){function t(e){f()(this,t),this.scope=null,this.listeners=null,this.inDispatch=!1,this.scope=e||this,this.listeners=[]}return m()(t,[{key:"add",value:function(t,e){return this.listeners.push({cb:t,scope:e||this.scope}),t}},{key:"addToTop",value:function(t,e){var n={cb:t,scope:e||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),t}},{key:"remove",value:function(t){var e=this.listeners,n=null;return P.a.tinymce.each(e,function(o,a){if(t==o.cb)return n=o,e.splice(a,1),!1}),n}},{key:"dispatch",value:function(){var t,e,n,o=arguments,a=this.listeners;for(this.inDispatch=!0,e=0;e<a.length&&!1!==(n=(t=a[e]).cb.apply(t.scope,o.length>0?o:[t.scope]));e++);return this.inDispatch=!1,n}}]),t}();function tt(t){return"object"===F()(t)&&t.name}function et(t,e){return"string"==typeof e?t.queryCommandState(e):!!tt(e)&&t.queryCommandState(e.name)}function nt(t,e,n,o){return t.execCommand(e,n,o)}var ot=n("jGny"),at="//".concat(P.a.location.host);function rt(t){var e=function(){function t(t){this.init=this.init(t)}return t.INCOMPATIBLE_PLUGINS=["dfe"],t.shouldInit=function(){var t=X()("body");return t.hasClass("edit")||t.hasClass("create")||t.hasClass("copy-page")},t.suppressIncompatiblePlugins=function(){for(var e=function(){},n=0,o=t.INCOMPATIBLE_PLUGINS.length;n<o;n++)P.a.tinymce.PluginManager.lookup[t.INCOMPATIBLE_PLUGINS[n]]=e},t.prototype.init=function(t){var e=X.a.ui.keyCode,n=X()("#content-title"),o=X()("form.editor"),a=X()(t.getBody()),r=X()(t.getDoc()),i=X()("#editor-precursor"),c=X()(t.getWin()),s=X()("#toolbar"),l=X()("#toolbar .toolbar-primary"),u=r.scrollTop(),d=parseInt(a.css("padding-top"),10)+parseInt(a.css("margin-top"),10),f=parseInt(i.css("padding-top"),10),p=P.a.requestAnimationFrame||P.a.webkitRequestAnimationFrame,m=X()('<ol id="breadcrumbs"></ol>');function h(e){var n=this;t.plugins.customtoolbar.toggleToolbarButtons(e,e,e,function(){return!X()(n).parent().hasClass("close")})}X()(".cell",i).prepend(m);var g=Object(L.N)(L.a)?function(){var t=u-r.scrollTop(),e=s.offset().top-o.offset().top,n=l.outerHeight(),c=parseInt(i.css("margin-top"),10),d=i.outerHeight();a.css("padding-top","".concat(c+d,"px")),i.css("top","".concat(e+n+t+f,"px"))}:function(){var t=u-r.scrollTop(),e=s.offset().top-o.offset().top,n=i.outerHeight(),c=s.outerHeight();i.css("top","".concat(e+c+t+f,"px")),a.css("padding-top","".concat(n+d,"px"))};return function(){n.on("keydown",function(n){var o=n.keyCode||n.which;o!==e.ENTER&&o!==e.DOWN||(n.preventDefault(),n.stopPropagation(),t.focus())}).on("focus click",function(){h(!0)}),c.on("focus",function(){h(!1)})}(),function(t){!function e(){t(e),g()}(),a.on("scroll mousewheel",function(){setTimeout(g,0)})}(p),!0},{Editor:t,ThemeOptions:{controlHandlers:{},controls:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote"},stateControls:["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"],init:function(e,n){var o=t.shouldInit(),a=this;o&&t.suppressIncompatiblePlugins(),a.editor=e,a.url=n,a.settings=P.a.tinymce.extend({theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,conflink,oldlinkbrowserButton,confimage,conf_macro_browser,separator,search,code,customtoolbar, monospacep,h1,h2,h3,h4,h5,h6,pre,blockquote",readonly:e.settings.readonly},e.settings),e.on("init",function(){e.settings.readonly||(e.on("NodeChange",function(t){a.nodeChanged(e,null,t.element,!1,{parents:t.parents})}),e.on("keyup",function(){a._updateUndoStatus(e)}),e.on("MouseUp",function(){a._updateUndoStatus(e)}),e.dom.bind(e.dom.getRoot(),"dragend",function(){a._updateUndoStatus(e)}),o&&new t(e))})},execCommand:function(t,e,n){var o=this["_".concat(t)];return!!o&&(o.call(this,e,n),!0)},renderUI:function(t){return this.bindControls(),{iframeContainer:P.a.tinymce.DOM.get("rte"),editorContainer:"wysiwyg",sizeContainer:void 0,deltaHeight:t.deltaHeight}},getInfo:function(){return{longname:"Confluence theme",author:"Atlassian",authorurl:"http://tinymce.moxiecode.com",version:"".concat(P.a.tinymce.majorVersion,".").concat(P.a.tinymce.minorVersion)}},bindControls:function(){var t=this,e=t.settings;P.a.tinymce.each(P.a.tinymce.explode(e.theme_advanced_buttons1),function(e){if(!t.createEditorButtons(e))switch(e){case"formatselect":t.createBlockFormats()}}),t.bindControlHandlers(),t.renderToolbarButtons()},renderToolbarButtons:function(){var t=this,e={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=M()(this.editor.buttons,function(t,n){return(t=Object.assign({},e,t)).id=n,t.weight=z()(t.weight)?t.weight:1/0,t});n=Q()(n,function(t){return!!t.locationGroup}),W()(["toolbar-primary"],function(e){var o=X()(".".concat(e)),a=Q()(n,{toolbar:e});a=Y()(a,"weight"),W()(a,function(e){t.createEditorButtons(e.id);var n=o.find(".".concat(e.locationGroup)),a=X()(function(t){return'<li id="'.concat(t.id,'" class="toolbar-item ').concat(t.className,'" data-tooltip="').concat(t.tooltip,'" data-weight="').concat(t.weight,'">\n                            <a class="toolbar-trigger aui-button" href="#" data-control-id="').concat(t.id,'">\n                                <span class="icon ').concat(t.icon,'"></span>\n                                <span class="trigger-text">').concat(t.title,"</span>\n                            </a>\n                        </li>")}(e));n.append(a).removeClass("hidden")})})},createEditorButtons:function(t){var e=this.editor.buttons[t];if(!e)return!1;e.cmd?this.controls[t]=e.cmd:this.controls[t]={func:e.onclick,name:t}},bindControlHandlers:function(){var t=this;t.controlHandlers.buttons={},t.controlHandlers.buttons.state=new $,t.controlHandlers.buttons.click=new $,t.controlHandlers.buttons.click.add(function(e){var n=t.controls[e];"string"===F()(n)?nt(Object(R.b)().getEditor(),t.controls[e]):tt(n)&&n.func()})},createBlockFormats:function(){var t=this;t.controlHandlers.formatselect={},t.controlHandlers.formatselect.state=new $,t.controlHandlers.formatselect.click=new $,t.controlHandlers.formatselect.click.add(function(t){nt(Object(R.b)().getEditor(),"FormatBlock",!1,t)})},createForeColorMenu:function(){return!0},_updateUndoStatus:function(t){var e=t.undoManager;this.controlHandlers.buttons.state.dispatch("undo","disabled",!e.hasUndo()&&!e.typing),this.controlHandlers.buttons.state.dispatch("redo","disabled",!e.hasRedo())},nodeChanged:function(t,e,n,o,a){var r=this;P.a.tinymce.each(r.stateControls,function(e){r.controlHandlers.buttons.state.dispatch(e,"active",!!et(t,r.controls[e]))}),r._updateUndoStatus(t),r.controlHandlers.buttons.state.dispatch("outdent","disabled",!et(t,"Outdent"));var i=function(t){for(var e=a.parents,n=0;n<e.length;n++)if(t(e[n]))return e[n]}(t.dom.isBlock);i&&r.controlHandlers.formatselect.state.dispatch(i.nodeName.toLowerCase())}}}}();P.a.tinymce.create("tinymce.themes.ConfluenceTheme",e.ThemeOptions),P.a.tinymce.ThemeManager.add("atlassian",P.a.tinymce.themes.ConfluenceTheme),P.a.requestAnimFrame=P.a.requestAnimationFrame||P.a.webkitRequestAnimationFrame;var n=function(){var t=D.a,e=["compat3x","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","cursorTarget","confluencecleanupplugin","aeTable","confluencepastetableplugin","confluencepastemacroplugin","pagelayoutplugin","iosediting","autoconvert","confluencelist","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation"];return Object(L.N)("confluence.table.resizable")&&e.push("tableContentWrapper"),{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:"".concat(at).concat(D.a,"/"),plugins:e.join(","),theme:"atlassian",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,confimage,conf_macro_browser,separator,code,customtoolbar,help,monospace,separator,searchreplace,linkbrowserButton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:t,plugin_action_base_path:"".concat(t,"/plugins/tinymce"),editor_plugin_action_base_path:"".concat(t,"/plugins/editor/tinymce"),page_id:N.a.get("page-id"),draft_type:null,form_name:N.a.get("form-name"),space_key:encodeURI(N.a.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:!1,inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0}}();0==n.page_id&&(n.page_id=null,n.draft_type=N.a.get("draft-type")),Object(R.a)().addBeforeInitCallback(function(t){t.contentCssTags=P.a.document.querySelector('script[title="editor-css"]').innerHTML,t.language=N.a.get("action-locale").replace("_","-");var e=N.a.get("min-editor-height");e&&(t.autoresize_min_height=e)});var o=!(N.a.get("atlassian-account-id")&&N.a.get("confluence.prefs.editor.disable.autocomplete"));if(o&&(n.plugins+=",autocomplete,autocompletelink,autocompletemedia"),n.locale="object"===F()(t)&&void 0!==t.locale?t.locale:"",n.messages="object"===F()(t)&&"object"===F()(t.messages)?t.messages:void 0,!!N.a.get("auto-start")){0,Object(B.b)("rte-loaded",{editPermission:!0});var a=P.a.document.getElementById(n.editor_id);Object(B.b)("rte-initial-raw-content-ready",{title:N.a.get("page-title")||N.a.get("original-content-title")||"",editorContent:a.value,confRev:N.a.get("conf-revision"),syncRev:P.a.document.getElementById("syncRev").value,syncRevSource:N.a.get("sync-revision-source")}),Object(U.a)("confluence.editor"),o&&(n.plugins+=",autocompletemacro");var r="0"==="".concat(N.a.get("page-id")),i=function(t,e){if("template"===t)return ot.a.createProfileForTemplateEditor();if("comment"===t)return ot.a.createProfileForCommentEditor();var n={versionComment:!e,notifyWatchers:!e};return ot.a.createProfileForPageEditor(n)}(N.a.get("content-type"),r).plugins.join(",");i&&(n.plugins+=",".concat(i)),Object(R.a)().preInitialise(n),Object(R.a)().initialise(),Object(U.b)("confluence.editor")}else Object(R.a)().preInitialise(n)}var it,ct=n("IGvV"),st=n("k8+f"),lt=n("DnRC"),ut=n("lZ+S"),dt=Object(ct.b)(Object(L.N)(L.a)?function(){return Promise.all([n.e(0),n.e(351)]).then(n.t.bind(null,"GA/f",7))}:function(){return Promise.all([n.e(0),n.e(352)]).then(n.t.bind(null,"ZdR3",7))})(it=function(t){function e(){var t,o;f()(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return o=g()(this,(t=y()(e)).call.apply(t,[this].concat(r))),w()(v()(o),"state",{loaded:!1}),w()(v()(o),"_loadAtlassianTinymce",function(){return n.e(355).then(n.bind(null,"qrpA"))}),w()(v()(o),"_loadAtlassianEditorPlugins",function(){return Promise.all([n.e(0),n.e(354)]).then(n.bind(null,"QEi/"))}),w()(v()(o),"_loadOtherEditorFiles",function(){var t=o.props,e=t.canEdit,n=t.onError,a=t.isExcludeEditorPluginsFragmentEnabled;x.a.require(ut.a.EDITOR_LOADER,function(){Object(st.a)({listener:"EditorLoader.js",globalProperty:"AJS.Confluence.EditorLoader"},function(){P.a.AJS.Confluence.EditorLoader.load(o._successCallback,n,{editPermission:e}),a&&Object(lt.a)(),o._mount&&o.setState({loaded:!0})})})}),w()(v()(o),"_successCallback",function(){var t=o.props,e=t.intl,n=t.onPreloadEditorFinish,a=t.onSuccess;n(t.contentId),"function"==typeof a&&a(),Object(L.N)(L.h)&&(Object(A.a)(),Object(H.a)(),rt({locale:e.locale,messages:e.messages}))}),o}return E()(e,t),m()(e,[{key:"componentDidMount",value:function(){this._mount=!0,this._loadEditor(this.props)}},{key:"shouldComponentUpdate",value:function(t,e){return!O()(t,this.props)||!O()(e,this.state)}},{key:"componentDidUpdate",value:function(t){this.props.contentId!==t.contentId&&this._loadEditor(this.props)}},{key:"componentWillUnmount",value:function(){this._mount=!1}},{key:"_loadEditor",value:function(t){var e=this,n=t.contentId,o=t.onStartPreloadEditor,a=t.isEditorNextEnabled;o(n),a?Object(st.a)({listener:"EditorLoader.js",globalProperty:"AJS"},function(){e._loadAtlassianTinymce().then(function(){e._loadAtlassianEditorPlugins().then(function(t){t.default(),e._loadOtherEditorFiles()})})}):this._loadOtherEditorFiles()}},{key:"render",value:function(){return i.a.createElement("div",{"data-test-id":this.state.loaded?"tinymce-editor-loaded":void 0})}}]),e}(r.Component))||it,ft=Object(T.g)(dt);e.default=Object(c.connect)(function(t){return{isEditorNextEnabled:Object(l.c)(t,"fd-87.editor.spa")}},function(t){return{onStartPreloadEditor:function(e){return t(Object(s.q)({contentId:e}))},onPreloadEditorFinish:function(e){return t(Object(s.p)({contentId:e}))}}})(function(t){return i.a.createElement(u.a,null,function(e){var n=e.featureFlags;return i.a.createElement(ft,a()({},t,{isExcludeEditorPluginsFragmentEnabled:n["confluence.frontend.exclude.editor.plugins.fragment"]}))})})},DnRC:function(t,e,n){"use strict";function o(){return Promise.all([n.e(1),n.e(0),n.e(11),n.e(353)]).then(n.bind(null,"2kJU")).then(function(t){return(0,t.triggerEditorPluginsLoaded)()})}n.d(e,"a",function(){return o})},JGxT:function(t,e,n){"use strict";var o=n("zWu7");e.a=o.a},bS8p:function(t,e,n){"use strict";var o=n("Jygk"),a=n.n(o),r=n("xeH2"),i=n.n(r);e.a={offset:function(t){var e=i()(t).offset(),n=i()(a.a.tinymce.activeEditor.iframeElement),o=n.offset(),r=n[0].contentWindow.document,c=i()(a.a.tinymce.activeEditor.getBody()),s=i.a.support.boxModel&&r.documentElement.scrollTop||c.scrollTop(),l=i.a.support.boxModel&&r.documentElement.scrollLeft||c.scrollLeft();return{top:e.top-s+o.top,left:e.left-l+o.left}},getSelectedText:function(){var t=a.a.tinymce.activeEditor.selection;return t.getRng().text||t.getSel()&&t.getSel().toString&&t.getSel().toString()||""},setHtml:function(t){t&&a.a.tinymce.activeEditor.setContent(t)},getHtml:function(){return"".concat(a.a.tinymce.activeEditor.getContent())},isEmpty:function(){var t=a.a.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","").trim();return"<p></p>"===t||""===t},editorHasContentChanged:function(){return a.a.tinymce.activeEditor.isDirty()},editorResetContentChanged:function(){a.a.tinymce.activeEditor.setDirty(!1)},getChildIndex:function(t,e){for(var n=t.childNodes,o=0,a=n.length;o<a;o++)if(n[o]==e)return o;return-1}}},jGny:function(t,e,n){"use strict";e.a={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize","Adg3Editor"]}},createProfileForPageEditor:function(t){var e=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer","Adg3Editor","fabric_migration"];return t&&t.versionComment&&e.push("confluenceversioncomment"),t&&t.notifyWatchers&&e.push("confluencenotifywatchers"),{plugins:e}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","confluencetemplateeditor","Adg3Editor"]}}}},zWu7:function(t,e,n){"use strict";var o={},a={set:function(t,e){o[t]=e},get:function(t){if("undefined"!=typeof document){var e=document.querySelector("meta[name='ajs-".concat(t,"']"));return e?function(t){var e="string"==typeof t?t.toLowerCase():"";return"true"===e||"false"!==e&&t}(e.content):o[t]}},getBoolean:function(t){return!0===this.get(t)},getNumber:function(t){return+this.get(t)},getAllAsMap:function(){var t={};if(!document.querySelectorAll.length)return t;var e=document.querySelectorAll("meta[name^=ajs-]");if(e)for(var n=0;n<e.length;n++)t[e[n].name.substring(4)]=e[n].content;return Object.assign(t,o)}};e.a=a}}]);
//# sourceMappingURL=page.editor-loader.b5053e775ceb3d0c85af-v38.js.map