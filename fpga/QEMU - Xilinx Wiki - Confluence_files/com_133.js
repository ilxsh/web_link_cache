WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-keyboard-shortcuts', location = 'js/confluence-keyboard-shortcuts.js' */
define("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts","ajs jquery confluence-keyboard-shortcuts/confluence-keyboard-shortcuts-soy confluence/legacy-editor-global-AVOID-IF-POSSIBLE window confluence/dialog confluence-keyboard-shortcuts/shortcut-dialog-tab-autoformat confluence/dark-features".split(" "),function(a,f,n,p,w,z,A,x){var c,g={Autoformat:[],Editor:[],enabled:!1,ready:!1,dialog:null,closeDialog:function(){t().then(function(a){a.hide()});return!1},openDialog:function(){f(this).removeClass("interactive");
t().then(function(a){a.show()});return!1}},t=function(){function k(){p&&p.isVisible&&p.isVisible()?(c.overrideLastTab(),c.gotoPanel(1)):c.gotoPanel(0)}var e=f.Deferred();if(c)return k(),e.resolve(c);var h=g.shortcuts,u=-1!==w.navigator.platform.indexOf("Mac"),B=function(d){var b=a("span").addClass("item-action");d=d.keys[0];for(var f=0;f<d.length;f++){0<f&&b.append(y("then"));for(var c=b,l=d[f].split("+"),v=0;v<l.length;v++){0<v&&c.append(y("+"));for(var e=c,q=l[v].split(".."),
k=0;k<q.length;k++)0<k&&e.append(y("to")),e.append(t(q[k]))}}return b},t=function(d){var b=a("kbd");switch(d){case "Shift":case "Sh":b.text("Shift");b.addClass("modifier-key");break;case "Ctrl":d=u?"âŒ˜":"Ctrl";b.text(d);b.addClass("modifier-key");break;case "Tab":b.text("Tab");b.addClass("modifier-key");break;case "Alt":b.text("Alt");
b.addClass("modifier-key");break;case "LeftAlt":d=u?"Option":"Left Alt";b.text(d);b.addClass("modifier-key");break;case "Control":b.text("Control");b.addClass("modifier-key");break;case "Option":b.text("Option");b.addClass("modifier-key");break;case "UpArrow":b.text("\u2191");b.addClass("regular-key");break;case "DownArrow":b.text("\u2193");
b.addClass("regular-key");break;case "LeftArrow":b.text("\u2190");b.addClass("regular-key");break;case "RightArrow":b.text("\u2192");b.addClass("regular-key");break;default:b.text(d),b.addClass("regular-key")}return b},y=function(d){var b=a("span");b.text(d);b.addClass("key-separator");return b},m=function(d,b,c){d=f(n.keyboardShortcutModule({title:d}));for(var k=d.find("ul"),l=0;l<c.length;l++){var e=c[l];if(!e.hidden&&
-1!==f.inArray(e.context,b)){var h=a("li").addClass("item-details"),q=e.description,q=a("strong").addClass("item-description").append(q);h.append(q);h.append(B(e));k.append(h)}}return d};c=z.component({width:950,height:660,id:"keyboard-shortcuts-dialog"});c.addHeader("Keyboard Shortcuts");c.addPanel("General",function(){var d=f(n.keyboardShortcutPanel({panelId:"general-shortcuts-panel"})),b=f(d).children(".shortcutsmenu");
a.Meta.get("atlassian-account-id")&&d.find(".keyboard-shortcut-dialog-panel-header").append(n.keyboardShortcutEnabledCheckbox());b.append(m("Global Shortcuts",["global"],h));b.append(m("Page / Blog Post Actions",["viewcontent","viewinfo"],h));return d}());c.addPanel("Editor",function(){var d=f(n.keyboardShortcutPanel({panelId:"editor-shortcuts-panel"})),b=f(d).children(".shortcutsmenu"),
c=["tinymce.block"],e=["tinymce.rich"],l=["tinymce.actions"];x.isEnabled("editor.spa.uxenhancements")&&(d.addClass("foxy-ux-enhancement"),c=["adg3.tinymce.block"],e=["adg3.tinymce.rich"],e.push(u?"adg3.tinymce.rich.mac":"adg3.tinymce.rich.win"),l=["adg3.tinymce.actions"],l.push(u?"adg3.tinymce.actions.mac":"adg3.tinymce.actions.win"));b.append(m("Block Formatting",c,h));b.append(m("Rich Formatting",e,h));b.append(m("Editing Actions",
l,h));return d}());c.addPanel("Editor Autoformatting",A());c.addCancel("Close",function(){a.debug("Hiding Shortcuts help");c.hide();return!1});c.popup.element.find(".dialog-title").prepend(n.keyboardShortcutHelpLink());a.trigger("keyboard-shortcut-dialog-ready",c);k();e.resolve(c);f("#keyboard-shortcut-enabled-checkbox").prop("checked",r.keyboardShortcuts.enabled).click(function(d){var b=f(this).prop("checked");f.ajax({type:"POST",url:a.contextPath()+
"/rest/confluenceshortcuts/latest/enabled",data:f.toJSON({enabled:b}),dataType:"json",contentType:"application/json"}).done(function(){r.keyboardShortcuts.enabled=b;r.keyboardShortcuts.ready=!1;b?a.trigger("add-bindings.keyboardshortcuts"):a.trigger("remove-bindings.keyboardshortcuts")})});return e},r={init:function(){a.debug("confluence-keyboard-shortcuts initialising");a.PageGadget||w.parent.AJS&&w.parent.AJS.PageGadget?a.debug("Inside the Page Gadget. Skipping keyboard shortcuts"):(g.enabled=a.Meta.getBoolean("use-keyboard-shortcuts"),
a.bind("shortcuts-loaded.keyboardshortcuts",function(a,c){g.shortcuts=c.shortcuts;f("#keyboard-shortcuts-link").click(g.openDialog)}),a.bind("register-contexts.keyboardshortcuts",function(c,e){if(g.enabled){c=e.shortcutRegistry;e=p&&p.isVisible&&p.isVisible();f("#action-menu-link").length&&!e&&c.enableContext("viewcontent");f("#viewPageLink").length&&c.enableContext("viewinfo");if(e){x.isEnabled("editor.spa.uxenhancements")?c.enableContext("adg3.tinymce.actions"):c.enableContext("editor");var h=require("tinymce"),
k=h.activeEditor,n=f("#rte").closest("form");f.each(g.shortcuts,function(c,e){if(0===e.context.indexOf("tinymce")){var m=e.op,d=e.param;f.each(e.keys,function(){var b=this,c;"click"==m?c=function(){f(d).click()}:"execute"==m&&(c=d);if(c){f.isArray(b)&&(b=b.join(","));var g=b.toLowerCase(),g=4<=parseInt(h.majorVersion,10)&&h.isMac?g.replace("ctrl","meta"):g;a.debug("Adding shortcut for "+g);k.addShortcut(g,"",c);x.isEnabled("editor.spa.uxenhancements")||"tinymce.actions"!=e.context||-1===b.indexOf("+")||
(a.debug("Binding shortcut on inputs too for "+b),n.delegate(":input","keydown",function(a){var d=a.keyCode?a.keyCode:a.which,e=b.split("+"),e=f.map(e,function(b){return"Ctrl"==b&&a.metaKey||"Shift"==b&&a.shiftKey||d==b.charCodeAt(0)?null:b});e.length||(c(),a.preventDefault())}))}else a.logError("ERROR: unkown editor shortcut key operation "+m+" for shortcut "+b)})}})}g.ready=!0}}),"undefined"!==typeof a.contextPath()&&(f("#rte").length?a.bind("init.rte",function(){a.trigger("initialize.keyboardshortcuts")}):
a.trigger("initialize.keyboardshortcuts")))}};r.keyboardShortcuts=g;return r});require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts",function(a){var f=require("ajs");Confluence.KeyboardShortcuts=a.keyboardShortcuts;f.toInit(a.init)});
}catch(e){WRMCB(e)};