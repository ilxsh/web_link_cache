(window.webpackJsonp=window.webpackJsonp||[]).push([[354],{"+7yL":function(e,t,n){var o=n("k5DV");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},"+wbh":function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,".aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,monospace;margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}",""])},"3eVS":function(e,t,n){var o=n("ipYc");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},"7ffy":function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:transparent;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},CxWt:function(e,t,n){var o=n("PvHY");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},"FVF/":function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,"body.ios{min-height:150px}",""])},ILgc:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,"#charmap-picker{border:0;font-size:16px;font-family:Arial,Helvetica,FreeSans,sans-serif;padding:2px;text-align:center}#charmap-view{padding-right:1em;text-align:left;vertical-align:top}#charmap-info{text-align:center;vertical-align:top;width:100%}#charmap-info>table{border:0;height:100px;padding:0;width:100%}#code-value{font-size:3em}#code-name{font-size:13px}#code-name,#code-value{color:#666;text-align:center}.charmap a:active,.charmap a:hover,.charmap a:link,.charmap a:visited{color:#326ca6;text-decoration:none}",""])},OGf2:function(e,t,n){var o=n("Rbpl"),a=n("7l8p");"string"==typeof o&&(o=[[e.i,o,""]]),e.exports=o.locals||{},e.exports._getContent=function(){return o},e.exports._getCss=function(){return o.toString()},e.exports._insertCss=function(e){return a(o,e)}},PvHY:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},Q2fH:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return c});var o=n("xeH2"),a=n.n(o);function r(e,t,n,o){return"function"==typeof o?a()(e).bind(t,n,o):a()(e).bind(t,n)}function i(e,t,n){return a()(e).unbind(t,n)}function c(e,t,n){return a()(e).trigger(t,n)}},"QEi/":function(e,t,n){"use strict";n.r(t);var o=n("RhWx"),a=n.n(o),r=n("M2LZ"),i=n("bfgX"),c="confluence.spa.editor",l=n("cGYM"),s=function(e,t){Object.keys(t).forEach(function(e){t[e]=Object(l.a)(t[e])}),Object(i.b)("analytics",{name:"".concat(c,".plugins.").concat(e),data:t})},d=n("WM+X"),u=n("xeH2"),f=n.n(u),m=n("Jygk"),p=n.n(m),g=n("Zf7T");function h(){var e,t,n=[],o={};p.a.tinymce.Env.ie?(e="\ufeff{$caret}",t="<p>{$caret}</p>"):t=e=p.a.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var a={insertTextPlaceHolder:function(t){var n=function(e){return'<span class="text-placeholder">'.concat(e,"</span>")}(e),o=f()("<div></div>").append(n);t&&o.find(".text-placeholder").html(t),p.a.tinymce.activeEditor.execCommand("mceInsertContent",!1,o.html())},removePlaceholder:function(n){var o=p.a.tinymce.activeEditor,a=f()(o.getBody()),r=e,i=n.parentElement;"LI"===i.nodeName&&(r=t);var c=o.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");i.replaceChild(c,n);var l=a.find("#placeholder-cursor")[0];o.selection.select(l.firstChild),o.dom.remove(l,!1),o.execCommand("mceInsertContent",!1,r)},addPlaceholderType:function(e){e&&e.type&&(n.push(e),o[e.type]=e)},getPlaceholderTypes:function(){return[].concat(n)},getPlaceholderType:function(e){return o[e]}};return Object(g.b)().Placeholder=a,a}var b=n("JGxT");function v(){return{name:"textplaceholder",canHandleElement:function(e){return e.hasClass("text-placeholder")},handle:function(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=h.getPlaceholderTypes(),o=e.containerEl,a=f()(o),r=a.attr("data-placeholder-type"),i=[],c=d("default",p.a.tinymce.activeEditor.translate("property.panel.textplaceholder.display.default"),p.a.tinymce.activeEditor.translate("property.panel.textplaceholder.display.default.tooltip"));c.selected=!r,i.push(c);for(var l=0,s=n.length;l<s;l++)t=n[l],i.push(d(t.type,t.label,t.tooltip));i.push(null),i.push({className:"text-placeholder-property-panel-remove-button",text:p.a.tinymce.activeEditor.translate("property.panel.textplaceholder.remove"),click:function(){p.a.Confluence.PropertyPanel.destroy(),h.removePlaceholder(a)}}),p.a.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,i,{anchorIframe:Object(g.b)().getEditorFrame()})}function d(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-".concat(e),text:t,tooltip:n,selected:r===e,click:function(){!function(e){"default"===e?a.removeAttr("data-placeholder-type"):a.attr("data-placeholder-type",e);var t=f()(".text-placeholder-property-panel-type-".concat(e));t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function y(){var e=h(),t='<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>',n='<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>',o={click:!1,keypress:!0},a=p.a.tinymce.VK,r=p.a.tinymce.dom.Event,c="template"===b.a.get("content-type");function l(t){Object(i.b)("cursor-target-refresh"),f()("#rte-button-insert-placeholder").click(function(t){t.preventDefault(),e.insertTextPlaceHolder()}),t.on("KeyPress",function(e){if(13===e.keyCode&&!e.shiftKey){var n=t.selection.getNode(),o=f()(n).closest(".text-placeholder");if(o.length&&Object(g.b)().Cursor.isCursorAtEnd(t,t.selection.getRng(),n))return Object(g.b)().Cursor.insertParagraph(t,o,!0),p.a.tinymce.dom.Event.cancel(e)}},!0)}var s={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function d(e){return!s[e.nodeName]}function u(t){function n(){var e=u();e&&t.selection.select(e)}function c(e){e.off("KeyDown",l),e.off("KeyPress",s),e.off("Click",s)}function l(n){var o=u();return n.keyCode===a.LEFT||n.keyCode===a.UP?(function(e,t){for(var n,o=t.previousSibling;t&&!o;)o=(t=t.parentNode).previousSibling;if(o){for(n=o;!d(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(t,o),r.cancel(n)):n.keyCode===a.RIGHT||n.keyCode===a.DOWN?(function(e,t){for(var n,o=t.nextSibling;t&&!o;)o=(t=t.parentNode).nextSibling;if(o){for(n=o;!d(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(t,o),r.cancel(n)):n.keyCode===a.BACKSPACE||n.keyCode===a.DELETE?(e.removePlaceholder(o),r.cancel(n)):void 0}function s(t){if(!p.a.tinymce.Env.gecko||t.isChar||"keypress"!==t.type){var n=u();if(n){var a=n.getAttribute("data-placeholder-type");(function(t,n){var a=e.getPlaceholderType(t);return!!f.a.extend({},o,a&&a.activation)[n]})(a,t.type)&&(e.removePlaceholder(n),Object(i.b)("editor.text-placeholder.activated",{placeholderType:a||"",triggerEvent:t}))}}}function u(){var e=f()(t.getBody()).find(".text-placeholder.selected");return e.length?e[0]:(c(t),null)}t.on("NodeChange",function(e){var o=e.element,a=f()(o).closest(".text-placeholder");f()(t.getBody()).find(".text-placeholder.selected").not(a).removeClass("selected"),a.length?(a.hasClass("selected")||(a.addClass("selected"),function(e){e.on("KeyDown",l,!0),e.on("KeyPress",s,!0),e.on("Click",s,!0)}(t)),setTimeout(n,0)):c(t)},!0)}return{init:function(e){e.on("init",function(){(c?l:u)(e),function(e){var o=f()(e.getDoc()).find("head");f.a.browser.msie?o.append(t):o.append(n)}(e)})},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}var C=n("7LQG"),w=0,x={updateNode:function(e,t){var n=p.a.tinymce.activeEditor,o=f()(e,n.getDoc()),a="confluence.update-node-".concat(w++);Object(i.b)("synchrony.stop",{id:a});var r=x.prepareNodeForUpdate(o);return x.replaceNode(o,t).fail(r).always(function(){Object(i.b)("synchrony.start",{id:a})}).promise()},storeNodeState:function(e,t){for(var n,o={},a=0,r=t.length;a<r;a++)n=t[a],o[n]=e.attr(n);return function(){for(var t in o)e.attr(t,o[t])}},prepareNodeForUpdate:function(e){var t=null;return e.is("img")&&(t=x.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:"".concat(C.a,"/images/border/spacer.gif"),width:e.attr("width"),height:e.attr("height")})),t},replaceNode:function(e,t){var n=x.getDoc(),o=f()(t,n),a=f()(e,n),r="confluence.replace-node-".concat(w++);return Object(i.b)("synchrony.stop",{id:r}),f.a.Deferred(function(){var e=this;o.is("img")?(o[0].onload=function(){this.onload=null,e.resolve(this)},f.a.browser.opera&&(o[0].src=o.attr("src")),n.createDocumentFragment().appendChild(o[0])):e.resolve(o[0])}).always(function(){Object(i.b)("synchrony.start",{id:r})}).done(function(e){a.replaceWith(e)}).promise()},replaceSelection:function(e){var t=p.a.tinymce.activeEditor,n=t.selection.getRng(!0),o=t.getDoc().createRange(),a=f()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=Object(g.b)().HIDDEN_CHAR),n.insertNode(a);var r=t.getDoc().createTextNode(Object(g.b)().HIDDEN_CHAR);t.dom.insertAfter(r,a);var i=r;return o.setStartBefore(i),o.setEndAfter(i),o.collapse(!1),t.selection.setRng(o),a},normalize:function(e){var t,n,o,r=p.a.tinymce.activeEditor,i=r.selection.getRng(!0),c=[];e&&e.childNodes&&(p.a.tinymce.isWebKit?t=i:p.a.tinymce.isGecko&&(t=i.cloneRange(),((n={startIndex:a()(e.childNodes).indexOf(i.startContainer),startOffset:t.startOffset,endIndex:a()(e.childNodes).indexOf(i.endContainer),endOffset:t.endOffset}).startIndex>-1||n.endIndex>-1)&&(c=function(e){var t=[],n=0;return e.childNodes.forEach(function(e,o){var a={},r=t[o-1]||{};a.isTextNode=3===e.nodeType,a.textNodesBefore=(a.isTextNode&&r.isTextNode?1:0)+~~r.textNodesBefore,a.precedingTextLength=n,n=a.isTextNode?n+e.nodeValue.length:0,t.push(a)}),t}(e))),e.normalize(),p.a.tinymce.isGecko&&((o=c[n.startIndex])&&(n.newStartIndex=n.startIndex-o.textNodesBefore,n.newStartOffset=n.startOffset+o.precedingTextLength,t.setStart(e.childNodes[n.newStartIndex],n.newStartOffset)),(o=c[n.endIndex])&&(n.newEndIndex=n.endIndex-o.textNodesBefore,n.newEndOffset=n.endOffset+o.precedingTextLength,t.setEnd(e.childNodes[n.newEndIndex],n.newEndOffset))),t&&r.selection.setRng(t))},getDoc:function(){return f.a.browser.mozilla||f.a.browser.opera?document:p.a.tinymce.activeEditor.getDoc()},isolateSelectedRange:function(){var e,t=p.a.tinymce.activeEditor,n=x.getDoc(),o=t.selection,a=o.getRng(!0),r=a.startContainer,i=a.startOffset,c=a.endContainer,l=a.endOffset;if(a.collapsed)return a;function s(e,o,a){var r=t.dom.getParent(e,t.dom.isBlock);r||(r=t.getBody());var i=function(e,t,o,a){var r,i,c=null,l=null,s=a?"nextSibling":"previousSibling";if(!(r=0===t)&&a&&(r=3===e.nodeType?t===e.length:t===e.childNodes.length),r)for(c=e[s],l=e;null===c;){if(l===o)return;if(l.parentNode===o)break;c=(l=l.parentNode)[s]}else 3===e.nodeType?(i=e.data,e.data=i.slice(t),c=n.createTextNode(i.slice(0,t)),l=e,f()(c).insertBefore(l),a&&(i=l,l=c,c=i)):c=(l=e.childNodes[t-(a?1:0)])[s];return[l,c]}(e,o,r,a);return i?i[1]?function(e,t,n,o){for(var a,r,i,c;t!==n&&t.parentNode!==n;){if(a=(r=t.parentNode).cloneNode(!1),o)for(f()(a).insertAfter(r),i=e;i;)c=i.nextSibling,a.appendChild(i),i=c;else for(f()(a).insertBefore(r),i=r.firstChild;i!==t;)c=i.nextSibling,a.appendChild(i),i=c;e=a,t=r}return t}(i[1],i[0],r,a):i[0]:void 0}r===c&&(e=l-i);var d=s(r,i);d&&a.setStartBefore(d),r!==a.startContainer&&(l=e||l);var u=s(c,l,!0);return u&&a.setEndAfter(u),o.setRng(a),a}},k=x;var T=n("HvGa"),E=n.n(T),A=function(e){var t=document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");return n.indexOf(e)>-1&&-1===n.indexOf("".concat(e,".disable"))}},S=n("bQlP");function I(){var e=b.a.get("content-id");return+e||(e=b.a.get("page-id")),+e||(e="0"),e}function M(e){return e.closest(B).length>0}function O(e,t,n){M(e)&&(t.disable(),document.getElementById("rte-button-insert-table").setAttribute("data-tooltip",n.translate("tinymce.tablepicker.nested_table_unsupported")))}var B=A(S.g)?"BLOCKQUOTE, TABLE.confluenceTable, LI":null;function N(e){return f()(e).hasClass("wysiwyg-macro")}function R(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:"".concat(C.a,"/rest/tinymce/1/macro/placeholder"),contentType:"application/json; charset=utf-8",data:f.a.toJSON(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: ".concat(e));n=e}var o,a=f.a.Deferred(),r=p.a.tinymce.activeEditor;if(!t){var c="macro-".concat((new Date).getTime());o=r.dom.create("span",{id:c}),r.selection.setNode(o),t=o=r.dom.select("#".concat(c))[0],a.fail(function(){f()(o).remove()})}return f.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),E.a.Editor.UI.setButtonsState(!1),f.a.ajax(n).done(function(e){"<"!==e[0]&&(e=document.createTextNode(e)),!function(e){return e&&e.parentNode}(t)?a.rejectWith(this,arguments):k.updateNode(t,e).done(function(t){a.resolve(t,e)}).fail(a.reject)}).fail(function(e,t,n){a.rejectWith(this,arguments)}),a.done(function(e,t){E.a.Editor.UI.setButtonsState(!0),N(e)&&/P|H\d/.test(e.parentNode.nodeName)&&r.dom.split(e.parentNode,e),function(e){var t=p.a.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng(!0);if(N(e)){!p.a.tinymce.isIE&&f()("p, pre",e).each(function(e,t){0===t.childNodes.length&&t.appendChild(n.createElement("br"))});var a=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;a&&(o.setStart(a,0),o.setEnd(a,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),r.nodeChanged(),Object(g.b)().showElement(e),r.selection.onSetContent.dispatch(r.selection,{content:t,format:"html"}),p.a.tinymce.activeEditor.undoManager.add(),Object(i.b)("macro-browser.macro-inserted")}).fail(function(){E.a.Editor.UI.setButtonsState(!0)}),a.promise()}var _={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:R,isInMacro:function(e){return(e.jquery?e:f()(e)).closest(".wysiwyg-macro").length>0},updateMacro:function(e,t,n,o){return R({contentId:I(),macro:{name:n,params:e,body:t||""}},o)}},P=_;var D={storedRange:null,bookmark:null,getCurrentNode:function(){return f()(p.a.tinymce.activeEditor.selection.getNode())},isMacroDiv:function(e){return f()(e).hasClass("wysiwyg-macro")},isMacroTag:function(e){var t=f()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:function(e){return f()(e).hasClass("editor-inline-macro")},isMacroWithBody:function(e){return f()(e).hasClass("wysiwyg-macro")},isMacroStartTag:function(e){return f()(e).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(e){return f()(e).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(e){return f()(e).hasClass("wysiwyg-macro-body")},hasMacroBody:function(e){return"true"==f()(e).attr("macrohasbody")},getNestingMacros:function(e){var t=[];return f()(e||D.getCurrentNode()).parents(".wysiwyg-macro").each(function(e,n){t.push(f()(n).attr("data-macro-name"))}),t},logMCESelection:function(e){p.a.tinymce.activeEditor.selection},getSelectedMacro:function(){var e=D.getCurrentNode();return D.isMacroDiv(e)?e:P.isInMacro(e)},openMacro:function(e){E.a.MacroBrowser.open({selectedMacro:e,onComplete:D.macroBrowserComplete,onCancel:D.macroBrowserCancel})},editMacro:function(e){var t=f()(e);D.editedMacroDiv=t[0];var n=p.a.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});p.a.tinymce.activeEditor.selection.select(t[0]),Object(g.b)().BookmarkManager.storeBookmark(),f.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(C.a,"/rest/tinymce/1/macro/definition"),data:f.a.toJSON({contentId:I(),macroHtml:n}),dataType:"text",success:function(e){D.openMacro(f.a.secureEvalJSON(e))}})},macroBrowserToolbarButtonClicked:function(e){var t=p.a.tinymce.activeEditor,n=D.getCurrentNode();Object(g.b)().BookmarkManager.storeBookmark();var o=f.a.extend({presetMacroName:null,nestingMacros:D.getNestingMacros(n),onComplete:D.macroBrowserComplete,onCancel:D.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if(e&&!e.ignoreEditorSelection&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof E.a.MacroBrowser.Model.addMacro)return E.a.MacroBrowser.open(o);if(o.presetMacroMetadata)E.a.MacroBrowser.open(o);else if(o.presetMacroName){var a=E.a.MacroBrowser.getMacroMetadata(o.presetMacroName);a?(o.presetMacroMetadata=a,E.a.MacroBrowser.open(o)):E.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:function(e){e&&e.details?(E.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=E.a.MacroBrowser.getMacroMetadata(o.presetMacroName),E.a.bind("reset.complete",function e(){E.a.MacroBrowser.open(o),E.a.unbind("reset.complete",e)}),E.a.trigger("reset.rte")):E.a.MacroBrowser.open(o)},errorCallback:function(e){console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})}else E.a.MacroBrowser.open(o)},macroBrowserComplete:function(e){var t={contentId:b.a.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};Object(g.b)().BookmarkManager.restoreBookmark(),D.editedMacroDiv?(P.insertMacro(t,D.editedMacroDiv),delete D.editedMacroDiv):P.insertMacro(t)},macroBrowserCancel:function(){Object(g.b)().BookmarkManager.restoreBookmark(),D.editedMacroDiv=null,D.editedMacro=null}},H=D;function j(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var L={isCursorAtStartOf:function(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf:function(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("context is invalid. received: ".concat(e));var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var a,r=new p.a.tinymce.dom.TreeWalker(n,e);do{a=r.prev(!0)}while(j(a));return void 0===a},isCursorAtEndOf:function(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf:function(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("container is invalid. received: ".concat(e));var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var a,r=new p.a.tinymce.dom.TreeWalker(n,e);do{a=r.next(!0)}while(j(a));return void 0===a||"BR"===a.nodeName&&void 0===r.next(!0)},setCursorAtStartOfContents:function(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: ".concat(e));var t=p.a.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))}};function F(e,t){return"undefined"!=typeof document&&document.addEventListener?document.addEventListener(e,t):null}n("CxWt");var z,W=function(){var e=p.a.Confluence.PropertyPanel,t=[];return Object(i.a)("add-handler.property-panel",function(e,n){n&&t.push(n)}),{init:function(n){var o,a=function(){return!!e.current},r=function(o,r){var c={focusedEl:r,focusedNodeName:r.nodeName&&r.nodeName.toLowerCase(),ed:n,e:f.a.extend({},o)},l=function(e){if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""}(f()(r)),s=function(e){return!!e.closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length}(f()(r)),d=function(){return!!f()(".toolbar-contextual").length}();if(c.containerEl=l,Object(i.b)("user-blurred-rte-element",c),l&&!function(e){return"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0)}(o)&&!a()&&e.shouldCreate)for(var u=0,m=t.length;u<m;u++)if(t[u].canHandleElement(f()(l))){if(d||!s)return t[u].handle(c);!function(e){F("shown.contextToolbar",function(){e.handle(c)})}(t[u])}};function c(e,t){r(e,t.elem)}function l(t,n){a()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():Object(i.b)("same-anchor.property-panel"))}function s(){setTimeout(function(){Object(g.b)().bindScroll("property-panel",function(){e.destroy()})},0),f()(n.getDoc()).bind("keydown.property-panel.escape",function(t){27===t.keyCode&&a()&&e.destroy()})}function d(){Object(g.b)().unbindScroll("property-panel"),f()(n.getDoc()).unbind("keydown.property-panel.escape")}p.a.tinymce.Env.ie&&n.on("MouseDown",function(e){o&&o.unbind("mouseup.IEDragHandlesWorkaround"),(o=f()(e.target)).filter("img, table").bind("mouseup.IEDragHandlesWorkaround",function(){r(n,e,e.target)})}),n.on("Click",function(e){r(e,e.target)}),n.on("KeyUp",function(e){27!==e.keyCode&&r(e,n.selection.getNode())},!0),n.on("ContextMenu",function(){e.destroy()}),Object(i.a)("trigger.property-panel",c),Object(i.a)("user-blurred-rte-element",l),Object(i.a)("created.property-panel",s),Object(i.a)("destroyed.property-panel",d),n.on("Remove",function(){Object(i.c)("trigger.property-panel",c),Object(i.c)("user-blurred-rte-element",l),Object(i.c)("created.property-panel",s),Object(i.c)("destroyed.property-panel",d)})},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}};var K=function(){var e=p.a.tinymce.DOM.getViewPort(p.a.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},V=function(e){e&&p.a.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},U={storeBookmark:function(){var e,t=p.a.tinymce.activeEditor,n=K();t.focus();var o=t.selection.getRng();e=o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,z={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},restoreBookmark:function(){var e=p.a.tinymce.activeEditor.selection,t=p.a.tinymce.activeEditor.getWin();z&&(V(z),t.focus(),e.setRng(z.range)),z=null},getScroll:K,restoreScroll:V};var $=U;n("VRGO");var q=/^\u200b?(\[)$/;function J(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function G(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function X(e){return e&&"ul"===e.nodeName.toLowerCase()&&!G(e)}function Q(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach(function(e){e.removeAttribute("data-inline-task-id"),e.classList.remove("checked")}))}var Y=n("dHP6"),Z=function(e){e.addCommand("confInsertTable",function(t,n){!function(e,t,n,o){var a,r,i,c,l,s=p.a.tinymce.Env,d=s.ie&&s.ie<10?"&nbsp;":'<br data-mce-bogus="1">';for(i='<table id="__mce" class="confluenceTable"><tbody>',a=0;a<n;a++){var u=0===a&&o,f=u?"confluenceTh":"confluenceTd";for(i+="<tr>",r=0;r<t;r++)i+=u?"<th class=".concat(f,">").concat(d,"</th>"):"<td class=".concat(f,">").concat(d,"</td>");i+="</tr>"}i+="</tbody></table>",e.undoManager.transact(function(){e.insertContent(i),c=e.dom.get("__mce"),e.dom.setAttrib(c,"id",null),e.$("tr",c).each(function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each(function(t,n){l=l||n,e.fire("newcell",{node:n})})}),e.dom.setAttribs(c,e.settings.table_default_attributes||{}),e.dom.setStyles(c,e.settings.table_default_styles||{})}),e.selection.select(l,!0),e.selection.collapse(!0)}(e,n.cols,n.rows,n.heading),Object(Y.b)("insert.table")})};function ee(){return f()("#table-highlight-group").attr("data-highlight-colour")||""}function te(e,t,n){if(t.length){for(var o=function(e,t){var n=f()(e.selection.getNode());return!(!n.length||n[0]!==t[0]&&!n.closest(t).length)}(e,t),a=t[0],r=a.ownerDocument.createElement(n),i=a.attributes,c=0,l=i.length;c<l;c++){var s=i[c];r.setAttribute(s.nodeName,s.nodeValue)}for(;a.hasChildNodes();)r.appendChild(a.firstChild);return a.parentNode.replaceChild(r,a),o&&(e.selection.select(r,!0),e.selection.collapse()),f()(r)}}var ne={convertToNormalCells:function(e,t){t.filter("th").each(function(){var t=f()(this);(t=te(e,t,"td")).removeClass("confluenceTh"),t.addClass("confluenceTd")})},convertToHeadingCells:function(e,t){t.filter("td").each(function(){var t=f()(this);(t=te(e,t,"th")).removeClass("confluenceTd"),t.addClass("confluenceTh")})},areCellsHeadings:function(e){var t=e.filter("th").length;return e.length===t},isColumnHeading:function(e,t){var n=f()(e).children("tbody").children("tr");return 1!==n.length&&n.children().filter("th:nth-child(".concat(t,")")).length===n.length},areCellsHighlighted:function(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,o=ee();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==o)return!1;return!0}(t)},isColumnHighlighted:function(e,t){var n=f()(e).children("tbody").children("tr").children("th,td").nthCol(t),o=n.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(n.length!==o)return!1;for(var a=n.eq(0).attr("data-highlight-colour"),r=1,i=n.length;r<i;r++)if(a!==n.eq(r).attr("data-highlight-colour"))return!1;return!0},getSelectedHighlightColour:ee},oe=0,ae=1;function re(e){var t=0;e.find(">tbody >tr").each(function(){var e=0;f()(this).find(">th,>td").each(function(){var t=f()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++}),e>t&&(t=e)});var n=e.find(">colgroup"),o=n.find("col"),a=o.length;if(a!==t){var r=n.length>0;if(r||(n=f()("<colgroup>")),t>a)for(var i=0;i<t-a;i++){var c=f()("<col>");n.append(c)}else for(var l=0;l<a-t;l++)o.last().remove();return r||e.prepend(n),n}}function ie(e,t,n){var o=e.find(">colgroup>col");0===o.length&&(re(e),o=e.find(">colgroup>col"));for(var a,r,i,c=o.length,l=e.find(">thead>tr,>tbody>tr,>tr"),s=0;s<l.length;s++)if(c===l.eq(s).find(">th, >td").length){a=l.eq(s);break}if(a)r=a.find(">th, >td");else{var d=f()("<tr>");(i=f()("<tfoot>")).append(d);for(var u=0;u<c;u++)d.append(f()("<td>"));e.append(i),r=d.find(">td")}for(var m=e.outerWidth()-1,g=[],h=[],b=0;b<c;b++){var v=r.eq(b),y=v[0].getBoundingClientRect(),C=t?"".concat(y.width/m*100,"%"):v.outerWidth();g[b]=C,h[b]=y}var w=0;p.a.tinymce.activeEditor&&(w=p.a.tinymce.activeEditor.getWin().pageXOffset);for(var x=0;x<c;x++)o.eq(x).attr("data-resize-pixel",h[x].width).attr("data-resize-percent",h[x].width/m*100).attr("data-offset-left",h[x].left+w).attr("data-offset-right",h[x].right+w).removeAttr("data-mce-style"),(!n||x===n.index()&&x===n.next().index())&&o.eq(x).css({width:g[x]});i&&i.remove(),e.removeAttr("data-mce-style")}function ce(e,t,n){var o={},a=!1,r=t.find("body");return n.each(function(){var t=f()(this);pe(t)&&t.find("th, td").each(function(){if(!o[t]){var n=f()(this),i=n.offset().left+n.innerWidth();Math.abs(i-parseInt(e.attr("data-offset-right")))<=oe&&(o[t]=!0,a=!0,function(e,t){f()('<div contenteditable="false" class="resize-alignment-bar">').css({top:se(e[0],r[0]),left:t,height:e.height()}).appendTo(r)}(t,i))}})}),a}function le(e){e.find(".resize-alignment-bar").remove()}function se(e,t){return parseInt(e.getBoundingClientRect().top-t.getBoundingClientRect().top,10)}var de=function(e){var t={$doc:f()(p.a.document)},n=this,o=n.data("uuid");if(!n.data("initialized")){o||(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),n.data("uuid",o));var a,r,c,l,s,d,u,m,g,h,v=29,y=(e=f.a.extend(t,e||{})).$doc,C=e.editor,w=y.find("body"),x=!1,k=-1,T=!1,E=7,S=f()('<div contenteditable="false" class="synchrony-exclude" id="resize-indicator">'),I=f()('<div contenteditable="false" class="synchrony-exclude resize-width-holder" unselectable="on">'),M=!1,O=4,B=function(){S.remove(),n.removeClass("active-resizable"),M=!1,u=void 0,l=null,s=null,w.attr("data-table-resizing",!1)},N=function(e){y.find("#resize-indicator").length>0?S=y.find("#resize-indicator"):S.appendTo(w),n.addClass("active-resizable"),S.css({top:se(n[0],w[0]),left:e,height:n.height()}),M=!0},R=function(e){w.outerWidth(!0)!==w[0].scrollWidth&&(e&&fe(n),w.find("#".concat(o,"-holder")).length||(I.css("width",n.width()+parseInt(f()(C.getBody()).css("margin-right"))),I.attr("id","".concat(o,"-holder")),n.after(I)))};return n.on("mousemove.table-resizable".concat(o),"th, td",function(e){if(!x&&!(f()(this).parents("table.confluenceTable").length>1||ge(n)&&A("confluence.table.resizable.hide-indicator-on-fluid"))){re(n);var t,o=f()(this),r=o.offset().left,i=Math.round(S.outerWidth()/2),c=o.index(),l=o.parent().children();k=-1;var s=o.closest("tr").index();if(o.closest("table.confluenceTable tr").prevAll("tr").each(function(){var e=f()(this),t=e.index();e.children("td, th").each(function(){if(o.offset().left>f()(this).offset().left){var e=parseInt(f()(this).attr("colspan")),n=parseInt(f()(this).attr("rowspan"));e&&n?t+n>s&&(c+=e):n&&t+n>s&&(c+=1)}})}),T=!1,e.pageX-o.offset().left<o.outerWidth()/2){if(0===(c-=1)&&o.prev().hasClass("numberingColumn"))return;if(c<0){T=!0;var u=l.eq(0);u.attr("colspan")?k+=parseInt(u.attr("colspan")):k++}else for(var m=0;m<=c;m++){var p=l.eq(m);p.attr("colspan")?k+=parseInt(p.attr("colspan")):k++}t=T?r+o.outerWidth()-i:r-i}else{if(0===c&&o.hasClass("numberingColumn"))return;for(var g=0;g<=c;g++){var h=l.eq(g);h.attr("colspan")?k+=parseInt(h.attr("colspan")):k++}t=r+o.outerWidth()-i}a=o.closest("table").find("col").eq(k),function(){if(Math.abs(d-t)<=1)if(M){if(Math.abs(e.pageX-t-i)<=O)return;B()}else{if(!(Math.abs(e.pageX-t-i)<=O))return;N(t)}else Math.abs(e.pageX-t-i)<=O?N(t):B()}(),d=t,pe(n)&&R()}}),n.on("mousedown.table-resizable".concat(o),function(e){P(e)}),n.on("mouseout.table-resizable".concat(o),function(){x||B()}),y.on("keypress.table-resizable".concat(o),function(){M&&B()}),y.on("mousemove.table-resizable".concat(o),function(e){x&&(Object(i.b)("synchrony.stop",{id:"confluence.table-resize-plugin"}),_(e.pageX-r,!0,e),e.preventDefault())}),y.on("mouseup.table-resizable".concat(o),function(){x&&(n[0].releaseCapture&&n[0].releaseCapture(),x=!1,B(),le(y),fe(n),a&&a.width()!==c&&(ge(n)&&n.addClass("relative-table"),Object(i.b)("analytics",{name:"confluence.table.resize.from.".concat(h),data:{pageId:b.a.get("page-id")}})),me(n)&&ue(n),pe(n)&&R(!0),C&&(C.undoManager.add(),Object(i.b)("synchrony.start",{id:"confluence.table-resize-plugin"})))}),n.data("initialized",!0),this}function _(e,t,o){c||(c=a.width()),a.attr("data-mce-style")&&a.removeAttr("data-mce-style");var r=!1;if(m){var i=e-m,d=n.parent().width(),p=n.width()/d*100;me(n)&&p>99.9&&i>1&&(r=!0,!s&&(s=a.width()+a.next().width()));var h=Math.abs(Math.abs(e)-Math.abs(m));if(h>=E&&(u=!1),u&&h<E)return}var b=c+e;if(b<v&&(b=v),a.width(b),(r||l)&&(a.next().width(s-b),!l&&(l=o.pageX)),l&&l>o.pageX&&(l=null),ie(n,!1,a),!T&&t&&(S.css({display:"block",top:se(n[0],w[0]),left:parseInt(a.attr("data-offset-right"))-1,height:n.height()}),pe(n))){var C=ce(a,y,g)||function(e,t,n){var o;return Math.abs(parseInt(e.next().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=ae&&(o=!0,n.find(".resizable-align-right").remove(),f()('<div contenteditable="false" class="resize-alignment-bar resizable-align-right">').css({height:t.height(),top:se(t[0],n[0]),left:parseInt(e.next().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.attr("data-offset-left"))-1}).appendTo(n)),Math.abs(parseInt(e.prev().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=ae&&(o=!0,f()('<div contenteditable="false" class="resize-alignment-bar">').css({height:t.height(),top:se(t[0],n[0]),left:parseInt(e.prev().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.prev().attr("data-offset-left"))-1}).appendTo(n)),o}(a,n,w);C&&(u=!0),!C&&le(w)}m=Math.abs(e)}function P(e){a&&M&&(h=pe(n)?"fixed":me(n)?"relative":"fluid",x=!0,ie(n),n.updateTableModeInToolbar(),A("confluence.table.resizable.relative.keep.width")&&a.next().length||n.css({width:""}),r=e.pageX,n[0].setCapture&&n[0].setCapture(),y.find("body").attr("data-table-resizing",!0),c=parseInt(a.width(),10),g=function(e){var t=e.nextAll(".confluenceTable").first(),n=e.prevAll(".confluenceTable").first();return f.a.merge(n,t)}(n),e.preventDefault())}},ue=function(e){var t=e.parent().width(),n=e.width()/t*100;return n>100&&(n=100),e.css({width:"".concat(n,"%")}).attr("data-resize-percent",n),function(e){ie(e,!0)}(e),e},fe=function(e){return e.parent("body").find("#".concat(e.data("uuid"),"-holder")).remove(),e},me=function(e){return e.hasClass("relative-table")},pe=function(e){return e.hasClass("fixed-table")},ge=function(e){return!me(e)&&!pe(e)},he=function(e){var t={$doc:f()(p.a.document)},n=(e=f.a.extend(t,e||{})).$doc,o=this.data("uuid");return n.find("#resize-indicator").remove(),this.off("mousemove.table-resizable".concat(o)),this.off("mouseout.table-resizable".concat(o)),this.off("mousedown.table-resizable".concat(o)),n.off("keypress.table-resizable".concat(o)),n.off("mousemove.table-resizable".concat(o)),n.off("mouseup.table-resizable".concat(o)),this.data("initialized",!1),this},be=function(){return fe(f()(this)).removeClass("relative-table fixed-table").removeAttr("style").find(">colgroup").remove(),this},ve=function(){var e=f()(this);return fe(e),function(e){return ie(e),e}(e).css("width","").removeClass("relative-table").addClass("fixed-table"),this},ye=function(){if(this.parent().closest("table.confluenceTable").length)return f()("#table-mode-picker .dropdown-text").text(p.a.tinymce.activeEditor.translate("tinymce.table.responsive")),void f()("#table-mode-picker .aui-dd-parent").addClass("disabled");f()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),pe(this)?f()("#table-mode-picker .dropdown-text").text(p.a.tinymce.activeEditor.translate("tinymce.table.fixed_width")):f()("#table-mode-picker .dropdown-text").text(p.a.tinymce.activeEditor.translate("tinymce.table.responsive"))},Ce=function(e,t,n){if(n||n.content){var o=f()("<div/>").append(n.content);o.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each(function(){!function(e){e.data("resize-percent")?e.css({width:"".concat(e.data("resize-percent"),"%")}):e.attr("style",e.data("mce-style"))}(f()(this))}),n.content=o.html()}},we=function(e){A("confluence.table.resizable")&&(function(){f.a.fn.tableResizable=de,f.a.fn.removeTableResizable=he,f.a.fn.toggleFluidColumnWidth=be,f.a.fn.toggleFixedColumnWidth=ve,f.a.fn.updateTableModeInToolbar=ye}(),e.on("init",function(){!function(e){var t=f()(e.getWin().document),n=function(){t.find("table.confluenceTable").each(function(){f()(this).removeTableResizable({$doc:t})})};function o(){n(),t.find("#resize-indicator").remove(),t.find(".resize-width-holder").remove(),f()(e.getBody()).removeAttr("data-table-resizing")}e.on("Change",function(){var n=e.selection.getNode(),o=f()(n).parent().closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable");o.is(".confluenceTable")&&o.removeTableResizable({$doc:t}).tableResizable({$doc:t,editor:e,force:!0})}),Object(i.a)("confluence.editor.on.save",o),e.on("Remove",function(){Object(i.c)("confluence.editor.on.save",o)}),t.on("mousemove","table.confluenceTable",function(){var n=f()(this);n.parents("table.confluenceTable").length||n.data("initialized")||n.tableResizable({$doc:t,editor:e})}),p.a.tinymce.isWebKit&&f()(p.a.document).bind("prePaste",Ce),p.a.tinymce.Env.ie&&f()('<style type="text/css"></style>').html(".confluenceTable td, .confluenceTable th {overflow: hidden !important;}.confluenceTable .content-wrapper {overflow-x : visible !important}").appendTo(t.find("head"))}(e)}))},xe=function(e){function t(e){var t;n(e),function(){return!ne.getSelectedHighlightColour()}()||(t=ne.getSelectedHighlightColour(),e.attr("data-highlight-colour",t),e.addClass("highlight-".concat(t)))}function n(e){var t,n,o;for(t=0,n=e.length;t<n;t++)(o=e.eq(t)).attr("data-highlight-colour")&&o.removeAttr("data-highlight-colour"),o[0].className=o[0].className.replace(/( |^)highlight(-\w+)+/g,"")}e.on("init",function(){var o=function(e){return f()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},a=function(e){var t=f()(e.getBody()).find("th.confluenceTh.mceSelected,td.confluenceTd.mceSelected");return t.length?t:o(e)},r=function(e){return 0===e.find("tbody > tr > td").length};function i(e){return f()(e).parents("table").is(".confluenceTable")}function c(t){if(9===t.keyCode){var n=e.selection.getNode();if(i(n)&&!function(t){var n=e.dom.getParent(t,"UL,OL,TR").tagName;return"UL"===n||"OL"===n}(n)){var o=t.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell";return e.execCommand(o),t.preventDefault(),!1}}}e.addCommand("confTableRowToggleHeading",function(){var t=function(e){var t=f()(e.getBody()).find("td.mceSelected,th.mceSelected");t.length||(t=f()(e.selection.getNode()));for(var n=t.closest("tr"),o=n.parent(),a=o.is("tbody")?n.parent().parent():o;0!==n.length&&!a.is(".confluenceTable");)a=(o=(n=a.closest("tr")).parent()).is("tbody")?n.parent().parent():o;return n}(this),n=t.children("td,th"),o=0;ne.areCellsHeadings(n)?(r(t.closest("table"))||(n=n.filter(function(){var e=f()(this),t=e.closest("table");return o+=e.attr("colspan")||1,!ne.isColumnHeading(t,o)})),ne.convertToNormalCells(e,n)):ne.convertToHeadingCells(e,n)}),e.addCommand("confTableColumnToggleHeading",function(){var t=function(e){var t=f()([]);return e.each(function(){var e=f()(this),n=e.index()+1,o=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(o.children().nthCol(n))}),t}(a(this));ne.areCellsHeadings(t)?(r(t.closest("table"))||(t=t.filter(function(){var e=f()(this).parent("tr").children(),t=e.filter("th");return e.length!==t.length})),ne.convertToNormalCells(e,t)):ne.convertToHeadingCells(e,t)}),e.addCommand("confTableSelectionToggleHighlight",function(e,o){var r=o&&o.alwaysHighlight,i=a(this);ne.areCellsHighlighted(i)&&!r||function(){return!!f()("#table-highlight-group").attr("data-remove-highlight")}()?n(i):t(i)}),(p.a.tinymce.isIE8||A("confluence-table-enhancements.auto-row"))&&e.on("KeyDown",function(t){function n(t,n){var o=e.selection.getRng(!0),a=o.startContainer;if(o.collapsed){var r=function(e,t,n){for(;e!=t;){if(e[n])return!1;e=e.parentNode}return!0}(a,t,n);return 3===a.nodeType?r&&o.startOffset==("nextSibling"==n?a.length:0):a==t?o.startOffset==("nextSibling"==n?a.childNodes.length-1:0):r}return!1}if((37===t.keyCode||39===t.keyCode)&&!t.shiftKey){var a=o(this);if(a.length){var r=a[0];if(37===t.keyCode&&n(r,"previousSibling")&&!function(){var t=e.selection.getNode();return f()(t).parents("table").first().find("tr:first-child").children().first()[0]==t}())return e.execCommand("mceTableMoveCaretToPrevCell"),p.a.tinymce.dom.Event.cancel(t);if(39===t.keyCode&&n(r,"nextSibling")&&!function(){var t=e.selection.getNode();return f()(t).parents("table").first().find("tr:last-child").children().last()[0]==t}())return e.execCommand("mceTableMoveCaretToNextCell"),p.a.tinymce.dom.Event.cancel(t)}}}),e.on("KeyDown",function(t){c(t),A("editor.spa.uxenhancements")||function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(!0),o=f()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==o.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var a=o.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],r=f()(a);r.hasClass("numberingColumn")&&(a=r.next()[0]),n.setStart(a,0),n.setEnd(a,0),e.selection.setRng(n),t.preventDefault()}}}(t)}),A("confluence-table-enhancements.auto-row")&&(e.on("Click",function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")}),e.on("KeyDown",function(t){if((38===t.keyCode||40===t.keyCode)&&i()&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1},!0))}),A("confluence-table-enhancements.auto-row")&&e.on("init",function(){f()(p.a.tinymce.activeEditor.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")})},ke=function(e){var t,n,o=/([\+\-]?\d*)[nN]([\+\-]?\d*)/;e.fn.nthCol=function(a){return n=function(e){var t,n={multiplier:0,offset:0};return"even"===e?e="2n":"odd"===e?e="2n+1":/^\d*$/.test(e)&&(e="0n+".concat(e)),null!==(t=o.exec(e))&&(n.multiplier=t[1]-0,n.offset=t[2]-0),n}(a),t=function(t){var n,o,a=[],r=0,i=[];return e.each(t,function(e,t){var c=0,l=0,s=t.rowSpan||1,d=t.colSpan||1;for(t.parentNode!==n&&((n=t.parentNode).parentNode!==o&&(o=n.parentNode,a=[]),r=0,void 0===a[n.rowIndex]&&(a[n.rowIndex]=[])),c=0;c<a[n.rowIndex].length+1;c+=1)if(void 0===a[n.rowIndex][c]){r=c;break}for(i[e]=r,c=n.rowIndex;c<n.rowIndex+s;c+=1)for(void 0===a[c]&&(a[c]=[]),l=r;l<r+d;l+=1)a[c][l]=!0}),i}(this),e(this).filter(function(e){return function(e,o,a){var r=t[a]-(n.offset-1);return 0===n.multiplier?0===r:r%n.multiplier==0&&r/n.multiplier>=0}(0,0,e)})}},Te=function(){var e=p.a.tinymce.each,t=p.a.AJS.storageManager;ke(f.a);var n,o=t("atlassian.editor","tables"),a=1,r=10,i=8;function c(e,t){return parseInt(e.getAttribute(t)||1)}function l(t,o,l){var s,d,u,m,g;b();function h(e,t){return(e=e.cloneNode(t)).removeAttribute("id"),t&&N()&&e.removeChild(e.children[0]),e}function b(){var n=0;s=[],e(["thead","tbody","tfoot"],function(a){var r=o.select("> ".concat(a," > tr"),t);e(r,function(t,r){r+=n,e(o.select("> td, > th",t),function(e,t){var n,o;if(s[r])for(;s[r][t];)t++;var i=c(e,"rowspan"),l=c(e,"colspan");for(o=r;o<r+i;o++)for(s[o]||(s[o]=[]),n=t;n<t+l;n++)s[o][n]={part:a,real:o==r&&n==t,elm:e,rowspan:i,colspan:l}})}),n+=r.length})}function v(e,t){var n=s[t];if(n)return n[e]}function y(e,t,n){e&&(1===(n=parseInt(n))?e.removeAttribute(t,1):e.setAttribute(t,n,1))}function C(e){return e&&(o.hasClass(e.elm,"mceSelected")||e==m)}function w(){var n=[];return e(t.rows,function(t){e(t.cells,function(e){if(o.hasClass(e,"mceSelected")||e==m.elm)return n.push(t),!1})}),n}function x(t){var n;return p.a.tinymce.walk(t,function(a){var r;if(3===a.nodeType)return e(o.getParents(a.parentNode,null,t).reverse(),function(e){e=h(e,!1),n?r&&r.appendChild(e):n=r=e,r=e}),r&&(r.innerHTML=p.a.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1},"childNodes"),y(t=h(t,!1),"rowSpan",1),y(t,"colSpan",1),n?t.appendChild(n):p.a.tinymce.isIE||(t.innerHTML='<br data-mce-bogus="1" />'),f()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}function k(){var n=o.createRng();if(e(o.select("tr",t),function(e){0===e.cells.length&&o.remove(e)}),0===o.select("tr",t).length)return n.setStartAfter(t),n.setEndAfter(t),l.setRng(n),void o.remove(t);e(o.select("thead,tbody,tfoot",t),function(e){0===e.rows.length&&o.remove(e)}),function(){var e;b();var t=s[Math.min(s.length-1,d.y)];t&&(e=t[Math.min(t.length-1,d.x)].elm)&&function(e){p.a.tinymce.isIE9||p.a.tinymce.isIE10up?(l.setCursorLocation(e,0),l.collapse(!0)):(l.select(e,!0),l.collapse(!0))}(e)}()}function T(e,t,n,a){var r,i,c,l,d;for(r=s[t][e].elm.parentNode,c=1;c<=n;c++)if(r=o.getNext(r,"tr")){for(i=e;i>=0;i--)if((d=s[t+c][i].elm).parentNode==r){for(l=1;l<=a;l++)o.insertAfter(x(d),d);break}if(-1==i)for(l=1;l<=a;l++)r.insertBefore(x(r.cells[0]),r.cells[0])}}function E(){e(s,function(t,n){e(t,function(e,t){var a,r,i;if(C(e)&&(a=c(e=e.elm,"colspan"),r=c(e,"rowspan"),a>1||r>1)){for(y(e,"rowSpan",1),y(e,"colSpan",1),i=0;i<a-1;i++)o.insertAfter(x(e),e);T(t,n,r-1,a)}})})}function S(t){var n,a,r,i,l,d,u,f,m,g,b;for(e(s,function(o,a){if(e(o,function(e){if(C(e)&&(e=e.elm,l=e.parentNode,d=h(l,!1),n=a,t))return!1}),t)return!n}),i=0;i<s[0].length;i++)if(s[n][i]&&(a=s[n][i].elm)!=r){if(t){if(n>0&&s[n-1][i]&&(m=c(f=s[n-1][i].elm,"rowSpan"))>1){y(f,"rowSpan",m+1);continue}}else if((m=c(a,"rowspan"))>1){y(a,"rowSpan",m+1);continue}(u=(b=I(i))?o.create("th"):o.create("td")).colSpan=a.colSpan,u.width=a.width,u.innerHTML=p.a.tinymce.isIE9?"":p.a.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />',u.className=a.className,b||(o.removeClass(u,p.a.tinymce.settings.confluence_table_heading_style),o.addClass(u,p.a.tinymce.settings.confluence_table_cell_style)),g=o.getAttrib(a,"data-highlight-colour"),M(i)?o.setAttrib(u,"data-highlight-colour",g):o.removeClass(u,"highlight-".concat(g)),d.appendChild(u),r=a}d.hasChildNodes()&&(t?l.parentNode.insertBefore(d,l):o.insertAfter(d,l)),B()}function I(e){if(1===s.length)return!1;for(var t=0;t<s.length;t++)if(s[t]&&s[t][e]&&"TH"!==s[t][e].elm.tagName.toUpperCase())return!1;return!0}function M(e){var t=s[0][e].elm.getAttribute("data-highlight-colour");if(null===t)return!1;for(var n=0;n<s.length;n++)if(s[n][e].elm.getAttribute("data-highlight-colour")!==t)return!1;return!0}function O(t){var l,d,u=[];return e(s,function(n){if(e(n,function(e,n){if(C(e)&&(l=n,t))return!1}),t)return!l}),(0!=l||!t||!N())&&(e(s,function(e,s){var m,g;if(e[l]){var h=e[l].elm;if(A("confluence.table.resizable")&&0===s){var b=f()(h).closest("table"),v=b.find(">colgroup>col").eq(l),C=f()("<col>");t?C.insertBefore(v):C.insertAfter(v),b.hasClass("fixed-table")&&(n&&0!==parseFloat(n)?C.css({width:n}):C.css({width:i+2*r+a}))}if(h!=d){if(g=c(h,"colspan"),m=c(h,"rowspan"),1==g){var w=function(e){var t=o.create(e.tagName);t.colSpan=e.colSpan,t.width=e.width,t.className=e.className,t.innerHTML=p.a.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';var n=o.getAttrib(e,"data-highlight-colour");return n&&o.setAttrib(t,"data-highlight-colour",n),f()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}(h);t?(h.parentNode.insertBefore(w,h),T(l,s,m-1,g)):(o.insertAfter(w,h),T(l,s,m-1,g)),u.push(w)}else y(h,"colSpan",h.colSpan+1);d=h}}}),u)}function B(){if(N()){g=1;var n=0,o=0;e(t.rows,function(e){e=f()(e),ne.areCellsHeadings(e.children())?e.children(":first").addClass("numberingColumn").attr("contenteditable","true"):o>0?o--:(e.children(":first").html(g).attr("contenteditable","false").addClass("numberingColumn"),(n=e.children(":first").attr("rowspan"))>1&&(o=n-1),g++)})}}function N(){return f()(t.rows[0]).children(":first").hasClass("numberingColumn")}function R(e){if(e){if(f()(t.rows[0]).children(":first").addClass("numberingColumn"),A("confluence.table.resizable")){var n=f()(t),o=n.find(">colgroup>col").eq(0),c=f()("<col>");c.insertBefore(o),n.hasClass("fixed-table")&&c.css({width:i+2*r+a})}}else f()(t.rows[0]).children(":first").removeClass("numberingColumn"),A("confluence.table.resizable")&&f()(t).find(">colgroup>col").eq(0).remove()}function _(){var t=[];e(s,function(n){e(n,function(n,a){C(n)&&-1===p.a.tinymce.inArray(t,a)&&(A("confluence.table.resizable")&&f()(n.elm).closest("table").find(">colgroup>col").eq(a).remove(),e(s,function(e){if(e[a]){var t=e[a].elm,n=c(t,"colSpan");n>1?y(t,"colSpan",n-1):o.remove(t)}}),t.push(a))})}),k()}function P(){var t={};return e(s,function(o){e(o,function(e,o){C(e)&&(A("confluence.table.resizable")&&(n=f()(e.elm).closest("table").find(">colgroup>col").eq(o).css("width"),0===parseFloat(n)&&(n=e.elm.getBoundingClientRect().width)),t[o]||(t[o]=[]))})}),e(s,function(n){e(n,function(e,n){t[n]&&t[n].push(e.elm.innerHTML)})}),t}function D(e){e&&e.parentNode&&(l.select(e.parentNode),l.collapse(!0))}function H(e,t){var n=v(e.x,e.y).elm,o=void 0===t||t;if((p.a.tinymce.isGecko||p.a.tinymce.isIE)&&n.firstChild&&(n=n.firstChild),p.a.tinymce.isIE9||p.a.tinymce.isIE10up){var a=l.getRng(1);o?(a.setStart(n,0),a.setEnd(n,0)):(a.setStartAfter(n,0),a.setEndAfter(n,0)),l.setRng(a)}else l.select(n,!0),l.collapse(o)}function j(){var e,t=s[0].length;return d.x==t-1&&d.y==s.length-1||(d.x==t-1&&N()?(e={x:1,y:d.y+1},ne.areCellsHeadings(f()(s[e.y][0].elm).parent().children())&&(e.x=0)):e=d.x==t-1?{x:0,y:d.y+1}:{x:d.x+1,y:d.y}),e}function L(){var e,t;return 0==d.x&&0==d.y||(1==d.x&&N()&&!ne.areCellsHeadings(f()(s[d.y][0].elm).parent().children())?(t=d.y-1,e={x:s[t].length-1,y:t}):d.x>0?e={x:d.x-1,y:d.y}:(t=d.y-1,e={x:s[t].length-1,y:t})),e}function F(t){var n;return e(s,function(o,a){return e(o,function(e,o){if(e.elm==t)return n={x:o,y:a},!1}),!n}),n}(m=o.select("td.mceSelected,th.mceSelected")[0]||f()(l.getStart()).closest(["table.confluenceTable > tbody > tr > th","table.confluenceTable > tbody > tr > td","table.confluenceTable > thead > tr > th","table.confluenceTable > thead > tr > td"].join(","))[0])&&(d=F(m),u=function(){var t,n;return t=n=0,e(s,function(o,a){e(o,function(e,o){var r,i;C(e)&&(e=s[a][o],o>t&&(t=o),a>n&&(n=a),e.real&&(r=e.colspan-1,i=e.rowspan-1,r&&o+r>t&&(t=o+r),i&&a+i>n&&(n=a+i)))})}),{x:t,y:n}}(),m=v(d.x,d.y)),p.a.tinymce.extend(this,{deleteTable:function(){var e=o.createRng();e.setStartAfter(t),e.setEndAfter(t),l.setRng(e),o.remove(t)},split:E,merge:function(t,n,a){var r,i,c,l,f,m,g,h,C;if(t){var w=F(t);c=(r=w.x)+(n-1),l=(i=w.y)+(a-1)}else r=d.x,i=d.y,c=u.x,l=u.y;if(0!=r||!N()){g=v(r,i);var x=v(c,l);if(g&&x&&g.part==x.part){for(E(),b(),y(g=v(r,i).elm,"colSpan",c-r+1),y(g,"rowSpan",l-i+1),m=i;m<=l;m++)for(f=r;f<=c;f++)s[m]&&s[m][f]&&(t=s[m][f].elm)!=g&&(h=p.a.tinymce.grep(t.childNodes),e(h,function(e){g.appendChild(e)}),h.length&&(h=p.a.tinymce.grep(g.childNodes),C=0,e(h,function(e){"BR"===e.nodeName&&o.getAttrib(e,"data-mce-bogus")&&C++<h.length-1&&g.removeChild(e)})),o.remove(t));k()}}},insertRow:S,insertCol:O,insertNumCol:function(){var t;N()?(e(s,function(e){var t=e[0].elm;f()(t).hasClass("numberingColumn")&&null!==t.parentNode&&t.parentNode.removeChild(t)}),R(!1)):(e(s,function(e){var n=e[0].elm;if(t!=n){var o=x(n);n.parentNode.insertBefore(o,n),n.rowSpan>1&&(o.rowSpan=n.rowSpan),t=n}}),R(!0)),B()},updateNumCol:B,deleteCols:_,deleteRows:function(){var t=w();(p.a.tinymce.isIE9||p.a.tinymce.isIE10)&&D(t[0]),e(t.reverse(),function(t){!function(t){var n,a;e(t.cells,function(e){var t=c(e,"rowSpan");t>1&&(y(e,"rowSpan",t-1),T((n=F(e)).x,n.y,1,1))}),n=F(t.cells[0]),e(s[n.y],function(e){var t;(e=e.elm)!=a&&((t=c(e,"rowSpan"))<=1?o.remove(e):y(e,"rowSpan",t-1),a=e)})}(t)}),k(),B()},cutRows:function(){var e=w();return(p.a.tinymce.isIE9||p.a.tinymce.isIE10)&&D(e[0]),o.remove(e),k(),B(),e},copyRows:function(){var t=w();return e(t,function(e,n){t[n]=h(e,!0)}),t},pasteRows:function(t,n){var a=w(),r=a[n?0:a.length-1],i=r.cells.length;e(s,function(t){var n;if(i=0,e(t,function(e){e.real&&(i+=e.colspan),e.elm.parentNode==r&&(n=1)}),n)return!1}),n||t.reverse(),e(t,function(e){var t,a=e.cells.length;for(f()(e.cells[0]).hasClass("numberingColumn")&&(e.removeChild(e.cells[0]),a--),g=0;g<a;g++)y(t=e.cells[g],"colSpan",1),y(t,"rowSpan",1);for(N()&&(e.insertBefore(e.firstChild.cloneNode(!1),e.firstChild),f()(e.firstChild).addClass("numberingColumn"),a++);i<a;)O(!1),i++;for(g=a;g<i;g++)e.appendChild(x(e.cells[a-1]));n?r.parentNode.insertBefore(e,r):o.insertAfter(e,r)}),B()},getPos:F,setStartCell:function(e){d=F(e)},setEndCell:function(e){var t,n,a,r,i,c,l,f;if(u=F(e),d&&u){t=Math.min(d.x,u.x),n=Math.min(d.y,u.y),i=a=Math.max(d.x,u.x),c=r=Math.max(d.y,u.y);for(var m=n;m<=c;m++)(e=s[m][t]).real||t-(e.colspan-1)<t&&(t-=e.colspan-1);for(var p=t;p<=i;p++)(e=s[n][p]).real||n-(e.rowspan-1)<n&&(n-=e.rowspan-1);for(var g=n;g<=r;g++)for(var h=t;h<=a;h++)(e=s[g][h]).real&&(l=e.colspan-1,f=e.rowspan-1,l&&h+l>i&&(i=h+l),f&&g+f>c&&(c=g+f));o.removeClass(o.select("td.mceSelected,th.mceSelected"),"mceSelected");for(var b=n;b<=c;b++)for(var v=t;v<=i;v++)s[b][v]&&o.addClass(s[b][v].elm,"mceSelected")}},moveCaretToNextCell:function(){var e=j();e||(S(!1),b(),e=j()),H(e)},moveCaretToPrevCell:function(){var e=L();e||(S(!0),b(),function(){d=F(o.getParent(l.getStart(),"th,td"))}(),e=L()),H(e,!1)},cutColumns:function(){var e=P();return _(),e},copyColumns:P,pasteColumns:function(e,t){var n=Object.keys(e);t||n.reverse(),f.a.each(n,function(n,o){var a=O(t);for(n=0;n<a.length;n++)a[n].innerHTML=e[o][n]||""})},prepareTableForColPasteAndCheckIfNeedToRepaint:function(t){var n,o,a=t[Object.keys(t)[0]].length,r=!1;if(e(s,function(t,r){a--,n=r,e(t,function(e,t){o=t})}),a>0)for(r=!0,m=v(o,n),g=0;g<a;g++)S(!1);return r},toggleFluidColumnWidth:function(){t&&t.rows&&(f()(t).toggleFluidColumnWidth(),f()("#table-mode-picker .dropdown-text").text(p.a.tinymce.activeEditor.translate("tinymce.table.responsive")))},toggleFixedColumnWidth:function(){t&&t.rows&&(f()(t).toggleFixedColumnWidth(),f()("#table-mode-picker .dropdown-text").text(p.a.tinymce.activeEditor.translate("tinymce.table.fixed_width")))}})}return{init:function(t){var a=!0;function r(e){var n=t.selection;e=e||n.getNode().parentNode;var o=t.dom.getParent(e,"table.confluenceTable");if(o)return new l(o,t.dom,n)}function i(){t.getBody().style.webkitUserSelect="",a&&(t.dom.removeClass(t.dom.select("td.mceSelected,th.mceSelected"),"mceSelected"),a=!1)}function s(e){for(var n,a=[],r=0;r<e.length;r++)a.push(t.serializer.serialize(e[r]));n="<tr>".concat(a.join("</tr><tr>"),"</tr>"),o.setItem("copied",n,7200)}function d(){var e,n=[],a=o.getItem("copied")||"";return a&&((e=t.getDoc().createElement("div")).innerHTML="<table>".concat(a,"</table>"),n=f()(e).find("tr")),n}function u(e){o.setItem("copiedCols",JSON.stringify(e))}function m(){return JSON.parse(o.getItem("copiedCols"))||{}}e([["table","table.desc","mceInsertTable",!0],["delete_table","table.del","mceTableDelete"],["delete_col","table.delete_col_desc","mceTableDeleteCol"],["delete_row","table.delete_row_desc","mceTableDeleteRow"],["col_after","table.col_after_desc","mceTableInsertColAfter"],["col_before","table.col_before_desc","mceTableInsertColBefore"],["row_after","table.row_after_desc","mceTableInsertRowAfter"],["row_before","table.row_before_desc","mceTableInsertRowBefore"],["row_props","table.row_desc","mceTableRowProps",!0],["cell_props","table.cell_desc","mceTableCellProps",!0],["split_cells","table.split_cells_desc","mceTableSplitCells",!0],["merge_cells","table.merge_cells_desc","mceTableMergeCells",!0]],function(e){t.addButton(e[0],{title:e[1],cmd:e[2],ui:e[3]})}),p.a.tinymce.isIE||t.on("Click",function(e){"TABLE"===(e=e.target).nodeName&&(t.selection.select(e),t.nodeChanged())}),t.on("PreProcess",function(e){var n,o,a,r=t.dom,i=r.select("table",e.node);for(n=i.length;n--;)o=i[n],r.setAttrib(o,"data-mce-style",""),(a=r.getAttrib(o,"width"))&&(r.setStyle(o,"width",a),r.setAttrib(o,"width","")),(a=r.getAttrib(o,"height"))&&(r.setStyle(o,"height",a),r.setAttrib(o,"height",""))}),t.on("init",function(){var n,o,l,s=t.dom;function d(e){if(p.a.tinymce.isWebKit){var t=e.selection.getRng(),n=e.selection.getNode(),o=e.dom.getParent(t.startContainer,"TD,TH");if(function(e,t,n,o){var a,r=e.dom.getParent(t.startContainer,"TABLE");r&&(a=r.parentNode);var i=3===t.startContainer.nodeType&&0==t.startOffset&&0==t.endOffset&&o&&("TR"===n.nodeName||n==a),c=("TD"===n.nodeName||"TH"===n.nodeName)&&!o;return i||c}(e,t,n,o)){o||(o=n);for(var a=o.lastChild;a.lastChild;)a=a.lastChild;t.setEnd(a,a.nodeValue.length),e.selection.setRng(t)}}}if(t.on("MouseDown",function(e){2!=e.button&&(i(),o=s.getParent(e.target,"td,th"),n=s.getParent(o,"table"))}),s.bind(t.getDoc(),"mouseover",function(e){var i,c,d=s.getParent(e.target,"td,th");if(o&&(l||d!=o)&&d){(c=s.getParent(d,"table"))==n&&(l||((l=r(c)).setStartCell(o),t.getBody().style.webkitUserSelect="none"),l.setEndCell(d),a=!0),i=t.selection.getSel();try{i.removeAllRanges?i.removeAllRanges():i.empty()}catch(e){}e.preventDefault()}}),t.on("MouseUp",function(){var e,a,r,i,c,d=t.selection;if(o){var u=function(t,n){var o=new p.a.tinymce.dom.TreeWalker(t,t);do{if(3===t.nodeType&&0!==p.a.tinymce.trim(t.nodeValue).length)return void(n?e.setStart(t,0):e.setEnd(t,t.nodeValue.length));if("BR"===t.nodeName)return void(n?e.setStartBefore(t):e.setEndBefore(t))}while(t=n?o.next():o.prev())};if(l&&(t.getBody().style.webkitUserSelect=""),(a=s.select("td.mceSelected,th.mceSelected")).length>0){e=s.createRng(),i=a[0],e.setStartBefore(i),e.setEndAfter(i),u(i,1),r=new p.a.tinymce.dom.TreeWalker(i,s.getParent(a[0],"table"));do{if("TD"===i.nodeName||"TH"===i.nodeName){if(!s.hasClass(i,"mceSelected"))break;c=i}}while(i=r.next());u(c),d.setRng(e)}t.nodeChanged(),o=l=n=null}}),t.on("Undo",function(){a=t.dom.select("td.mceSelected, th.mceSelected").length>0}),t.on("KeyUp",function(){i()}),t.on("KeyDown",function(){d(t)}),t.on("MouseDown",function(e){2!=e.button&&d(t)}),t.plugins.aeTable.fixTableCellSelection=d,p.a.tinymce.isWebKit){t.on("KeyDown",function(n){var o=p.a.tinymce.util.VK,a=n.keyCode;function r(e,n,o){var a=e?"previousSibling":"nextSibling",c=t.dom.getParent(n,"tr"),d=c[a];if(d)return s(t,n,d,e),p.a.tinymce.dom.Event.cancel(o),!0;var u=t.dom.getParent(c,"table"),f=c.parentNode,m=f.nodeName.toLowerCase();if("tbody"===m||m===(e?"tfoot":"thead")){var g=function(e,n,o,a){var r=t.dom.select(">".concat(a),n),i=r.indexOf(o);if(e&&0===i||!e&&i===r.length-1)return function(e,n){var o=e?"thead":"tfoot",a=t.dom.select(">".concat(o),n);return 0!==a.length?a[0]:null}(e,n);if(-1===i){var c="thead"===o.tagName.toLowerCase()?0:r.length-1;return r[c]}return r[i+(e?-1:1)]}(e,u,f,"tbody");if(null!==g)return function(e,n,o,a){var r=i(n,e);return r&&s(t,o,r,e),p.a.tinymce.dom.Event.cancel(a),!0}(e,g,n,o)}return function(e,n,o,a,c){var s=a[o];if(s)return l(s),!0;var d=t.dom.getParent(a,"td,th");if(d)return r(e,d,c);var u=i(n,!e);return l(u),p.a.tinymce.dom.Event.cancel(c)}(e,c,a,u,o)}function i(e,n){var o=e&&e[n?"lastChild":"firstChild"];return o&&"BR"===o.nodeName?t.dom.getParent(o,"td,th"):o}function l(e){t.selection.setCursorLocation(e,0)}function s(t,n,o,a){var r=function(t,n){var o=0,a=0;return e(t.children,function(e,t){if(o+=c(e,"colspan"),a=t,o>n)return!1}),a}(o,function(e){for(var t=0,n=e;n.previousSibling;)t+=c(n=n.previousSibling,"colspan");return t}(t.dom.getParent(n,"td,th"))),s=o.childNodes[r];l(i(s,a)||s)}function d(e){var n=t.selection.getNode(),o=t.dom.getParent(n,"td,th"),a=t.dom.getParent(e,"td,th");return o&&o!==a&&function(e,n){return t.dom.getParent(e,"TABLE")===t.dom.getParent(n,"TABLE")}(o,a)}if(function(){return a==o.UP||a==o.DOWN}()&&function(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}(t)){var u=t.selection.getNode();setTimeout(function(){d(u)&&r(!n.shiftKey&&a===o.UP,u,n)},0)}})}if(!p.a.tinymce.isIE){var u=function(){};p.a.tinymce.isGecko&&t.on("KeyDown",function(e){var n,o,a=t.dom;37!==e.keyCode&&38!==e.keyCode||(n=t.selection.getRng(),(o=a.getParent(n.startContainer,"table"))&&t.getBody().firstChild==o&&function(e,t){var n=t.ownerDocument,o=n.createRange();o.setStartBefore(t),o.setEnd(e.endContainer,e.endOffset);var a=n.createElement("body");return a.appendChild(o.cloneContents()),0===a.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length}(n,o)&&((n=a.createRng()).setStartBefore(o),n.setEndBefore(o),t.selection.setRng(n),e.preventDefault()))}),t.on("KeyUp",u),t.on("SetContent",u),t.on("VisualAid",u),p.a.tinymce.isGecko&&t.on("KeyDown",function(e){if(e.keyCode===p.a.tinymce.util.VK.ENTER&&e.shiftKey){var n=t.selection.getRng().startContainer;if(s.getParent(n,"td,th")){var o=t.getDoc().createTextNode("\ufeff");s.insertAfter(o,n)}}}),t.startContent=t.getContent({format:"raw"})}}),e({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){t.dom.select("td.mceSelected,th.mceSelected").length&&e.merge()},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertNumberingCol:function(e){e.insertNumCol()},mceTableUpdateNumberingCol:function(e){e.updateNumCol()},mceAutoWidth:function(e){e.toggleFluidColumnWidth()},mceFixedWidth:function(e){e.toggleFixedColumnWidth()},mceTableInsertColBefore:function(e){n=null,e.insertCol(!0)},mceTableInsertColAfter:function(e){n=null,e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){s(e.cutRows())},mceTableCopyRow:function(e){s(e.copyRows())},mceTablePasteRowBefore:function(e){e.pasteRows(d(),!0)},mceTablePasteRowAfter:function(e){e.pasteRows(d())},mceTableDelete:function(e){e.deleteTable()},mceTableMoveCaretToNextCell:function(e){e.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(e){e.moveCaretToPrevCell()},mceTableCopyCol:function(e){u(e.copyColumns())},mceTableCutCol:function(e){u(e.cutColumns())},mceTablePasteColBefore:function(e){var n=m();e.prepareTableForColPasteAndCheckIfNeedToRepaint(n)&&(t.execCommand("mceRepaint"),e=r()),e.pasteColumns(n,!0)},mceTablePasteColAfter:function(e){e.pasteColumns(m(),!1)}},function(e,n){t.addCommand(n,function(){var n=r();n&&(e(n),t.execCommand("mceRepaint"),i())})}),Z(t),we(t),xe(t)}}};n("zFIa");var Ee=function(e){return e.replace(/[&"'<>`]/g,function(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"})};function Ae(e,t,n){"cl.ly"==e.host?f.a.get("".concat(C.a,"/rest/autoconvert/1.0/cloudappembed?resource=").concat(e.path.substr(1)),function(e){if(e)switch(e.item_type){case"image":var o=Ee(e.content_url);n(f()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(o,'" data-image-src="').concat(o,'"/>'))[0]);break;case"bookmark":t.text(e.name),t.attr("href",Ee(e.redirect_url)),n(t)}else n()}):n()}var Se=function(){Object(i.a)("init.rte",function(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(Ae)})};function Ie(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?"".concat(e,"#").concat(t.anchor.substring(t.anchor.indexOf("-")+1)):e},n=function(n,a,r){if(o(n)){var i,c=function(e){return C.a?e.path.substring(C.a.length+1):e.path.substring(1)}(n),l=decodeURIComponent(c).split("/");n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(i="$".concat(n.queryKey.focusedCommentId),i=t(i,n)):n.queryKey.pageId?(i="$".concat(n.queryKey.pageId),i=t(i,n)):"display"===l[0]?i=function(e,n,o){return 2===o.length&&0===o[1].indexOf("~")?n=o[1]:3===o.length?(n="".concat(o[1],":").concat(o[2].replace(/\+/g," ")),n=t(n,e)):4===o.length&&"status"===o[1]?n="$".concat(o[3]):6===o.length&&(n="".concat(o[1],":")+"/".concat(o[2],"/").concat(o[3],"/").concat(o[4],"/").concat(o[5].replace(/\+/g," ")),n=t(n,e)),n}(n,i,l):"spaces"===l[0]&&(i=(i=(i=e.spaViewPageLinkHandler(l))||e.spaBlogPostLinkHandler(l))?t(i,n):function(e,n,o){return 2!==o.length&&3!==o.length||-1!==o[1].indexOf(".action")||(n="".concat(o[1],":")+"",n=t(n,e)),n}(n,i,l)),i?(i="[".concat(i,"]"),p.a.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(i,function(e){r(f()(e).children()[0])},function(){r()})):r()}else r()},o=function(e){var t=!0;return t=t&&e.authority===document.location.host,t=t&&(!C.a||0===e.path.indexOf(C.a)),t};this.init=function(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}Ie.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$".concat(n)},Ie.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],o=e[3],a=e[4],r=e[5],i=e[6],c=e[7];if(t&&n&&o&&a&&r&&i&&c)return"".concat(n,":/").concat(o,"/").concat(a,"/").concat(r,"/").concat(c.replace(/\+/g," "))};var Me=function(){var e=new Ie;Object(i.a)("init.rte",e.init)};function Oe(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var o=decodeURIComponent(e.queryKey.url);(t=f()(t)).attr("href",o),t.attr("data-mce-href",o),t.text(o),n(t)}else n()})}var Be=function(){Object(i.a)("init.rte",Oe)};function Ne(e,t,n){if(-1!==e.host.search(".linkedin.")){var o="https://card-meta.atlassian.io/meta?url=".concat(e.source);f.a.ajax(o,{timeout:5e3,success:function(n){if(-1===n.title.search("Sign In")){var o=n.title.indexOf("|"),a=-1===o?n.title:n.title.substring(0,o);t.text(a),t.attr("href",e.source)}},error:function(e,t){0},complete:function(){n()}})}else n()}var Re=function(){A("autoconvert-link-to-page-title")&&Object(i.a)("init.rte",function(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(Ne)})},_e=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):"".concat(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"(.*)")};p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(function(t,n,o){if(t.source===n.text()){for(var a=0;a<e.length;a++){var r=e[a],i=t.source.match(r.regex);if(i){var c=i[1];if(r.defaultAlias){var l=r.defaultAlias.replace(/%s/,c);return void o(f()(n).text(l))}return void o(f()(n).text(c))}}o()}else o()}),setTimeout(function(){!function(){f.a.ajax({url:"".concat(C.a,"/rest/autoconvert/latest/shortcutlinkconfigurations"),type:"GET",dataType:"json",success:function(n){e=n.configurations;for(var o=0;o<e.length;o++){var a=e[o];try{a.regex=new RegExp(t(a.expandedValue,a.defaultAlias))}catch(e){console.log("Failed to generated regex for ".concat(a))}}},error:function(e){console.log("Failed to load shortcut link configurations ".concat(e.statusText))}})}()},0)},Pe=function(){Object(i.a)("init.rte",_e)},De=function(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?f.a.get("".concat(C.a,"/rest/autoconvert/1.0/skitchembed?url=").concat(e.source),function(e){e&&e.url?n(f()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(e.url,'" data-image-src="').concat(e.url,'"/>'))[0]):n()}):n()},He=function(){Object(i.a)("init.rte",function(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(De)})};function je(){var e=[/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/maps.google(.[a-z]+)+\/maps/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(function(t,n,o){for(var a=decodeURI(t.source),r=0;r<e.length;r++)if(a.match(e[r])){var i={name:"widget",params:{url:a}};return void p.a.tinymce.plugins.Autoconvert.convertMacroToDom(i,o,o)}o()})}var Le=function(){Object(i.a)("init.rte",je)};function Fe(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(function(e,t,n){if(e.host.match(".*youtu.be.*")){var o=e.path.substr(1),a="http://youtube.com/watch?v=".concat(o);n(f()(t).attr("href",a).html(a))}else n()})}var ze=function(){Object(i.a)("init.rte",Fe)},We={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,t){var n=null;for(var o in t)if(t.hasOwnProperty(o)){var a=t[o],r=a.url;if("/"!==a.url[a.url.length-1]&&(r+="/"),0===e.indexOf(r)){n=a;break}}return n},pasteHandler:function(e,t,n){var o=E.a.Editor.JiraConnector.servers;if(!o)return n(),null;var a=E.a.Editor.JiraAnalytics,r={},i=We._getMatchedServerFromLink(e.source,o),c=null;if(i){var l=We.jqlRegEx.exec(e.source)||We.jqlRegExAlternateFormat.exec(e.source),s=E.a.JQLHelper.isFilterUrl(e.source),d=We.issueKeyOnlyRegEx.exec(e.source)||We.issueKeyWithinRegex.exec(e.source);if(d?(d=d[2],a&&(r.type=a.linkTypes.jql)):(d=We.singleTicketXMLEx.exec(e.source))&&(d=d[1],a&&(r.type=a.linkTypes.xml)),l)r.is_single_issue=!1,r.type=E.a.JQLHelper.checkQueryType(e.source),c={name:"jira",params:{server:i.name,serverId:i.id,jqlQuery:decodeURIComponent(l[1].replace(/\+/g,"%20"))}};else if(s){var u=e.source;r.is_single_issue=!1,r.type=E.a.JQLHelper.checkQueryType(u),c={name:"jira",params:{server:i.name,serverId:i.id,jqlQuery:E.a.JQLHelper.getFilterFromFilterUrl(u)}}}else d&&(r.is_single_issue=!0,c={name:"jira",params:{server:i.name,serverId:i.id,key:d}})}c?(p.a.tinymce.plugins.Autoconvert.convertMacroToDom(c,n,n),a&&a.triggerPasteEvent(r)):n()}};var Ke=/^\/(.*?)\/status\/([^/]+\/?$)/,Ve=/^\/(.*?)\/statuses\/([^/]+\/?$)/,Ue=function(e,t,n){var o,a,r;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(Ke))?a="".concat(e.protocol,"://twitter.com/").concat(o[1],"/status/").concat(o[2]):(o=decodeURI(e.path).match(Ve))&&(a="".concat(e.protocol,"://twitter.com/").concat(o[1],"/statuses/").concat(o[2])),a?(r={name:"widget",params:{url:a}},p.a.tinymce.plugins.Autoconvert.convertMacroToDom(r,n,n)):n()):n()},$e=function(){Object(i.a)("init.rte",function(){return p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(Ue)})};function qe(){Se(),Me(),Be(),Re(),Pe(),He(),Le(),ze(),function(){Object(i.a)("init.rte",function(){p.a.tinymce.plugins.Autoconvert.autoConvert.addHandler(We.pasteHandler)})}(),$e()}var Je={initializeEditor:function(){p.a.AJS&&p.a.AJS.Rte&&p.a.AJS.Rte.BootstrapManager&&p.a.AJS.Rte.BootstrapManager.addOnInitCallback(function(){var e=p.a.tinymce.activeEditor;e&&(!p.a.MutationObserver||p.a.tinymce.Env.gecko||p.a.tinymce.Env.webkit?function(e){e.on("Paste",function(e){return!!Je.onPaste(e)||(p.a.tinymce.dom.Event.cancel(e),!1)})}(e):function(e){new MutationObserver(function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.addedNodes.length)for(var o=0;o<n.addedNodes.length;o++)if("img"===n.addedNodes[o].localName)return void p.a.setTimeout(Je.pasteFromDataURL,0)}}).observe(e.getDoc(),{childList:!0,subtree:!0})}(e))})},pasteFromDataURL:function(){var e=f()('img[src^="data:image"]:not(".editor-inline-macro")',p.a.tinymce.activeEditor.getDoc());f.a.each(e,function(){var e,t,n,o=this.src;if(A("filestore.direct.upload")&&!A("filestore.direct.upload.force.disable")){var a=o.split(","),r=atob(a[1]),i=r.length;for(t=r.length,e=new Uint8Array(i);i--;)e[i]=r.charCodeAt(i)}else{n="base64",t=3*(e=o.substring(22,o.length)).length/4;for(var c=0,l=e.length-1;"="==e[l];l--)c++;t-=c}p.a.AJS.Confluence.Uploader.upload([Je.createUploadFile(e,t,n)])}),e.remove()},onPaste:function(e){return!e||!e.clipboardData||Je.pasteFromEvent(e)},showClipboardAccessError:function(){var e=p.a.tinymce.activeEditor;new p.a.AJS.Dialog({width:400,closeOnOutsideClick:!0}).addPanel("alert",f()("<div />",{text:e.translate("clipboardaccess.browser.not.supported")})).addButton(e.translate("clipboardaccess.ok"),function(e){e.remove()}).show().updateHeight()},pasteFromEvent:function(e){if(e&&e.clipboardData){if(e.clipboardData.items){var t=e.clipboardData.items[0];if(!t||"file"!=t.kind)return!0;var n=t.getAsFile(),o=Je.createUploadFile(n,n.size);return p.a.AJS.Confluence.Uploader.upload([o]),!1}p.a.setTimeout(function(e){var t=f()("img[src^='webkit-fake-url://']",p.a.tinymce.activeEditor.getDoc());t.length&&(t.remove(),e.showClipboardAccessError())},0,this)}return!0},createUploadFile:function(e,t,n){var o=new Date,a=o.getMonth()+1;return{fileName:"image".concat(o.getFullYear(),"-").concat(a,"-").concat(o.getDate(),"_").concat(o.getHours(),"-").concat(o.getMinutes(),"-").concat(o.getSeconds(),".png"),fileSize:t,slice:function(t,n){return e.slice(t,t+n)},getAsBinary:function(){return e},getData:function(){return e},encoding:n}}};n("e2U2");var Ge=function(){var e=p.a.Confluence.PropertyPanel;if(!(f.a.browser.msie&&f.a.browser.version<=8)){var t,n,o,a,r,c,l,s,d,u,m,h,b,v="img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",y="img",C=10,w=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100],x="confluence.draggable-plugin",k="div.innerCell,div.cell",T="body",E="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img",A="li,td,th",S="p,h1,h2,h3,h4,h5,h6,blockquote",I="li,td,th";return{init:function(e){t=e,e.on("Init",function(){var t;n=f()(e.getWin()),o=f()(e.getDoc()),a=f()(e.getBody()),t=f.a.browser.webkit?a:o.find("html"),h=function(e){var t=0;return{scrollUp:function(n){if(t!==-n){t=-n;var o=e.scrollTop()/n*1e3;e.stop(!1,!1),e.animate({scrollTop:0},{duration:o})}},scrollDown:function(n){if(t!==n){var o=e[0].scrollHeight,a=(o-e.scrollTop())/n*1e3;e.stop(!1,!1),e.animate({scrollTop:o},{duration:a})}},cancelScrolling:function(){e.stop(!0,!1)},scrollHeight:function(){return e[0].scrollHeight}}}(t),function(){o.delegate(v,{mousedown:O})}()})},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}function M(e){var n=!!a.children(".contentLayout,.contentLayout2").length;function r(){return o.find("#move-indicator")}function i(e){return"move-indicator"===e.attr("id")}function c(e){return n?e.is(k):e.is(T)}function l(e,t){var n=e.offset();return t+o.scrollTop()-n.top}return{positionNear:function(t,n){var s=function(t,n){var s=f()(o[0].elementFromPoint(t,n)),d=!0;if(function(t){return!(!t.is(E)||i(t))&&!(t.is("td.wysiwyg-macro-body")&&"PLAIN_TEXT"===t.closest("table").attr("data-macro-body-type")||t.is("img")&&!e.is("img"))}(s))return{target:s,before:function(e,t,n){if(e.is("img")){var a=function(e,t){var n=e.offset();return t+o.scrollLeft()-n.left}(e,t),r=e.width();return a<r/2}var i=l(e,n),c=e.height();return i<c/2}(s,t,n)};if(c(s)){if(function(e,t){return l(e.children().first(),t)<0}(s=function(e){return e.is("div.cell")?e.children("div.innerCell").first():e}(s),n))s=s.children().first();else if(function(e,t){return function(e,t){var n=l(e,t),o=e.height();return n-o}(e.children().last(),t)>0}(s,n))s=s.children().last(),d=!1;else{if(function(e){return function(){return r().length>0}()&&r().parent(e).length>0}(s))return null;s=function(t){var n=e.parent(E);return n.length||(n=t.find(E).last()),n.length||(n=a.find(E).last()),n}(s),d=!1}return{target:s,before:d}}return null}(t,n);s&&function(e,t){if(!i(e)){var n=r();e.is(A)&&e.find(n).length||(n.length?n.detach():n=function(){return f()('<span id="move-indicator">|</span>')}(),!(e=function(e){if(e.is(A)){var t=e.children().first();t.is(S)&&(e=t)}return e}(e)).is("img")&&Object(g.b)().Cursor.isTextContainerEmpty(e[0])?e.prepend(n):e.is(I)?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n))}}(s.target,s.before)},replaceWith:function(e){var n=r();n.length?(e.is(y)&&c(n.parent())&&(e=f()("<p></p>").append(e)),n.replaceWith(e),t.dom.isBlock(e[0])&&e.parent().is("p")&&e.unwrap(),Object(g.b)().showElement(e),t.selection.select(e[0]),t.selection.collapse(!0)):t.undoManager.undo(),Object(g.b)().Cursor.fixCursorTargets(t.getBody())},destroy:function(){var e=r();e.length&&(e.remove(),Object(g.b)().Cursor.fixCursorTargets(t.getBody()))}}}function O(e){if(1===e.which&&e.target===e.currentTarget)if(d)_(e);else{d=f()(e.target),t.selection.select(e.target),e.preventDefault(),o.bind({"mousemove.moveable-zone":R,"mouseup.moveable-zone":_,"keydown.moveable-zone":B,"mouseover.moveable-zone":N});var n=d.offset();l=e.pageX,s=e.pageY,r=n.top-s,c=n.left-l,m=!0,d=function(e){return u=e.attr("style")||"",e}(d)}}function B(e){27===e.keyCode&&function(){h.cancelScrolling(),o.unbind(".moveable-zone"),t.undoManager.undo(),t.selection.select(d[0]),t.selection.collapse(!1),d=null}()}function N(){o.find(".mceSelected").removeClass("mceSelected")}function R(o){if(m){if(function(e){var t=Math.abs(l-e.pageX),n=Math.abs(s-e.pageY);return t<C&&n<C}(o))return;Object(g.b)().BookmarkManager.storeBookmark(),t.undoManager.beforeChange(),t.undoManager.typing=!0,t.undoManager.add(),Object(i.b)("synchrony.stop",{id:x}),function(){var e=t.selection.getSel();e&&e.removeAllRanges&&e.removeAllRanges()}(),d.css({position:"absolute",width:d.css("width"),"max-width":"50%"}),e.current&&e.destroy(),d.detach(),Object(g.b)().Cursor.fixCursorTargets(t.getBody()),a.append(d),b=M(d),m=!1}o.preventDefault(),d.hide(),function(e,t){var o=w.length;if((t=Math.max(t,0))<o)return void h.scrollUp(w[t]);var a=n.height(),r=Math.max(0,a-t);if(r<o)return void h.scrollDown(w[r]);h.cancelScrolling()}(o.clientX,o.clientY),b.positionNear(o.clientX,o.clientY);var u=Math.min(o.pageY+r,h.scrollHeight()-d.outerHeight()),f=o.pageX+c;d.css({top:u,left:f,opacity:.5}),d.show()}function _(e){o.unbind(".moveable-zone"),h.cancelScrolling(),m?d=null:(e.preventDefault(),d.detach(),d.attr("style",u),b.replaceWith(d),b.destroy(),d=null,b=null,N(),t.undoManager.add(),Object(i.b)("synchrony.start",{id:x}))}},Xe=(n("+7yL"),function(){var e,t,n=function(){var e=f()("#wysiwyg").is(":hidden")?f()("#preview"):f()("#wysiwyg");t=e.find("iframe");var n=f()("#header-precursor"),o=f()(p.a).height(),a=n.offset().top+n.height()+f()("#header").height();f()("#content.edit").height(o-a),setTimeout(function(){if(f()("#preview").is(":hidden"))t.height(0).height(e.height());else{f()("#content.edit").height("auto");var n=f()("#savebar-container").height();a+=f()("#editor-precursor").height();t.height(o-a-n-4)}},1)};return{init:function(t){t.on("Init",function(){var o,a;f()(t.getBody()).addClass("fullsize");var r=p.a.tinymce.Env;(r.ie||r.opera)&&(o=t.getWin(),e=f()(o.parent),a=f()(o.parent.document),f()("body").css({overflow:"hidden"}),e.bind("resize.resizeplugin",function(){n()}),a.bind("messageClose",function(){setTimeout(n,0)}),a.bind("resize.resizeplugin",function(e,t){n(t&&t.height)}),a.bind("mode-changed",function(){n()}),t.on("Change",function(){n()}),n())})},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});var Qe=function e(t,n){var o;if(!b.a.get("atlassian-account-id")||!b.a.get("confluence.prefs.editor.disable.autoformat")){R.prototype={registerHandler:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers:function(e,t,n,o){var a=!0;return f.a.each(this.handlers[e]||[],function(e,r){if(r.handles(t))return a=r.execute(t,n,o),!1}),a}};var a,r=n.editor,c=new R,l=[new _(")",e.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile.png"),new _("(",e.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.png"),new _("P",e.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.png"),new _("p",e.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.png"),new _("D",e.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.CROSS,"cross","emotions_dlg.error","error.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on","emotions_dlg.lightbulb_on","lightbulb_on.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.png"),new _(")",e.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.png"),new _("3",e.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.png"),new _("3",e.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.png")],s=[];for(a=0;a<l.length;a++)s[a]=new p.a.Image,s[a].src=l[a].imagePath;if(A(S.a)){f.a.each({"*":"italic",_:"italic","`":"monospace"},function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));c.registerHandler(e.charCodeAt(0),O(n,function(e){D(t,e[2])},!0))});f.a.each({"*":"bold",_:"bold","~":"strikethrough"},function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"\\").concat(e,"(?=[^\\s])([^*]*?[^\\s])\\").concat(e,")$"));c.registerHandler(e.charCodeAt(0),O(n,function(e){D(t,e[2])},!0))}),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#)$/,function(){r.execCommand("formatBlock",!1,"h1",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#\#)$/,function(){r.execCommand("formatBlock",!1,"h2",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#\#\#)$/,function(){r.execCommand("formatBlock",!1,"h3",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#\#\#\#)$/,function(){r.execCommand("formatBlock",!1,"h4",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#\#\#\#\#)$/,function(){r.execCommand("formatBlock",!1,"h5",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#\#\#\#\#\#)$/,function(){r.execCommand("formatBlock",!1,"h6",{skip_undo:!0})},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(1\))$/,function(){r.execCommand("InsertOrderedList")},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(>)$/,function(){r.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})},!0));var d=O(/^\u200b?(\-\-)$/,function(){r.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0),u=O(/^(\*\*)$/,function(){r.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0);c.registerHandler("-".charCodeAt(0),d),c.registerHandler("*".charCodeAt(0),u);var m=O(/^\u200b?(\`\`)$/,function(){P.insertMacro({contentId:b.a.get("content-id")||"0",macro:{name:"code",body:""}})},!0);c.registerHandler("`".charCodeAt(0),m)}else{for(f.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough"},function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));c.registerHandler(e.charCodeAt(0),O(n,function(e){D(t,e[2])},!0))}),r.formatter.register("code",{inline:"code"}),c.registerHandler("}".charCodeAt(0),O(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,function(e){D("code",e[2])},!0)),a=1;a<=6;a++)!function(e){c.registerHandler(" ".charCodeAt(0),O(new RegExp("^\\u200b?(h".concat(e,"\\.)$")),function(){r.execCommand("formatBlock",!1,"h".concat(e),{skip_undo:!0})},!0))}(a);c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(bq\.)$/,function(){r.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})},!0));var h=O(/^\u200b?(\-\-\-\-)$/,function(){r.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0);c.registerHandler(" ".charCodeAt(0),h),c.registerHandler(13,h),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\#)$/,function(){r.execCommand("InsertOrderedList")},!0))}c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\*)$/,function(){r.execCommand("InsertUnorderedList")},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(1\.)$/,function(){r.execCommand("InsertOrderedList")},!0)),c.registerHandler(" ".charCodeAt(0),O(/^\u200b?(\-)$/,function(){var e=r.dom;r.execCommand("InsertUnorderedList");var t=e.getParent(r.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))},!0)),Object(i.b)("confluence.editor.registerHandlers",{handlerManager:c,createHandler:O,ed:r});var v=O(/((\<\-\-?\>)([^\s-]*))$/,function(e){r.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);c.registerHandler(" ".charCodeAt(0),v),c.registerHandler(13,v);var y=O(/((\-\-?\>)([^\s-]*))$/,function(e){r.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);c.registerHandler(" ".charCodeAt(0),y),c.registerHandler(13,y);var C=O(/((\<\-\-?)([^\s-]*))$/,function(e){r.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);c.registerHandler(" ".charCodeAt(0),C),c.registerHandler(13,C),c.registerHandler(" ".charCodeAt(0),O(/[^-]*[\s](\-\-\-?)$/,function(e){var t=2===e[1].length?"":"";r.execCommand("mceInsertContent",!1,t,{skip_undo:!0})},!1));var w=O(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,function(e){var t=2===e[3].length?"":"";r.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})},!1);c.registerHandler(" ".charCodeAt(0),w),c.registerHandler(13,w),c.registerHandler(13,O(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,function(e){var t='<table class="confluenceTable"><tr>',n="",o=!0,a=f()(e[1].slice(2,-2).split("||")).map(function(e){return e=f.a.trim(this),o=o&&""==e,e});o&&(a[0]=r.translate("editor.autoformat.sampletext.firstcell"));for(var i=0,c=a.length;i<c;i++)t+='<th class="confluenceTh">'.concat(a[i],"</th>"),n+='<td class="confluenceTd">'.concat(Object(g.b)().ZERO_WIDTH_WHITESPACE,"</td>");t+="</tr><tr>".concat(n,"</tr></table>"),r.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),r.selection.select(f()(r.selection.getRng(!0).commonAncestorContainer).parents("table").find(o?"th":"td")[0].childNodes[0]),f()(r.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0,B)),c.registerHandler(13,O(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,function(e){var t='<table class="confluenceTable"><tr>',n=!0,o=f()(e[1].slice(1,-1).split("|")).map(function(e){return e=f.a.trim(this),n=n&&""==e,e});n&&(o[0]=r.translate("editor.autoformat.sampletext.firstcell"));for(var a=0,i=o.length;a<i;a++)t+='<td class="confluenceTd">'.concat(o[a],"</td>");t+="</tr></table>",r.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&r.selection.select(f()(r.selection.getRng(!0).commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),f()(r.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0,B));var x=O(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,function(e){var t=e[3]?e[1]:"http://".concat(e[1]),n=r.dom.create("a",{href:t});n.appendChild(document.createTextNode(e[1])),r.execCommand("mceInsertContent",!1,I(n),{skip_undo:!0}),r.getDoc().execCommand("unlink",!1,{})},!1,"a");c.registerHandler(" ".charCodeAt(0),x),c.registerHandler(13,x);var k=O(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,function(e){var t=r.dom.create("a",{href:"mailto:".concat(e[1])});t.appendChild(document.createTextNode(e[1])),r.execCommand("mceInsertContent",!1,I(t),{skip_undo:!0}),r.getDoc().execCommand("unlink",!1,{})},!1,"a");c.registerHandler(" ".charCodeAt(0),k),c.registerHandler(13,k);var T=function(e,t){var n=O(e,function(){r.execCommand("mceInsertContent",!1,t,{skip_undo:!0})},!1);c.registerHandler(" ".charCodeAt(0),n),c.registerHandler(13,n)};T(/(?:\b|^)(jira|JIRA)$/,"Jira"),T(/(?:\b|^)([Ss]tatus[Pp]age)$/,"Statuspage"),T(/(?:\b|^)([Ff]ishEye)$/,"Fisheye"),T(/(?:\b|^)([Ss]ource[Tt]ree)$/,"Sourcetree"),T(/(?:\b|^)([Hh]ip[Cc]hat)$/,"Hipchat"),T(/(?:\b|^)([Bb]it[Bb]ucket)$/,"Bitbucket"),T(/(?:\b|^)(atlassian)$/,"Atlassian");var E={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};f.a.each(E,function(e,t){c.registerHandler(e.charCodeAt(0),O(t,function(t){var n=t[1]+e,o={type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(b.a.get("context-path"),"/rest/tinymce/1/wikixhtmlconverter"),data:f.a.toJSON({wiki:n,entityId:b.a.get("content-id"),spaceKey:b.a.get("space-key"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?p.a.tinymce.confluence.MacroUtils.insertMacro(o):"!"==e?f.a.ajax(o).done(function(e){!n===e?p.a.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):r.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}):f.a.ajax(o).done(function(e){r.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})},!0))}),r.on("KeyPress",function(e){return c.executeHandlers(N(e),r,e,t)}),r.on("KeyDown",function(e){if(13===N(e))return c.executeHandlers(13,r,e,t)},!0);return{getHandlerCount:function(){return Object.keys(c.handlers).length}}}function I(e){return f()("<div>").append(e.cloneNode(!0)).html()}function M(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var o=t.nodeValue.substring(0,n),a=t.previousSibling;a&&3===a.nodeType;a=a.previousSibling)o=a.nodeValue+o;return o}function O(e,t,n,a){return{handles:function(t){var n=t.selection.getRng(!0),o=n.commonAncestorContainer||{};return!!n.collapsed&&(!f()(o).closest("pre,.text-placeholder").length&&((!a||!f()(o).closest(a).length)&&e.test(M(n))))},execute:function(a,r,i){var c,l=1,s=N(r);if(32===s?a.execCommand("mceInsertContent",!1,"&nbsp;"):a.execCommand("mceInsertContent",!1,String.fromCharCode(s)),a.undoManager.transact(function(){var n=a.selection.getRng(!0);"|"==(c=M(n))[c.length-1]&&(c+=" ",l=0);var r=e.exec(c.substring(0,c.length-1)),i=function(e,t,n){var o,a;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var r=t,i=n;r&&3===r.nodeType;r=r.previousSibling){if(-1==i&&(i=r.nodeValue.length),i>e)return{container:r,offset:i-e};if(i==e){for(a=0,o=r.parentNode;r=r.previousSibling;)a++;return{container:o,offset:a}}e-=i,i=-1}return null}}(r[1].length+l,n.commonAncestorContainer,n.startOffset);n.setStart(i.container,i.offset);var s=f()(n.commonAncestorContainer);a.selection.setRng(n),s.closest(".wysiwyg-macro-body").length&&n.toString()==s.text()?(s[0].innerHTML="<br>",a.selection.select(s[0].childNodes[0]),a.selection.collapse(!0)):a.execCommand("delete",!1,{},{skip_undo:!0}),t(r,a.selection.getRng(!0)),o=a.selection.getRng(!0)}),n)return i.preventDefault(),i.stopPropagation(),p.a.tinymce.dom.Event.cancel(r),Object(g.b)().showElement(o.startContainer),!1}}}function N(e){return e.which}function R(){this.handlers={}}function _(e,t,n,o,a){var i=e.charCodeAt(0),l="".concat(Object(g.b)().getResourceUrlPrefix(),"/images/icons/emoticons/").concat(a),s=O(t,function(){var e=r.dom.createHTML("img",{src:l,alt:r.translate("tinymce.".concat(o)),title:r.translate("tinymce.".concat(o)),border:0,class:"emoticon emoticon-".concat(n),"data-emoticon-name":n});r.execCommand("mceInsertContent",!1,e,{skip_undo:!0})},!0);this.imagePath=l,c.registerHandler(i,s)}function D(e,t){var n=r.formatter.get(e)[0],o=r.dom.create(n.inline,{style:n.styles});o.appendChild(document.createTextNode(t)),r.execCommand("mceInsertContent",!1,"".concat(I(o),"\ufeff"),{skip_undo:!0})}},Ye=(Qe.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}},"stickyTableHeaders"),Ze=0,et={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:p.a.document,objHead:"head",objWindow:p.a,scrollableArea:p.a,cacheHeaderHeight:!1};f.a.fn[Ye]=function(e){return this.each(function(){var t=f.a.data(this,"plugin_".concat(Ye));t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&f.a.data(this,"plugin_".concat(Ye),new function(e,t){var n=this;n.$el=f()(e),n.el=e,n.id=Ze++,n.$el.bind("destroyed",f.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each(function(){var e=f()(this);e.css("padding",0),n.$originalHeader=f()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.".concat(Ye),[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=f()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)}),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),f.a.removeData(n.el,"plugin_".concat(Ye)),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.".concat(Ye),n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.".concat(Ye).concat(n.id),n.setPositionValues),n.$window.on("resize.".concat(Ye).concat(n.id),n.toggleHeaders)),n.$scrollableArea.on("resize.".concat(Ye),n.toggleHeaders),n.$scrollableArea.on("resize.".concat(Ye),n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".".concat(Ye),n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".".concat(Ye).concat(n.id),n.setPositionValues),n.$window.off(".".concat(Ye).concat(n.id),n.toggleHeaders)),n.$scrollableArea.off(".".concat(Ye),n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var o=this,a=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(o,a)},t)}},n.toggleHeaders=n.debounce(function(){n.$el&&n.$el.each(function(){var e,t=f()(this),o=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),a=t.offset(),r=n.$scrollableArea.scrollTop()+o,i=n.$scrollableArea.scrollLeft(),c=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),l=n.isWindowScrolling?r>a.top:o>a.top,s=(n.isWindowScrolling?r:0)<a.top+t.height()-c-(n.isWindowScrolling?0:o);l&&s?(e=a.left-i+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=o,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.".concat(Ye))),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(f()("td,th",n.$clonedHeader),f()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.".concat(Ye)))})},0),n.setPositionValues=n.debounce(function(){var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})},0),n.updateWidth=n.debounce(function(){if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=f()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=f()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}},0),n.getWidth=function(e){var t=[];return e.each(function(e){var o,a=f()(this);if("border-box"===a.css("box-sizing")){var r=a[0].getBoundingClientRect();o=r.width?r.width:r.right-r.left}else if("collapse"===f()("th",n.$originalHeader).css("border-collapse"))if(p.a.getComputedStyle)o=parseFloat(p.a.getComputedStyle(this,null).width);else{var i=parseFloat(a.css("padding-left")),c=parseFloat(a.css("padding-right")),l=parseFloat(a.css("border-width"));o=a.outerWidth()-i-c-l}else o=a.width();t[e]=o}),t},n.setWidth=function(e,t,n){t.each(function(t){var o=e[t];n.eq(t).css({"min-width":o,"max-width":o})})},n.resetWidth=function(e,t){e.each(function(e){var n=f()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})})},n.setOptions=function(e){n.options=f.a.extend({},et,e),n.$window=f()(n.options.objWindow),n.$head=f()(n.options.objHead),n.$document=f()(n.options.objDocument),n.$scrollableArea=f()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}(this,e))})};var tt=function(e){return!e.parents("table").length>0},nt=function(e){return!e.closest(".columnLayout").length>0},ot=function(){return!f()("body").hasClass("theme-documentation")},at=function(e){var t=f()(e);return ot()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&nt(t)&&tt(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},rt=function(e,t){var n=t||f()(window);e.closest(".table-wrap").scroll(function(){n.trigger("scroll.stickyTableHeaders")})},it=function(e){f()(e).each(function(){var e=f()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),o=n.length&&n.closest("thead").length>0,a=n.length&&0===n.parent().index();if(tt(e)&&nt(e)&&!o&&a&&!t){var r=f()("<thead />").append(n.parent());e.prepend(r)}})},ct=ot,lt=function(e,t){var n=e.filter(function(){return at(this)});n.stickyTableHeaders(t).addClass("stickyTableHeaders"),Object(i.a)("sticky-table-headers.change.options",function(e,t){n.stickyTableHeaders(t)}),rt(n)},st={initialize:function(){var e=f()(".confluenceTable"),t=f()(window);if(ct()){if(it(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var o=/sticky|tableFloating|confluenceTh/;new MutationObserver(f.a.debounce(function(e){for(var n,a=!1,r=0,i=e.length;r<i;r++)if(n=e[r].target.className,!o.test(n)){a=!0;break}a&&t.trigger("resize.stickyTableHeaders")},0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}lt(e,{cacheHeaderHeight:!0})}},setupTable:lt},dt=function(e,t){var n=p.a.tinymce.activeEditor;if(n){var o=function(e){var t={};return t.objWindow=f()(e.getWin()),t.scrollableArea=t.objWindow,t.objDocument=f()(e.getDoc()),t.objHead=t.objDocument.find("head"),t}(n),a=f.a.extend({},o,t),r=e.filter(function(){return at(this)});r.stickyTableHeaders(a).addClass("stickyTableHeaders"),rt(r,a.objWindow)}},ut={initialize:function(){var e=p.a.tinymce.activeEditor;if(e){var t=f()(e.getBody()).find(".confluenceTable");it(t),dt(t)}},setupTable:dt};var ft={init:function(e){var t=p.a.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",function(){Object(i.a)("beforeunload",n)}),e.on("Remove",function(){Object(i.c)("beforeunload",n)})},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}};var mt={init:function(e){var t=p.a.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",function(){Object(i.a)("beforeunload",n)}),e.on("Remove",function(){Object(i.c)("beforeunload",n)})},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}};var pt=function(){return{init:function(e){var t,n=p.a.Confluence.Editor.Drafts,o=p.a.Confluence.Editor;function a(){var e=p.a.location.search;return void 0===e?"":("?"===e.charAt(0)&&(e=e.substr(1)),e.split("&").filter(function(e){return 0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accountId=")||0===e.indexOf("displayName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("atlOrigin=")||0===e.indexOf("src.")}).join("&"))}function r(){!function(e,t){0!==e&&p.a.history&&p.a.history.replaceState&&(f()("#confluence-ui").length?p.a.history.replaceState(null,"","".concat(p.a.location.pathname,"?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(a())):p.a.history.replaceState(null,"","".concat(C.a,"/pages/resumedraft.action?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(a())))}(b.a.get("draft-id"),b.a.get("draft-share-id")),o.UI.cancelButton.attr("data-tooltip",e.translate("editor.shared.draft.done.desc")),o.UI.cancelButton.on("click",function(){Object(i.b)("analytics",{name:"confluence.editor.done.button.clicked"}),Object(i.b)("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:b.a.get("content-id"),currentVersion:b.a.get("page-version")||"null"}})})}function c(){if(!b.a.get("has-collaborated")&&p.a.AJS.Rte.Content.editorHasContentChanged()){b.a.set("has-collaborated",!0);var e=b.a.get("content-id");f.a.ajax({type:"PUT",url:"".concat(C.a,"/rest/experimental/relation/collaborator/from/user/current/to/content/").concat(e,"?targetStatus=draft"),error:function(){b.a.set("has-collaborated",!1)}}),f.a.ajax({type:"DELETE",url:"".concat(C.a,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(e,"?targetStatus=current")}),f.a.ajax({type:"PUT",url:"".concat(C.a,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(e,"?targetStatus=draft"),error:function(){b.a.set("has-collaborated",!1)}})}}var l=function(e){return f()("#draft-status").show(),n.bindUnloadMessage(),o.UI.cancelButton.click(function(){n.save({skipErrorHandler:!0})}),r(),setInterval(n.save,+b.a.get("draft-save-interval")||3e4)};e.on("Init",function(){A("collaborative-audit-log")&&Object(i.a)("editor.local.change",c)}),e.on("Remove",function(){A("collaborative-audit-log")&&Object(i.c)("editor.local.change",c)}),Object(i.a)("rte-ready",function(){t=l()}),Object(i.a)("rte-destroyed",function(){clearInterval(t)})},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}};var gt={init:function(e){e.on("Init",function(){e.addCommand("mceConfMacroBrowser",p.a.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)})},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},ht={init:function(e){e.on("init",function(){if(b.a.get("use-watch")){var t={userWatchingOwnContent:b.a.get("user-watching-own-content")};f()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" '.concat(t?'checked="checked"':"",'/>\n            <label for="watchPage">').concat(e("comment.notification.enable"),"</label>\n        </li>\n    </ul>\n")}(function(t){return e.translate(t)},t.userWatchingOwnContent))}})},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},bt={init:function(e){var t=function(e){f()(".tablesorter",e.node).each(function(e,t){var n,o,a=f()(t).find("thead");1===a.length&&"THEAD"===(a=a[0]).nodeName&&1===a.childNodes.length&&(o=a.removeChild(a.childNodes[0]),n=f()(t).find("tbody")[0],t.removeChild(a),n.insertBefore(o,n.childNodes[0]))})};e.on("PastePostProcess",t),e.on("remove",function(){e.off("PastePostProcess",t)})},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}},vt={init:function(e){e.on("Init",function(){e.getBody().classList.add("resizable")});var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height",e.getElement().offsetHeight)),o=parseInt(e.getParam("autoresize_max_height",0));e.on("Change SetContent Paste KeyUp Init",a),e.addCommand("mceAutoResize",a)}function a(r){var i=e.getDoc(),c=i.body,l=i.documentElement,s=p.a.tinymce.DOM,d=n,u=r===Object(r)&&r.forceExec||!1,m=f()(i).height();if(m>n&&(d=m),o&&m>o?(d=o,c.style.overflowY="auto",l.style.overflowY="auto"):(c.style.overflowY="hidden",l.style.overflowY="hidden",c.scrollTop=0),u||d!==t){var g=d-t;s.setStyle(s.get("".concat(e.id,"_ifr")),"height","".concat(d,"px")),t=d,p.a.tinymce.Env.webkit&&g<0&&a()}}},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},yt=function(){function e(e){return e.nodeValue.toLowerCase()}return{search:function(t,n,o,a,r){var i=t.getSel(),c=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var o=t.childNodes,a=0,r=o.length;a<r;++a)n.push.apply(n,e(o[a]));return n}(a);n=n.replace(/\s/g,"").toLowerCase();var l=c.map(e).join(""),s=function(e,t,n,o){var a=o?e.lastIndexOf(t,n-1):e.indexOf(t,n+1);return a<0&&!o?a=e.indexOf(t):0===a&&0===n&&o&&(a=e.lastIndexOf(t)),a}(l,n,o=function(e,t,n){var o=e.getRng();if(o.endContainer.nodeValue){var a=n.indexOf(o.endContainer.nodeValue.toLowerCase())+o.endOffset;t=t!==a&&-1!==t?a:t}return t}(t,o,l),r);if(s<0)return[!1,s];var d=function(e,t,n){for(var o,a,r,i,c=0,l=0;l<t.length;l++){if(t[l].nodeType===Node.TEXT_NODE){var s=e+n.length;!a&&t[l].length+c>=s&&(a=t[l],i=s-c),!o&&t[l].length+c>e&&(o=t[l],r=e-c),c+=t[l].length}if(o&&a)return{startNode:o,startIndex:r,endNode:a,endIndex:i}}}(s,c,n),u=document.createRange();return u.setStart(d.startNode,d.startIndex),u.setEnd(d.endNode,d.endIndex),i.removeAllRanges(),i.addRange(u),u.startContainer.parentNode.scrollIntoView(),[!0,s]}}},Ct=n("m+2k"),wt=function(){var e=yt(),t=new Ct.a(p.a.navigator.userAgent),n='<mark data-searching class="find-current">',o=function e(t){var n=t,o=null,a=null,r=null,i=null,c=null,l={initialised:!1,find:function(e,t,n){var a=o.getFindInput().val(),i=r.findText(a,!0,e);i&&t?t():!i&&n&&n()},replace:function(e,t){var n=o.getFindInput(),a=o.getReplaceInput(),i="";a&&(i=a.val());var c=r.replaceText(n.val(),i,!0);c&&e?e():!c&&t&&t()},replaceAll:function(e,t){var n=o.getFindInput(),a=o.getReplaceInput(),i="";a&&(i=a.val());var c=r.replaceAll(n.val(),i);c&&e?e():!c&&t&&t()},focus:function(){o.focusFindTextBox()},isVisible:function(){return null!=o},init:function(){o=e.UI(n,i,c),(a=new e.MarkManager).addListener(o),r=null,r=p.a.tinymce.Env.ie?new e.implIE(o):new e.impl(o,a),o.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=o.getFindInput(),n=t.val();t.val(n+e)}o.onVisible()},onHide:function(){i=o.getFindInput().val(),c=o.getReplaceInput().val(),r.destroy(),r=null,o.destroy(),o=null,a.destroy(),a=null},_clearSavedValues:function(){i=null,c=null}};return l};return o.utils={moveCursorToEnd:function(e){if(p.a.tinymce.Env.ie){var t=e.createTextRange();t.execCommand("SelectAll"),t.move("textedit"),t.select()}else if(p.a.tinymce.Env.gecko){var n=f()(e).val().length;e.setSelectionRange(n,n)}},createTextRange:function(e,t){return e.selection?e.selection.createRange():t.getBody().createTextRange()}},o.impl=function(n,o){var a=new p.a.tinymce.html.Writer,r=o,i=-1,c=function n(o,a,c){if(!o)return!1;var l=p.a.tinymce.activeEditor,s=l.selection,d=l.getWin();function u(){return l.undoManager.ignore(function(){r.markCurrentlySelectedRange()}),!0}function f(){return l.undoManager.ignore(function(){r.removeCurrentMark(!0),p.a.tinymce.activeEditor.selection.isCollapsed()||p.a.tinymce.activeEditor.selection.collapse()}),!1}if(r.isCursorAtCurrentMark()&&l.undoManager.ignore(function(){s=r.selectCurrentMark()}),s.isCollapsed()||s.collapse(c),p.a.tinymce.Env.gecko)return d.find(o,!1,c)?u():a?(s.select(l.getBody(),!1),s.collapse(!c),n(o,!1,c)):f();if(!t.isMSEdge())return d.find(o,!1,c,!0,!1,!1,!1)?u():f();var m=e.search(s,o,i,l.getBody(),c);return i=m[1],m[0]?u():void 0},l=function(e){var t=p.a.tinymce.activeEditor;a.text(e),t.selection.setContent(a.getContent(),{format:"raw"}),a.reset(),t.selection.collapse(!0)},s={};return s.findText=c,s.replaceText=function(e,t,n){var o=p.a.tinymce.activeEditor;return r.hasCurrentMark()?(o.undoManager.transact(function(){var e=r.replaceCurrentMark(t);e&&o.selection.select(e)}),c(e,n)):c(e,n)},s.replaceAll=function(n,o){var a=p.a.tinymce.activeEditor,i=0;return a.undoManager.transact(function(){var c=a.selection,s=a.getWin();if(r.removeCurrentMark(!1),a.execCommand("selectAll"),a.selection.collapse(!0),t.isMSEdge())for(var d=-1;;){var u=e.search(c,n,d,a.getBody(),!1);if(!u[0])break;d=u[1],l(o),i++}else for(;s.find(n,!1,!1,!1,!1,!1,!1);)l(o),i++;if(0===i)p.a.Confluence.EditorNotification.notify("info",a.translate("tinymce.searchreplace_dlg.notfound"));else if(1===i)p.a.Confluence.EditorNotification.notify("success",a.translate("tinymce.searchreplace_dlg.allreplaced.singular"));else if(i>1){var f=a.translate("tinymce.searchreplace_dlg.allreplaced.plural");p.a.Confluence.EditorNotification.notify("success",f.replace("{0}",i))}}),i},s.destroy=function(){r=null,a=null},s},o.implIE=function(e){var t={},a=e,r=null,i=new p.a.tinymce.html.Writer,c=o.utils.createTextRange,l=function e(n,o,a){if(!n)return!1;var i=p.a.tinymce.activeEditor,c=i.getDoc(),l=t.storedRange=t.storedRange||c.body.createTextRange();if(i.focus(),r&&r.select(),i.selection.collapse(!a),u(),a&&r){var s=c.body.createTextRange();s.moveToElementText(f()("p:first",i.getBody())[0]),l.setEndPoint("StartToStart",s);var m=r.text;m.length&&(m=m.replace(/s+$/,"")).length&&l.moveEnd("character",-m.length);var g=l.text.length;l.moveEnd("word",-1),l.text.length>=g&&l.moveEnd("character",-1),l.select(),l.collapse(!1)}return r=null,l.findText(n,a?-1:1,0)?(l.scrollIntoView(),(l=d(l)).select(),r=l,!0):o?(i.selection.select(p.a.tinymce.activeEditor.getBody(),!0),i.selection.collapse(!a),e(n,!1,a)):void(t.storedRange=null)},s=function(){u()},d=function(e){var t=e.htmlText;return e.pasteHTML(n+t+"</mark>"),a.marked(),function(){var e=p.a.tinymce.activeEditor;e.on("Change",s),e.on("BeforeSetContent",s)}(),e},u=function(){!function(){var e=p.a.tinymce.activeEditor;e.off("Change",s),e.off("BeforeSetContent",s)}();var e=p.a.tinymce.activeEditor,t=f()("mark",e.getDoc());if(t.length){var n=!1,o=e.selection.getRng(!0).commonAncestorContainer;f()(o).closest("mark").length&&(n=!0),t.each(function(e,t){var n=f()(t);n.contents().each(function(e,t){n.before(t)})}).remove(),n&&e.execCommand("RemoveFormat")}a.markRemoved()},m=function(){u()};return t.findText=l,t.replaceText=function(e,t,n){var o=p.a.tinymce.activeEditor;if(r){var a=o.getDoc().createTextNode(t),i=f()("mark",o.getDoc());o.undoManager.transact(function(){i.parent()[0].replaceChild(a,i[0]);var e=o.getDoc().createElement("mark");e.setAttribute("class","current"),e.dataset.searching=!0,a.parentNode.insertBefore(e,a),e.appendChild(o.getDoc().createTextNode(t)),e.parentNode.removeChild(a)})}return l(e,n)},t.replaceAll=function(e,t){var n=p.a.tinymce.activeEditor,o=0;return n.undoManager.transact(function(){var a=n.selection,r=n.getDoc();u(),a.select(n.getBody(),!1),a.collapse(!0),n.focus();for(var l=c(r,n);l.findText(e,1,0);)l.scrollIntoView(),l.select(),i.text(t),n.selection.setContent(i.getContent(),{format:"raw"}),i.reset(),o++,l.moveStart("character",t.length);if(0==o)p.a.Confluence.EditorNotification.notify("info",n.translate("tinymce.searchreplace_dlg.notfound"));else if(1==o)p.a.Confluence.EditorNotification.notify("success",n.translate("tinymce.searchreplace_dlg.allreplaced.singular"));else if(o>1){var s=n.translate("tinymce.searchreplace_dlg.allreplaced.plural");p.a.Confluence.EditorNotification.notify("success",s.replace("{0}",o))}}),o},t.destroy=function(){p.a.tinymce.activeEditor.onBeforeGetContent.remove(m),u(),a=null,r=null,i=null},function(){p.a.tinymce.activeEditor.onBeforeGetContent.add(m)}(),t},o.UI=function(e,t,n){var a=null,r=o.utils.moveCursorToEnd;p.a.tinymce.activeEditor&&p.a.tinymce.activeEditor.plugins&&p.a.tinymce.activeEditor.plugins.customtoolbar&&(a=p.a.tinymce.activeEditor.plugins.customtoolbar.getToolbarRow(e));var i=function(){var e=f()(".toolbar-find-input",a);return e.length?e:null},c=function(){var e=f()(".toolbar-replace-input",a);return e.length?e:null},l=function(e){if("input"===e.type||"propertychange"===e.type){var t=i(),n=null!=t&&t.val().length>0;d(n),u(n)}},s=function(){var e=i();h(e&&e.val())},d=function(e){e?(p.a.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),p.a.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(p.a.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),p.a.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},u=function(e){var t=i();m().toggleClass("default-action",e&&t.val().length>0)},m=function(){var e=f()(".search-toolbar-find-next-button",a).closest(".aui-button");return e.length?e:null},g=function(e){var t=p.a.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},h=function(e){var t=p.a.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},b={};return b.getFindInput=i,b.getReplaceInput=c,b.focusFindTextBox=function(){top.focus(),i().focus()},b.onVisible=function(){var e=i();e.focus(),e.val().length>0&&(r(e[0]),d(!0),h(!0))},b.destroy=function(){},b.marked=function(){g(!0)},b.markRemoved=function(){g(!1)},function(e,t){var n=i(),o=!1;e&&e.length&&(n.val(e),o=!0),t&&t.length&&c().val(t);!function(){function e(e,t){if(e)if(p.a.tinymce.isIE9)e[0].attachEvent("onpropertychange",t);else{var n=p.a.tinymce.isIE8?"propertychange":"input";e.bind(n,t)}}var t=i();e(t,l),e(t,s),f()(a).focusin(function(){u(!0)}).focusout(function(){u(!1)}),t.focus(function(){u(!0)})}(),d(o),h(o),g(!1)}(t,n),b},o.MarkManager=function(){var e=null,t=new p.a.tinymce.html.Writer,o=null,a=[],r=function(){l()},i=function(){if(!e)return null;var t=p.a.tinymce.activeEditor;return t.selection.select(e[0]),t.selection},c=function(t){h(),(s(e,t)||o&&p.a.tinymce.activeEditor.selection.getRng(!0).toString()==o)&&(e=null,o=null,f.a.each(a,function(e,t){t.markRemoved()}))},l=function(){h(),f()("mark",p.a.tinymce.activeEditor.getDoc()).each(function(e,t){s(f()(t),!1)}),e=null,o=null,f.a.each(a,function(e,t){t.markRemoved()})},s=function(e,t){var n=p.a.tinymce.activeEditor.selection.getRng(!0);if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=p.a.tinymce.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),a=null,r=null;if(e.contents().each(function(t,n){e.before(n),a||(a=n),r=n}),o||t){var i=p.a.tinymce.activeEditor.selection.getRng(!0);i.setStartBefore(a),i.setEndAfter(r),t||i.collapse(!1),p.a.tinymce.activeEditor.selection.setRng(i)}return e.remove(),!0},d=function(){return!!e||(o?p.a.tinymce.activeEditor.selection.getRng(!0).toString()==o:void 0)},u=function(){l()},m=function(){h(),f.a.each(a,function(e,t){t.markRemoved()})},g=function(e){var t=p.a.tinymce.activeEditor;t.on("Change",r),t.on("BeforeSetContent",r),e&&(t.on("Click",m),t.on("DblClick",m))},h=function(){var e=p.a.tinymce.activeEditor;e.off("Change",r),e.off("BeforeSetContent",r),e.off("Click",m),e.off("DblClick",m)},b={markCurrentlySelectedRange:function(){var t=p.a.tinymce.activeEditor;if(e){var r=t.selection.getBookmark();c(!1),t.selection.moveToBookmark(r)}o=null;var l=t.selection.getRng(!0);e=f()(n+"</mark>",t.getDoc());try{l.surroundContents(e[0]),g(!1)}catch(t){1==t.code&&(o=l.toString(),e=null,g(!0))}f.a.each(a,function(e,t){t.marked()}),o||i().collapse()}};return b.removeCurrentMark=c,b.removeAllMarks=l,b.selectCurrentMark=i,b.isCursorAtCurrentMark=function(){if(!e)return!1;var t=p.a.tinymce.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng(!0);if(3===n.startContainer.nodeType)return n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,a=n.startOffset;return a>0&&o[a-1]===e[0]||!!(a+1<o.length&&o[a+1===e[0]])}},b.hasCurrentMark=d,b.replaceCurrentMark=function(n){if(function(n){if(e||!d())return!1;var o=p.a.tinymce.activeEditor;return o.undoManager.transact(function(){t.text(n),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()}),o.undoManager.ignore(function(){c(!1)}),!0}(n))return null;if(!e)return null;var o=p.a.tinymce.activeEditor,a=[];o.undoManager.ignore(function(){e.contents().each(function(e,t){a.push(t)}),c(!1)});var r=void 0;return o.undoManager.transact(function(){r=f()(a[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=a.length-1;e>=0;e--)f()(a[e]).remove()}),r},b.addListener=function(e){a.push(e)},b.destroy=function(){c(!0),p.a.tinymce.activeEditor.onBeforeGetContent.remove(u)},function(){p.a.tinymce.activeEditor.onBeforeGetContent.add(u)}(),b},o},xt=n("Q2fH"),kt=function(){Object(xt.a)(document,"initContextToolbars.Toolbar",function(e,t){p.a.Confluence.Editor.searchToolbar=function(){var e=p.a.Confluence.Editor;return{initContextToolbars:function(t,n){var o=function(e){if(p.a.tinymce.Env.ie){var t=e.createTextRange();t.execCommand("SelectAll"),t.move("textedit"),t.select()}else if(p.a.tinymce.Env.gecko){var n=f()(e).val().length;e.setSelectionRange(n,n)}},a=function(e){top.focus(),p.a.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},r=function(){top.focus();var e=f()("#search-toolbar-find-text");e.focus(),o(e[0])},i=function(){top.focus();var e=f()("#search-toolbar-replace-text");e.focus(),o(e[0])},c=function(){if(p.a.tinymce.Env.ie&&frames.wysiwygTextarea_ifr.focus(),p.a.tinymce.Env.ie||p.a.tinymce.Env.gecko){var e=p.a.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},l=new e.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:n.translate("tinymce.searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if(!p.a.tinymce.isIE8&&(e.ctrlKey||p.a.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:r,onNotFound:r};p.a.tinymce.activeEditor.undoManager.ignore(function(){p.a.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})})}else 27===e.which&&(e.preventDefault(),p.a.tinymce.activeEditor.undoManager.ignore(function(){p.a.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))},cssClass:"toolbar-find-input"}),s=new e.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:n.translate("tinymce.searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if(!p.a.tinymce.isIE8&&(e.ctrlKey||p.a.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=p.a.tinymce.activeEditor.undoManager.ignore(function(){p.a.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:i,onNotFound:r},{skip_undo:!0})});g(i,r,t)}else 27===e.which&&(e.preventDefault(),p.a.tinymce.activeEditor.undoManager.ignore(function(){p.a.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))},cssClass:"toolbar-replace-input"}),d=new e.Toolbar.Components.TextButton({text:n.translate("tinymce.searchreplace_dlg.findprevious"),click:function(){var e={backwards:!0,onFound:function(){top.focus(),a("search-toolbar-find-previous-button")},onNotFound:r};n.undoManager.ignore(function(){n.execCommand("mceConfSearch",!1,e,{skip_undo:!0})})},textClass:"search-toolbar-find-previous-button"}),u=new e.Toolbar.Components.TextButton({text:p.a.tinymce.Env.ie?n.translate("tinymce.searchreplace_dlg.findlabel"):n.translate("tinymce.searchreplace_dlg.findnext"),click:function(){var e={backwards:!1,onFound:function(){top.focus(),a("search-toolbar-find-next-button")},onNotFound:r};n.undoManager.ignore(function(){n.execCommand("mceConfSearch",!1,e,{skip_undo:!0})})},textClass:"search-toolbar-find-next-button"}),m=new e.Toolbar.Components.TextButton({text:n.translate("tinymce.searchreplace_dlg.replace"),click:function(){g(function(){top.focus(),a("search-toolbar-replace-button")},r)},textClass:"search-toolbar-replace-button"}),g=function(e,t,n){p.a.Confluence.Editor.searchManager&&(p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?p.a.Confluence.Editor.searchManager.replace(e,t):n&&n())},h=new e.Toolbar.Components.TextButton({text:n.translate("tinymce.searchreplace_dlg.replaceall"),click:function(){var e={onReplaced:c,onNotReplaced:r};n.undoManager.transact(function(){n.execCommand("mceConfReplaceAll",!1,e)})},textClass:"search-toolbar-replaceall-button"}),b=new e.Toolbar.Components.Button({text:n.translate("tinymce.searchreplace_dlg.close"),iconClass:"icon-close",click:function(){n.undoManager.ignore(function(){n.execCommand("mceConfSearchClose",!1,null)})}});return{Buttons:[new e.Toolbar.Components.Group([b],{groupClass:"close"}),new e.Toolbar.Components.Group([l,s],{groupClass:"no-separator"}),new e.Toolbar.Components.Group(p.a.tinymce.Env.ie?[u]:[d,u]),new e.Toolbar.Components.Group([m,h])]}}}}().initContextToolbars(e,t)})};function Tt(){var e=p.a.Confluence.Editor,t=null,n=function(e){e.preventDefault(),e.stopPropagation()},o=function(e){n(e);var o=e.which;o||(o=e.charCode?e.charCode:e.keyCode),o<48||t.push(o)},a=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)},r=function(){var e=p.a.tinymce.activeEditor;e.off("KeyDown",o),e.off("KeyPress",n),e.off("KeyUp",n);for(var r="",i=0;i<t.length;i++)r+=a(t[i]);return r.toLowerCase()},c=function(){!function(){var e=p.a.tinymce.activeEditor;t=[],e.on("KeyDown",o),e.on("KeyPress",n),e.on("KeyUp",n)}();var a=f()("body"),i=!a.hasClass("no-tools")||a.hasClass("no-tools-toolbars-visible");Object(xt.b)(document,"createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:i,onVisible:function(){var t=r();e.searchManager.onVisible(t),e.searchManager.initialised=!0}}),r()};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",function(){t.undoManager.ignore(function(){!function(){var t=f()("#rte-button-searchreplace");t.hasClass("active")?(t.removeClass("active"),e.searchManager.onHide(),Object(xt.b)(document,"disableContextToolbarRow.Toolbar",{id:"searchreplace"}),p.a.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),p.a.tinymce.activeEditor.focus()):(t.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),e.searchManager.init(),Object(xt.b)(document,"enableContextToolbarRow.Toolbar",{id:"searchreplace"}))}()})}),t.addCommand("mceConfSearch",function(t,n){e.searchManager&&((!(n=n||{}).backwards||p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button"))&&(n.backwards||p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button"))?e.searchManager.find(n.backwards,n.onFound,n.onNotFound):e.searchManager.focus())}),t.addCommand("mceConfReplaceAll",function(t,n){e.searchManager&&(n=n||{},p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&e.searchManager.replaceAll(n.onReplaced,n.onNotReplaced))}),t.addCommand("mceConfSearchClose",function(){e.searchManager&&t.undoManager.ignore(function(){t.execCommand("mceSearchReplaceToolbar",!1,null)})}),t.addButton("searchreplace",{title:"searchreplace.search_desc",cmd:"mceSearchReplaceToolbar"}),8!=p.a.tinymce.Env.ie&&t.addShortcut("ctrl+f","searchreplace.search_desc",function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore(function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})}),Object(i.a)("rte-ready",function(){c(),Object(xt.b)(document,"disableContextToolbarRow.Toolbar",{id:"searchreplace"})})},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}function Et(){var e=p.a.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},a=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},r=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)},i=function(e){var t=f()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},c=function(){if(!n){n=!0;var c=f()("#rte-button-searchreplace"),l=!c.hasClass("active"),s=f()("body"),d=!s.hasClass("no-tools")||s.hasClass("no-tools-toolbars-visible");l?(c.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),f()(document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:d,onVisible:function(){var c=function(){var e=p.a.tinymce.activeEditor;e.off("KeyDown",a),e.off("KeyPress",o),e.off("KeyUp",o);for(var n="",i=0;i<t.length;i++)n+=r(t[i]);return n.toLowerCase()}();e.searchManager.onVisible(c),i(!0),n=!1,e.searchManager.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),function(){var e=p.a.tinymce.activeEditor;t=[],e.on("KeyDown",a),e.on("KeyPress",o),e.on("KeyUp",o)}(),e.searchManager.init(),i(!1)):(c.removeClass("active"),e.searchManager.onHide(),f()(document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:d,onHide:function(){f()(document).trigger("contextToolbarRowRemoved.Toolbar"),i(!0),n=!1,e.searchManager.initialised=!1}}),i(!1),p.a.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),p.a.tinymce.activeEditor.focus())}};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",function(){t.undoManager.ignore(function(){c()})}),t.addCommand("mceConfSearch",function(t,n){e.searchManager&&((!(n=n||{}).backwards||p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button"))&&(n.backwards||p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button"))?e.searchManager.find(n.backwards,n.onFound,n.onNotFound):e.searchManager.focus())}),t.addCommand("mceConfReplaceAll",function(t,n){e.searchManager&&(n=n||{},p.a.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&e.searchManager.replaceAll(n.onReplaced,n.onNotReplaced))}),t.addCommand("mceConfSearchClose",function(){e.searchManager&&t.undoManager.ignore(function(){t.execCommand("mceSearchReplaceToolbar",!1,null)})}),t.addButton("searchreplace",{title:"searchreplace.search_desc",cmd:"mceSearchReplaceToolbar"}),8!=p.a.tinymce.Env.ie&&t.addShortcut("ctrl+f","searchreplace.search_desc",function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore(function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})})},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}var At=n("T0aG"),St="object"===("undefined"==typeof window?"undefined":n.n(At)()(window))?window.localStorage:{},It=function(e,t){var n=b.a.get("atlassian-account-id")||"anonymous",o="localStorage/".concat(e,".").concat(n,".").concat(t),a=!1,r=/\d+#/,i=function(e){if(!a)return null;var t,n=St.getItem("".concat(o,".").concat(e));return(t=r.exec(n))&&(n=n.replace(t[0],""),+new Date>t[0].replace("#",""))?(St.removeItem("".concat(o,".").concat(e)),null):(n&&n.indexOf('"')>-1&&(n=JSON.parse(n)),n)};try{a=Object.keys(St).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:i,getAllItems:function(){if(!a)return null;var e={};for(var t in St)if(St.hasOwnProperty(t)&&t.startsWith("".concat(o,"."))){var n=t.split("".concat(o,"."))[1];e[n]=i(n)}return e},doesContain:function(e){return!!i(e)},getItemAsBoolean:function(e){var t=i(e);return"false"!==t&&("true"===t||!!t)},setItem:function(e,t,n){a&&(t=function(e){var t=1e3*(e||0);return t?+new Date+t+"#":""}(n)+t,St.setItem("".concat(o,".").concat(e),t))},setItemQuietly:function(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log("Unable to write to localStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}},removeItem:function(e){a&&St.removeItem("".concat(o,".").concat(e))}}}("confluence","userSettings");function Mt(e,t){return t?"".concat(e,".").concat(t.replace(/\./g,"-")):e}var Ot,Bt={get:function(e,t,n){var o=Mt(e,t),a=It.getItem(o);return null!==a?JSON.parse(a):void 0!==n?n:null},set:function(e,t,n,o){var a=Mt(e,t);o===n?It.removeItem(a):It.setItem(a,JSON.stringify(o),2592e3)}},Nt={init:function(e){e.on("init",function(){var t={contentId:b.a.get("content-id")},n=f()("#rte-savebar-tinymce-plugin-point");n.append(function(e){return'\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>'.concat(e("editor.minor.edit"),"</span>\n        </label>\n    </span>\n")}(function(t){return e.translate(t)}));var o=n[0].querySelector('input[id="notifyWatchers"]'),a=Bt.get("notifyWatchers",t.contentId,!0);null!==a&&(o.checked=a),Object(xt.a)(o,"change",function(){Bt.set("notifyWatchers",t.contentId,!0,o.checked)})})},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}};function Rt(){Object(i.b)("analytics",{name:"confluence.table.image.insert",data:{pageId:b.a.get("page-id"),tableMode:Pt()}})}function _t(){return!!f()(Ot.selection.getNode()).closest("table.confluenceTable").length}function Pt(){var e=f()(Ot.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function Dt(){var e=f()(Ot.getBody()).find("table.confluenceTable");Object(i.b)("analytics",{name:"confluence.table.quality.in.page",data:{pageId:b.a.get("page-id"),total:e.length,fixed:e.filter(".fixed-table").length,fluid:e.filter(":not(.fixed-table,.relative-table)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var Ht={init:function(e){function t(e,t){_t()&&function(e){e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&Object(i.b)("analytics",{name:"confluence.table.img.resize",data:{pageId:b.a.get("page-id"),tableMode:Pt(),isImgBiggerCell:function(){var e=f()(Ot.selection.getNode()),t=e.closest("th, td");return e.width()>t.width()}()}})}(t)}Ot=e,e.on("ExecCommand",function(e){switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":!function(){Object(i.b)("analytics",{name:"confluence.table.mode.to.".concat(Pt()),data:{pageId:b.a.get("page-id")}})}();break;case"mceTableCopyRow":!function(){Object(i.b)("analytics",{name:"confluence.table.row.copy",data:{pageId:b.a.get("page-id")}})}();break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":!function(){Object(i.b)("analytics",{name:"confluence.table.row.paste",data:{pageId:b.a.get("page-id")}})}();break;case"mceTableCopyCol":!function(){Object(i.b)("analytics",{name:"confluence.table.col.copy",data:{pageId:b.a.get("page-id")}})}();break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":!function(){Object(i.b)("analytics",{name:"confluence.table.col.paste",data:{pageId:b.a.get("page-id")}})}();break;case"mceInsertContent":!function(e){var t=f()("<div/>").html(e);t.find("img").length&&_t()&&Rt(),t.find("table.confluenceTable").length&&Object(i.b)("analytics",{name:"confluence.table.paste",data:{pageId:b.a.get("page-id")}})}(e.value)}}),e.on("Init",function(){e.selection.onSetContent.add(function(e,t){_t()&&t&&function(e){f()("<div/>").html(e.content).find(".confluence-embedded-image").length&&Rt()}(t)})}),Object(i.a)("analyticsEvent",t),Object(i.a)("rte.safe-save.success",Dt),e.on("Remove",function(){Object(i.c)("analyticsEvent",t),Object(i.c)("rte.safe-save.success",Dt)})},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}};function jt(e,t,n){n&&n.node&&f()(".inline-comment-marker",n.node).contents().unwrap()}var Lt={init:function(e){e.on("beforeExecCommand",function(e){if("Indent"===e.command||"Outdent"===e.command){var t=e.target,n=t.selection.getNode(),o=n.nodeName.toLowerCase();if("li"!==o&&"body"!==o){var a=parseInt(t.dom.getStyle(n,"margin-left")||0,10)+parseInt(t.dom.getStyle(n,"padding-left")||0,10);if(0!==a){var r=t.settings.indentation,i=/[a-z%]+/i.exec(r);t.dom.setStyle(n,"padding-left",""),t.dom.setStyle(n,"margin-left",a+i)}}}})},getInfo:function(){return{longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},Ft=function(e){var t=e.selection.getNode(),n=f()(t).closest("a"),o=e.selection.getRng();n.length&&function(e,t,n){if(!e.selection.getSel().isCollapsed)return!1;if(t.compareEndPoints){var o=e.getBody().createTextRange();return o.moveToElementText(n),o.collapse(0),0===t.compareEndPoints("EndToEnd",o)}var a=t.endContainer;if(3===a.nodeType)return a.wholeText.length==t.endOffset;var r=a.childNodes[t.endOffset];return f()(r).is(":last-child")}(e,e.selection.getRng(),t)&&(o.setStartAfter(n[0]),o.setEndAfter(n[0]),e.selection.setRng(o),e.selection.collapse())},zt=function(e){var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Wt=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,o=n.childNodes.length,a=n.childNodes[o-1],r=a.length,i=e.dom.createRng();i.setStart(a,r),i.setEnd(a,r),e.selection.setRng(i)}},Kt={init:function(e){e.on("KeyDown",function(t){p.a.tinymce.VK.modifierPressed(t)||32!==t.keyCode||Ft(e),p.a.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&e.selection.selectedRange&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=zt(e.selection.selectedRange);t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore(function(){Wt(e,t),t.parentNode.removeChild(t)})}}(e)})}};n("tQaH");function Vt(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}var Ut=n("VrFO"),$t=n.n(Ut),qt=n("Y9Ll"),Jt=n.n(qt),Gt=new(function(){function e(t,n){$t()(this,e);var o=b.a.get("atlassian-account-id")||"anonymous";this._namespace="sessionStorage/".concat(t,".").concat(o,".").concat(n),this._sessionStorageSupported=!!p.a.sessionStorage}return Jt()(e,[{key:"getItem",value:function(e){if(!this._sessionStorageSupported)return null;var t=p.a.sessionStorage.getItem("".concat(this._namespace,".").concat(e));return t&&t.indexOf('"')>-1&&(t=JSON.parse(t)),t}},{key:"doesContain",value:function(e){return!!this.getItem(e)}},{key:"setItem",value:function(e,t){if(this._sessionStorageSupported)try{p.a.sessionStorage.setItem("".concat(this._namespace,".").concat(e),t)}catch(n){console.error("Unable to write to sessionStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}}},{key:"removeItem",value:function(e){this._sessionStorageSupported&&p.a.sessionStorage.removeItem("".concat(this._namespace,".").concat(e))}}]),e}())("atlassian","frontend"),Xt=function(e){var t=[];return a()(e).forEach(function(e,n){(function(e,t){var n=t?t.documentElement:p.a.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),a=o.top,r=o.bottom,i=n.offsetHeight;return 0<=a&&a<i||0<=r&&r<=i||a<=0&&0<=r&&r>=i}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})}),t},Qt=function(e){var t=Xt(e),n=null;return t.some(function(e){return!!function(e,t){var n=t?t.documentElement:p.a.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,a=n.offsetHeight;return 0<=o&&o<a}}(e.visibleBlockEl)&&(n=e,!0)}),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}},Yt=function(e){var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return a()(e).some(function(e,n){var o=Qt(e.children),a=o.visibleBlockEl,r=o.targetElementIndex;return!!a&&(t.columnIndex=n,t.targetElementIndexInColumn=r,t.visibleBlockEl=a,!0)}),t},Zt=function(e){if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")};var en=function(e){var t=e.contentId,n=e.isInViewPage,o=e.docObject,a=void 0===o?document:o,r=e.winObject,i=void 0===r?p.a:r,c=function(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if(Zt(e)){var o=e.children[0].children,a=Qt(o),r=a.targetElementIndex,i=a.visibleBlockEl;if(i){var c=i.getElementsByClassName("innerCell"),l=Yt(c),s=l.columnIndex,d=l.targetElementIndexInColumn,u=l.visibleBlockEl;u&&(n.targetElementIndex=d,n.offsetBetweenTargetAndCurrentScroll=t-Vt(u),n.columnLayoutPosition={rowIndex:r,columnIndex:s})}}else{var f=Qt(e.children),m=f.targetElementIndex,p=f.visibleBlockEl;p&&(n.targetElementIndex=m,n.offsetBetweenTargetAndCurrentScroll=t-Vt(p),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}(n?a.getElementById("main-content"):a.body,i.pageYOffset);c&&(c.contentId=t,c.isInViewPage=n,Gt.setItem("editor-persit-scroll-position",JSON.stringify(c)))},tn={_saveScrollPosition:function(e){e.getDoc()&&e.getWin()&&en({contentId:I(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},_restoreScrollPositionIfNeeded:function(e){e.getDoc()&&e.getWin()&&function(e){var t=e.contentId,n=e.isInViewPage,o=e.docObject,a=void 0===o?document:o,r=e.winObject,i=void 0===r?p.a:r,c=Gt.getItem("editor-persit-scroll-position");try{c=JSON.parse(c)}catch(e){}finally{Gt.removeItem("editor-persit-scroll-position")}if(c&&c.contentId===t&&c.isInViewPage!==n){var l;l=n?a.getElementById("main-content"):a.body;var s,d=c.columnLayoutPosition;if(d){var u=l.children[0].children[d.rowIndex].getElementsByClassName("innerCell")[d.columnIndex];s=u&&u.children[c.targetElementIndex]}else s=l.children[c.targetElementIndex];if(s){var f=Vt(s)+c.offsetBetweenTargetAndCurrentScroll;setTimeout(function(){return i.scrollTo(0,f)},1)}}}({contentId:I(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:function(e){var t=b.a.get("content-type");"page"!==t&&"blogpost"!==t||(Object(i.a)("rte-collab-ready",function(){tn._restoreScrollPositionIfNeeded(e)}),Object(i.a)("rte-ready",function(){p.a.Confluence.Editor.UI.cancelButton.click(function(){return tn._saveScrollPosition(e)}),p.a.Confluence.Editor.UI.saveButton.click(function(){return tn._saveScrollPosition(e)})}))},getInfo:function(){return{longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},nn=n("2wFc");function on(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}function an(e){0}var rn={init:function(e){e.on("init",function(){!function(e,t){var n=e.listener,o=e.globalProperty,a=e.interval,r=void 0===a?250:a;if(on(o))return an("window.".concat(o," is already available for use by ").concat(n,".")),t(),null;var i=setInterval(function(){an("".concat(n," is waiting for window.").concat(o," to be available")),on(o)&&(an("window.".concat(o," now available!")),clearInterval(i),t())},r)}({listener:"packages/confluence-editor/src/editor-plugins/fabric-migration/plugin.js",globalProperty:"Synchrony.ready"},function(){p.a.Synchrony.ready(function(t){rn._bindSynchronyMigrationEvent(t,e)})})})},_bindSynchronyMigrationEvent:function(e,t){var n={url:p.a.require("confluence-collaborative-editor-plugin/synchrony-util").getServiceUrl(),topic:"".concat(b.a.get("synchrony-app-id"),"/confluence-").concat(b.a.get("page-id"),"-migration"),jwt:b.a.get("synchrony-token")};e.channel(n).on("message",function(){rn._showMessageDialog(t)})},_showMessageDialog:function(e){var t={content:rn.getDialogContent(),width:420,height:40,id:"fabric-migration-dialog",name:"fabric.migration.dialog.title"},n={buttons:[{label:"fabric.migration.dialog.action",action:function(){!function(e){p.a.location=e}(Object(nn.n)(b.a.get("space-key"),b.a.get("content-type"),b.a.get("page-id")))},customClass:"aui-button aui-button-primary"}],cancelLink:!1},o=e.windowManager.open(t,n),a=p.a.document.getElementById(o);a&&a.querySelector(".button-panel-button").classList.remove("button-panel-button")},getDialogContent:function(){var e=p.a.tinymce.EditorManager.activeEditor.translate("tinymce.fabric.migration.dialog.content");return"\n      <p>\n        <span class='exceptionMessage'>\n          ".concat(e," \n        </span>\n      </p>\n    ")},getInfo:function(){return{longname:"Confluence Fabric Editor Migration",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},cn=n("cczi");function ln(){p.a.tinymce.activeEditor.getBody().style.height="auto"}var sn=n("owi1");function dn(){var e=Object(sn.a)();return{component:function(e){var t;return e=e||{},e=f.a.extend({},{keypressListener:function(n){27===n.keyCode?(E.a.debug("dialog.js: escape keydown caught"),f()(".aui-dropdown",t.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():t.hide())):13===n.keyCode&&(E.a.debug("dialog.js: enter keydown caught"),f()(".aui-dropdown",t.popup.element).is(":visible")||"textarea"!=(n.target.nodeName&&n.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit))},width:865,height:530},e),t=new E.a.Dialog(e),document.addEventListener("hideLayer",function(n,o,a){"popup"==o&&a==t&&"function"==typeof e.onCancel&&e.onCancel()}),t},initialiser:function(t){var n=this;Object(i.a)("show.dialog",function(e,t){var n=E.a.Meta.get("page-id"),o=E.a.Meta.get("space-key"),a=E.a.Meta.get("editor-mode"),r=E.a.Meta.get("new-page");E.a.EventQueue=E.a.EventQueue||[],E.a.EventQueue.push({name:t.dialog.id,properties:function(){var e={};return n&&(e.pageid=n),o&&(e.spacekey=o),a&&(e.editormode=a),r&&(e.newpage=r),e}()})}),document.addEventListener("showLayer",function(n,o,a){e.runBinderComponents(),"popup"==o&&a&&function(n){var o,a=t(n);if(!a.attr("data-lasttab-override")){a.attr("data-tab-default")&&(o=a.attr("data-tab-default"));var r=e.storageManager(a.attr("id")),i=r.getItem("last-tab"),c=null!=i?i:o;c&&t(".page-menu-item:visible:eq(".concat(c,") button"),a).click(),a.attr("data-lasttab-bound")||(t(".page-menu-item",a).each(function(e,n){t(n).click(function(){r.setItem("last-tab",e)})}),a.attr("data-lasttab-bound","true"))}}(a.element)}),E.a.Dialog.prototype.overrideLastTab=function(){t(n.popup.element).attr("data-lasttab-override","true")},E.a.Dialog.prototype.addHelpText=function(e,o){if(e){var a=e;o&&(a=E.a.template(e).fill(o).toString());var r=n.page[n.curpage];r.buttonpanel||r.addButtonPanel();var i=t("<div class='dialog-tip'></div>").html(a);r.buttonpanel.append(i),t("a",i).click(function(){return p.a.open(n.href,"_blank").focus(),!1})}},E.a.Dialog.prototype.getTitle=function(){return t("#".concat(n.id,".dialog-components:visible h2")).text()},E.a.Dialog.prototype.isVisible=function(){return t("#".concat(n.id)).is(":visible")}}}}var un=function(){return Confluence.Link},fn="undefined"!=typeof Confluence?Confluence:{};var mn=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,o=e.triggerText,a=e.iconClass,r=e.click,i=!!e.disabled,c=e.id;this.render=function(){var e=f()('<button type="button"></button>').addClass("aui-button").attr("data-tooltip",n||t);if(c&&e.attr("id",c),i&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click(function(){e.prop("disabled")||r()}),a){var l=f()("<span />");l.addClass("icon ".concat(a)),l.text(t),e.append(l)}if(o){var s=f()("<span />");s.addClass("trigger-text"),s.text(o),e.append(s)}return e[0]}},DropDownButton:function(e){var t,n=e.id,o=e.tooltip,a=e.text||"",r=e.iconClass,i=!!e.disabled,c=e.dropDownContent;this.render=function(){var e=f()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",o);e.attr("id",n);var l=f()("<div/>").addClass("aui-dd-parent"),s=f()("<a href='#'></a>");if(s.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),a&&s.append("<span class='dropdown-text'>".concat(a,"</span>")),i&&(e.addClass("disabled"),s.addClass("disabled")),r){var d=f()("<span />");d.addClass("icon ".concat(r)),d.text(a),s.append(d)}var u=f()("<span/>");return u.addClass("icon").addClass("icon-dropdown"),s.append(u),t=f()("<div/>").addClass("hidden").addClass("aui-dropdown"),c&&t.append(c),l.append(s),l.append(t),e.append(l),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,o=e.click,a=!!e.disabled,r=e.tooltip;this.render=function(){var e=f()('<button type="button"></button>').addClass("aui-button").addClass(n).text(t);return r&&e.attr("data-tooltip",r),a&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click(function(){e.prop("disabled")||o()}),e[0]}},TextBox:function(e){var t=e.id,n=e.text,o=e.name,a=e.keydown,r=e.cssClass;this.render=function(){var e=f()("<div></div>").addClass("toolbar-item");e.append(f()('<label for="'.concat(t,'">').concat(n,"</label>")));var i=f()('<input id="'.concat(t,"\" type='text' name=\"").concat(o,'" class="').concat(r,' text" autocomplete="off">'));return i.keydown(function(e){a(e)}),e.append(i),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=f()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,a=n.length;o<a;o++)e.append(n[o].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,o=t&&t.dropDownOptions||{};this.render=function(){var e=f()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var a=0,r=n.length;a<r;a++)e.append(n[a].render());return e.append(function(){var e=o.id,t=o.disabled,n=o.dropDownContent,a=o.title,r=o.alignment,i=f()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&i.attr("id",e),a&&i.attr({"data-tooltip":a}),r&&i.data("dropdown-alignment",r);var c=f()("<div/>").addClass("aui-dd-parent"),l=f()("<a href='#'></a>");l.addClass("toolbar-trigger aui-dd-trigger"),t&&(i.addClass("disabled"),l.addClass("disabled"));var s=f()("<span/>");s.addClass("icon").addClass("icon-dropdown"),l.append(s);var d=f()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&d.append(n),c.append(l),c.append(d),i.append(c),i[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},p.a.Confluence.Editor.Toolbar={},p.a.Confluence.Editor.Toolbar.Components=e,e},pn=function(){var e,t,n,o,a,r,i,c,l,s,d,u,m,h,b,v,y,C,w={},x=4,k=4,T=15,E=20,A=25,S=17,I=20,M=0,O=!1;function B(){i.css({top:f()("#insert-table-dropdown").outerHeight(!0)}),B=function(){}}function N(){i.hasClass("hidden")||(!function(){var t=f()(p.a.tinymce.activeEditor.getDoc());e.unbind(".atlassian-table-picker"),t.unbind(".atlassian-table-picker")}(),i.addClass("hidden"),n.addClass("hidden"),r.removeClass("active"))}function R(e,t){e==v&&t==y||(e=Math.max(1,Math.min(T,e)),t=Math.max(1,Math.min(E,t)),h=Math.max(x,e),b=Math.max(k,t),v=e,y=t,c.width(h*A+1),c.height(b*S+I),P(l,h,b),P(d,v,y),P(s,h,1),P(u,v,1),_(),m.text("".concat(v," x ").concat(y)))}function _(){s.toggleClass("hidden",!C),u.toggleClass("hidden",!C)}function P(e,t,n){e.width(A*t+1),e.height(S*n+1)}function D(t){var n=l.offset(),o=n.top-e.scrollTop(),a=n.left-e.scrollLeft(),r=o+l.outerHeight(!0)+M,i=r-S-M,c=a+l.outerWidth(!0)+M,s=c-A-M,d=t.clientY,u=t.clientX,f=h,m=b;u>c?f+=~~((u-c)/A+1):u<s&&(f+=~~((u-s)/A-1)),d>r?m+=~~((d-r)/S+1):d<i&&(m+=~~((d-i)/S-1)),R(f,m)}function H(e){e!=C&&(C=e,_())}function j(e){var n=function(e){var t=~~(e.offsetX||e.originalEvent.layerX),n=~~(e.offsetY||e.originalEvent.layerY),o=1+~~(t/A),a=1+~~(n/S);return o<1||o>T||a<1||a>E?null:{width:o,height:a}}(e);e.preventDefault(),n&&(N(),function(e,n,o){var a,r;0;var i=f()("#tinymce-table-form");i.length?(i.find('input[name="rows"]').val(n),i.find('input[name="cols"]').val(e)):(a=p.a.AJS.renderTemplate("tableForm",n,e),(r=f()("<div></div>").addClass("hidden")).append(a),t.append(r));f()("#table-heading-checkbox").prop("checked",o),Object(g.b)().BookmarkManager.restoreBookmark(),p.a.tinymce.activeEditor.undoManager.beforeChange();var c={cols:e,rows:n,heading:o};p.a.tinymce.activeEditor.execCommand("confInsertTable",!1,c),r&&r.remove()}(n.width,n.height,C))}function L(e){f.a.browser.msie?(16===e.keyCode&&H(!e.shiftKey),27===e.keyCode&&N()):(0===e.charCode&&H(!e.shiftKey),27===e.keyCode&&0===e.charCode&&N())}function F(){N()}return w.insertTable=j,{bindToControl:function(){e=f()(document),t=e.find("body"),o=f()("#insert-table-dropdown"),a=f()("#rte-button-insert-table"),r=o.find(".aui-dd-parent"),i=f()("#table-picker-container"),c=i.find(".table-picker-box"),l=i.find(".picker-cell"),s=i.find(".picker-heading"),d=i.find(".picker-selected-cell"),u=i.find(".picker-selected-heading"),m=c.find(".desc"),n=f()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(o),a.click(function(t){t.preventDefault(),O||(Object(g.b)().BookmarkManager.storeBookmark(),function(){B(),C=!0,R(1,1),function(){var t=f()(p.a.tinymce.activeEditor.getDoc());e.bind("mousemove.atlassian-table-picker",D),e.bind("keydown.atlassian-table-picker",L),e.bind("keyup.atlassian-table-picker",L),t.bind("keydown.atlassian-table-picker",L),t.bind("keyup.atlassian-table-picker",L)}(),n.removeClass("hidden"),i.removeClass("hidden"),r.addClass("active"),a.focus()}())}),n.click(F),d.click(j),u.click(j)},disable:function(){O=!0,o.addClass("disabled")},enable:function(){O=!1,o.removeClass("disabled"),a.attr("data-tooltip",p.a.tinymce.activeEditor.translate("tinymce.tablepicker.insert_table_title"))},close:N,_internal:w}},gn=function(){p.a.AJS.Rte=Object(g.b)()||{},p.a.AJS.Rte.TablePicker=pn()};var hn=[],bn=function(e){e.fn.tipsy.autoBounds2=function(t,n){return function(){var o={},a=e(document).scrollTop()+t,r=e(document).scrollLeft()+t,i=e(this);return n.length>1?(o.ns=n[0],o.ew=n[1]):"e"==n[0]||"w"==n[0]?o.ew=n[0]:o.ns=n[0],i.offset().top<a&&(o.ns="n"),i.offset().left<r&&(o.ew="w"),e(window).width()+e(document).scrollLeft()-(i.offset().left+i.width())<t&&(o.ew="e"),e(window).height()+e(document).scrollTop()-(i.offset().top+i.height())<t&&(o.ns="s"),o.ns?o.ns+(o.ew?o.ew:""):o.ew}}};function vn(){f()(".tipsy").remove()}function yn(){var e=/\+/g;setTimeout(function(){f()("#rte-savebar .aui-button[title]").each(function(){var t=f()(this),n=t.attr("title");if(t.removeAttr("title"),p.a.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)})},0)}function Cn(){bn(f.a);var e={live:!0,gravity:"n",title:function(){return f()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},t=f.a.fn.tipsy.autoBounds2(50,"n"),n=f.a.fn.tipsy.autoBounds2(50,"w"),o=f.a.extend({},e,{gravity:t}),a=f.a.extend({},e,{gravity:n}),r=f.a.extend({},e,{gravity:"se"});function c(e,t,n){if("dropdown"===t&&(f()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var o=n.trigger.data("tipsy");o&&(o.hoverState="out")}}f()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(o),f()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(a),f()("#rte-savebar [data-tooltip]").tooltip(r),f()("#editor-precursor [data-tooltip]").tooltip(o),f()("#property-panel [data-tooltip]").tooltip(o),F("showLayer",c),F("hideLayer",c),Object(i.a)("created.property-panel",vn),Object(i.a)("destroyed.property-panel",vn),Object(i.a)("register-contexts.keyboardshortcuts",yn)}function wn(){Object(i.c)("created.property-panel",vn),Object(i.c)("destroyed.property-panel",vn),Object(i.c)("register-contexts.keyboardshortcuts",yn)}function xn(){var e,t,n=fn.Editor,o="disabled";function a(e){var t=function(){e&&e.hide()};Object(xt.a)(document,"showLayer",function(n,o,a){if("dropdown"==o&&a==e){var r=p.a.tinymce.activeEditor;r.on("Click",t),r.on("KeyUp",t)}}),Object(xt.a)(document,"hideLayer",function(n,o,a){if("dropdown"==o&&a==e){var r=p.a.tinymce.activeEditor;r.off("Click",t),r.off("KeyUp",t)}})}function r(e){e.addCallback("show",function(){e.$.parents(".disabled").length&&e.hide()})}function i(e,t){var n=u(t);f()("#".concat(n)).removeClass(o)}function c(e,t){var n=u(t);f()("#".concat(n)).addClass(o)}function l(e,t){t?e.closest(".aui-button").prop(o,!0).attr("aria-disabled","true").toggleClass(o,t):e.closest(".aui-button").prop(o,!1).removeAttr("aria-disabled").toggleClass(o,t)}function s(e,t,n,a){var r=f()("#toolbar"),i=r.find(".toolbar-item"),c=f()("#insert-menu, #more-menu"),l=f()("#insert-menu, #color-picker-control"),s=f()("#format-dropdown"),d=a||function(){return!0};i.toggleClass(o,e),c.toggleClass(o,e),l.toggleClass(o,e),s.toggleClass(o,!!t),Object(g.b)().TablePicker[e?"disable":"enable"](),void 0!==n&&r.find("button, input").filter(d).toggleClass(o,n).prop(o,n)}var d=function(t){return function(n){var a=n.element,r=function(e){return e=f()(e).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(t){return e.is(t)}}(a),i=r("BLOCKQUOTE"),c=r("PRE"),l=r(".text-placeholder");c?s(!0,f()(a).parents("table").is("[data-macro-body-type='PLAIN_TEXT']")):l?s(!0):i?(s(!1),e.toggleClass(o,!0)):s(!1),O(f()(a),Object(g.b)().TablePicker,t),C(f()(a))}};function u(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function m(e){return f()("#".concat(e)).length>0}function h(e,t){var n=t.animate;void 0==n&&(n=!0);var o=u(t),a=f()("#".concat(o));n?a.addClass("disabled"):(a.addClass("disabled"),function(){f()(this).remove(),Object(xt.b)(document,"resize.resizeplugin"),t.onHide&&t.onHide()}.call(a))}function b(e,t){var n=u(t);if(!m(n)){var o=t.animate;void 0==o&&(o=!0);var a=f()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual disabled");a.attr("id",n),t.editorAdjacent&&a.addClass("editor-adjacent");for(var r=t.topToolbar?f()("#rte-toolbar.aui-toolbar:visible"):f()("#savebar-container .aui-toolbar:visible"),i=0,c=t.buttons.length;i<c;i++){var l=t.buttons[i];a.append(l.render())}if(t.editorAdjacent)r.append(a);else{var s=f()(".editor-adjacent",r).filter(":first");s.length?s.before(a):r.append(a)}a.find(".toolbar-dropdown").each(function(){v(this)});o||function(){Object(xt.b)(document,"resize.resizeplugin"),Object(xt.b)(document,"shown.contextToolbar"),t.onVisible&&t.onVisible()}(),a.removeClass("disabled")}}function v(e){var t=f()(e),n=t.dropDown("Standard",{alignment:t.data("dropdown-alignment")||"left"})[0];t.find(".dropdown-item").click(function(e){!function(e){var t=e.attr("data-macro-name"),n=e.attr("data-command"),o=e.attr("data-format"),a=e.attr("data-control-id"),r=p.a.tinymce.activeEditor;t&&H.macroBrowserToolbarButtonClicked({presetMacroName:t}),n&&r.execCommand(n,!1),o&&r.theme.controlHandlers.formatselect.click.dispatch(o),a&&r.theme.controlHandlers.buttons.click.dispatch(a)}(f()(this)),n.hide(),e.preventDefault()}),r(n),a(n)}function y(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){f()("#rte-savebar .hints-text").html(p.a.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),f()("#rte-savebar a.hints-close").click(function(e){f()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()}),f()("#rte-savebar a.hints-next").click(function(e){o(),e.preventDefault()})}function C(e){A(S.f)&&(e.closest("P, BLOCKQUOTE, H1, H2, H3, H4, H5, PRE").length>0?t.toggleClass(o,!0):t.toggleClass(o,!1))}return{init:function(o){v("#format-dropdown"),v("#more-menu .aui-dd-parent"),v("#insert-menu .aui-dd-parent"),f()("#pagelayout-menu").length&&v("#pagelayout-menu .aui-dd-parent"),f()("#template-menu").length&&v("#template-menu .aui-dd-parent"),function(){var e=f()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),n=f()("#rte-button-color"),o=n.find(".selected-color"),i=t.dropDown("Standard",{alignment:"left"})[0],c=n.attr("data-color");o.css("background-color","#".concat(c)),e.delegate("a[data-color]","click",function(e){var t=f()(this),a=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(p.a.tinymce.execCommand("ForeColor",!1,"#".concat(a)),n.attr("data-color",a),o.css("background-color","#".concat(a)))}),r(i),a(i)}}(),function(){Object(g.b)().TablePicker.bindToControl(p.a.tinymce.activeEditor,f()("#insert-table-dropdown"))}(),function(){var e=f()("#rte-button-source-mode");e.click(function(){e.hasClass("active")?n.changeMode(n.MODE_RICHTEXT):n.changeMode(n.MODE_SOURCE)})}(),y(),function(){e=f()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright"),t=f()("#rte-button-indent")}(),function(e){Object(xt.b)(document,"initContextToolbars.Toolbar",e),Object(xt.a)(document,"createContextToolbarRow.Toolbar",b),Object(xt.a)(document,"removeContextToolbarRow.Toolbar",h),Object(xt.a)(document,"enableContextToolbarRow.Toolbar",i),Object(xt.a)(document,"disableContextToolbarRow.Toolbar",c)}(o);var l=f()("#format-dropdown"),s=l.find("span.dropdown-text");o.on("BeforeExecCommand",function(e){var t=e.command,n=e.value,o=p.a.tinymce.activeEditor;if(f.a.each(["pre","blockquote"],function(){"FormatBlock"==t&&n==this&&(o.formatter.remove("alignleft"),o.formatter.remove("aligncenter"),o.formatter.remove("alignright"))}),f()(o.selection.getNode()).closest("pre,.text-placeholder").length)for(var a=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],r=a.length,i=0;i<r;i++)t==a[i]&&e.preventDefault();if("FormatBlock"==t&&"pre"==n&&(o.undoManager.add(),o.execCommand("removeFormat")),"FormatBlock"==t&&"p"==n){var c=l.find(".dropdown-item[data-format='blockquote']").text();s.text()==c&&o.execCommand("FormatBlock",!1,"blockquote")}"confDefaultTable"===t&&M(f()(o.selection.getNode()))&&e.preventDefault()}),o.on("ExecCommand",function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var o=l.find(".dropdown-item[data-format='".concat(n,"']"));o.length||(o=l.find(".dropdown-item[data-format='p']")),s.text(o.text())}}),o.on("NodeChange",d(o)),o.on("init",function(){var e=p.a.tinymce.activeEditor;var t={};f()(".aui-toolbar").find("[data-control-id]").each(function(n,o){var a=(o=f()(o)).attr("data-control-id");"formatselect"==a?e.theme.controlHandlers[a].state.add(function(e){var t=p.a.tinymce.activeEditor;if("p"==e){var n=t.selection.getNode();f()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var o=l.find(".dropdown-item[data-format='".concat(e,"']")).text();o&&s.text(o)}):t[a]=o});var n=e.theme.controlHandlers.buttons;n.state.add(function(e,n,o){var a=t[e];if(a){var r=a.find(".icon-check"),i=a.closest(".toolbar-item");r.length?r.toggleClass("hidden",!o):i.toggleClass(n,o)}}),f()(".aui-toolbar").delegate(".toolbar-item","click",function(e){var t=f()(this);if(t.hasClass("disabled"))e.preventDefault();else{var o=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");o&&(n.click.dispatch(o),e.preventDefault())}}),f.a.support.shrinkWrapBlocks=!1,Cn()}),o.on("Remove",function(){wn()}),o.on("Focus",function(){var e=f()(o.selection.getNode());O(e,Object(g.b)().TablePicker,o),C(e)})},toggleToolbarButton:l,disableToolbarButton:function(e){l(f()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){l(f()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){f()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var t=u({id:e});return m(t)&&!f()("#".concat(t)).hasClass(o)},getToolbarRow:function(e){var t=u({id:e}),n=f()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!f()(".".concat(e.replace(".",""))).closest(".aui-button").prop(o)},bindDropdownMenu:v,toggleToolbarButtons:s,getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}function kn(){var e=fn.Editor,t="disabled";function n(e){var t=function(){e&&e.hide()};Object(xt.a)(document,"showLayer",function(n,o,a){if("dropdown"==o&&a==e){var r=p.a.tinymce.activeEditor;r.on("Click",t),r.on("KeyUp",t)}}),Object(xt.a)(document,"hideLayer",function(n,o,a){if("dropdown"==o&&a==e){var r=p.a.tinymce.activeEditor;r.off("Click",t),r.off("KeyUp",t)}})}function o(e){e.addCallback("show",function(){e.$.parents(".disabled").length&&e.hide()})}function a(e,n){var o=d(n);f()("#".concat(o)).removeClass(t)}function r(e,n){var o=d(n);f()("#".concat(o)).addClass(t)}function i(e,n){n?e.closest(".aui-button").prop(t,!0).attr("aria-disabled","true").toggleClass(t,n):e.closest(".aui-button").prop(t,!1).removeAttr("aria-disabled").toggleClass(t,n)}function c(e,n,o,a){var r=f()("#toolbar"),i=r.find(".toolbar-item"),c=f()("#insert-menu, #more-menu"),l=f()("#insert-menu, #color-picker-control"),s=f()("#format-dropdown"),d=a||function(){return!0};i.toggleClass(t,e),c.toggleClass(t,e),l.toggleClass(t,e),s.toggleClass(t,!!n),Object(g.b)().TablePicker[e?"disable":"enable"](),void 0!==o&&r.find("button, input").filter(d).toggleClass(t,o).prop(t,o)}var l,s=function(e){return function(n){var o=n.element,a=function(e){return e=f()(e).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(t){return e.is(t)}}(o),r=a("BLOCKQUOTE"),i=a("PRE"),l=a(".text-placeholder");if(i)c(!0,f()(o).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(l)c(!0);else if(r){c(!1),f()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass(t,!0)}else c(!1);O(f()(o),Object(g.b)().TablePicker,e)}};function d(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function u(e){return f()("#".concat(e)).length>0}function m(e,t){var n=t.animate;void 0==n&&(n=!0);var o=function(){f()(this).remove(),Object(xt.b)(document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(l),l=setTimeout(function(){var e=d(t),a=f()("#".concat(e));n?a.slideUp(400,o):(a.hide(),o.call(a))},100)}function h(e,t){var n=d(t),o=t.animate;if(void 0==o&&(o=!0),u(n))f()("#".concat(n,":hidden")).slideDown(400,function(){0});else{var a=f()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");a.attr("id",n),t.editorAdjacent&&a.addClass("editor-adjacent");for(var r=t.topToolbar?f()("#rte-toolbar.aui-toolbar:visible"):f()("#savebar-container .aui-toolbar:visible"),i=0,c=t.buttons.length;i<c;i++){var s=t.buttons[i];a.append(s.render())}if(a.css({display:"none"}),t.editorAdjacent)r.append(a);else{var m=f()(".editor-adjacent",r).filter(":first");m.length?m.before(a):r.append(a)}a.find(".toolbar-dropdown").each(function(){b(this)});var p=function(){Object(xt.b)(document,"resize.resizeplugin"),Object(xt.b)(document,"shown.contextToolbar"),t.onVisible&&t.onVisible()};clearTimeout(l),l=setTimeout(function(){o?a.slideDown(400,p):(a.show(),p())},100)}}function b(e){var t=f()(e),a=t.dropDown("Standard",{alignment:t.data("dropdown-alignment")||"left"})[0];t.find(".dropdown-item").click(function(e){!function(e){var t=e.attr("data-macro-name"),n=e.attr("data-command"),o=e.attr("data-format"),a=e.attr("data-control-id"),r=p.a.tinymce.activeEditor;t&&H.macroBrowserToolbarButtonClicked({presetMacroName:t}),n&&r.execCommand(n,!1),o&&r.theme.controlHandlers.formatselect.click.dispatch(o),a&&r.theme.controlHandlers.buttons.click.dispatch(a)}(f()(this)),a.hide(),e.preventDefault()}),o(a),n(a)}function v(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){f()("#rte-savebar .hints-text").html(p.a.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),f()("#rte-savebar a.hints-close").click(function(e){f()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()}),f()("#rte-savebar a.hints-next").click(function(e){o(),e.preventDefault()})}return{init:function(t){b("#format-dropdown"),b("#more-menu .aui-dd-parent"),b("#insert-menu .aui-dd-parent"),f()("#pagelayout-menu").length&&b("#pagelayout-menu .aui-dd-parent"),f()("#template-menu").length&&b("#template-menu .aui-dd-parent"),function(){var e=f()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),a=f()("#rte-button-color"),r=a.find(".selected-color"),i=t.dropDown("Standard",{alignment:"left"})[0],c=a.attr("data-color");r.css("background-color","#".concat(c)),e.delegate("a[data-color]","click",function(e){var t=f()(this),n=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(p.a.tinymce.execCommand("ForeColor",!1,"#".concat(n)),a.attr("data-color",n),r.css("background-color","#".concat(n)))}),o(i),n(i)}}(),function(){Object(g.b)().TablePicker.bindToControl(p.a.tinymce.activeEditor,f()("#insert-table-dropdown"))}(),function(){var t=f()("#rte-button-source-mode");t.click(function(){t.hasClass("active")?e.changeMode(e.MODE_RICHTEXT):e.changeMode(e.MODE_SOURCE)})}(),v(),function(e){Object(xt.b)(document,"initContextToolbars.Toolbar",e),Object(xt.a)(document,"createContextToolbarRow.Toolbar",h),Object(xt.a)(document,"removeContextToolbarRow.Toolbar",m),Object(xt.a)(document,"enableContextToolbarRow.Toolbar",a),Object(xt.a)(document,"disableContextToolbarRow.Toolbar",r)}(t);var i=f()("#format-dropdown"),c=i.find("span.dropdown-text");t.on("BeforeExecCommand",function(e){var t=e.command,n=e.value,o=p.a.tinymce.activeEditor;if(f.a.each(["pre","blockquote"],function(){"FormatBlock"==t&&n==this&&(o.formatter.remove("alignleft"),o.formatter.remove("aligncenter"),o.formatter.remove("alignright"))}),f()(o.selection.getNode()).closest("pre,.text-placeholder").length)for(var a=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],r=a.length,l=0;l<r;l++)t==a[l]&&e.preventDefault();if("FormatBlock"==t&&"pre"==n&&(o.undoManager.add(),o.execCommand("removeFormat")),"FormatBlock"==t&&"p"==n){var s=i.find(".dropdown-item[data-format='blockquote']").text();c.text()==s&&o.execCommand("FormatBlock",!1,"blockquote")}}),t.on("ExecCommand",function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var o=i.find(".dropdown-item[data-format='".concat(n,"']"));o.length||(o=i.find(".dropdown-item[data-format='p']")),c.text(o.text())}}),t.on("NodeChange",s(t)),t.on("init",function(){var e=p.a.tinymce.activeEditor;var t={};f()(".aui-toolbar").find("[data-control-id]").each(function(n,o){var a=(o=f()(o)).attr("data-control-id");"formatselect"==a?e.theme.controlHandlers[a].state.add(function(e){var t=p.a.tinymce.activeEditor;if("p"==e){var n=t.selection.getNode();f()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var o=i.find(".dropdown-item[data-format='".concat(e,"']")).text();o&&c.text(o)}):t[a]=o});var n=e.theme.controlHandlers.buttons;n.state.add(function(e,n,o){var a=t[e];if(a){var r=a.find(".icon-check"),i=a.closest(".toolbar-item");r.length?r.toggleClass("hidden",!o):i.toggleClass(n,o)}}),f()(".aui-toolbar").delegate(".toolbar-item","click",function(e){var t=f()(this);if(t.hasClass("disabled"))e.preventDefault();else{var o=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");o&&(n.click.dispatch(o),e.preventDefault())}}),f.a.support.shrinkWrapBlocks=!1,Cn()}),t.on("Remove",function(){wn()})},toggleToolbarButton:i,disableToolbarButton:function(e){i(f()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){i(f()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){f()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var n=d({id:e});return u(n)&&!f()("#".concat(n)).hasClass(t)},getToolbarRow:function(e){var t=d({id:e}),n=f()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!f()(".".concat(e.replace(".",""))).closest(".aui-button").prop(t)},bindDropdownMenu:b,toggleToolbarButtons:c,getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}var Tn=n("QTRv");Tn.a.configure(function(){return{endpoint:p.a.location?"".concat(p.a.location.protocol,"//").concat(p.a.location.host):"",contextPath:C.a}}());var En=Tn.a,An=(n("gV2d"),function(){return!A("editor.insert-wiki-markdown")}),Sn={HELP_REST_API:"".concat(C.a,"/plugins/tinymce/helplink.action"),WIKI:{CONFLUENCE:{api:En.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"tinymce.confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:En.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"tinymce.confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},In={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:b.a.get("content-id"),spaceKey:b.a.get("space-key")},Mn=null,On=function(){var e=Bt.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return Sn.WIKI[e]},Bn=function(e,t){var n=f()(function(e,t,n){return'\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="'.concat(t.val,'">').concat(e(t.label),"</option>\n                ").concat(Object.keys(n).filter(function(e){return n[e].val!==t.val}).map(function(t){return'<option value="'.concat(n[t].val,'">').concat(e(n[t].label),"</option>")}),"\n            </select>\n        </form>\n    </span>\n")}(e,t,Sn.WIKI));return f()("#insert-wiki-insert-title").append(n),f()("#".concat(In.selectionMenuId))},Nn=function(){var e=f()("#".concat(In.selectionMenuId));return e.length?e.val():On().val},Rn=function(e){var t={wiki:(e=e||{}).textToConvert,entityId:In.entityId,spaceKey:In.spaceKey};e.api(JSON.stringify(t),function(t,n){t?e.errorCallback(t):e.successCallback(n)})},_n=function(){var e=f()("#".concat(In.markupEditId)),t=e.val();f.a.trim(t)?Rn({api:Sn.WIKI[Nn()].api,textToConvert:t,successCallback:function(e){Mn.html(e)},errorCallback:function(){Mn.html(e.val())}}):Mn.html(t)},Pn=function(){var e=Nn();Bt.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",e),function(e){var t=f()("#".concat(In.dialog.id)).find(".dialog-help-link"),n=Sn.WIKI[e].helpLink;t.load(Sn.HELP_REST_API,{linkUrlKey:n})}(e),_n()};function Dn(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,function(e){return"string"==typeof t[e]?t[e]:"&quot;"})}var Hn={init:function(e,t){In.dialog.content=An()?function(e){return'\n    <p id="insert-wiki-info-title">'.concat(e("tinymce.confluence.conf_wikimarkup_info_title"),'</p>\n    <form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">').concat(e("tinymce.confluence.conf_wikimarkup.insert.label"),'</span>\n            <span id="insert-wiki-preview-title">').concat(e("tinymce.confluence.conf_wikimarkup_preview_label"),"</span>\n        </h3>\n        <textarea class='monospaceInput textarea' id='insert-wiki-textarea' name='wikitext'/>\x3c!--\n            --\x3e<div class='example-container' id='insert-wiki-textarea-preview'></div>\n    </form>\n")}(function(t){return e.translate(t)}):" \n    <form action='#' method='post' id=\"insert-wiki-markup-form\" class=\"aui\">\n        <textarea class='monospaceInput textarea originalDefault' id='insert-wiki-textarea' name='wikitext'/>\n    </form>\n";var n=function(t){var n=In.dialog.id,o=Nn();e.windowManager.setBusy(n,!1),p.a.tinymce.EditorManager.activeEditor.windowManager.close(n),An()&&(Object(i.b)("analytics",{name:"insert-wiki-markup-dialog.".concat(o)}),"MARKDOWN"===o&&(t=function(e){var t=f()(e);return t.find("img").addClass("confluence-embedded-image"),f()("<div>").append(t.clone()).html()}(t))),e.execCommand("mceInsertContent",!1,t),function(e){p.a.tinymce.each(e.dom.select("p > p"),function(t){try{e.dom.split(t.parentNode,t)}catch(e){}})}(e)},o=function(t,n,o){e.windowManager.setBusy(In.dialog.id,!1);var a=function(e,t){return"\n        <p class='warning'>\n            ".concat(e,"\n        </p>\n        <p class='exception-report'>\n            <span class='exceptionMessage'>\n                ").concat(t,"\n            </span>\n        </p>\n")}(p.a.tinymce.EditorManager.activeEditor.translate("tinymce.confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?p.a.tinymce.EditorManager.activeEditor.translate("tinymce.confluence.conf_wikimarkup_timeout"):"".concat(Dn(n)," : ").concat(Dn(o)));p.a.tinymce.EditorManager.activeEditor.windowManager.alert(a)};e.addCommand("InsertWikiMarkup",function(){var a=On();if(e.windowManager.open(In.dialog,{buttons:[{label:"confluence_dlg.insertbutton.title",action:function(){e.windowManager.setBusy(In.dialog.id,!0),Rn({api:a.api,successCallback:n,errorCallback:o,textToConvert:f()("#".concat(In.markupEditId)).val(),setBusy:!0})}}],plugin_url:t,helpLink:a.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),An()){var r;!function(e){var t=f()("#wysiwygTextarea_ifr").contents().find("head").html(),n=f()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");f()("#".concat(e)).append(n);var o=n.contents(),a=o[0];a.open(),a.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),a.close(),o.find("head").html(t),Mn=o.find("body")}(In.previewAreaId),Bn(function(t){return e.translate(t)},a).on("change",Pn),f()("#".concat(In.markupEditId)).on("keydown",function(){clearTimeout(r),r=setTimeout(_n,In.serverRequestTimer)})}}),e.addButton("insertwikimarkup",{title:"confluence.conf_wikimarkup_desc",cmd:"InsertWikiMarkup"})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}};var jn={fields:{string:{language:function(e,t){var n=f()(p.a.Confluence.Templates.MacroBrowser.macroParameterSelect()),o=f()("select",n);return null==t&&(t={}),t.setValue=function(e){if(0==o.find("option[value='".concat(e,"']")).length){var t=f()("<option/>");t.val(e),t.text(e),o.append(t)}},function(e){En.getPluginCodeLanguages(function(t,n){if(!t&&n.length){var o=e.val();e.empty(),e.append(f()("<option/>").attr("value","")),n.forEach(function(t){var n=f()("<option />");n.val(t.aliases[0]),n.text(t.friendlyName),e.append(n)}),e.val(o)}})}(o),new p.a.AJS.MacroBrowser.Field(n,o,t)}}}};var Ln=[],Fn=function(e){return["shift","shiftLeft","shiftRight","ctrl","ctrlLeft","ctrlRight","alt","altLeft","altRight","meta","metaLeft","metaRight"].indexOf(e)>-1},zn=function(e){var t={"-":{default:189,variants:[189,45,109,173]},"\\":{default:47,variants:[47,191]},"/":{default:92,variants:[92,220]}};for(var n in t){var o=t[n];if(o.variants.indexOf(e)>-1)return o.default}return e},Wn=function(e){var t={};return e.forEach(function(e){var n=zn(e.which),o=function(e,t){return Fn(e)?e+(1===t.location?"Left":"Right"):e}(Un(n),e);t[o]=e}),t},Kn=function(e,t){var n=Wn(e);return qn(n,t)},Vn=function(e){var t=p.a.tinymce.Env.mac?"mac":"win";return e.map(function(e){return{keys:e[t].split("+").map(function(e){return 0===e.toLowerCase().indexOf("arrow")?function(e){return{arrowleft:37,arrowup:38,arrowright:39,arrowdown:40}[e]}(e.toLowerCase()):Fn(e)||e.length>1?e:function(e){var t=e.charCodeAt(0);return"-"===e||"\\"===e||"/"===e?zn(t):t}(e)}),context:e.context,param:e.param,description:e.description}})},Un=function(e){switch(e){case 16:return"shift";case 17:return"ctrl";case 18:return"alt";case 91:case 93:case 224:return"meta";default:return e}},$n=function(e){return Un(e)!==e},qn=function(e,t){return t.filter(function(t){return function(e,t){return Object.keys(e).length===t.keys.length&&t.keys.every(function(t){return!(!Fn(t)||!function(e,t){return!(!e["".concat(t,"Left")]&&!e["".concat(t,"Right")])}(e,t))||!!e[t]})}(e,t)})[0]},Jn=function(e,t,n){if(n){e.preventDefault();var o=n.param.split("-");t.execCommand(o[0],!1,o[1])}},Gn=function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o&&o.which===e.which&&(t.splice(n,1),n--)}},Xn=function(){Ln.length=0},Qn=function(e,t){return function(n){if(n.metaKey||n.shiftKey||n.altKey||n.ctrlKey){if(Gn(n,Ln),Ln.push(n),Ln.length>1&&Kn(Ln,t)){var o=Kn(Ln,t);Jn(n,e,o)}!function(){if(p.a.tinymce.Env.mac)for(var e=0;e<Ln.length;e++){var t=Ln[e].which;$n(t)||(Ln.splice(e,1),e--)}}()}else Xn()}},Yn=function(e,t){var n=Vn(t);return e.on("keydown",Qn(e,n),!0),e.on("keyup",function(){return function(e){Gn(e,Ln)}}(),!0),e.on("blur",Xn),p.a.addEventListener("error",Xn),function(e,t){var n=p.a.document.querySelectorAll("#versionComment, #content-title");if(n&&0!==n.length)for(var o=function(o){t.forEach(function(t){n[o].addEventListener("keydown",function(n){var o=!0,a=n.keyCode?n.keyCode:n.which,r=p.a.tinymce.Env.mac?"meta":"ctrl";t.keys.forEach(function(e){o=!(!o||!(e==r&&n.metaKey||"shift"==e&&n.shiftKey||a==e))}),o&&(n.preventDefault(),Jn(n,e,t))})})},a=0;a<n.length;a++)o(a)}(e,n.filter(function(e){return"form.input"===e.context})),n},Zn=[{win:"ctrl+altLeft+0",mac:"meta+alt+0",context:"tinymce.block",param:"FormatBlock-p",description:"Paragraph"},{win:"ctrl+altLeft+1",mac:"meta+alt+1",context:"tinymce.block",param:"FormatBlock-h1",description:"Heading 1"},{win:"ctrl+altLeft+2",mac:"meta+alt+2",context:"tinymce.block",param:"FormatBlock-h2",description:"Heading 2"},{win:"ctrl+altLeft+3",mac:"meta+alt+3",context:"tinymce.block",param:"FormatBlock-h3",description:"Heading 3"},{win:"ctrl+altLeft+4",mac:"meta+alt+4",context:"tinymce.block",param:"FormatBlock-h4",description:"Heading 4"},{win:"ctrl+altLeft+5",mac:"meta+alt+5",context:"tinymce.block",param:"FormatBlock-h5",description:"Heading 5"},{win:"ctrl+altLeft+6",mac:"meta+alt+6",context:"tinymce.block",param:"FormatBlock-h6",description:"Heading 6"},{win:"ctrl+shift+7",mac:"meta+shift+7",context:"tinymce.list",param:"InsertOrderedList",description:"Numbered List"},{win:"ctrl+shift+8",mac:"meta+shift+8",context:"tinymce.block",param:"InsertUnorderedList",description:"Bullet List"},{win:"ctrl+altLeft+9",mac:"ctrl+altLeft+9",context:"tinymce.quote",param:"mceBlockQuote",description:"Quote"},{win:"ctrl+shift+I",mac:"meta+shift+I",context:"",param:"confDefaultTable",description:"Insert Table"},{win:"ctrl+shift+M",mac:"meta+shift+M",context:"",param:"confMonospace",description:"Mono Spaced Font"},{win:"ctrl+shift+-",mac:"meta+shift+-",context:"",param:"InsertHorizontalRule",description:"Insert Horizontal Rule"},{win:"ctrl+H",mac:"meta+shift+H",context:"",param:"mceSearchReplaceToolbar",description:"Find Replace"},{win:"ctrl+\\",mac:"meta+\\",context:"",param:"RemoveFormat",description:"Remove Formatting"},{win:"ctrl+/",mac:"meta+/",context:"",param:"mceConfShortcutDialog",description:"Help"},{win:"alt+shift+arrowUp",mac:"ctrl+alt+arrowUp",context:"",param:"mceTableInsertRowBefore",description:"Insert table row above"},{win:"alt+shift+arrowDown",mac:"ctrl+alt+arrowDown",context:"",param:"mceTableInsertRowAfter",description:"Insert table row after"},{win:"alt+shift+arrowRight",mac:"ctrl+alt+arrowRight",context:"",param:"mceTableInsertColAfter",description:"Insert column after"},{win:"alt+shift+arrowLeft",mac:"ctrl+alt+arrowLeft",context:"",param:"mceTableInsertColBefore",description:"Insert column before"},{win:"ctrl+shift+9",mac:"meta+shift+9",context:"",param:"FormatBlock-blockquote",description:"Quote"},{win:"ctrl+S",mac:"meta+S",context:"form.input",param:"preventDefaultSave",description:"Prevent default behavior of browser"},{win:"ctrl+13",mac:"meta+13",context:"form.input",param:"publish",description:"Save"},{win:"ctrl+shift+E",mac:"meta+shift+E",context:"form.input",param:"preview",description:"Preview"},{win:"ctrl+shift+J",mac:"meta+shift+J",context:"",param:"mceJiralink",description:"Open Insert JIRA dialog"}],eo=function(e){return{"meta+Alt+0":e.shortcuts.remove("meta+Alt+0"),"meta+Alt+1":e.shortcuts.remove("meta+Alt+1"),"meta+Alt+2":e.shortcuts.remove("meta+Alt+2"),"meta+Alt+3":e.shortcuts.remove("meta+Alt+3"),"meta+Alt+4":e.shortcuts.remove("meta+Alt+4"),"meta+Alt+5":e.shortcuts.remove("meta+Alt+5"),"meta+Alt+6":e.shortcuts.remove("meta+Alt+6"),"meta+Alt+7":e.shortcuts.remove("meta+Alt+7"),"meta+Alt+8":e.shortcuts.remove("meta+Alt+8"),"meta+s":e.shortcuts.remove("meta+s"),"meta+shift+i":e.shortcuts.remove("meta+shift+i"),"meta+shift+x":e.shortcuts.remove("meta+shift+x"),"meta+shift+c":e.shortcuts.remove("meta+shift+c"),"meta+shift+v":e.shortcuts.remove("meta+shift+v"),"ctrl+shift+M":e.shortcuts.remove("ctrl+shift+M"),"ctrl+F":e.shortcuts.remove("ctrl+F"),"meta+shift+n":e.shortcuts.remove("meta+shift+n"),"meta+shift+b":e.shortcuts.remove("meta+shift+b"),"access+0":e.shortcuts.remove("access+0"),"access+1":e.shortcuts.remove("access+1"),"access+2":e.shortcuts.remove("access+2"),"access+3":e.shortcuts.remove("access+3"),"access+4":e.shortcuts.remove("access+4"),"access+5":e.shortcuts.remove("access+5"),"access+6":e.shortcuts.remove("access+6"),"access+7":e.shortcuts.remove("access+7"),"access+8":e.shortcuts.remove("access+8"),"access+9":e.shortcuts.remove("access+9"),"alt+arrowUp":e.shortcuts.remove("alt+38"),"alt+arrowDown":e.shortcuts.remove("alt+40"),"ctrl+f":e.shortcuts.remove("ctrl+f"),"ctrl+shift+n":e.shortcuts.remove("ctrl+shift+n"),"ctrl+shift+b":e.shortcuts.remove("ctrl+shift+b"),"ctrl+shift+I":e.shortcuts.remove("ctrl+shift+I"),"ctrl+0":e.shortcuts.remove("ctrl+0"),"ctrl+1":e.shortcuts.remove("ctrl+1"),"ctrl+2":e.shortcuts.remove("ctrl+2"),"ctrl+3":e.shortcuts.remove("ctrl+3"),"ctrl+4":e.shortcuts.remove("ctrl+4"),"ctrl+5":e.shortcuts.remove("ctrl+5"),"ctrl+6":e.shortcuts.remove("ctrl+6"),"ctrl+7":e.shortcuts.remove("ctrl+7"),"ctrl+8":e.shortcuts.remove("ctrl+8"),"ctrl+s":e.shortcuts.remove("ctrl+s")}},to=function(){p.a.tinymce.execCommand("confInsertTable",!1,{cols:3,rows:3})},no=function(){document.querySelector("#rte-button-publish").click()},oo=function(){document.querySelector("#rte-button-preview").click()},ao=function(e,t){return function(){e.execCommand("FormatBlock",!1,t)}};function ro(){var e;function t(){var t=f()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),f()("#editor-precursor .cell").prepend(t)}if("comment"!==b.a.get("content-type")){var n=f()("#quickedit-breadcrumbs");n.length>0&&(f()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),f()("#breadcrumb-section").append(n)),e=f()(".edited-page-title").parent().detach(),t(),Object(xt.a)(p.a.document,"mode-changed",function(n,o){"preview"===o?function(){var t=f()("#breadcrumbs").detach();e.detach(),f()("#breadcrumb-section").append(t)}():"richtext"===o&&t()})}}var io={CONNECT:["wr!confluence.web.resources:navigator-context","wr!com.atlassian.plugins.atlassian-connect-plugin:confluence-atlassian-connect-resources-v5"]}.CONNECT.concat(["wr!com.atlassian.plugins.atlassian-connect-plugin:dynamic-css-resources","wr!com.atlassian.plugins.atlassian-connect-plugin:featured-macro-css-resources"]).concat(["wr!com.atlassian.plugins.atlassian-connect-plugin:confluence-atlassian-connect-autoconvert-resources-v5","wr!com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5"]);function co(e){function t(e){f()("#autocomplete-dropdown .top-menu-item").spin(e)}function n(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?E.a.MacroBrowser.hasRequiredParameters(n)||n.alwaysShowConfig?H.macroBrowserToolbarButtonClicked(t):(Object(g.b)().BookmarkManager.storeBookmark(),P.insertMacro({contentId:E.a.Meta.get("content-id")||"0",macro:{name:n.macroName,body:""}})):H.macroBrowserToolbarButtonClicked(t)}function o(e){if(e.hidden&&!E.a.MacroBrowser.isHiddenMacroShown(e))return null;var t={className:"autocomplete-macro-".concat(e.macroName),callback:function(t){n(t,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(t.name=e.title,t.href="#",t.icon=(e.icon.relative?E.a.params.staticResourceUrlPrefix:"")+e.icon.location):t.html=E.a.Editor.Autocompleter.Util.dropdownLink(e.title),t}E.a.Editor.Autocompleter.Settings["{"]={ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return e.translate("editor.autocomplete.macros.header.text")},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:E.a.Editor.Autocompleter.Util.dropdownLink(e.translate("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){n(e,{searchText:e.text()})}}]},getDataAndRunCallback:function(n,a,r){var c=E.a.MacroBrowser.getMetadataPromise(),l=this,s=arguments;function d(){var e;e=a?function(e){for(var t=[],a=E.a.MacroBrowser.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),r=0,i=a.length;r<i;r++){var c=o(a[r]);if(c&&t.push(c)==n.maxResults)break}return t}(a):function(e){var t=[];return f()("#macro-insert-list li").each(function(n,a){var r=f()(a),i=e.find(function(e){return e.macroName===r.attr("data-macro-name")});if(i){var c=o(i);c&&t.push(c)}}),t}(E.a.MacroBrowser.metadataList),t(!1),r([e],a)}function u(e){e.preventDefault(),e.stopPropagation(),Object(i.b)("analytics",{name:"autocomplete-macrobrowser.load-retry"}),function(){E.a.MacroBrowser.reset(),E.a.MacroBrowser.preLoadMacro()}(),l.getDataAndRunCallback.apply(l,s)}l.alreadyBinded||(l.alreadyBinded=!0,c.always(function(){d(),l.alreadyBinded=!1}),c.fail(function(){Object(i.b)("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),E.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:e.translate("editor.autocomplete.macros.error.load.header"),body:"<p><a id='macro-retry-link' href='#'>".concat(e.translate("editor.autocomplete.macros.error.load.retrylink"),"</a></p>")}),f()("#macro-retry-link").click(u),f()("#autocomplete-dropdown ol").eq(1).show()})),"pending"===c.state()&&(r([],a),t(!0))},update:function(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}}}var lo=function(){return{initContextToolbars:function(){var e,t=p.a.aui,n=p.a.tinymce.activeEditor,o=mn(),a=function(e){var t,o="tinymce.".concat(e);t=A("editor.spa.uxenhancements")?p.a.tinymce.isMac?"".concat(o,"_shortcut_mac"):"".concat(o,"_shortcut_win"):"".concat(o,"_shortcut");var a=n.translate(o),r=n.translate(t,"");return r&&r!==t&&(a+=" (".concat(r,")")),a},r="aui-icon aui-icon-small aui-iconfont-table-",i=p.a.AJS.storageManager("atlassian.editor","tables"),c={Buttons:[new o.Group([new o.Button({text:a("table.row_before_desc"),iconClass:"".concat(r,"row-up"),click:function(){p.a.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new o.Button({text:a("table.row_after_desc"),iconClass:"".concat(r,"row-down"),click:function(){p.a.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new o.Button({text:a("table.delete_row_desc"),iconClass:"".concat(r,"row-remove"),click:function(){p.a.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new o.Group([new o.Button({text:a("table.cut_row_desc"),iconClass:"".concat(r,"cut-row"),click:function(){p.a.tinymce.execCommand("mceTableCutRow",!1,""),n.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-paste-row")}}),new o.Button({text:a("table.copy_row_desc"),iconClass:"".concat(r,"copy-row"),click:function(){p.a.tinymce.execCommand("mceTableCopyRow",!1,""),n.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-paste-row")}}),new o.Button({text:a("table.paste_row_before_desc"),iconClass:"".concat(r,"paste-row"),click:function(){p.a.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!i.doesContain("copied")})]),new o.Group([new o.Button({text:a("table.col_before_desc"),iconClass:"".concat(r,"col-left"),click:function(){p.a.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new o.Button({text:a("table.col_after_desc"),iconClass:"".concat(r,"col-right"),click:function(){p.a.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new o.Button({text:a("table.delete_col_desc"),iconClass:"".concat(r,"col-remove"),click:function(){p.a.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new o.Group([new o.Button({text:a("table.merge_cells_desc"),iconClass:"".concat(r,"merge"),click:function(){p.a.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new o.Button({text:a("table.split_cells_desc"),iconClass:"".concat(r,"split"),click:function(){p.a.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new o.Group([new o.Button({text:a("table.row_highlight"),iconClass:"".concat(r,"header-row"),click:function(){p.a.tinymce.execCommand("confTableRowToggleHeading",!1),p.a.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new o.Button({text:a("table.col_highlight"),iconClass:"".concat(r,"header-column"),click:function(){p.a.tinymce.execCommand("confTableColumnToggleHeading",!1)}})]),new o.SplitGroup([new o.Button({text:a("table.selection_highlight"),iconClass:"".concat(r,"bg"),click:function(){p.a.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:function(){var e=f()("<ul/>").addClass("table-highlight-picker"),t=[!1,!1,!1,!1,!1,!0];return f.a.each(["grey","red","green","blue","yellow",""],function(n,o){var a=f()("<li/>"),r=f()("<a href='#'></a>");t[n]?r.addClass("remove-highlight").attr("data-remove-highlight",!0):r.addClass("highlight-".concat(o)).attr("data-highlight-colour",o),a.append(r),e.append(a)}),e}(),alignment:"right"},postProcess:function(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=f()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-table-bg").after(t)}}),new o.Group([new o.Button({text:a("table.del"),iconClass:"".concat(r,"remove"),click:function(){p.a.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:hn},l=function(e){var t=f()(e).closest("td,th"),o=f()(".mceSelected",t.closest("table"));!function(e){function t(e,t){return parseInt(e.attr(t),10)}return e.filter(function(){var e=f()(this);return t(e,"rowspan")>1||t(e,"colspan")>1}).length>=1}(t.add(o))?n.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"):n.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split")},s=function(){var e=t.buttons.button({id:"table-more-settings-trigger",text:"",iconType:"aui",iconClass:"aui-icon-small aui-iconfont-configure",iconText:a("table.more.heading"),extraAttributes:{type:"button","data-aui-trigger":"true","aria-controls":"table-more-settings","data-tooltip":a("table.more.heading")}}),n=t.inlineDialog2.inlineDialog2({alignment:"bottom left",respondsTo:"toggle",id:"table-more-settings"}),o=t.buttons.buttons({content:e});return function(e){this.render=function(){var r=f()(o),i=f()(n),c=i[0],l=function(){c.open=!1};return i.on("aui-show",function(n){f()(".aui-inline-dialog-contents",n.target).html(function(e){var n=f()("<div></div>"),o=f()("<h2>".concat(a("table.more.heading"),"</h2>"));return n.append(o),e.forEach(function(e){var o=f()(t.form.field({type:"checkbox",id:e.id,labelContent:e.text,isChecked:e.isChecked(),isDisabled:e.isDisabled}));o.on("change",e.onChange),n.append(o)}),n}(e))}),r.append(i),f()(p.a).on("resize",f.a.debounce(l,100)),Object(xt.a)(p.a.document,"enableContextToolbarRow.Toolbar disableContextToolbarRow.Toolbar",l),r}}}();function d(e){var t=f()(this),o=f()("#table-highlight-group"),a=o.attr("data-highlight-colour"),r=o.attr("data-remove-highlight");a&&(o.removeClass("highlight-".concat(a)),o.removeAttr("data-highlight-colour")),o.removeClass("remove-highlight"),r&&o.removeAttr("data-remove-highlight");var i=t.attr("data-highlight-colour");i&&(o.addClass("highlight-".concat(i)),o.attr("data-highlight-colour",i)),t.attr("data-remove-highlight")&&(o.addClass("remove-highlight"),o.attr("data-remove-highlight",!0)),n.focus(),n.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}if(n.on("NodeChange",function(t){var n=t.element,o=f()("body"),a=!o.hasClass("no-tools")||o.hasClass("no-tools-toolbars-visible");e||null==n.parentNode||"BODY"===n.nodeName||(e=!0,!function(e){return f()(e).closest("table:not(.wysiwyg-macro)").length}(n)?Object(xt.b)(p.a.document,"disableContextToolbarRow.Toolbar",{animate:a}):(Object(xt.b)(p.a.document,"createContextToolbarRow.Toolbar",{buttons:c.Buttons,topToolbar:!0,animate:a}),Object(xt.b)(p.a.document,"enableContextToolbarRow.Toolbar",{id:"default"}),A("confluence.table.resizable")&&function(e){f.a.fn.updateTableModeInToolbar&&f()(e).closest("table").updateTableModeInToolbar()}(n),l(n)),e=!1)}),n.on("Undo",function(){n.nodeChanged()}),n.initialized?f()(p.a.document).delegate("#table-highlight-colour .aui-dropdown a","click",d):n.on("init",function(){f()(p.a.document).delegate("#table-highlight-colour .aui-dropdown a","click",d)}),n.on("Remove",function(){f()(p.a.document).undelegate("#table-highlight-colour .aui-dropdown a","click",d)}),A("confluence.table.resizable")&&c.Buttons.splice(0,0,new o.Group([new o.DropDownButton({id:"table-mode-picker",text:a("table.auto_width"),dropDownContent:function(){var e=f()("<ul/>").addClass("table-mode-list"),t=[{name:a("table.responsive"),mceCmd:"mceAutoWidth",tooltip:a("table.responsive_tooltip")},{name:a("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:a("table.fixed_width_tooltip")}];return f.a.each(t,function(t,n){var o=f()("<li/>").addClass("dropdown-item").attr("data-tooltip",n.tooltip),a=f()("<a href='#'>".concat(n.name,"</a>")).addClass("item-link");o.on("click",function(){p.a.tinymce.execCommand(n.mceCmd,!1,"")}),e.append(o.append(a))}),e}()})])),A("confluence-table-enhancements.copy-cut-paste-cols.disabled")||c.Buttons.splice(3,0,new o.Group([new o.Button({text:a("table.col_cut_desc"),iconClass:"".concat(r,"cut-column"),click:function(){p.a.tinymce.execCommand("mceTableCutCol",!1,"")}}),new o.Button({text:a("table.col_copy_desc"),iconClass:"".concat(r,"copy-column"),click:function(){p.a.tinymce.execCommand("mceTableCopyCol",!1,"")}}),new o.Button({text:a("table.col_paste_desc"),iconClass:"".concat(r,"paste-column"),click:function(){p.a.tinymce.execCommand("mceTablePasteColBefore",!1,"")}})])),!A("confluence-table-enhancements.auto-row.disabled")){var u=[];A("confluence-table-enhancements.auto-row.disabled")||u.push({text:a("table.numbering_column_desc"),id:"insert-numbering-column",isChecked:function(){return f()(n.selection.getNode()).closest("table").find(".numberingColumn").length>0},onChange:function(){p.a.tinymce.execCommand("mceTableInsertNumberingCol",!1,"")}}),c.Buttons.push(new s(u))}return c}}};function so(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(e.page||e.date||e.space||("page"==p.a.AJS.params.contentType||"blogpost"==p.a.AJS.params.contentType?e.page=document.getElementById("content-title").value:"comment"==p.a.AJS.params.contentType&&(e.page=p.a.AJS.params.pageTitle)),e.date){var t=e.date.split("/");e.page=["",t[2],t[0],t[1],e.page].join("/")}return e.space&&(e.page="".concat(e.space,":").concat(e.page)),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]),(("page"==p.a.AJS.params.contentType||"blogpost"==p.a.AJS.params.contentType)&&e.page==document.getElementById("content-title").value||"comment"==p.a.AJS.params.contentType&&e.page==p.a.AJS.params.pageTitle)&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=p.a.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){p.a.AJS.log("attachment:dependencyUpdated called: ".concat(e,", ").concat(t));var n=function(e){var t={},n=e.split(":",2);return t.spaceKey=2==n.length&&n[0]||p.a.AJS.params.spaceKey,t.title=n[n.length-1],0==t.title.indexOf("/")&&(t.postingDay=t.title.substr(1,10),t.title=t.title.substr(12)),t.title==document.getElementById("content-title").value&&(t.title=""),t.title||(p.a.AJS.params.newPage?t.draftId=p.a.AJS.params.contentId:t.pageId=p.a.AJS.params.pageId),t}(t);this.getData(n)},n},spacekey:function(e){return p.a.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return p.a.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return p.a.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},p.a.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),p.a.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),p.a.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),p.a.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),p.a.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var o=t.substring(n+1);o&&("doc"==o&&"docx"==o&&(e.name="viewdoc"),"pdf"==o&&(e.name="viewpdf"),"ppt"==o&&"pptx"==o&&(e.name="viewppt"),"xls"==o&&"xlsx"==o&&(e.name="viewxls"))}}}}}n("3eVS");var uo,fo,mo,po,go=n("xODI"),ho=n.n(go),bo="macro-placeholder-property-panel-edit-button",vo="status-macro-title first last editable",yo=13,Co=27,wo="status",xo=["Grey","Red","Yellow","Green","Blue"],ko=xo[0];function To(){Eo();var e=p.a.Confluence.MacroParameterSerializer.deserialize(f()(fo).attr("data-macro-parameters")),t=!1,n=!1;return e&&mo&&(t=e.title!==mo.title,n=e.colour!==mo.colour),t||n}function Eo(){if(po){var e=So(mo)==po.val(),t=""===po.val();e||t?delete mo.title:mo.title=po.val()}}function Ao(){if(!uo||!uo.state||"pending"!==uo.state()){Eo();var e={contentId:p.a.Confluence.Editor.getContentId(),macro:{name:wo,params:mo,defaultParameterValue:"",body:""}};(uo=p.a.tinymce.confluence.MacroUtils.insertMacro(e,fo)).done(function(e,t){!function(e){p.a.tinymce.activeEditor.selection.select(e),$.storeBookmark(),p.a.tinymce.activeEditor.selection.collapse()}(fo=e)}).fail(function(e){0})}}function So(e){return e.colour||e.color||ko}function Io(e){var t=f()("<input/>");return t.attr("class",vo),t.keyup(function(e){return e.keyCode!==yo||(p.a.AJS.Confluence.PropertyPanel.destroy(),!1)}),t.keydown(function(e){return e.keyCode!==Co||function(){return po=null,!0}()}),t}function Mo(e){(po=Io()).val(e.find("span.panel-button-text").text()),e.replaceWith(po),po.select().focus()}function Oo(e){var t=function(e){H.editMacro(f()(e))};((function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf(bo)>-1)return e[t];return null})(e)).click=function(){p.a.AJS.Confluence.PropertyPanel.destroy(),To()?uo.always(t):t(fo)}}var Bo=function(e){var t=(e.attr("data-macro-parameters")||"").split("|"),n={};return t&&f.a.each(t,function(e,t){var o=t.split("=",2);o.length>0&&(n[o[0]]=o.length>1?o[1]:"")}),n},No=function(e){return e.attr("data-macro-name")},Ro=function(){return{"calendar-view-month":"month","calendar-view-week":"week","calendar-view-list":"list","calendar-view-upcoming":"upcoming","calendar-view-timeline":"timeline"}},_o=function(){!function(){f.a.each(Ro(),function(e,t){p.a.AJS.Confluence.PropertyPanel.Macro.registerButtonHandler(e,function(e,n){var o=f()(n);p.a.AJS.Rte.getEditor().selection.select(o[0]),p.a.AJS.Rte.BookmarkManager.storeBookmark(),p.a.tinymce.confluence.MacroUtils.insertMacro({contentId:p.a.Confluence.Editor.getContentId(),macro:{name:No(o),params:f.a.extend(Bo(o),{defaultView:t}),defaultParameterValue:"",body:""}})})})}(),function(){p.a.AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("add-subcalendar",function(e,t){var n=f()(t);p.a.Confluence.TeamCalendars.Dialogs.getAddDialogForMacro({name:No(n),params:Bo(n),defaultParameterValue:"",body:""})})}(),function(){Object(i.a)("created.property-panel",function(e,t){var n=Bo(f()(t.anchor)).defaultView||"month";"upcoming"===n&&(n="list"),f()(".macro-property-panel-calendar-view-".concat(n),t.panel).addClass("selected")})}()},Po=function(){Object(i.a)("init.rte",_o)},Do=n("OGf2"),Ho=n.n(Do);function jo(){return!1}function Lo(){return!0}var Fo=0,zo=(new Date).getTime();function Wo(e){return(e="".concat(e||"")).replace(/\./g,"-")}function Ko(e,t){if(p.a.AJS.EventQueue&&t&&t.attributes.id){var n={},o=Wo(t.attributes.id);n.name="helptips.".concat(o,".").concat(e),n.properties={},p.a.AJS.EventQueue.push(n)}}var Vo={dismissedTipIds:[],loaded:f.a.Deferred(),url:function(){return"".concat(C.a,"/rest/calendar-services/1.0/tips")},sync:function(e,t){return e||(e="get"),t||(t=null),f.a.ajax(this.url(),{type:e,context:this,dataType:"json",contentType:"application/json",data:t&&JSON.stringify(t),processData:!1}).promise()},fetch:function(){if(p.a.AJS.Meta.get("atlassian-account-id")){var e=this.sync();return e.done(function(e){f.a.merge(this.dismissedTipIds,e),this.loaded.resolve()}),e.promise()}},show:function(e){this.loaded.done(e)},dismiss:function(e){var t=e.attributes.id;t?(this.dismissedTipIds.push(t),this.sync("post",{id:t})):e._dismissed=!0},undismiss:function(e){var t=e.attributes.id;t?(this.dismissedTipIds.splice(f.a.inArray(t,this.dismissedTipIds),1),this.sync("delete",{id:t})):e._dismissed=!1},isDismissed:function(e){var t=e.attributes.id;return t?f.a.inArray(t,this.dismissedTipIds)>=0:e._dismissed}},Uo=function(e){this.attributes=f.a.extend({},e),this.attributes.id||(this.attributes.id=!1),this.attributes.body&&(this.attributes.bodyHtml=this.attributes.body,delete this.attributes.body),this.cid=function(){return"c".concat(zo).concat(Fo++)}();var t=this.attributes.anchor;delete this.attributes.anchor,this.view=t?new $o(this,t):new qo(this),this.view.$el.addClass("tc-aui-help-tip")};f.a.extend(Uo.prototype,{show:function(){var e=this;Vo.show(function(){e.isDismissed()||(e.view.show(),Ko("shown",e))})},dismiss:function(){var e=Wo(arguments[0]||"programmatically");this.view.dismiss(),this.isDismissed()||(Vo.dismiss(this),Ko("dismissed.".concat(e),this))},isVisible:function(){return this.view.$el.is(":visible")},isDismissed:function(){return Vo.isDismissed(this)}});var $o=function(e,t){this.initialize(e,t)};f.a.extend($o.prototype,{initialize:function(e,t){var n=this,o=f()("#rte").height()-t.offset().top<200,a=f()(p.a.AJS.Rte.getEditor().getDoc()).scrollTop();this.model=e,this.beforeHide=jo,this.closeButton=f()(function(e){return'\n    <button class="tc-helptip-close aui-button aui-style"><span>'.concat(e("com.atlassian.confluence.extra.team-calendars.calendar.helptip.close"),"</span></button>\n")}(function(e){return p.a.tinymce.activeEditor.translate(e)})),this.closeButton.click(function(t){e.dismiss("close-button"),t.preventDefault()}),this.popup=p.a.AJS.InlineDialog(t,e.cid,function(t,o,a){t.html(function(e,t){var n="";return e.title&&(n+='<h4 class="tc-helptip-title">'.concat(e.title,"</h4>")),n+='<div class="tc-helptip-body">'.concat(e.bodyHtml,"</div>"),e.url&&(n+='<a class="tc-helptip-link" href="'.concat(e.url,'" target="_blank">').concat(t("calendar3.helptip.learn.more"),"</a>")),n}(e.attributes,function(e){return p.a.tinymce.activeEditor.translate(e)})),t.append(n.closeButton),t.unbind("mouseover mouseout"),t.find(".tc-helptip-link").click(function(){Ko("learn-more.clicked",e)}),a()},{container:"#content",noBind:!0,onTop:o,preHideCallback:function(){return n.beforeHide()},calculatePositions:function(e,n,r,i){var c=p.a.AJS.InlineDialog.opts.calculatePositions(e,n,r,i);return c.popupCss.top=o?f()("#rte").offset().top+t.offset().top-e.height()-9:f()("#rte").offset().top+(t.offset().top-a)+t.height()+9,c.popupCss.left=t.offset().left,c.displayAbove=o,c}}),this._popupHide=this.popup.hide,this.popup.hide=jo,this.$el=f()(this.popup[0]),f()(document).bind("showLayer",function(t,n,o){"inlineDialog"===n&&o.id===e.cid&&(p.a.AJS.InlineDialog.current=null,f()(document.body).unbind("click.".concat(e.cid,".inline-dialog-check")),o._validateClickToClose=jo,o.hide=jo)})},show:function(){var e=this.popup,t=function(t){e.has(t.target).length||(e.shadow.remove(),e.remove())};e.show(),f()("#full-height-container").click(t),p.a.AJS.Rte.getEditor().onClick.add(t)},dismiss:function(){this.beforeHide=Lo,this._popupHide()}});var qo=function(e){this.initialize(e)};f.a.extend(qo.prototype,{initialize:function(){this.$el=f()("<div></div>")},show:function(){},dismiss:function(){}});var Jo=[].concat(a()(function(){return["wr!confluence.web.resources:quicksearchdropdown"]}()),a()(function(){return["wr!com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend"]}()),a()(function(){return["wr!confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE","wr!confluence.web.resources:hint-manager"]}()),a()(function(){return["wr!confluence.web.resources:raphael"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-link-browser:link-object"]}()),a()(function(){return["wr!confluence.web.resources:core"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-link-browser:link-browser-conf-frontend"]}()),a()(function(){return["wr!confluence.extra.jira:macro-browser-resources","wr!confluence.extra.jira:dialogsJs-for-conf-frontend","wr!confluence.extra.jira:jirachart-macro"]}()),a()(function(){return io}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-conf-frontend"]}()),a()(function(){return["wr!confluence.web.resources:breadcrumbs"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources"]}()),a()(function(){return["wr!com.atlassian.confluence.keyboardshortcuts:confluence-keyboard-shortcuts"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-labels:labels-editor"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.content-formatting-macros:content-formatting-macros-resources"]}()),a()(function(){return["wr!confluence.web.resources:ajs","wr!com.atlassian.auiplugin:aui-inline-dialog2","wr!confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-conf-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-invite-to-edit:edit-resources"]}()),a()(function(){return["wr!confluence.macros.multimedia:macro-browser-smart-fields"]}()),a()(function(){return["wr!com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend","wr!com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources-conf-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources"]}()),a()(function(){return["wr!confluence.macros.advanced:editor_includemacro-conf-frontend"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-request-access-plugin:confluence-request-access-plugin-resources"]}()),a()(function(){return["wr!confluence.web.resources:deferred-dialog-loader"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources","wr!com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources","wr!com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-resources"]}()),a()(function(){return["wr!com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser"]}()),a()(function(){return["wr!com.atlassian.confluence.extra.team-calendars:amd","wr!com.atlassian.confluence.extra.team-calendars:user-timezone-setup","wr!com.atlassian.confluence.extra.team-calendars:calendar-init-editor","wr!com.atlassian.confluence.extra.team-calendars:macro-browser-web-resources"]}()),a()(function(){return["wr!confluence.extra.jira:text-placeholders-jira"]}())),Go=["wr!confluence.web.resources.colors:colors","wr!com.atlassian.confluence.keyboardshortcuts:confluence-keyboard-shortcuts","wr!com.atlassian.confluence.editor:editor-resources-conf-frontend","wr!com.atlassian.confluence.plugins.confluence-browser-metrics:editor"].concat(a()(Jo)),Xo=[function(){p.a.tinymce.create("tinymce.plugins.ConfList",function(){return{init:function(e){e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function o(t){return(t=n.getParent(t,n.isBlock))&&parseInt(e.dom.getStyle(t,"margin-left")||0,10)+parseInt(e.dom.getStyle(t,"padding-left")||0,10)>0}return o(t.getStart())||o(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}}()),p.a.tinymce.PluginManager.add("conflist",p.a.tinymce.plugins.ConfList)},function(){p.a.tinymce.PluginManager.add("tasklist",function(e){var t=function(){var t=J(e);t&&function(t){var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n}(t)&&function(e){return a()(e.childNodes).every(function(e){return e.hasAttribute("data-inline-task-id")})}(t)&&e.undoManager.ignore(function(){t.classList.add("inline-task-list")})};function n(t,n){if(function(){var e=p.a.AJS.Meta.get("use-inline-tasks");return"true"===e||!0===e}()||"page"===b.a.get("content-type")||"blogpost"===b.a.get("content-type")){var o=n.handlerManager,a=n.createHandler;o.registerHandler("]".charCodeAt(0),a(q,function(){e.execCommand("InsertInlineTaskList")},!0))}}function o(){e.addQueryStateHandler("InsertInlineTaskList",function(){return G(J(e))}),e.addQueryStateHandler("InsertUnorderedList",function(){return X(J(e))})}e.addCommand("InsertInlineTaskList",function(){"page"!==b.a.get("content-type")&&"blogpost"!==b.a.get("content-type")||e.undoManager.transact(function(){X(J(e))&&(e.execCommand("InsertOrderedList"),Q(J(e))),function(e){var t=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":t,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select('[data-task-list-id="'.concat(t,'"]')).forEach(function(t){var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML="<span class='placeholder-inline-tasks'>".concat(e.translate("tinymce.confluence.placeholder.inline.tasks"),"</span>"),e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")})}(e)})}),e.on("BeforeExecCommand",function(t){"InsertUnorderedList"===t.command&&G(J(e))&&!t.value?e.undoManager.ignore(function(){e.execCommand("InsertOrderedList"),Q(J(e))}):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore(function(){Q(J(e))})}),e.on("execCommand",function(e){"Indent"===e.command&&t()}),e.on("Click",function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,a;if(p.a.tinymce.Env.gecko){var r=n.getBoundingClientRect();o=t.pageX-(r.left+p.a.tinymce.DOM.getViewPort(e.getWin()).x),a=t.pageY-(r.top+p.a.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,a=t.offsetY;return o>=3&&o<=14&&a>=3&&a<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}}),e.on("KeyUp",function(t){if(t.keyCode===p.a.tinymce.util.VK.ENTER&&!t.shiftKey){var n=function(){var t=e.selection.getStart();return t&&t.tagName&&"LI"===t.tagName.toUpperCase()?t:e.dom.getParent(t,"li")}();n&&(e.dom.removeClass(n,"checked"),e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id"))}}),e.on("KeyDown",function(e){e.shiftKey||e.keyCode!==p.a.tinymce.util.VK.TAB||p.a.tinymce.util.VK.metaKeyPressed(e)||t()}),Object(i.a)("confluence.editor.registerHandlers",n),Object(i.a)("rte-ready",o),e.on("Remove",function(){Object(i.c)("confluence.editor.registerHandlers",n),Object(i.c)("rte-ready",o)})})},function(){Object(i.a)("init.rte",Qe)},function(){p.a.tinymce.create("tinymce.plugins.DeleteCommandPlugin",function(){return{init:function(e){e.addCommand("mceDelete",function(t,n){(function(){if(p.a.tinymce.Env.webkit){var t=e.selection.getRng(1);if(t.collapsed)return!1;var n=f()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&L.isRangeAtStartOf(n,t)&&L.isRangeAtEndOf(n,t)){var o=f()(n.firstChild).is("pre")?"pre":"p",a=f()("<".concat(o,"><br data-mce-bogus='1'></").concat(o,">"))[0];return f()(n).html(a),e.selection.select(a,1),!0}}return!1})()||e.getDoc().execCommand("Delete",t,n)})},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("deletecommand",p.a.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e=function(e){var t=new p.a.tinymce.util.Dispatcher,n=p.a.tinymce.Env.ie;return{AUIWindowManager:{init:function(e){e.on("init",function(){e.windowManager=new p.a.tinymce.AUIWindowManager(e)})},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0},open:function(e,t){var o=this;e=e||{},o.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n&&(e.center=!0,e.help=!1,e.dialogWidth="".concat(e.width,"px"),e.dialogHeight="".concat(e.height,"px")),o.features=e,o.params=t,o.eventDispatcher.dispatch("open",{t:o,settings:e,params:t});var a=e.height;e.name&&(a+=56),(t.cancelLink||t.buttons)&&(a+=51),a+=40,e.popup&&(a+=8);var r=e.id||p.a.tinymce.DOM.uniqueId(),i=(new dn).component({width:e.width,height:a,id:r,onCancel:function(){i.hide().remove()}});e.name&&i.addHeader(this.editor.translate("tinymce.".concat(e.name))),this.createDialogButtons(i,t,r),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(i,e,t,r),t.helpLink&&this.createHelpLink(i,t.helpLink,t.helpName,r),t.hintText&&this.createHintText(i,t.hintText,r);var c={id:r,settings:e,params:t,dialog:i};return this.modalDialogsStack.push(c),this.dialogs[r]=c,this.count++,Object(g.b)().BookmarkManager.storeBookmark(),i.show(),void 0!=i.takeFocus&&i.takeFocus(),n&&(f()("#".concat(r)).css("overflow","hidden"),f()("#".concat(r,".").concat(t.cssClass)).css("overflow","hidden")),r},initialiseSettings:function(e){e.width=parseInt(e.width||400,10),e.height=parseInt(e.height||250,10),e.resizable=!1,void 0==e.popup&&(e.popup=!0),e.popup&&void 0!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons:function(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var a=t.buttons[o];e.addButton(this.editor.translate("tinymce.".concat(a.label)),a.action,a.customClass)}t.cancelLink&&e.addCancel(this.editor.translate("tinymce.auiwindowmanager.cancel"),function(){return p.a.tinymce.activeEditor.windowManager.close(n)})},createDialogContent:function(e,t,n,o){var a=this.createContentId(o),r="panel_".concat(a);t.popup?(e.addPanel(r,f()('<iframe id="'.concat(a,'" width="100%" height="').concat(t.height,'px" frameborder="0" name="auidialogiframe" src="').concat(t.file,'" scrolling="').concat(t.scrollbars,'"></iframe>')),n.cssClass),e.takeFocus=function(){f()("#".concat(a)).focus()}):(void 0==t.content?(e.addPanel(r,f()('<div id="'.concat(a,'"/>')),n.cssClass),f()("#".concat(a)).load(t.file)):e.addPanel(r,f()('<div id="'.concat(a,'">').concat(t.content,"</div>")),n.cssClass),e.takeFocus=function(){var e=f()("#".concat(a,":input"));if(e.length)f()(e[0]).focus();else{var t=f()("#".concat(a," .button-panel button"));t.length&&f()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:function(e,t,n){var o=f()("<div></div>").addClass("dialog-tip");o.text(p.a.tinymce.activeEditor.translate("tinymce.".concat(t))),f()("#".concat(n," .dialog-button-panel")).append(o)},createHelpLink:function(e,t,n,o){var a=f()("<div></div>").addClass("dialog-help-link");a.load("".concat(C.a,"/plugins/tinymce/helplink.action"),{linkUrlKey:t,linkNameKey:n||""}),f()("#".concat(o," .dialog-components .dialog-title")).prepend(a)},close:function(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,p.a.tinymce.activeEditor.focus(),Object(g.b)().BookmarkManager.restoreBookmark()),!1},alert:function(e,t,n){var o,a={content:"<p>".concat(e,"</p>"),width:500,height:160,popup:!1},r={buttons:[{label:"auiwindowmanager.ok",action:function(){p.a.tinymce.activeEditor.windowManager.toggleOtherDialogs(o,!0),p.a.tinymce.activeEditor.windowManager.close(o),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"};o=this.open(a,r),this.toggleOtherDialogs(o,!1)},createInstance:function(e,t,n,o,a,r){return new(p.a.tinymce.resolve(e))(t,n,o,a,r)},toggleOtherDialogs:function(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var o=this.modalDialogsStack[n];o.id!=e&&f()("".concat(o.id," .dialog-button-panel")).toggle(t)}},confirm:function(e,t,n,o){o=o||p.a,t.call(n||this,o.confirm(this._decode(this.editor.translate("tinymce.".concat(e)))))},setBusy:function(t,n){var o=this.dialogs[t],a="#".concat(this.createBusyContentId(t)),r="#".concat(this.createContentId(t)),i=f()(r),c=f()(a);if(o)if(n){var l=f()(r);l.hide();var s=l.parent(),d=f()(a,s);d.length||(s.append(f()('<div id="'.concat(a,'" class="spinner"></div>'))),d=f()(a,s),e.spinner(d[0],50,"#666")),f()(".button-panel button",f()("#".concat(t))).each(function(e,t){f()(t).prop("disabled",!0)}),f()(d[0]).show()}else c.length&&c.hide(),f()(".button-panel button",f()("#".concat(t))).each(function(e,t){f()(t).prop("disabled",!1)}),i.show()},logMCESelection:function(e){p.a.tinymce.activeEditor.selection},setDefaultParameters:function(e){return e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e},createContentId:function(e){return"content_".concat(e)},createBusyContentId:function(e){return"content_busy_".concat(e)},resizeBy:function(){}}}}(p.a.Raphael);p.a.tinymce.create("tinymce.plugins.AUIWindowManager",e.AUIWindowManager),p.a.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",e.WindowManager),p.a.tinymce.PluginManager.add("auiwindowmanager",p.a.tinymce.plugins.AUIWindowManager)},function(){!function(){var e=v();p.a.Confluence.PropertyPanel.TextPlaceholder=e,Object(i.a)("init.rte",function(){"template"===b.a.get("content-type")&&Object(i.b)("add-handler.property-panel",e)})}(),p.a.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",y()),p.a.tinymce.PluginManager.add("textplaceholders",p.a.tinymce.plugins.TextPlaceholderPlugin)},function(){p.a.tinymce.create("tinymce.plugins.EmotionsPlugin",function(){return{init:function(e,t){e.addCommand("mceEmotion",function(){e.windowManager.open({file:"".concat(p.a.tinymce.settings.editor_plugin_action_base_path,"/emotions.action"),width:190+parseInt(e.getLang("emotions.delta_width",0)),height:125+parseInt(e.getLang("emotions.delta_height",0)),inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t})}),e.addButton("emotions",{title:"emotions.emotions_desc",cmd:"mceEmotion"}),e.on("Click",function(t){var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return n=e.selection.getRng(!0),(t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n),e.selection.collapse(),p.a.tinymce.dom.Event.cancel(t)})},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("emotions",p.a.tinymce.plugins.EmotionsPlugin)},function(){p.a.tinymce.create("tinymce.plugins.ConfluencePlugin",function(){return{init:function(e){e.addCommand("mceConfUnlink",function(t,n){var o=e.selection,a=n||o.getNode(),r=f()(a);if("A"!==a.nodeName){var i=r.closest("a");if(!i.length)return;a=i[0],r=i}var c=r.attr("href");if(c||(c="#",r.attr("href",c)),!r.attr("data-linked-resource-id")&&un().isExternalLink(c)&&r.text()==function(e){var t=/(.*)[\/]$/.exec(e);return null!=t?t[1]:e}(c)){var l=e.dom.create("span",{class:"nolink"},c);e.dom.replace(l,a,!1)}else o.select(a),r.removeClass("createlink unresolved"),e.execCommand("UnLink")}),e.addButton("confimage",{title:"confluence.confimage_desc",cmd:"mceConfimage"}),e.addButton("conf_macro_browser",{title:"confluence.conf_macro_browser_desc",cmd:"mceConfMacroBrowser"})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("confluence",p.a.tinymce.plugins.ConfluencePlugin)},function(){p.a.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",function(){var e=p.a.tinymce.util.VK;return{init:function(t){var n=this;function o(e){t.on("KeyDown",e),p.a.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function a(e,t){return e&&1===e.childNodes.length&&f()(e).is(t)&&f()(e.firstChild).is("br")}function r(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!f()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",function(){t.on("SetContent",function(e){e.selection&&p.a.tinymce.each(t.dom.select("p > .wysiwyg-macro"),function(e){var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}})})}),t.on("SetContent",function(){p.a.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),function(e){t.dom.select("pre",e).length||(p.a.tinymce.isIE?t.dom.setHTML(e,"<pre></pre>"):t.dom.setHTML(e,"<pre><br /></pre>"))})}),t.on("KeyDown",function(n){var o=t.selection,a=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==f.a.inArray(n.keyCode,a)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=f.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!p.a.tinymce.isMac&&n.altKey)){var r=o.getNode();if(H.isMacroWithBody(r)){var i=f()(".wysiwyg-macro-body",r);i.length>0&&o.select(i[0],!0)}}}),t.on("DblClick",function(e){var t=f()(e.target),n=function(e){return e.closest("[data-macro-name]")}(t);if(n.length){if(n.attr("data-macro-body-type"))if(p.a.tinymce.isIE){if(!t.hasClass("wysiwyg-macro-body")&&!t.hasClass("wysiwyg-macro"))return}else if(t.closest(".wysiwyg-macro-body").length)return;H.editMacro(n),p.a.AJS.Confluence.PropertyPanel&&p.a.AJS.Confluence.PropertyPanel.current&&p.a.AJS.Confluence.PropertyPanel.destroy()}}),t.addCommand("mceConfRemoveMacro",function(e){f()(e).remove(),p.a.tinymce.isGecko&&t.execCommand("mceRepaint",!1)}),n._isCursorInMostNestedElement=r,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t.previousSibling&&!t.nextSibling&&a(t,"p, pre")}(p.a.tinymce.isWebKit||p.a.tinymce.isGecko)&&o(function(n){if(46===n.keyCode&&e(t.selection.getRng(!0)))return p.a.tinymce.dom.Event.cancel(n)}),n._isCursorInLastParagraphOrPre=e}(),function(){p.a.tinymce.isWebKit&&o(function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng(!0),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return r(e)&&1===t.childNodes.length&&f()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!f()(o).is("li")))||p.a.tinymce.dom.Event.cancel(e)})}(),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return 0===e.startOffset&&f()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&f()(t.firstChild).is("br")}p.a.tinymce.isWebKit&&o(function(n){return 8!==n.keyCode||!e(t.selection.getRng(!0))||(t.execCommand("Outdent"),p.a.tinymce.dom.Event.cancel(n))}),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=f()(t);return 0===e.startOffset&&a(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&t.nextSibling&&a(t.nextSibling,"p, pre")}p.a.tinymce.isWebKit&&o(function(n){if(46!==n.keyCode)return!0;var o=t.selection.getRng(!0),a=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,r=f()(a);if(e(o)){var i=a.nextSibling;return r.remove(),t.selection.select(i,!0),p.a.tinymce.dom.Event.cancel(n)}}),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=f()(t);return 0===e.startOffset&&a(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&a(t.previousSibling,"p, pre")}p.a.tinymce.isWebKit&&o(function(n){if(8!==n.keyCode)return!0;var o=t.selection.getRng(!0),a=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,r=f()(a);if(e(o)){var i=a.previousSibling;return r.remove(),t.selection.select(i,!0),p.a.tinymce.dom.Event.cancel(n)}}),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=f()(t);return!(!t||e.startOffset>0)&&(k.normalize(t),t&&0===e.startOffset&&a(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(p.a.tinymce.isWebKit||p.a.tinymce.isGecko)&&o(function(n){return 8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng(!0))?p.a.tinymce.dom.Event.cancel(n):void 0)}),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function a(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&r(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&r(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function c(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&r(e)&&!t.previousSibling&&!t.nextSibling}function l(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&r(e)&&!t.previousSibling&&!t.nextSibling}(p.a.tinymce.isWebKit||p.a.tinymce.isGecko)&&o(function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng(!0),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!f()(o).closest(".wysiwyg-macro-body").size()||(k.normalize(o),!(46===e.keyCode&&(a(n)||c(n))||8===e.keyCode&&(i(n)||l(n)))||(o.lastChild&&!f()(o.lastChild).is("br")&&f()(o).append("<br/>"),f()(o.firstChild).remove(),t.selection.select(o,1),p.a.tinymce.dom.Event.cancel(e)))}),n._isCursorBehindOnlyCharacterInNestedElement=a,n._isCursorAfterOnlyCharacterInNestedElement=i,n._isCursorBehindOnlyChildInNestedElement=c,n._isCursorAfterOnlyChildInNestedElement=l}(),function(){function e(e){return!e.collapsed&&0===e.startOffset&&a(e.startContainer,function(e){return!e.previousSibling})&&function(e,t){return!!e&&(3===e.nodeType?t===e.nodeValue.length:1===e.nodeType&&(1===e.childNodes.length&&f()(e.firstChild).is("br")?0===t:t===e.childNodes.length))}(e.endContainer,e.endOffset)&&a(e.endContainer,function(e){return!e.nextSibling})}function a(e,t){if(!e)return!1;if(f()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!f()(e).is(".wysiwyg-macro-body"));return!0}p.a.tinymce.isWebKit&&o(function(n){if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng(!0);if(e(o)){var a=f()(o.startContainer).closest(".wysiwyg-macro-body");if(a.length>0){var r,i=f()(a[0].firstChild).is("pre");return t.undoManager.add(),a.empty(),r=i?f()("<pre><br/></pre>").appendTo(a):f()("<p><br/></p>").appendTo(a),t.selection.select(r[0],!0),p.a.tinymce.dom.Event.cancel(n)}}return!0}),n._isMacroBodySelected=e}(),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=f()(t);return 0===e.startOffset&&a(t,"p")&&n.next().is("table")}p.a.tinymce.isWebKit&&o(function(n){if(46===n.keyCode&&e(t.selection.getRng(!0)))return p.a.tinymce.dom.Event.cancel(n)}),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function a(e){return e?3===e.nodeType?e:a(e.firstChild)||a(e.nextSibling):null}function r(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:r(e.previousSibling)||r(e.parentNode):null}function i(e){var t,n;return f()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(r(e.startContainer)||(t=a(function e(t){return!t||f()(t.parentNode).is(".wysiwyg-macro td")?null:f()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=f()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(r(e.startContainer)||(t=a(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}p.a.tinymce.isWebKit&&p.a.tinymce.isMac&&o(function(n){var o=t.selection.getRng();if((n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var a=i(o);if(a!==o)return t.selection.setRng(a),p.a.tinymce.dom.Event.cancel(n)}}),n._selectTillStart=i}(),function(){t.on("KeyDown",function(e){if(e.keyCode===p.a.tinymce.util.VK.TAB){var n=t.selection.getRng(1),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(f()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var a=t.getDoc().createTextNode("\t");return n.insertNode(a),t.selection.setCursorLocation(a,1),t.undoManager.add(),p.a.tinymce.dom.Event.cancel(e)}}})}()},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}()),p.a.tinymce.PluginManager.add("macroplaceholder",p.a.tinymce.plugins.MacroPlaceHolderPlugin)},function(){Object(xt.a)(p.a.document,"initContextToolbars.Toolbar",function(e){lo().initContextToolbars(e),function(){(function(e){var t={},n={},o=function(e,n){var o,a;for(a in t)if(t.hasOwnProperty(a)&&t[a].isEnabled)for(var r=0,i=t[a].events.length;r<i;r++)(o=t[a].events[r]).type.toLowerCase().indexOf(n.type)>-1&&(o.shouldTrigger(e,n)?o.callback.apply(this,[n.target]):o.missed&&o.missed())};return{addEventsForComponent:function(a,r){a in t||(t[a]={},t[a].events=[],t[a].isEnabled=!0);for(var i=function(i,c){!(r[i].type in n)&&function(){n[r[i].type]=!0,e[r[i].type].add(o)}(),"function"!=typeof r[i].shouldTrigger&&function(e){r[i].shouldTrigger=function(t,n){return n.target.tagName.toLowerCase()==e}}(r[i].shouldTrigger),t[a].events.push(r[i])},c=0,l=r.length;c<l;c++)i(c)},disableEventsForComponent:function(e){for(var n=0,o=t.length;n<o;n++)if(e in t)return t[e].isEnabled=!1,!0;return!1},enableEventsForComponent:function(e){for(var n=0,o=t.length;n<o;n++)if(e in t)return t[e].isEnabled=!0,!0;return!1}}})(p.a.tinymce).addEventsForComponent("TableToolbar",hn)}()})},function(){var e=Object(S.N)(S.a)?xn:kn;mn(),gn(),p.a.tinymce.create("tinymce.plugins.customtoolbar",e()),p.a.tinymce.PluginManager.add("customtoolbar",p.a.tinymce.plugins.customtoolbar)},function(){p.a.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",Hn),p.a.tinymce.PluginManager.add("insertwikimarkup",p.a.tinymce.plugins.InsertWikiMarkupPlugin)},function(){p.a.tinymce.create("tinymce.plugins.PropertyPanel",W()),p.a.tinymce.PluginManager.add("propertypanel",p.a.tinymce.plugins.PropertyPanel)},function(){},function(){p.a.tinymce.create("tinymce.plugins.ConfMonospacePlugin",function(){return{init:function(e){e.addCommand("confMonospace",function(){e.formatter.toggle("monospace",void 0)}),p.a.tinymce.activeEditor.on("Init",function(){var e=p.a.tinymce.activeEditor;e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")}),e.addButton("monospace",{title:"monospace",cmd:"confMonospace"})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("confmonospace",p.a.tinymce.plugins.ConfMonospacePlugin)},function(){p.a.tinymce.create("tinymce.plugins.KeyboardShortcutsPlugin",function(){return{init:function(e){for(var t=1;t<7;t++)e.addCommand("FormatBlock-h".concat(t),ao(e,"h".concat(t)));e.addCommand("FormatBlock-p",ao(e,"p")),e.addCommand("FormatBlock-pre",ao(e,"pre")),e.addCommand("FormatBlock-blockquote",ao(e,"blockquote")),e.addCommand("mceConfShortcutDialog",p.a.Confluence.KeyboardShortcuts.openDialog),e.addCommand("preventDefaultSave",function(){}),e.addCommand("publish",no),e.addCommand("preview",oo),e.addCommand("confDefaultTable",to),e.addButton("help",{title:"confluence.conf_shortcuts_help_desc",cmd:"mceConfShortcutDialog"});var n=p.a.document.createElement("meta"),o=p.a.document.querySelector("head");n.setAttribute("name","ajs-use-keyboard-shortcuts"),n.setAttribute("content","true"),o.appendChild(n),A("editor.spa.uxenhancements")&&Object(i.a)("rte-ready",function(){eo(e),Yn(e,Zn)})},getInfo:function(){return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("keyboardshortcuts",p.a.tinymce.plugins.KeyboardShortcutsPlugin)},function(){p.a.tinymce.create("tinymce.plugins.ConfCharmapPlugin",function(){return{init:function(e){e.addCommand("confCharmap",function(){e.windowManager.open({id:"insert-char-dialog",url:"".concat(p.a.tinymce.settings.editor_plugin_action_base_path,"/charmap.action"),width:600+parseInt(e.getLang("advanced.charmap_delta_width",0)),height:290+parseInt(e.getLang("advanced.charmap_delta_height",0)),inline:!0,name:"advanced.charmap_desc"})})},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("confcharmap",p.a.tinymce.plugins.ConfCharmapPlugin)},function(){var e=this,t=".wysiwyg-macro,.placeholder,table";p.a.tinymce.create("tinymce.plugins.CursorTargetPlugin",function(){return{cursorTarget:{addFixSelector:function(e){t+=",".concat(e)}},cursorTargetPlugin:{init:function(n){var o=!0,a="ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6",r=f.a.ui.keyCode;function c(e,n){f()(t,e).each(function(e,o){!function(e,n){var o=f()(e);function r(e){if(0===e.length)throw new Error("no paragraph element specified");l()&&e.addClass("auto-cursor-target");var t=e[0];return 0===t.childNodes.length&&(t.innerHTML="<br />"),t}function i(e){return!f()(e).is(a)}function c(e,t){var n=f()("<p/>");if(f()(e.parentNode).is("li, td, th"))for(;e[t]&&i(e[t]);)n["previousSibling"==t?"prepend":"append"](e[t]);return r(n)}(!o.prev().length||o.prev(t).length||f()(e.parentNode).is("li, td, th")&&i(e.previousSibling))&&o.before(c(e,"previousSibling")),(!o.next().length||o.next(".synchrony-container").length||f()(e.parentNode).is("li, td, th")&&i(e.nextSibling))&&o.after(c(e,"nextSibling")),l()&&o.next().length&&!o.next().next().length&&d(o.next()[0])&&o.next().addClass("auto-cursor-target"),n&&function(e){function n(e){("BR"===e[0].nodeName||d(e[0]))&&e.replaceWith(r(f()("<p/>")))}var o=e.prev();o.length&&function(e){for(var n=e.prev();n.length&&!n.is(t);){var o=n[0];if("BR"!==o.nodeName&&"P"!==o.nodeName)return!1;n=n.prev()}return!0}(o)&&n(o);var a=e.next();a.length&&function(e){for(var n=e.next();n.length&&!n.is(t);){var o=n[0];if("BR"!==o.nodeName&&"P"!==o.nodeName)return!1;n=n.next()}return!0}(a)&&n(a)}(o)}(o,n)})}function l(){return"page"===b.a.get("content-type")||"blogpost"===b.a.get("content-type")}function s(e){return f()("p",e).each(function(e,t){d(t)&&u(t)&&f()(t).attr("data-tag","marked-for-deletion")}),f()("p[data-tag=marked-for-deletion]",e).remove(),e}function d(e){return 1===e.nodeType&&0===e.childNodes.length||function(e){for(var t=0,n=0,o=0,a=e.childNodes.length;o<a;o++){var r=e.childNodes[o];if("BR"===r.nodeName){if(++t>1)return!1}else if(/^[\s|\u00A0]$/.test(r.nodeValue)){if(++n>1)return!1}else if(""!==r.nodeValue)return!1}return!0}(e)}function u(e){if(!e||1!==e.nodeType)return!1;var n=h(e,!1),o=h(e,!0),a=m(n)||f()(n).is(t),r=m(o)||f()(o).is(t),i=m(n)&&m(o);return a&&r&&!i}function m(e){return!e||e.className&&/cell|header|footer/.test(e.className)}function h(e,t){var n=f()(e);do{var o=t?n[0].nextSibling:n[0].previousSibling;if(o)return o;n=n.parent()}while(n.length>0&&!n.is(".cell, .mceContentBody, td, li"));return null}function v(e){var t=e.startContainer;return 3===t.nodeType?!(t.previousSibling&&(3===t.previousSibling.nodeType||f()(t.previousSibling).is("br")))&&0===e.startOffset:1===t.nodeType&&0===e.startOffset}function y(e,t){return t.startContainer==t.endContainer&&1===t.startContainer.nodeType&&function(e,t){var n=t.startOffset;return e||n--,n>=0&&n<t.startContainer.childNodes.length&&"TABLE"===t.startContainer.childNodes[n].nodeName}(e,t)}function C(e){if(!e.collapsed)return!1;var t,n=e.startContainer;if(3===n.nodeType)return t=h(n,!0),e.startOffset==n.nodeValue.length&&(null==t||f()(t).is("br"));if(1===n.nodeType){if(f()(n).is("td, th")&&0===e.startOffset&&n.childNodes.length>0)return f()(n.childNodes[0]).is("br");var o=0===e.startOffset?0:e.startOffset-1;return null==(t=h(n.parentNode.childNodes[o],!0))||f()(t).is("br")}return!1}function w(e){return e&&1===e.childNodes.length&&f()(e.childNodes[0]).is("br")}function x(e,t){return!(!p.a.tinymce.isWebKit||!y(!1,t))||!(!p.a.tinymce.isGecko||!(C(t)||u(e)&&0===t.startOffset&&w(e)))}function k(e,t){return!(!p.a.tinymce.isWebKit||!(y(!0,t)||v(t)&&u(e)||function(e){var t=n.getBody();return!!t.childNodes.length&&e.collapsed&&0===e.startOffset&&t.childNodes[0]==e.startContainer}(t)))||!!(p.a.tinymce.isGecko&&v(t)&&u(e)&&w(e))}function T(e){var t=p.a.tinymce.activeEditor,n=e.keyCode;return n!==r.BACKSPACE&&n!==r.DELETE||(t.selection.isCollapsed()?n===r.BACKSPACE&&k(t.selection.getNode(),t.selection.getRng(o))?p.a.tinymce.dom.Event.cancel(e):n===r.DELETE&&x(t.selection.getNode(),t.selection.getRng(o))&&p.a.tinymce.dom.Event.cancel(e):c(t.getBody()),!0)}var E=function(){c(n.getBody(),!0)},A=function(e){c(e,!1),p.a.tinymce.isIE10&&function(e){f()("p, td.confluenceTd, th.confluenceTh",e).each(function(e,t){(function(e){return e&&""===e.innerHTML})(t)&&f()(t).html("<br />")})}(e)};if(l()){var S=function(){A(n.getBody())};Object(i.a)("cursor-target-refresh",S),n.on("Remove",function(){Object(i.c)("cursor-target-refresh",S)})}else n.on("SetContent",function(){var e=p.a.tinymce.activeEditor;c(e.getBody()),function(e){var t=p.a.tinymce.isIE?"&nbsp;":"<br/>";f()("p, td.confluenceTd, th.confluenceTh",e).each(function(e,n){(function(e){return e&&e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0)})(n)&&f()(n).html(t)})}(e.getBody())}),n.on("GetContent",function(e){var t="<div class='root-node'>"+e.content+"</div>",o=s(f()(t)),a=f.a.extend({},e,{getInner:!1}),r=n.serializer.serialize(o[0],a);e.content=r.substring("<div class='root-node'>".length,r.length-"</div>".length)}),n.on("init",function(){var e=p.a.tinymce.activeEditor;e.dom.events.bind(e.selection,"SetContent",E),e.dom.events.bind(e.getBody(),"cut",E),Object(i.a)("cursor-target-refresh",E)}),n.on("Remove",function(){Object(i.c)("cursor-target-refresh",E)}),p.a.tinymce.isGecko&&n.on("KeyDown",function(e){e.keyCode!==r.ENTER&&e.keyCode!==r.BACKSPACE&&e.keyCode!==r.DELETE||n.selection.normalize()}),n.on("KeyDown",T),n.on("KeyUp",T),p.a.tinymce.isGecko&&n.on("KeyPress",T),n.on("Paste",E);f.a.extend(e,{isCursorBeforeAfterTable:y,isCursorTarget:u,_isTextContainerEmpty:d,_removeCollaborativeEditorCursorTargets:function(e){var t=f()("<div>");return t.html(e),t.find("p.auto-cursor-target").each(function(e,t){t.remove()}),t.html()},_processCursorTargets:s,_isCursorAtStartOfContainer:v,_isCursorAtEndOfContainer:function(e){var t=e.startContainer;if(3===t.nodeType)return!(t.nextSibling&&(3===t.nextSibling.nodeType||f()(t.nextSibling).is("br")))&&e.endOffset==t.nodeValue.length;if(1===t.nodeType){var n=t.childNodes[e.startOffset];return!(!f()(n).is("br")||null!=n.nextSibling)||e.endOffset==t.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:h,_doesContainerHaveNestedContent:function e(t){var n,o=f()(t).children();for(n=0;n<o.length;n++)if(!d(o[n])&&(f()(o[n]).contents().filter(function(){return 3===this.nodeType}).length||e(o[n])))return!0;return!1},_addCursorTargetParagraphsToContent:c,_isCursorAtEndOfBottomRightCellInTable:C,_shouldCancelDelete:x,_shouldCancelBackspace:k,_collabEditingCursorTargetRefresh:A}),p.a.AJS.Rte.Cursor=Object(g.b)().Cursor||{},f.a.extend(p.a.AJS.Rte.Cursor,{isTextContainerEmpty:d,fixCursorTargets:c})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}}().cursorTargetPlugin),p.a.tinymce.PluginManager.add("cursorTarget",p.a.tinymce.plugins.CursorTargetPlugin)},function(){p.a.tinymce.create("tinymce.plugins.iOSEditing",function(){return{init:function(e){p.a.tinymce.Env.iOS&&setTimeout(function(){f()(e.getBody()).addClass("ios")},0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("iosediting",p.a.tinymce.plugins.iOSEditing)},function(){p.a.tinymce.create("tinymce.plugins.aeTable",Te()),p.a.tinymce.PluginManager.add("aeTable",p.a.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",function(n){t.cleanLinks(e,n)}),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,o=n.parser[n.strictMode?"strict":"loose"].exec(e),a={},r=14;r--;)a[n.key[r]]=o[r]||"";return a[n.q.name]={},a[n.key[12]].replace(n.q.parser,function(e,t,o){t&&(a[n.q.name][t]=o)}),a}e.prototype={addHandler:function(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort(function(e,t){return e.weight-t.weight}),this.handlers=[];for(var n=this.weightedHandlers.length,o=0;o<n;o++)this.handlers.push(this.weightedHandlers[o].handler)},cleanLinks:function(e){return f()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0},callHandlers:function(e){var o=0,a=this,r=f()(e),i=f()(e).clone(),c=i.attr("href"),l=t(n(c));function s(e){if(e&&(1!==e.length||!e.attr("href")))return u(e);if(e)o=0,l=t((i=e).attr("href")),d(a.handlers[o],l,i);else{if(!(++o<a.handlers.length))return u(i);d(a.handlers[o],l,i)}}function d(e,t,n){var o,r=s;o=setTimeout(function(){r=function(){},s()},p.a.tinymce.plugins.Autoconvert.callbackTimeout),e(t,n,function(){clearTimeout(o),r.apply(a,arguments),r=function(){}})}function u(e){a.editor.undoManager.beforeChange();var t=a.editor.selection,n=a.editor.selection.getBookmark();r.replaceWith(e),t.moveToBookmark(n),a.editor.undoManager.add()}0!==this.handlers.length&&d(this.handlers[0],l,i)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var o={macro:e,contentId:b.a.get("content-id")};f.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(C.a,"/rest/tinymce/1/macro/placeholder"),data:f.a.toJSON(o),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,o){var a=["{",t.name],r=!0;for(var i in t.defaultParameterValue&&(a.push(":",t.defaultParameterValue),r=!1),t.params)r?(a.push(":"),r=!1):a.push("|"),a.push(i,"=",t.params[i]);a.push("}"),e.getHtmlFromWikiMarkup(a.join(""),function(e){n(f()(e)[0])},function(){o()})},e.getHtmlFromWikiMarkup=function(e,t,n){var o={wiki:e,entityId:b.a.get("content-id"),spaceKey:b.a.get("space-key")};f.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(C.a,"/rest/tinymce/1/wikixhtmlconverter"),data:f.a.toJSON(o),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")};return{autoConverter:e,plugin:{init:function(t){var n=new e(t);function o(e,o,a){var r=f()(a.node).children("a");1===r.length&&"A"===r[0].tagName&&r.text()===r.attr("href")&&(r.attr("class","atlassian-autoconvert"),setTimeout(function(){var e=f()("a.atlassian-autoconvert",f()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)},0))}p.a.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",function(){f()(document).on("postPaste",o),t.addCommand("addAutoconverter",function(e,t){n.addHandler(t)})}),t.on("remove",function(){f()(document).off("postPaste",o)})},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}}();p.a.tinymce.plugins.Autoconvert=e.autoConverter,p.a.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),p.a.tinymce.PluginManager.add("autoconvert",p.a.tinymce.plugins.AutoconvertPlugin),qe()},function(){Object(i.a)("rte-ready",Je.initializeEditor)},function(){p.a.tinymce.create("tinymce.plugins.draggable",Ge()),p.a.tinymce.PluginManager.add("draggable",p.a.tinymce.plugins.draggable)},function(){p.a.tinymce.create("tinymce.plugins.InsertFiles",function(){return{init:function(e){e.addButton("confluence-insert-files",{title:e.translate("tinymce.confluence.files"),tooltip:"".concat(e.translate("tinymce.confluence.conf_file_desc")," (").concat(e.translate("tinymce.confluence.conf_file_shortcut"),")"),cmd:"mceConfimage",className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-editor-files",locationGroup:"rte-toolbar-group-files",weight:0})},getInfo:function(){return{longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}()),p.a.tinymce.PluginManager.add("insertfiles",p.a.tinymce.plugins.InsertFiles)},function(){p.a.tinymce.create("tinymce.plugins.flextofullsizeplugin",Xe()),p.a.tinymce.PluginManager.add("flextofullsize",p.a.tinymce.plugins.flextofullsizeplugin)},function(){p.a.tinymce.create("tinymce.plugins.Referrer",function(){return{init:function(e){e.on("Init",function(){var e=f()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)})},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("referrer",p.a.tinymce.plugins.Referrer)},function(){A("confluence.table.resizable")&&(p.a.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",function(){var e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>";return{init:function(n){function o(){f()(n.dom.select("table.confluenceTable:not(.".concat("wrapped",")"))).each(function(n,o){f()(o).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each(function(n,o){var a=f()(o);!a.find("> .content-wrapper").length&&a.find(e).length&&a.wrapInner(t)})})}Object(i.a)("rte-ready",o),n.on("Remove",function(){Object(i.c)("rte-ready",o)}),n.on("Change",function(){var o=n.selection;function a(){return o.getBookmark()}function r(e){o.moveToBookmark(e),Object(g.b)().BookmarkManager.storeBookmark()}var i=o.getNode(),c=f()(i);if(i&&c.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=o.getRng();if(e.is("tr")&&f()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),a=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(a,0),t.setEnd(a,0),o.setRng(t)}}(c);var l,s=c.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(s.find(e).length){var d=s.find("> .content-wrapper");d.length?(l=a(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(d),r(l)):s.find("> p").length?(l=a(),s.wrapInner(t),r(l)):(l=a(),s.wrapInner("<p/>").wrapInner(t),r(l))}}f()(n.getWin().document).find(".content-wrapper:empty").remove()})},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}()),p.a.tinymce.PluginManager.add("tableContentWrapper",p.a.tinymce.plugins.TableContentWrapperPlugin))},function(){p.a.tinymce.create("tinymce.plugins.LinkBrowser",function(){var e=Object(sn.a)().Editor.LinkBrowser;return{init:function(t){t.addButton("linkbrowserButton",{title:"confluence.conflink_desc",cmd:"mceConflink",class:"mce_conflink"}),t.addCommand("mceConflink",function(){e.open({bookmarkManager:$})}),t.addCommand("mceConfAttachments",function(){e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:$})})},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("linkbrowser",p.a.tinymce.plugins.LinkBrowser)},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceVersionComment",function(){return{init:function(e){e.on("Init",function(){var t=b.a.get("version-comment");f()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" '.concat(t?'value="'.concat(t,'"'):"",'\n           placeholder="').concat(e("editor.change.comment"),'"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">').concat(e("editor.change.comment"),"</label>\n</span>\n")}(function(t){return e.translate(t)},t))})},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("confluenceversioncomment",p.a.tinymce.plugins.ConfluenceVersionComment)},function(){},function(){console.log("Finished loading Autocomplete base, Macro browser, JIM, Jira chart plugin"),p.a.tinymce.create("tinymce.plugins.AutoCompleteMacro",function(){return{init:function(e){co(e)},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(p.a.tinymce.majorVersion,".").concat(p.a.tinymce.minorVersion)}}}}()),p.a.tinymce.PluginManager.add("autocompletemacro",p.a.tinymce.plugins.AutoCompleteMacro)},function(){A("confluence-table-enhancements.sticky-headers.disabled")||f()(document).ready(st.initialize),A("confluence-table-enhancements.sticky-headers-editor")&&(Object(i.a)("rte-ready",ut.initialize),Object(i.a)("rte-quick-edit-push-state",ut.initialize),Object(i.a)("rte-quick-edit-push-hash",ut.initialize))},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",ft),p.a.tinymce.PluginManager.add("confluenceleavecomment",p.a.tinymce.plugins.ConfluenceLeaveComment)},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",mt),p.a.tinymce.PluginManager.add("confluenceleavetemplate",p.a.tinymce.plugins.ConfluenceLeaveTemplate)},function(){var e=Object(S.N)(S.a)?Tt:Et;!function(){p.a.Confluence.Editor.SearchManager=wt()}(),kt(),p.a.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",e()),p.a.tinymce.PluginManager.add("searchreplace",p.a.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceDrafts",pt()),p.a.tinymce.PluginManager.add("confluencedrafts",p.a.tinymce.plugins.ConfluenceDrafts)},function(){},function(){},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",gt),p.a.tinymce.PluginManager.add("confluencemacrobrowser",p.a.tinymce.plugins.ConfluenceMacroBrowser)},function(){ho.a._insertCss(),p.a.AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function(e,t,n){fo=e,Oo(t),mo=p.a.Confluence.MacroParameterSerializer.deserialize(f()(fo).attr("data-macro-parameters")),po=null,t.splice(1,0,function(e){return{className:vo,text:Ee(e),click:Mo}}(function(e){return e.title||So(e)}(mo)))},"status"),function(){f.a.each(xo,function(e,t){p.a.AJS.Confluence.PropertyPanel.Macro.registerButtonHandler(t,function(e,n){mo.colour=t,p.a.AJS.Confluence.PropertyPanel.destroy()},wo)})}(),Object(i.a)("destroyed.property-panel",function(){To()&&Ao()})},function(){},function(){},function(){},function(){p.a.AJS.MacroBrowser.Macros.code=jn},function(){},function(){},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceWatch",ht),p.a.tinymce.PluginManager.add("confluencewatch",p.a.tinymce.plugins.ConfluenceWatch)},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",bt),p.a.tinymce.PluginManager.add("confluencesortabletablesplugin",p.a.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){p.a.tinymce.create("tinymce.plugins.AutoResizePlugin",vt),p.a.tinymce.PluginManager.add("autoresize",p.a.tinymce.plugins.AutoResizePlugin)},function(){},function(){},function(){p.a.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",Nt),p.a.tinymce.PluginManager.add("confluencenotifywatchers",p.a.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){!function(){p.a.AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",function(e,t){for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),o={},a=0;a<n.length;a++){var r=n[a].split("=");r.length>1&&(o[r[0]]=r[1])}var i=p.a.AJS.Meta.get("page-id"),c=p.a.AJS.Meta.get("content-type");function l(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n="".concat(n).concat(e,"=").concat(encodeURI(t))),n}o.space||(o.space=p.a.AJS.Meta.get("space-key"));var s=p.a.AJS.Meta.get("context-path")+"/plugins/servlet/oc/getattachment?";s=l("title",o.page,s),s=l("date",o.date,s),s=l("space",o.space,s),s=l("contexttype",c,s=l("contextid",i,s=l("filename",o.name,s)));var d=p.a.AJS.$.browser&&p.a.AJS.$.browser.msie?"_blank":"download-office-attachment";p.a.open(s,d)})}(),so()},function(){},Y.a,function(){p.a.tinymce.create("tinymce.plugins.TableAnalytics",Ht),p.a.tinymce.PluginManager.add("tableAnalytics",p.a.tinymce.plugins.TableAnalytics)},function(){Object(i.a)("init.rte",ro)},function(){Object(i.a)("init.rte",function(){Object(xt.c)(document,"postPaste",jt),Object(xt.a)(document,"postPaste",jt),p.a.tinymce.activeEditor&&p.a.tinymce.activeEditor.on("Remove",function(){Object(xt.c)(document,"postPaste",jt)})})},function(){p.a.tinymce.create("tinymce.plugins.ConfIndentation",Lt),p.a.tinymce.PluginManager.add("confindentation",p.a.tinymce.plugins.ConfIndentation)},function(){},function(){p.a.tinymce.create("tinymce.plugins.TextPatternPlugin",Kt),p.a.tinymce.PluginManager.add("aetextpattern",p.a.tinymce.plugins.TextPatternPlugin)},function(){p.a.require("confluence-request-access-plugin/grant-access").initWhenEditorReady()},function(){},d.b,function(){Object(g.b)().BookmarkManager=U},function(){p.a.tinymce.Env.gecko&&Object(i.a)("rte-ready",ln)},function(){12===p.a.tinymce.Env.ie&&Object(i.a)("rte-ready",ln)},function(){p.a.tinymce.create("tinymce.plugins.PersistScrollPosition",tn),p.a.tinymce.PluginManager.add("persit_scroll_position",p.a.tinymce.plugins.PersistScrollPosition)},function(){Po(),function(){Ho.a._insertCss(),void 0===p.a.Confluence.TeamCalendars&&(p.a.Confluence.TeamCalendars={}),p.a.Confluence.TeamCalendars.HelpTip=Uo,p.a.Confluence.TeamCalendars.HelpTip.Manager=Vo,Vo.fetch()}()},function(){p.a.tinymce.create("tinymce.plugins.FabricMigration",rn),p.a.tinymce.PluginManager.add("fabric_migration",p.a.tinymce.plugins.FabricMigration)}],Qo=function(){return Xo.forEach(function(e,t){try{e()}catch(n){s("initError",{fnName:e.name||t,message:n.message||"",exceptionName:n.name||""})}}),!0},Yo=!1;t.default=function(){if(!Yo){var e=window.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},function(){p.a.tinymce.confluence=p.a.tinymce.confluence||{},p.a.tinymce.confluence.macrobrowser=D}(),Object(cn.a)(),function(){p.a.tinymce.confluence=p.a.tinymce.confluence||{},p.a.tinymce.confluence.NodeUtils=x}(),function(){p.a.tinymce.confluence=p.a.tinymce.confluence||{},p.a.tinymce.confluence.MacroUtils=_}(),Yo=!0,r.a.require(Go).then(Qo,function(){s("wrmLoadError",{})})}}},Rbpl:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,".tc-aui-help-tip.aui-inline-dialog>.contents{-ms-box-sizing:border-box;box-sizing:border-box;padding:16px;position:relative}.tc-aui-help-tip.aui-inline-dialog .tc-helptip-body,.tc-aui-help-tip.aui-inline-dialog .tc-helptip-link,.tc-aui-help-tip.aui-inline-dialog .tc-helptip-title{margin-bottom:.5em}.tc-aui-help-tip.aui-inline-dialog .tc-helptip-body{color:#292929}.tc-aui-help-tip.aui-inline-dialog .tc-helptip-title{color:#292929;font-weight:400;margin:0}.tc-aui-help-tip.aui-inline-dialog .tc-helptip-body h3{margin-top:0}",""])},VRGO:function(e,t,n){var o=n("ILgc");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},"WM+X":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var o=n("bfgX"),a=n("Q2fH"),r=n("Jygk"),i=n.n(r),c=n("bQlP"),l=n("ieax"),s=n.n(l),d=n("dHP6"),u=function(){return i.a.document.querySelector("#rte-toolbar .toolbar-primary")},f=function(){var e=function(){return i.a.document.querySelector("#content.edit")}();(e||function(){return i.a.document.querySelector(".editor-container")}()).classList.add("adg3-editor"),e&&i.a.document.body.classList.add("adg3-editor")},m=function(){var e=i.a.tinymce.activeEditor;!function(e){var t='<style id="adg3-styles" type="text/css">'.concat(s.a._getCss(),"</style>"),n=e.getDoc().head;e.getBody().classList.add("adg3-editor"),n.insertAdjacentHTML("beforeend",t)}(e),function(){var e=i.a.document.querySelector("div.aui-toolbar2-secondary"),t=i.a.document.querySelector("ul#avatar-list"),n=i.a.document.querySelector("#synchrony-presence-overlay");e&&t&&n&&(e.appendChild(t),e.appendChild(n))}(),function(){u().insertAdjacentHTML("afterbegin",'\n        <ul class="aui-buttons">\n            ## ADG3 editor logo\n            <li id="adg3-charlie-icon">\n                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40px" height="40px" viewBox="10 9 20 21" version="1.1">\n                    <defs>\n                        <linearGradient x1="87.3894879%" y1="99.2165215%" x2="35.1317389%" y2="39.2162895%" id="linearGradient-1">\n                            <stop stop-color="#A5ADBA" offset="0%"/>\n                            <stop stop-color="#C1C7D0" offset="100%"/>\n                        </linearGradient>\n                        <linearGradient x1="14.1838118%" y1="5.80047897%" x2="61.141783%" y2="70.9663868%" id="linearGradient-2">\n                            <stop stop-color="#A5ADBA" offset="0%"/>\n                            <stop stop-color="#C1C7D0" offset="100%"/>\n                        </linearGradient>\n                    </defs>\n                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <g id="confluence-light" fill-rule="nonzero">\n                            <path d="M10.0679208,24.8931748 C9.85301417,25.243638 9.61165744,25.6503075 9.40666954,25.9743206 C9.22318946,26.2843791 9.32168891,26.6842575 9.62818873,26.8736224 L13.9263221,29.5186276 C14.0771954,29.6117793 14.2591589,29.6404355 14.4313594,29.5981625 C14.6035598,29.5558895 14.7515684,29.4462293 14.8421552,29.2938021 C15.0140805,29.0061578 15.2355997,28.6325508 15.4769564,28.2324938 C17.1796785,25.4221758 18.8923193,25.7660265 21.9803628,27.2406169 L26.2421274,29.2673521 C26.4035355,29.3441777 26.5891716,29.3523812 26.7567273,29.2900928 C26.924283,29.2278045 27.0594818,29.1003316 27.1315104,28.9367264 L29.1780831,24.3079674 C29.3226768,23.9773763 29.1755503,23.5919046 28.8474575,23.4417282 C27.9481557,23.0185274 26.159471,22.175432 24.5493241,21.3984617 C18.7567628,18.5881437 13.8337469,18.7732941 10.0679208,24.8931748 Z" id="Shape" fill="url(#linearGradient-1)"/><path d="M29.3400897,14.0618786 C29.5549964,13.7114154 29.7963531,13.3047459 30.001341,12.9807328 C30.1848211,12.6706743 30.0863216,12.2707959 29.7798218,12.081431 L25.4816884,9.43642585 C25.3287553,9.33452192 25.1403124,9.30085833 24.961556,9.343509 C24.7827995,9.38615966 24.6298552,9.50127703 24.5394053,9.66125129 C24.36748,9.9488956 24.1459608,10.3225026 23.9046041,10.7225596 C22.201882,13.5328776 20.4892412,13.1890269 17.4011977,11.7144365 L13.1526581,9.6910076 C12.99125,9.61418193 12.805614,9.60597847 12.6380582,9.66826684 C12.4705025,9.73055522 12.3353038,9.85802811 12.2632751,10.0216332 L10.2167024,14.6503923 C10.0721087,14.9809834 10.2192353,15.366455 10.547328,15.5166315 C11.4466298,15.9398323 13.2353145,16.7829277 14.8454614,17.559898 C20.6512477,20.3669097 25.5742636,20.1817593 29.3400897,14.0618786 Z" id="Shape" fill="url(#linearGradient-2)"/>\n                        </g>\n                    </g>\n                </svg>\n            </li>\n        </ul>\n    '),i.a.document.querySelector("#adg3-charlie-icon").addEventListener("click",function(){Object(d.b)("ADG3-Editor-Atlas-Logo-Clicked")})}(),function(e){var t=i.a.document.querySelector("#rte-button-pagelayout-2"),n=i.a.document.querySelector("#rte-button-searchreplace"),o=function(){t.classList.remove("active"),Object(a.b)(i.a.document,"disableContextToolbarRow.Toolbar",{id:"pl2-toolbar"})},r=function(){Object(a.b)(i.a.document,"disableContextToolbarRow.Toolbar",{id:"default"})},c=function(){l(n)&&e.execCommand("mceSearchReplaceToolbar")},l=function(e){return e.classList.contains("active")};t.addEventListener("click",function(){r(),c()}),n.addEventListener("click",function(){o(),r()}),Object(a.a)(i.a.document,"enableContextToolbarRow.Toolbar",function(e,t){t&&t.id&&"default"===t.id&&(o(),c())})}(e),function(){var e=i.a.document.querySelector(".toolbar-trigger[data-control-id=help]");Object(a.a)(e,"click",function(){this.parentElement.classList.contains("disabled")&&i.a.Confluence.KeyboardShortcuts.openDialog()})}(),function(){var e=i.a.document.querySelector("div.aui-toolbar2-secondary");if(e){var t=i.a.document.createElement("div");t.classList.add("adg3InviteToEdit"),e.appendChild(t)}}(),function(e){e.forEach(function(e){!function(e){e&&(e.remove?e.remove():e.removeNode(!0))}(i.a.document.querySelector(e))})}(["#rte-toolbar #macro-insert-list .dropdown-item.macro-gallery"])};t.b=function(){i.a.tinymce.create("tinymce.plugins.Adg3Editor",function(){return{init:function(){Object(o.c)("rte-ready",m),Object(c.N)(c.a)&&Object(o.a)("rte-ready",m)},getInfo:function(){return{longname:"Adg3 Themed Editor",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(i.a.tinymce.majorVersion,".").concat(i.a.tinymce.minorVersion)}}}}()),i.a.tinymce.PluginManager.add("Adg3Editor",i.a.tinymce.plugins.Adg3Editor)}},XxhQ:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,".adg3-editor .synchrony-tpi-0{background-color:#172b4d}.adg3-editor .synchrony-tpi-1{background-color:#0049b0}.adg3-editor .synchrony-tpi-2{background-color:#00875a}.adg3-editor .synchrony-tpi-3{background-color:#ff8b00}.adg3-editor .synchrony-tpi-4{background-color:#de350b}.adg3-editor .synchrony-tpi-5{background-color:#5243aa}.adg3-editor .synchrony-tpi-6{background-color:#a5adba}.adg3-editor .synchrony-tpi-7{background-color:#2684ff}.adg3-editor .synchrony-tpi-8{background-color:#57d9a3}.adg3-editor .synchrony-tpi-9{background-color:#5e6c84}.adg3-editor .synchrony-tpi-10{background-color:#ff8f73}.adg3-editor .synchrony-tpi-11{background-color:#998dd9}.adg3-editor .synchrony-tpi-0.synchrony-tps:before{border-left-color:#172b4d}.adg3-editor .synchrony-tpi-0.synchrony-tpe:before{border-right-color:#172b4d}.adg3-editor .synchrony-tpi-1.synchrony-tps:before{border-left-color:#0049b0}.adg3-editor .synchrony-tpi-1.synchrony-tpe:before{border-right-color:#0049b0}.adg3-editor .synchrony-tpi-2.synchrony-tps:before{border-left-color:#00875a}.adg3-editor .synchrony-tpi-2.synchrony-tpe:before{border-right-color:#00875a}.adg3-editor .synchrony-tpi-3.synchrony-tps:before{border-left-color:#ff8b00}.adg3-editor .synchrony-tpi-3.synchrony-tpe:before{border-right-color:#ff8b00}.adg3-editor .synchrony-tpi-4.synchrony-tps:before{border-left-color:#de350b}.adg3-editor .synchrony-tpi-4.synchrony-tpe:before{border-right-color:#de350b}.adg3-editor .synchrony-tpi-5.synchrony-tps:before{border-left-color:#5243aa}.adg3-editor .synchrony-tpi-5.synchrony-tpe:before{border-right-color:#5243aa}.adg3-editor .synchrony-tpi-6.synchrony-tps:before{border-left-color:#a5adba}.adg3-editor .synchrony-tpi-6.synchrony-tpe:before{border-right-color:#a5adba}.adg3-editor .synchrony-tpi-7.synchrony-tps:before{border-left-color:#2684ff}.adg3-editor .synchrony-tpi-7.synchrony-tpe:before{border-right-color:#2684ff}.adg3-editor .synchrony-tpi-8.synchrony-tps:before{border-left-color:#57d9a3}.adg3-editor .synchrony-tpi-8.synchrony-tpe:before{border-right-color:#57d9a3}.adg3-editor .synchrony-tpi-9.synchrony-tps:before{border-left-color:#5e6c84}.adg3-editor .synchrony-tpi-9.synchrony-tpe:before{border-right-color:#5e6c84}.adg3-editor .synchrony-tpi-10.synchrony-tps:before{border-left-color:#ff8f73}.adg3-editor .synchrony-tpi-10.synchrony-tpe:before{border-right-color:#ff8f73}.adg3-editor .synchrony-tpi-11.synchrony-tps:before{border-left-color:#998dd9}.adg3-editor .synchrony-tpi-11.synchrony-tpe:before{border-right-color:#998dd9}",""])},c8cs:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon,.wiki-content .aui-lozenge{color:#333;background-color:#ccc;border-color:#ccc}#property-panel a.macro-property-panel-Grey span.icon.aui-lozenge-subtle,.wiki-content .aui-lozenge.aui-lozenge-subtle{color:#333;background-color:#fff;border-color:#ccc}#property-panel a.macro-property-panel-Green span.icon,.wiki-content .aui-lozenge-success{color:#fff;background-color:#14892c;border-color:#14892c}#property-panel a.macro-property-panel-Green span.icon.aui-lozenge-subtle,.wiki-content .aui-lozenge-success.aui-lozenge-subtle{color:#14892c;background-color:#fff;border-color:#b2d8b9}#property-panel a.macro-property-panel-Red span.icon,.wiki-content .aui-lozenge-error{color:#fff;background-color:#d04437;border-color:#d04437}#property-panel a.macro-property-panel-Red span.icon.aui-lozenge-subtle,.wiki-content .aui-lozenge-error.aui-lozenge-subtle{color:#d04437;background-color:#fff;border-color:#f8d3d1}#property-panel a.macro-property-panel-Yellow span.icon,.wiki-content .aui-lozenge-current{color:#594300;background-color:#ffd351;border-color:#ffd351}#property-panel a.macro-property-panel-Yellow span.icon.aui-lozenge-subtle,.wiki-content .aui-lozenge-current.aui-lozenge-subtle{color:#594300;background-color:#fff;border-color:#ffe28c}#property-panel a.macro-property-panel-Blue span.icon,.wiki-content .aui-lozenge-complete{color:#fff;background-color:#4a6785;border-color:#4a6785}#property-panel a.macro-property-panel-Blue span.icon.aui-lozenge-subtle,.wiki-content .aui-lozenge-complete.aui-lozenge-subtle{color:#4a6785;background-color:#fff;border-color:#e4e8ed}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;padding-top:6px!important;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}#insert-menu .macro-status .icon{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90DBgUQHra5bYQAAADGSURBVDjL7dMxSkNREIXhb967JqAWRgXBQoRgJRa6AhejnY07sHEFbsFF2Ip21hYWNtaSQjBRfMm1SWUG3EAODFMc5py/GZYKlPnONHO1u6lqU7fWScEe1lCT8HfcYoDZn+OeiLv4l/F8uCO0aUGNcTwMXGC40EDTjb2e3qsmNhK/4LlENcJ6FhCMBEKXELT4CMeXW+iniGX1++Tput+Fkvm1+iy+3s5wsEhQG7X3cnRof8p2QriCx4KbOU6mKZr5ZPpZfgK/SqI2J6AKSn8AAAAASUVORK5CYII=) no-repeat 50%}.editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},cczi:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n("Jygk"),a=n.n(o),r=n("bS8p"),i=function(){void 0!==a.a.AJS.Rte&&void 0===a.a.AJS.Rte.Content&&(a.a.AJS.Rte.Content=r.a)}},dHP6:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return v});var o,a=n("Jygk"),r=n.n(a),i=n("hE99"),c=n("cGYM"),l=n("JGxT"),s=n("bfgX"),d={},u=0,f=function(){clearTimeout(o),o=setTimeout(g,6e4);r.a.tinymce.activeEditor.on("ExecCommand",function(e){var t="mceToggleFormat"===e.command?function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(e.value):e.command;p(h[t])}),r.a.tinymce.activeEditor.on("KeyPress",function(){p("keys")}),r.a.tinymce.activeEditor.on("KeyUp",function(e){46===e.keyCode?p("delete",u):8===e.keyCode&&p("backspace",u),u=r.a.tinymce.activeEditor.selection.getContent().length}),r.a.tinymce.activeEditor.on("MouseUp",function(){u=r.a.tinymce.activeEditor.selection.getContent().length}),r.a.tinymce.activeEditor.on("Paste",function(e){p("paste",e.clipboardData.getData("text/plain").length)}),r.a.tinymce.activeEditor.on("Remove",function(){g(),clearTimeout(o)})},m=function(){r.a.addEventListener("beforeunload",function(){g()})},p=function(e,t){if(e&&(d[e]?d[e]++:d[e]=1,t)){var n="".concat(e,"Size");d[n]?d[n]+=t:d[n]=t}},g=function e(){d.contentID=l.a.get("content-id"),d.currentVersion=l.a.get("page-version")||"null",d.tinymceVersion=Object(c.a)("".concat(r.a.tinymce.majorVersion,".").concat(r.a.tinymce.minorVersion)),d.frontEndVersion=Object(c.a)(i.b),Object(s.b)("analytics",{name:"confluence.editor.action",data:d}),d={},clearTimeout(o),o=setTimeout(e,6e4)},h={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"},b=p;function v(){Object(s.a)("rte-ready",function(){f(),m()})}},e2U2:function(e,t,n){var o=n("7ffy");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},gV2d:function(e,t,n){var o=n("+wbh");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)},ieax:function(e,t,n){var o=n("XxhQ"),a=n("7l8p");"string"==typeof o&&(o=[[e.i,o,""]]),e.exports=o.locals||{},e.exports._getContent=function(){return o},e.exports._getCss=function(){return o.toString()},e.exports._insertCss=function(e){return a(o,e)}},ipYc:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,".status-macro{min-width:76px;padding:2px 5px 1px}",""])},k5DV:function(e,t,n){(e.exports=n("RDo7")(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},"m+2k":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return c});var o=n("VrFO"),a=n.n(o),r=n("Y9Ll"),i=n.n(r),c=function(){function t(n){a()(this,t),n?this.userAgent=n:e.window&&(this.userAgent=e.window.navigator.userAgent)}return i()(t,[{key:"isFirefox",value:function(){return-1!==this.userAgent.indexOf("Firefox/")}},{key:"notFirefox",value:function(){return!this.isFirefox()}},{key:"isMSEdge",value:function(){return-1!==this.userAgent.indexOf("Edge/")}},{key:"notMSEdge",value:function(){return!this.isMSEdge()}},{key:"isIE",value:function(){return-1!==this.userAgent.indexOf("MSIE")||-1!==this.userAgent.indexOf("Trident/")||this.isMSEdge()}},{key:"notIE",value:function(){return!this.isIE()}},{key:"isChrome",value:function(){return-1!==this.userAgent.indexOf("Chrome/")}},{key:"notChrome",value:function(){return!this.isChrome()}},{key:"isSafari",value:function(){return-1!==this.userAgent.indexOf("Safari/")&&-1===this.userAgent.indexOf("Chrome/")}},{key:"notSafari",value:function(){return!this.isSafari()}},{key:"isPhantom",value:function(){return-1!==this.userAgent.indexOf("PhantomJS")}},{key:"notPhantom",value:function(){return!this.isPhantom()}},{key:"version",value:function(){if(this.isIE()){var e=this.userAgent.match(/MSIE\s([\d.]+)/)||this.userAgent.match(/rv:([\d.]+)/)||this.userAgent.match(/Edge\/([\d.]+)/);return parseInt(e[1])}return this.isChrome()?parseInt(this.userAgent.match(/Chrome\/([\d.]+)/)[1]):this.isSafari()?parseInt(this.userAgent.match(/Version\/([\d.]+)/)[1]):this.isFirefox()?parseInt(this.userAgent.match(/Firefox\/([\d.]+)/)[1]):void 0}},{key:"friendlyName",value:function(){return this.isMSEdge()?"MSEdge":this.isIE()?"IE":this.isChrome()?"Chrome":this.isSafari()?"Safari":this.isFirefox()?"Firefox":void 0}}]),t}()}).call(this,n("fRV1"))},owi1:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var o=function(){return e.Confluence}}).call(this,n("fRV1"))},xODI:function(e,t,n){var o=n("c8cs"),a=n("7l8p");"string"==typeof o&&(o=[[e.i,o,""]]),e.exports=o.locals||{},e.exports._getContent=function(){return o},e.exports._getCss=function(){return o.toString()},e.exports._insertCss=function(e){return a(o,e)}},zFIa:function(e,t,n){var o=n("FVF/");"string"==typeof o&&(o=[[e.i,o,""]]);var a={insertAt:"bottom",singleton:!0,hmr:!0,transform:void 0,insertInto:void 0};n("cuK8")(o,a);o.locals&&(e.exports=o.locals)}}]);
//# sourceMappingURL=atlassian-editor-plugins.bd26aec1016d3aebaf72-v38.js.map