
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="origin" />
    <meta property="og:description" content="lftp.sh自动上传脚本： #!/bin/bashecho -e &amp;quot;\nScript start at \033[43;35m `date &amp;quot;&#x2B;%H:%M:%S&amp;quot;` \" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>lftp命令详解 - 艾欧里亚ゞ - 博客园</title>
    
    <link rel="stylesheet" href="/css/blog-common.min.css?v=PyyhYDRKBG1sYtpoHme_xHO5AMd5iN57I45iBKF8FVY" />
    <link id="MainCss" rel="stylesheet" href="/skins/marvin2/bundle-marvin2-brown.min.css?v=CqfaBUbg9SqvqgJPSuqDPHer_ybpmQNTaqvehY8zcF4" />
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/marvin2/bundle-marvin2-brown-mobile.min.css?v=HOBX7OLV6PtPSKJHr3EkObytuIJdG1cQ-ELhzvtBQL0" />
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/wjoyxt/rss" />
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/wjoyxt/rsd.xml" />
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/wjoyxt/wlwmanifest.xml" />
    <script src="https://common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script src="/js/blog-common.min.js?v=9AUvV7CGRXeBxRXvxWjIJxJZemektvGlJfH8yBiYzRQ"></script>
    <script>
        var currentBlogId = 185431;
        var currentBlogApp = 'wjoyxt';
        var cb_enable_mathjax = false;
        var isLogined = false;
    </script>
    
    
    
</head>
<body>
    <a name="top"></a>
    <div id="page_begin_html">
        <canvas id="c_n9" width="1920" height="990" style="position: fixed; top: 0px; left: 0px; z-index: -1; opacity: 0.1;"></canvas>

<!DOCTYPE html>
<html lang="zh-CN">
<head>



<title>打赏</title>
</head>
<script>
        window.tctipConfig = {
            staticPrefix: "http://static.tctip.com",
            buttonImageId: 5,
            buttonTip:  "zanzhu",
            list:{
                alipay: { qrimg: "https://files.cnblogs.com/files/wjoyxt/zfb.bmp"}, //修改1
                weixin: { qrimg: "https://files.cnblogs.com/files/wjoyxt/wx.bmp"}, //修改2
            }
        };
</script>
<script src="http://static.tctip.com/js/tctip.min.js" defer></script>
<body>
</body>
</html>
    </div>
    <div id="top">

<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/wjoyxt/">艾欧里亚ゞ</a>
</h1>
<p id="tagline">
That which does not kill us makes us stronger！
</p>


</div>
<div id="leftmenu">

	
<h3>导航</h3>
<ul>
	<li>
		
</li>
	<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/wjoyxt/">
首页</a>
</li>
	<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
</li>
	<li>
		
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/%E8%89%BE%E6%AC%A7%E9%87%8C%E4%BA%9A%E3%82%9E">
联系</a></li>
	<li>
		

</li>
	<li>
		
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>


	<div id="calendar"><div id="blog-calendar" style="display:none"></div></div>                
                    <script>loadBlogDefaultCalendar();</script>
	<h3>统计</h3>
<ul>
	<li>
		随笔 -
		
454</li>
	<li>
		文章 -
		
0</li>
	<li>
		评论 -
		
32</li>
	<li>
		引用 -
		
0
	</li>
</ul>


	
<div id="sidebar_news" class="newsItem">
            <script>loadBlogNews();</script>
</div>

	<div id="blog-sidecolumn"></div>
                    <script>loadBlogSideColumn();</script>

</div>
<div id="main">
	<div id="post_detail">
	<div class="post">
		<h2>
			
<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wjoyxt/p/4819044.html">lftp命令详解</a>

		</h2>
		
<div id="cnblogs_post_body" class="blogpost-body ">
    <p><span style="color: #0000ff;">lftp.sh自动上传脚本：</span></p>
<div class="cnblogs_code">
<p>#!/bin/bash<br />echo -e "\nScript start at \033[43;35m `date "+%H:%M:%S"` \033[0m"<br />echo -e "\033[1;34m-----------------------------------------------------------------------\033[0m"<br />cd /root/upload ; rm -fr /root/upload/*<br />git clone git@10.35.33.29:xiaoban/server-api/xiaoban-server.git<br />mv /root/upload/xiaoban-server/* /root/upload/ ; rm -fr /root/upload/xiaoban-server<br />tar zcvf code.tar.gz ./* &gt;/dev/null</p>
<p><br />lftp &lt;&lt; EOF<br />open ftp://xiaoban:xiaoban@2018@ftp.wjoyxt.ren<br />cd<br />put /root/upload/code.tar.gz<br />close <br />bye<br />EOF<br />rm -fr /root/upload/*<br />echo -e "\033[1;34m-----------------------------------------------------------------------\033[0m"<br />echo -e "Script  end  at \033[43;35m `date "+%H:%M:%S"` \033[0m \n "</p>
</div>
<p>&nbsp;</p>
<p><span style="color: #0000ff;">使用lftp相比使用ftp的优势较多，可以显示上传下载的百分比进度以及可以上传下载文件夹。</span></p>
<p><span style="color: #0000ff;">-----------------------------------------------------------------------------</span></p>
<p><span style="color: #0000ff;">1、登录ftp<br />代码:<br />lftp 用户名:密码@ftp地址:传送端口（默认21）<br />用法<br />(1)<span style="color: #ff0000;">lftp username:password@127.0.0.1:21</span><br />(2)lftp username@127.0.0.1 回车&nbsp;&nbsp;&nbsp;&nbsp; ##默认21端口 回车后输入密码<br />(3)lftp 127.0.0.1 回车&nbsp;&nbsp; ##回车后 login 登录<br />(4)lftp 回车 --&gt; open 127.0.0.1 --&gt; login 登录</span><span style="color: #0000ff;"><br /><br />2、lftp中文乱码问题<br />登录后看到的都是中文乱码(因为一般本地都是utf-8的编码),怎么半呢，用 set 命令来解决<br /></span></p>
<div class="codeblock"><span style="color: #0000ff;">set ftp:charset gbk(或者 gb2312 或 utf-8) ##设置ftp端的编码格式<br />set file:charset utf-8 (...同上) ##设置本地编码格式<br /><br />附:set命令的技巧 (1)输入set 查看已经设置好的命令 (2)set -a 查看所有可以设置的命令清晰网</span></div>
<p>
<span style="color: #0000ff;"><br />3、查找ftp端文件<br /></span></p>
<div class="codeblock"><span style="color: #0000ff;">ls *.txt ##查找当前目录下的所有txt文件<br />ls ./123/ ##列出123目录下所有文件<br />find . -name "*.txt"&nbsp;&nbsp; ##递归查找站点上所有的txt文件<br />find ./xx -name "*.txt" ##查找xx目录下所有的txt文件<br /><br />附1: ls第二次读取的是本地缓存,可以用 rels 代替 ls 或者catch off / catch on 来开关catch,catch flush清空本地catch<br />附2: <span style="color: #ff0000;">浏览本地目录的命令可用<span style="background-color: #ffff00;"> !ls&nbsp;</span></span>, 如 !ls /usr/local/bin/</span></div>
<p>
<span style="color: #0000ff;"><br />4、下载文件</span></p>
<div class="codeblock"><span style="color: #0000ff;">下载文件之前要先设置好本地的目录，用来存放下载的文件<br />lcd /home/123/web&nbsp;&nbsp; ##设置本地存放目录 默认为 /home/usr<br /><br />get 123.txt&nbsp;&nbsp;&nbsp;&nbsp; ##下载123.txt文件到 /home/123/web 中<br />get -c 123.txt ##断点续传下载<br />mget *.txt&nbsp;&nbsp;&nbsp;&nbsp; ##批量下载所有txt文件<br />mget -c *.txt ##断点续传<br />mget -c ./123/aaa/*.txt&nbsp;&nbsp; ##断点续传、批量<a href="http://apps.hi.baidu.com/w_empty/blog/item/:void%280%29;/.1212516110553*/" target="_blank">下载</a>ftp端aaa目录下的所有txt文件<br /><br />pget -c -n 10 file.dat<br />##以最多10个线程以允许断点续传的方式下载file.dat<br />##可以通过设置 set pget:default-n 5 的值而使用默认值。<br /><br />mirror aaa/<br />##将aaa目录整个的下载下来，子目录也会自动复制 本地自动建立目录</span></div>
<p>
<span style="color: #0000ff;"><br />5、上传文件</span></p>
<div class="codeblock"><span style="color: #0000ff;">put 123.txt&nbsp;&nbsp;&nbsp;&nbsp; ##同下载<br />mput *.txt&nbsp;&nbsp;&nbsp;&nbsp; ##同下载<br /><br />mirror -R aaa/ ##同下载</span></div>
<p>
<span style="color: #0000ff;"><br />6、设置被动/非被动模式</span></p>
<div class="codeblock"><span style="color: #0000ff;">set ftp:passive-mode 1 ## 1 被动 0非主动<br /></span></div>
<p>
<span style="color: #0000ff;"><br />多任务处理</span></p>
<div class="codeblock"><span style="color: #0000ff;">ctrl+z ##将当前进行的任务移交后台处理<br />wait&nbsp;&nbsp; ##将后台处理任<a href="http://apps.hi.baidu.com/w_empty/blog/item/:void%280%29;/.1212516124164*/" target="_blank">务调</a>至前台查看<br />jobs&nbsp;&nbsp; ##查看后台进行的任务列表<br />kill all 或者 job_no ##删除所有任务 或 指定的任务<br /><br />##将任务加入任务列表<br />queue get 123.txt<br />queue put 234.txt<br />queue mirror aaa/<span class="Apple-converted-space">&nbsp;<br /><br />queue ##查看任务列表<br />jobs&nbsp;&nbsp; ##查看后台任务列表<br /><br />queue start ##开始任务列表<br />queue stop ##停止任务列表<br /></span></span></div>
<p>
<span style="color: #0000ff;"><br />其他命令清晰网<span class="Apple-converted-space">&nbsp;<br /><br />alias []<br />定义别名<br />alias less more<br />alias reconnect "close; cd ."<br />直接输入 alias 即可看到目前定义了<a href="http://apps.hi.baidu.com/w_empty/blog/item/:void%280%29;/.1212516138250*/" target="_blank">那些别名</a>。如果只输入 alias name 的话, 则是取消 name 这个别名。<br /><br />bookmark SUBCMD<br />设定书签, 可将目前站台及所在目录设成书签, 下次可直接进来, 不用再 cd 来 cd 去的<br /><br />bookmark add name 用来新增名称为 name 的书签<br />bookmark del name 删除名称为 name 的书签<br />bookmark list 显示目前有设定那些书签(另外直接打 bookmark 和 bookmark list 的结果一样)<br />bookmark edit 呼叫编辑器修改书签 (~/.lftp/bookmarks)<br /><br />cd 切换远端目录<br /><br />cache SUBCMD<br />管理 lftp 的 cache<br /><br />rels []<br />从 cache 中显示远端档案列表<br />rels 则不会从 cache 中读取<br /><br />recls opts [path/]pattern<br />从 cache 中显示远端的档案列表, 应该算是 ls 的加强版, 有很多参数可用,应该是可用来产生各种不同&gt;的档案列表以供其他程式使用。<br />recls 则不会从 cache 中读取<br /><br />du options<br />计算远端整个目录占用容量<br /><br />get OPTS -o<br />抓取远端档案<span class="Apple-converted-space">&nbsp;清晰网<span class="Apple-converted-space">&nbsp;<br /><br />get rfile -o lfile<br />抓 rfile 到本地改名为 lfile<br />-c 为续传<br />-E 抓档完成后, 将远端的档案砍了<br />-a 为 ascii mode, 预设为 binary mode<br />-O 设定 base directory 为本地端放档案的目录<br /><br />mget OPTS<br />下载远端档案(可用 wildcard expansion 也就是 *)<br /><br />pget OPTS -o<br />使用多个连结来下载档案, 预设为五个。<br />-n 3 为叁个连结<br /><br />jobs -v<br />显示目前有那些程序在背景执行<br />-v 显示详细的资讯(-v 可多加几个来显示更详细的资讯)<br /><br />lcd<br />切换本地端的目录<br /><br /><span style="color: #ff0000;">mirror OPTS remote [local]</span><br />下载整个目录(楼上的 get 只能用来抓档案)<br />-c 续传<br />-e 这个要小心一些, 比较远端和本地端的档案, 假如远端没有的, 就将本地端的档案删除, 也就是将本地端和远端资料同步。<br /><span style="color: #ff0000;">-R 上传整个目录</span><br />-n 只下载较新的档案<br />-r 不用递回到目录中<br />--parallel=n 同时下载 n 个档案(预设一次只下载一个)清晰网<span class="Apple-converted-space">&nbsp;<br /><br />module name args<br />载入模组<br /><br />put OPTS -o<br />上传档案<br /><br />mput OPTS<br />上传档案(可用 wildcard expansion 也就是 *)<br /><br />mv<br />将远端的 file1 改名为 file2<br /><br />mrm<br />用 wildcard expansion 方式来删除远端档案<br /><br />open OPTS<br />开启某个站台<br />open -u , -p site<br /><br />queue OPTS []<br />将 cmd 放到伫列中等待执行<br />-d index 将编号为 index 的 job 删除<br />-m index new_index 将编号为 index 的 job 移至编号 new_index, 插队专用。<br />-n index 在编号 index 之前新增一个 job<br /><br />wait []<br />将背景执行中的程序移至前景(也可用 fg)<br /><br />kill all|<br />删除全部的 jobs 或 job_no<br /><br />repeat delay command<br />每隔 delay 秒, 重覆执行 command, 预设是每隔一秒<br /><br />rm -r -f<br />移除远端档案<br /><br />mkdir -p<br />建立远端目录<br /><br />rmdir -f<br />移除远端目录<br /><br />set OPT []<br />设定变数<br />直接键入 set 可看目前定义了那些变数<br /><br />source<br />读取 file, 并执行 file 中的命令(应该是和 bash 中的 source 命令是一样的吧)<br /><br />debug [|off] -o<br />设定 debug level 为 level<br />-o 将输出导向至 file<br /><br />exit [|bg]<br />结束 lftp<br />此时若还有 jobs, 则会将 lftp 放至背景执行, 继续未完成的工作<br /><br />history -w file-r file-c|-l cnt<br />和 bash 中的 history 功能一样<br /><br />renlist []<br />只显示远端的档名<br /><br />pwd -p<br />显示目前远端所在目录<br />-p 连登入密码也显示<br /><br />scache []<br />只打 scache 显示目前所有的 session, 加上 session_no 可切换至其他的 session,<br />对於同时开启多个站台或同个站台不同目录间切换。<br /><br />国内的大多数ftp服务器使用的中文编码是gbk，而linxu大多数版本（包括debian，redhat，centOS，fc等版本）默认的编码是utf-8,于是会出现访问ftp服务器是出现中文乱码的问题，解决办法有两种：<br />1、临时解决<br />用lftp登录到ftp服务器上，设置远程服务器编码为gbk，而设置本地编码为utf-8，做法为：输入下面两个命令：<br />set ftp:charset gbk<br />set file:charset utf8<br /><br />2、永久解决<br />在目录$HOME/.lftp编辑文件（如果没有则建立）rc,输入下面两行，设置远程编码为gbk，本地编码为utf-8：<br />set ftp:charset gbk<br />set file:charset utf8<br />这种方法会导致访问utf8编码的服务器时出现中文乱码，不过就目前国内环境来说机会比较少。如果出现乱码时则临时输入下面两行就可以了：<br />set ftp:charset utf8<br />set file:charset utf8<br /><br />另外一个用的很多的图形界面的ftp客户端是gftp，在选项中可以选择编码，用惯了win下客户端的人应该能够很快的早到编码选择的地方，选择服务器端的编码为gbk就可以了。</span></span></span></span></span></p>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
    <div id="blog_post_info"></div>
    <div class="clear"></div>
    <div id="post_next_prev"></div>
</div>
		<p class="postfoot">
			posted on 
<span id="post-date">2015-09-18 14:03</span>&nbsp;
<a href="https://www.cnblogs.com/wjoyxt/">艾欧里亚ゞ</a>&nbsp;
阅读(<span id="post_view_count">...</span>)&nbsp;
评论(<span id="post_comment_count">...</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=4819044" rel="nofollow">
    编辑
</a>
<a href="javascript:void(0)" onclick="AddToWz(4819044);return false;">收藏</a>
		</p>
	</div>
	
	
<script src="https://common.cnblogs.com/highlight/9.12.0/highlight.min.js"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 185431, cb_blogApp = 'wjoyxt', cb_blogUserGuid = '10734916-42d7-e311-8d02-90b11c0b17d6';
    var cb_entryId = 4819044, cb_entryCreatedDate = '2015-09-18 14:03', cb_postType = 1; 
    loadViewCount(cb_entryId);
</script><a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>

<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
    <div id="comment_form_container"></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"></div>
    <div id="opt_under_post"></div>
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag.pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block">
        <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;"></div>
    </div>
    <div id="under_post_news"></div>
    <div id="cnblogs_c2" class="c_ad_block">
        <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;">
            <script>
                if (new Date() >= new Date(2018, 9, 13)) {
                    googletag.cmd.push(function () { googletag.display("div-gpt-ad-1539008685004-0"); });
                }
            </script>
        </div>
    </div>
    <div id="under_post_kb"></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div></div>


</div>
<p id="footer">
	Powered by: 
	<br />
	
	
<a href="https://www.cnblogs.com/" id="Footer1_Hyperlink3" style="font-size: 12px; font-family: Verdana">博客园</a>
	<br />
	Copyright &copy; 2019 艾欧里亚ゞ
<br /><span id="poweredby">Powered by .NET Core 3.1.0 on Linux</span>

</p>




    <div id="page_end_html">
        <script type="text/javascript" src="https://files.cnblogs.com/files/jingmoxukong/canvas-nest.min.js" defer></script>
    </div>
</body>
</html>