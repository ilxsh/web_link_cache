<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>Autofs - Community Help Wiki</title>
<script type="text/javascript" src="/moin_static198/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static198/light/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/moin_static198/light/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/moin_static198/light/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/moin_static198/light/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static198/light/css/msie.css">
<![endif]-->


<link rel="alternate" title="Community Help Wiki: Autofs" href="/community/Autofs?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Autofs&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="/community/CommunityHelpWiki">
<link rel="Alternate" title="Wiki Markup" href="/community/Autofs?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/community/Autofs?action=print">
<link rel="Search" href="/community/FindPage">
<link rel="Index" href="/community/TitleIndex">
<link rel="Glossary" href="/community/WordIndex">
<link rel="Help" href="/community/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">


    <div id="leftbanner">
    </div>
    <div id="rightbanner">
    </div>
    <div id="container">
        <div id="container-inner">
	    <div id="mothership">
		<ul>
	            <li><a href="https://partners.ubuntu.com">Partners</a> </li>
        	    <li><a href="https://www.ubuntu.com/support/community-support">Support</a></li>
        	    <li><a href="https://community.ubuntu.com">Community</a></li>
        	    <li><a href="https://www.ubuntu.com">Ubuntu.com</a></li>
	        </ul>
	    </div>
            <div id="header">
                <h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
                <ul id="main-menu">
                    <li><a href="https://help.ubuntu.com/">Official Documentation</a></li>
                    <li><a class="main-menu-item current" href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
                    <li><a href="https://community.ubuntu.com/t/contribute/26">Contribute</a></li>
                </ul>
            </div>
            <div id="menu-search">
                <div id="subheader"> 
                    <div class="subheader-menu"> 
                        <div id="second-nav">
<ul id="username"><li><a class="nbinfo" href="/community/Autofs?action=info" rel="nofollow">Page History</a></li><li><a href="/community/Autofs?action=login&amp;login=1" id="login" rel="nofollow">Login to edit</a></li></ul>
 </div> 
    <div id="user-info"> 
    </div>
 

                            
                        </div> 
                    </div> 


                    <div id="search-box">

<noscript>
 <form action="http://www.google.com/cse" id="cse-search-box">
   <div>
     <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq" />
     <input type="hidden" name="ie" value="UTF-8" />
     <input type="text" name="q" size="21" />
     <input type="submit" name="sa" value="Search" />
   </div>
 </form>
</noscript>

<script>
 document.write('<form action="https://help.ubuntu.com/search.html" id="cse-search-box">');
 document.write('  <div>');
 document.write('    <input type="hidden" name="cof" value="FORID:9" />');
 document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq" />');
 document.write('    <input type="hidden" name="ie" value="UTF-8" />');
 document.write('    <input type="text" name="q" size="21" />');
 document.write('    <input type="submit" name="sa" value="Search" />');
 document.write('  </div>');
 document.write('</form>');
</script>


                    </div>
                </div>
                <div id="title"><h1>
<span id="pagelocation"><a href="/community/Autofs">Autofs</a></span>
</h1>
                </div>
            <div id="cwt-nav3">

 <hr class="clear" />
            </div>
                <div id="cwt-content" class="clearfix content-area">

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><div><table style="float:right;  font-size: 0.9em;  width:40%;  background:#F1F1ED;  margin: 0 0 1em 1em;"><tbody><tr>  <td style="padding:0.5em;"><p class="line891"><br>
<div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Introduction">Introduction</a><ol><li>
<a href="#Quick_note_on_terms">Quick note on terms</a></li></ol></li><li>
<a href="#Installation">Installation</a></li><li>
<a href="#Configuration">Configuration</a><ol><li>
<a href="#The_Master_Map_File">The Master Map File</a></li><li>
<a href="#Map_Files">Map Files</a></li></ol></li><li>
<a href="#EXAMPLE:_Auto-mounting_an_NFS_share">EXAMPLE: Auto-mounting an NFS share</a><ol><li>
<a href="#Edit_.2Fetc.2Fauto.master">Edit /etc/auto.master</a></li><li>
<a href="#Create_.2Fetc.2Fauto.nfs">Create /etc/auto.nfs</a></li><li>
<a href="#Unmount_static_mounts_and_edit_.2Fetc.2Ffstab">Unmount static mounts and edit /etc/fstab</a></li><li>
<a href="#Reload_.2Fetc.2Finit.d.2Fautofs">Reload /etc/init.d/autofs</a></li><li>
<a href="#Make_sure_it_works">Make sure it works</a></li></ol></li><li>
<a href="#Advanced_Information">Advanced Information</a><ol><li>
<a href="#Note_on_.2Fnet_and_.2Fsmb">Note on /net and /smb</a></li><li>
<a href="#Wildcard_characters">Wildcard characters</a></li></ol></li><li>
<a href="#Mounting_Other_Types_of_Files_Systems">Mounting Other Types of Files Systems</a><ol><li>
<a href="#CIFS">CIFS</a></li><li>
<a href="#FUSE_based_file_systems">FUSE based file systems</a></li></ol></li><li>
<a href="#Debugging_Auto_Mount_Problems">Debugging Auto Mount Problems</a></li><li>
<a href="#See_Also">See Also</a></li><li>
<a href="#External_Links">External Links</a></li></ol></div></td>
</tr>
</tbody></table></div><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
<h1 id="Introduction">1. Introduction</h1>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867"><strong>autofs</strong> is a program for automatically mounting directories on an as-needed basis. Auto-mounts are mounted only as they are accessed, and are unmounted after a period of inactivity. Because of this, automounting NFS/Samba shares conserves bandwidth and offers better overall performance compared to static mounts via <strong>fstab</strong>. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867">
<h2 id="Quick_note_on_terms">1.1. Quick note on terms</h2>
<span class="anchor" id="line-10"></span><p class="line874">To avoid confusion, the following terminologies will be used: <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><ul><li><p class="line891"><strong>automount</strong> is the program used to configure a mount point for <strong>autofs</strong>. When <strong>autofs</strong> is started, an <strong>automount</strong> daemon is spawned for each map. <span class="anchor" id="line-13"></span></li><li>Auto-mount or auto-mounting refers to the process of automatically mounting filesystems. <span class="anchor" id="line-14"></span></li><li><p class="line891"><strong>autofs</strong> is the program that controls the operation of the <strong>automount</strong> daemons. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></li></ul><p class="line867">
<h1 id="Installation">2. Installation</h1>
<span class="anchor" id="line-17"></span><p class="line862">Install the <strong>autofs</strong> package either by clicking <a class="apt" href="apt:autofs">here</a> or entering the following in a terminal window: <span class="anchor" id="line-18"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><pre><span class="anchor" id="line-1"></span>$ sudo apt-get install autofs</pre><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span></li></ul><p class="line867">
<h1 id="Configuration">3. Configuration</h1>
<span class="anchor" id="line-23"></span><p class="line867"><strong>autofs</strong> can be configured by editing configuration files. There are other ways to configure autofs on a network (see <a href="/community/AutofsLDAP">AutofsLDAP</a>), but config files provide the simplest setup. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line867">
<h2 id="The_Master_Map_File">3.1. The Master Map File</h2>
<span class="anchor" id="line-26"></span><p class="line862">The master configuration file for <strong>autofs</strong> is <strong>/etc/auto.master</strong> by default. Unless you have a good reason for changing this, leave it as the default. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><p class="line874">Here is the sample file provided by Ubuntu: <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line867"><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><pre><span class="anchor" id="line-1-1"></span>#
<span class="anchor" id="line-2"></span># $Id: auto.master,v 1.4 2005/01/04 14:36:54 raven Exp $
<span class="anchor" id="line-3"></span>#
<span class="anchor" id="line-4"></span># Sample auto.master file
<span class="anchor" id="line-5"></span># This is an automounter map and it has the following format
<span class="anchor" id="line-6"></span># key [ -mount-options-separated-by-comma ] location
<span class="anchor" id="line-7"></span># For details of the format look at autofs(5).
<span class="anchor" id="line-8"></span>#/misc   /etc/auto.misc --timeout=60
<span class="anchor" id="line-9"></span>#/smb   /etc/auto.smb
<span class="anchor" id="line-10"></span>#/misc  /etc/auto.misc
<span class="anchor" id="line-11"></span>#/net    /etc/auto.net</pre><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><ul><li><p class="line862">By default, all lines are commented out by using the <strong>#</strong> character. <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span></li></ul><p class="line862">Each of the lines in <tt>auto.master</tt> describes a mount and the location of its map. These lines have the following format: <span class="anchor" id="line-47"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><pre><span class="anchor" id="line-1-2"></span>mount-point [map-type[,format]:] map [options]</pre><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span></li></ul><p class="line867">
<h3 id="Direct_and_Indirect_Maps">3.1.1. Direct and Indirect Maps</h3>
<span class="anchor" id="line-52"></span><p class="line867"><strong>automount</strong> maps can be direct or indirect. Indirect maps, such as those in the <strong>auto.master</strong> file shown above, create-mount points as subdirectories inside the main mount-point. For example, consider the following master map entry: <span class="anchor" id="line-53"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><pre><span class="anchor" id="line-1-3"></span>/smb   /etc/auto.smb</pre><span class="anchor" id="line-56"></span></li></ul><p class="line862">This entry in <tt>auto.master</tt> tells <tt>autofs</tt> to look in <strong>/etc/auto.smb</strong> and create mount-points in the <strong>/smb</strong> directory. <span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line862">Direct maps create a mount-point at the path specified in the relevant map file. The <strong>mount-point</strong> entry in <strong>auto.master</strong> is always <strong>/-</strong>. For example, the following line instructs <tt>autofs</tt> to create a mount-point at the place specified in <strong>auto.data</strong>: <span class="anchor" id="line-59"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><pre><span class="anchor" id="line-1-4"></span>/-        /etc/auto.data</pre><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span></li><li class="gap">If the map file is not specified using a full local or network path, the Name Service Switch configuration will be used to locate the map, e.g.: <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><pre><span class="anchor" id="line-1-5"></span>/-        auto.data</pre><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span></li></ul><p class="line867">
<h2 id="Map_Files">3.2. Map Files</h2>
<span class="anchor" id="line-69"></span><p class="line862">As indicated above, each <strong>autofs</strong> mount has its own map file. These files are usually named using the convention <strong>auto.&lt;X&gt;</strong>, where <strong>&lt;X&gt;</strong> can be anything as long as it matches an entry in <strong>auto.master</strong> and is valid for a file-name. <span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line874">Map files take the following format: <span class="anchor" id="line-72"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><pre><span class="anchor" id="line-1-6"></span>key [-options] location</pre><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span></li></ul><p class="line867">
<h1 id="EXAMPLE:_Auto-mounting_an_NFS_share">4. EXAMPLE: Auto-mounting an NFS share</h1>
<span class="anchor" id="line-78"></span><p class="line862">In this howto, we will configure autofs to auto-mount an NFS share, using a set of configuration files. This howto assumes that you are already familiar with NFS exports, and that you already have a properly-functioning NFS share on your network. Go to the <a href="/community/SettingUpNFSHowTo">NFS Setup Page</a> to learn how to set up such a server. <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><p class="line867">
<h2 id="Edit_.2Fetc.2Fauto.master">4.1. Edit /etc/auto.master</h2>
<span class="anchor" id="line-81"></span><p class="line862">The following step creates a mount point at <strong>/nfs</strong> and configures it according to the settings specified in <strong>/etc/auto.nfs</strong> (which we will create in the next step). <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><ol type="1"><li>Type the following into a terminal: <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><pre><span class="anchor" id="line-1-7"></span>$ sudo nano /etc/auto.master</pre><span class="anchor" id="line-87"></span></li><li><p class="line862">Add the following line at the end of <strong>/etc/auto.master</strong>: <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><pre><span class="anchor" id="line-1-8"></span>/nfs   /etc/auto.nfs</pre><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span></li></ol><p class="line867">
<h2 id="Create_.2Fetc.2Fauto.nfs">4.2. Create /etc/auto.nfs</h2>
<span class="anchor" id="line-93"></span><p class="line874">Now we will create the file which contains our automounter map: <span class="anchor" id="line-94"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><pre><span class="anchor" id="line-1-9"></span>$ sudo nano /etc/auto.nfs</pre><span class="anchor" id="line-97"></span></li></ul><p class="line862">This file should contain a separate line for each NFS share. The format for a line is {mount point} [{mount options}] {location}. If you have previously configured static mounts in <strong>/etc/fstab</strong>, it may be helpful to refer to those. Remember, the mount points specified here will be relative to the mount point given in <strong>/etc/auto.master</strong>. <span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><p class="line874">The following line is for shares using older versions of NFS (prior to version 4): <span class="anchor" id="line-100"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><pre><span class="anchor" id="line-1-10"></span>server   server:/</pre><span class="anchor" id="line-103"></span></li></ul><p class="line862">This creates a new mount point at <strong>/nfs/server/</strong> and mounts the NFS root directory exported by the machine whose host-name is <strong>server</strong>. <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><p class="line867">
<h3 id="NFSv4">4.2.1. NFSv4</h3>
<span class="anchor" id="line-106"></span><p class="line874">If your NFS shares use NFSv4, you need to tell autofs about that. In such a case, the above line would appear as follows: <span class="anchor" id="line-107"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><pre><span class="anchor" id="line-1-11"></span>server   -fstype=nfs4   server:/</pre><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span></li></ul><p class="line862">The client needs the same changes to <strong>/etc/default/nfs-common</strong> to connect to an NFSv4 server. <span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><ul><li style="list-style-type:none"><p class="line862">In <strong>/etc/default/nfs-common</strong> we set: <span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><pre><span class="anchor" id="line-1-12"></span>NEED_IDMAPD=yes
<span class="anchor" id="line-2-1"></span>NEED_GSSD=no # no is default</pre><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span></li></ul><p class="line867">
<h2 id="Unmount_static_mounts_and_edit_.2Fetc.2Ffstab">4.3. Unmount static mounts and edit /etc/fstab</h2>
<span class="anchor" id="line-120"></span><p class="line874">If you have previously configured the NFS shares as static mounts, now is the time to unmount them. <span class="anchor" id="line-121"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><pre><span class="anchor" id="line-1-13"></span>$ sudo umount /server</pre><span class="anchor" id="line-124"></span></li></ul><p class="line862">Next, remove (or comment out) their respective entries in <strong>/etc/fstab</strong>. <span class="anchor" id="line-125"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><pre><span class="anchor" id="line-1-14"></span>#server:/ /server/ nfs defaults 0 0</pre><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span></li></ul><p class="line867">
<h2 id="Reload_.2Fetc.2Finit.d.2Fautofs">4.4. Reload /etc/init.d/autofs</h2>
<span class="anchor" id="line-130"></span><p class="line874">After entering your changes, run the following command to reload autofs: <span class="anchor" id="line-131"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><pre><span class="anchor" id="line-1-15"></span>$ sudo service autofs reload</pre><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span></li></ul><p class="line874">If working on an older ubuntu version, and that does not work try: <span class="anchor" id="line-136"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><pre><span class="anchor" id="line-1-16"></span>$ sudo /etc/init.d/autofs reload</pre><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span></li></ul><p class="line874">If working in Natty, and that does not work try: <span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><pre><span class="anchor" id="line-1-17"></span>$ sudo /etc/init.d/autofs restart</pre><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span></li></ul><p class="line867">
<h2 id="Make_sure_it_works">4.5. Make sure it works</h2>
<span class="anchor" id="line-147"></span><p class="line874">In order to access the share and verify that it is working properly, enter the following into a shell: <span class="anchor" id="line-148"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><pre><span class="anchor" id="line-1-18"></span>$ ls /nfs/server</pre><span class="anchor" id="line-151"></span></li></ul><p class="line874">If you see your NFS share listed, congratulations! You have a functioning NFS mount via autofs! If you want to learn some more advanced information, keep reading. <span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><p class="line867">
<h1 id="Advanced_Information">5. Advanced Information</h1>
<span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><p class="line862">Following the example directory structure above, if you were to enter <strong>ls /nfs</strong> into a shell, you might be surprised to see nothing listed. But remember that you need to access a directory before it is auto-mounted. To access the share, enter <strong>ls /nfs/server</strong>. Once it has been accessed, your share will be listed only until it times out. This is good to keep in mind, as it could save you time diagnosing an <strong>autofs</strong> problem that isn't really there. <span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><p class="line867">
<h2 id="Note_on_.2Fnet_and_.2Fsmb">5.1. Note on /net and /smb</h2>
<span class="anchor" id="line-158"></span><p class="line862">These two default configurations may be useful for your set-up. If you have a lot of NFS or Samba shares, you may want to uncomment these lines. <strong>/net</strong> enables auto-mounting of file systems elsewhere on the network which are exported by NFS. For example, if you have a server named <strong>fileserver</strong> with an NFS export directory called <strong>/export</strong>, you can mount it by typing in a shell command line <strong>cd /net/fileserver/export</strong>. In an environment with NFS file servers, such a configuration can be useful. <strong>/smb</strong> functions the same way but is for Samba file systems. However, if you need to authenticate before accessing the Samba share, <strong>automount</strong> will not function. <span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><p class="line867">
<h2 id="Wildcard_characters">5.2. Wildcard characters</h2>
<span class="anchor" id="line-161"></span><p class="line862">Let's say you have a directory with a number of subdirectories which you want to have auto-mounted individually. An example of this is the <strong>/home</strong> directory, in which case <strong>/etc/auto.master</strong> might contain the following line: <span class="anchor" id="line-162"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><pre><span class="anchor" id="line-1-19"></span>/home   /etc/auto.home</pre><span class="anchor" id="line-165"></span></li></ul><p class="line862">If user1 is logged in, you will want to auto-mount his home directory. However, if you create a mount point for the whole <tt>/home</tt> directory, you will also mount the home directories of every other user at the same time, thus wasting bandwidth. One solution to this would be to create separate entries for each directory, as follows: <span class="anchor" id="line-166"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><pre><span class="anchor" id="line-1-20"></span># /etc/auto.home
<span class="anchor" id="line-2-2"></span>user1   server:/home/user1
<span class="anchor" id="line-3-1"></span>user2   server:/home/user2
<span class="anchor" id="line-4-1"></span>user3   server:/home/user3</pre><span class="anchor" id="line-172"></span></li></ul><p class="line874">This works, but is cumbersome. Instead, you can use wild-card characters, as follows: <span class="anchor" id="line-173"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><pre><span class="anchor" id="line-1-21"></span>*   server:/home/&amp;</pre><span class="anchor" id="line-176"></span></li></ul><p class="line862">The asterisk (<strong>*</strong>) is used in place of the mount point and the ampersand (<strong>&amp;</strong>) in place of the directory to be mounted. For more detail on the use of wild-cards see <a class="http" href="http://goo.gl/3EHqA4">Using Wild-card Characters as Short-cuts in AutoFS Maps</a>. <span class="anchor" id="line-177"></span><span class="anchor" id="line-178"></span><p class="line874">You can also use variables (see autofs(5) man page) to substitute users and other parameters to be able to create generic file for multiple users. Example below is smb map that maps based on user which asks for the share using $USER variable. <span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span><p class="line867"><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><pre><span class="anchor" id="line-1-22"></span>* -fstype=cifs,rw,credentials=/home/$USER/.smbcredentials,iocharset=utf8,uid=$USER,gid=users,file_mode=0700,dir_mode=0700 ://server/$USER
<span class="anchor" id="line-2-3"></span>share1 -fstype=cifs,rw,credentials=/home/$USER/.smbcredentials,iocharset=utf8,uid=$USER,gid=users ://server/share1
<span class="anchor" id="line-3-2"></span>share2 -fstype=cifs,rw,credentials=/home/$USER/.smbcredentials,iocharset=utf8,uid=$USER,gid=users ://server/share2</pre><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><p class="line867">
<h1 id="Mounting_Other_Types_of_Files_Systems">6. Mounting Other Types of Files Systems</h1>
<span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><p class="line867">
<h2 id="CIFS">6.1. CIFS</h2>
<span class="anchor" id="line-190"></span><p class="line862">When specifying a CIFS share in a map file, specify <strong>-fstype=cifs</strong> and precede the share location with a colon (:). <span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><p class="line874">Example: <span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><pre><span class="anchor" id="line-1-23"></span>mntpoint -fstype=cifs ://example.com/shrname</pre><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><p class="line874">Example:  Mount read-write, specifying a user and group to own the files: <span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><pre><span class="anchor" id="line-1-24"></span>mntpoint -fstype=cifs,rw,uid=myuserid,gid=mygrpid ://example.com/shrname</pre><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><p class="line874">Example:  Mount read-write, specifying a username and password to use to connect to the share: <span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><pre><span class="anchor" id="line-1-25"></span>mntpoint -fstype=cifs,rw,username=myuser,password=mypass ://example.com/shrname</pre><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><p class="line867">
<h2 id="FUSE_based_file_systems">6.2. FUSE based file systems</h2>
<span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><p class="line862">FUSE based file systems are mounted by specifying <strong>-fstype=fuse</strong>.  The file-system location specifies the user-space binary used to mount the file system, followed by a hash (<strong>#</strong>), followed by the location.   <span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><p class="line862">When specifying a FUSE file system location in map file, certain characters, notably the hash (<strong>#</strong>) and the colon (<strong>:</strong>), must be escaped by a backslash (<strong>\</strong>).  The entire location must be preceded by a colon (<strong>:</strong>). <span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><p class="line862">Since <strong>automount</strong> performs the mount as <strong>root</strong> it is usually necessary to specify <strong>allow_other</strong> on the mount options to allow your non-root userid to access the share. <span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><p class="line867">
<h3 id="SSHFS_file_system">6.2.1. SSHFS file system</h3>
<span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><p class="line862">SSHFS is a FUSE based file-system.  In an <strong>autofs</strong> mount, the colon (<strong>:</strong>) following the server name must be escaped by a backslash (<strong>\</strong>). <span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><p class="line862">You should have already set-up password-less authentication via public key encryption. <strong>Be sure that you understand the security implications of this before proceeding.</strong> <span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><p class="line862">Remember, <strong>automount</strong> will mount your SSHFS file-system as root, so you need to: <span class="anchor" id="line-223"></span><ol type="1"><li><p class="line862">Copy your private key to the <tt>/root/.ssh</tt> directory.  <strong>Be sure that you understand the security implications of this before proceeding.</strong> <span class="anchor" id="line-224"></span></li><li><p class="line862">Add the necessary host keys to <strong>/root/.ssh/known_hosts</strong>.   <span class="anchor" id="line-225"></span></li><li>Specify the user-name used to connect  <span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span></li></ol><p class="line862">To test mounting your SSHFS file system as <strong>root</strong> issued the following: <span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><pre><span class="anchor" id="line-1-26"></span>sudo sshfs user@example.com:/ mountpoint</pre><span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><p class="line862">If the mount succeeds without prompting you for a password, you are ready to mount the file-system via <strong>autofs</strong> <span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><p class="line874">Example: <span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><pre><span class="anchor" id="line-1-27"></span>mntpoint -fstype=fuse,allow_other :sshfs\#user@example.com\:/path/to/mount</pre><span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><p class="line874">Example:  Mount read-write, specifying a user and group to own the files: <span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><pre><span class="anchor" id="line-1-28"></span>mntpoint -fstype=fuse,rw,uid=1000,gid=1000,allow_other :sshfs\#user@example.com\:/path/to/mount</pre><span class="anchor" id="line-243"></span><p class="line874">Note that for FUSE mounts, uid and gid must be numeric ids. <span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><p class="line867">
<h1 id="Debugging_Auto_Mount_Problems">7. Debugging Auto Mount Problems</h1>
<span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><p class="line862">If you are having trouble automounting your file systems, it may be useful to run <strong>automount</strong> in the foreground. <span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><ol type="1"><li><p class="line862">Stop the <strong>autofs</strong> daemon <span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><pre><span class="anchor" id="line-1-29"></span>sudo service autofs stop</pre><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span></li><li class="gap"><p class="line862">Run <strong>automount</strong> in the foreground with verbose information <span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><pre><span class="anchor" id="line-1-30"></span>sudo automount -f -v</pre><span class="anchor" id="line-258"></span><span class="anchor" id="line-259"></span></li><li class="gap">From another terminal, try to mount your file-systems by changing directories into the mountpoint.   <span class="anchor" id="line-260"></span><span class="anchor" id="line-261"></span></li><li class="gap">Check the output from the first terminal for clues as to why the mount failed or was not attempted. <span class="anchor" id="line-262"></span><span class="anchor" id="line-263"></span></li></ol><p class="line867">
<h1 id="See_Also">8. See Also</h1>
<span class="anchor" id="line-264"></span><ul><li><p class="line891"><a href="/community/Mount">Mount</a> - Information about the mounting process and its configuration in Ubuntu. <span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span></li></ul><p class="line867">
<h1 id="External_Links">9. External Links</h1>
<span class="anchor" id="line-267"></span><ul><li><p class="line891"><a class="http" href="http://manpages.ubuntu.com/manpages/natty/en/man2/mount.2.html">The mount man page</a> - hosted on the official Ubuntu website. <span class="anchor" id="line-268"></span></li></ul><span class="anchor" id="bottom"></span></div><div id="pagebottom"></div>
</div>


            </div>
<p id="pageinfo" class="info" lang="en" dir="ltr">Autofs  (last edited 2019-07-08 16:36:05 by <span title="tomreyn @ 92.116.99.202[92.116.99.202]"><a class="interwiki" href="https://launchpad.net/~tomreyn" title="tomreyn @ 92.116.99.202[92.116.99.202]">tomreyn</a></span>)</p>

</div>
            
            <div id="footer">
		<p>
		The material on this wiki is available under a free license, see <a href="https://help.ubuntu.com/community/
		License">Copyright / License</a> for details<br /><b>You</b> can contribute to this wiki, see 
		<a href="https://help.ubuntu.com/community/WikiGuide">Wiki Guide</a> for details
		</p>
            </div>

        </div></body>
</html>

