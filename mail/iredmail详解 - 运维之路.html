<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><link rel="stylesheet" href="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/a.css" type="text/css" media="screen"> <script src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/hm.js"></script><script type="text/javascript" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/a"></script> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"><title>iredmail详解 - 运维之路</title><link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有文章" href="http://www.361way.com/feed"><link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有评论" href="http://www.361way.com/comments/feed"><link rel="pingback" href="http://www.361way.com/xmlrpc.php"> <style type="text/css" media="screen">@import url( http://www.361way.com/wp-content/themes/inove_white/style.css );</style> <!--[if IE]><link
rel="stylesheet" href="http://www.361way.com/wp-content/themes/inove_white/ie.css" type="text/css" media="screen" /> <![endif]-->  <script type="text/javascript">window.onload = function(){
                 prettyPrint();
             }</script> <meta name="description" content="iRedmail 组件 iRedMail主要是使用下面软件来构建邮件系统,下面是Ubuntu 10.04的软件版本。 Apache 2.2.x PHP 5.3.x MySQL 5.1.x OpenLDAP 2.4.x Postfix 2.7.x ( MTA ) Dovecot 1.2.x Amavisd"><link rel="canonical" href="http://www.361way.com/iredmail/1301.html"> <script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","url":"http://www.361way.com/","sameAs":[],"@id":"#person","name":"\u4e91\u865a\uff08Young\uff09"}</script> <link rel="dns-prefetch" href="http://s.w.org/"><link rel="alternate" type="application/rss+xml" title="运维之路 » iredmail详解评论Feed" href="http://www.361way.com/iredmail/1301.html/feed"> <script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.361way.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.10"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><script src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script> <style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style><link rel="https://api.w.org/" href="http://www.361way.com/wp-json/"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.361way.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.361way.com/wp-includes/wlwmanifest.xml"><meta name="generator" content="WordPress 4.9.10"><link rel="shortlink" href="http://www.361way.com/?p=1301"><link rel="alternate" type="application/json+oembed" href="http://www.361way.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.361way.com%2Firedmail%2F1301.html"><link rel="alternate" type="text/xml+oembed" href="http://www.361way.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.361way.com%2Firedmail%2F1301.html&amp;format=xml"><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><script src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/share.js"></script><link rel="stylesheet" href="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/slide_share.css"></head><body><div id="wrap"><div id="container"><div id="header"><div id="caption"><h1 id="title"><a href="http://www.361way.com/">运维之路</a></h1><div id="tagline">关注Linux运维技术及互联网的IT科技博客</div></div><div class="banner"> <marquee scrollamount="2" scrolldelay="60" onmouseover="this.stop()" onmouseout="this.start()" direction="up" style="width:550px;height:90px;float:right; background:#eeeeee"> <font size="3" color="red">本站提供收费咨询和远程操作服务，收入所得用于捐赠本站购买云主机费用<br> <a href="mailto:itybku@139.com">邮件联系：itybku@139.com</a></font><br> </marquee></div><div class="fixed"></div></div><div id="navigation"><div class="menu-%e9%a6%96%e9%a1%b5-container"><ul id="menu-%e9%a6%96%e9%a1%b5" class="menu"><li id="menu-item-5736" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5736"><a href="http://www.361way.com/">首页</a></li><li id="menu-item-5991" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5991"><a href="http://www.361way.com/edu">视频教程</a></li><li id="menu-item-5743" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5743"><a href="http://wiki.361way.com/">WIKI</a></li><li id="menu-item-5738" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5738"><a href="http://www.361way.com/donate">捐赠名单</a></li><li id="menu-item-5742" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5742"><a href="http://www.361way.com/sitemap">站点地图</a></li><li id="menu-item-5737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5737"><a href="http://www.361way.com/about-me">关于我</a></li></ul></div><div id="searchbox"><form action="http://www.361way.com" method="get"><div class="content"> <input type="text" class="textfield searchtip" name="s" size="24" value="搜索..."> <input type="submit" class="button" value=""></div></form></div> <script type="text/javascript">//
	var searchbox = MGJS.$("searchbox");
	var searchtxt = MGJS.getElementsByClassName("textfield", "input", searchbox)[0];
	var searchbtn = MGJS.getElementsByClassName("button", "input", searchbox)[0];
	var tiptext = "搜索...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
	searchbtn.onclick = function(e) {
		if(searchtxt.value == "" || searchtxt.value == tiptext) {
			return false;
		}
	}
//</script> <div class="fixed"></div></div><div id="content"><div id="main"><div id="postpath"> <a title="首页" href="http://www.361way.com/">首页</a> &gt; <a href="http://www.361way.com/category/http-html-web" rel="category tag">http/html/web</a>, <a href="http://www.361way.com/category/open-source-software" rel="category tag">开源软件</a></div><div class="post" id="post-1301"><h2>iredmail详解</h2><div class="info"> <span class="date">2012年5月10日 </span> <span class="author"><a href="http://www.361way.com/author/admin" title="由admin发布" rel="author">admin</a></span> <span class="addcomment"><a href="#respond">发表评论</a></span> <span class="comments"><a href="#comments">阅读评论</a></span><div class="fixed"></div></div><div class="content"><h2> iRedmail 组件<br></h2><p> iRedMail主要是使用下面软件来构建邮件系统,下面是Ubuntu 10.04的软件版本。</p><ul><li> Apache 2.2.x</li><li> PHP 5.3.x</li><li> MySQL 5.1.x</li><li> OpenLDAP 2.4.x</li><li> Postfix 2.7.x ( MTA )</li><li> Dovecot 1.2.x</li><li> Amavisd 2.6.x</li><li> ClamAV 0.9x</li><li> SpamAssassin 3.2.x</li><li> Policyd 1.8.x</li><li> Pysieved 1.0</li><li> Roundcube 0.7.2 (Webmail )</li><li> phpMyAdmin 3.3</li><li> phpLDAPadmin 1.2</li><li> Awstats 6.9</li></ul><p> 组件的工作原理</p><p> amavisd-new 在这里的作用主要是：</p><ul><li> 负责调用 ClamAV 对邮件进行病毒扫描</li><li> 负责调用 SpamAssassin 对邮件内容进行过滤</li><li> 实现 DKIM 签名和验证功能，还有实现免责声明的功能。</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail60.html" width="277" height="376"></p></ul><p> <a href="http://www.361way.com/index.php?title=File:Iredmail_amavise.png&amp;variant=zh-cn"><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail_amavise.html" width="502" height="174"></a>&nbsp;</p><p> Postfix组件</p><p> <a href="http://www.361way.com/index.php?title=File:Iredmail37.png&amp;variant=zh-cn"><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail37.html" width="862" height="505"></a>&nbsp;</p><p> 全部的组件 （图片来源 <a href="http://workaround.org/ispmail/lenny/bigpicture">http://workaround.org/ispmail/lenny/bigpicture</a> ）</p><p> <a href="http://www.361way.com/index.php?title=File:Iredmail61.png&amp;variant=zh-cn"><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail61.html" width="815" height="894"></a>&nbsp;</p><p> 1: 当邮件发送到服务器的25端口，postfix接受连接，它会做一些基本检查</p><ul><li> 发送者是否在黑名单或者实时黑名单,如果在黑名单，马上拒绝</li><li> 是否是授权用户，可以进行转发</li><li> 接收者是否是服务器的用户，如果不是，马上拒绝</li><li> 如果我们启用的灰名单，那么会拒绝邮件或者接收</li></ul><p> 2：postfix 把邮件通过10024端口交给amavis来处理，注意amavis，只会检查邮件而不会丢弃或者拒绝邮件。</p><p> 3：amavis调用SpamAssassin检查邮件是否是spam，如果SpamAssassin认为邮件是垃圾邮件，会给邮件打上标记spam</p><p> 4：amavis调用ClamAV，看邮件是否含有病毒</p><p> 5：amavis把检查完的邮件，通过10025端口重新把邮件交回给postfix</p><p>
 6：postfix把邮件交给LDA（local delivery 
agent），LDA是负责本地邮件投放到用户的邮箱，（我们这里使用dovecot提供的LDA功能，而不是postfix提供的LDA）邮件会进入用
户的邮箱，Dovecot会执行用户设置的filter，也就是Dovecot通过调用Sieve，放到相关的文件夹</p><p> 7：Dovecot 把邮件以maildir的方式存放在硬盘上。</p><p> 8: 用户使用邮件客户端，通过pop3或imap协议进行连接。webmail RoundCube，是通过imap的方式来读取邮件。</p><h2> &nbsp;组件的选择，比较<br></h2><p> linux下，对于开源软件来说，没有所谓像windows一样的邮件系统，你可以选择不同的组件，组成一个邮件系统，对于邮件来说，要实现一个功能，可能有多种组件，到底哪个最好，不同的组件间的如何搭配、组合，是一件非常头疼的事情。</p><p> 网上的文档，组合也是非常多样，到底哪种是最好或者更优？文档不会介绍为什么选择这个组件的理由。一般的管理员很难判断。下面就是iRedMail选择组件的理由。</p><p> 大家也可以参考这位老外的文章：<a href="http://workaround.org/ispmail">http://workaround.org/ispmail</a>
 
如果你细心查看这篇文档的几个版本，就会发现他的组件的不同和改进。现在他的组件，已经基本和iredmail是一样。从另外一个角度证明
iRedMail的组件选择，是可以经得起考验的。可以肯定一点就是目前iredmail的功能，性能会比你照这个文档配置的效果更好。</p><p></p><h3> &nbsp;MTA Postfix<br></h3><p> linux比较有名的4大MTA，如果从功能上，应该都是可以满足你的需求，详细的比较，大家可以阅读<a href="http://shearer.org/MTA_Comparison">http://shearer.org/MTA_Comparison</a></p><ul><li> Sendmail</li></ul><p> MTA软件的很多先进功能都是在Sendmail上最先实现的。但Sendmail也有典型的历史问题，主要是整个程序的没有实现良好的模块化，运行时需要SID权限，以及配置文件复杂难懂。这些是阻碍Sendmail更好普及应用的一些客观问题。</p><ul><li> Qmail</li></ul><p>
 
Qmail是新生一代的MTA代表，实现了模块化设计，避免了SID问题，基本功能齐全，配置较Sendmail简单，而且用户也很广泛。但Qmail从
2002年开发工作基本停止，版本停止更新，只能通过第三方的补丁来实现更多的功能，补丁程序也相对零乱，这些都是长期使用Qmail的用户或者邮件服务
提供商不得不认真考虑的问题。另外，Qmail的扩展性并不是很好，经常需要补丁来完成功能的扩展。</p><ul><li> Exim</li></ul><p> Ubuntu缺省的MTA，应该是非常不错，不过国内用户不多。</p><ul><li> Postfix</li></ul><p> Postfix在设计上可以说是最为优美的，其实现了良好的模块化，邮件的处理流程是通过调用各个功能模块来完成，在效率、功能、可用性、扩展及安全等方面都考虑得比较充分。</p><h3> &nbsp;MDA Dovecot<br></h3><p> pop和imap的服务器，有Dovecot 和Courier 作为选择。目前很多教程，都是采用Courier，只是因为Courier文档比较多，历史比较久。</p><p> 如果你关注一下，国外很多历史比较久邮件系统的方案，都开始从Courier转到Dovecot上。</p><p> Dovecot从2002年发布以来，性能远远超越Courier。</p><p> Postfix可以直接使用Dovecot的后台认证，不需要分开配置。（如果使用Courier，我们必须安装配置额外的认证软件，比如Saslauthd，配置这个，会是一个噩梦，如果出现问题，很难排错），并且Dovecot，可以很方便实现磁盘配额的功能。</p><p> Dovecot作为Courier的可替换组件，Dovecot在磁盘读写量上比Courier减少25%左右，内存占用也比Courier节省10%到70%不等。</p><p> <a href="http://www.cnbeta.com/articles/72682.htm">http://www.cnbeta.com/articles/72682.htm</a></p><p> 大家会发现，很多文档里，如果使用Counier，会介绍使用maildrop 作为LDA，也就是postfix把邮件交给maildrop，他负责投递到用户的邮箱。</p><p> 如果我们使用Dovecot，那么就可以直接使用Dovecot带的LDA就可以。不需要额外的软件。</p><p> 所以作为构建一个新的邮件服务器，Dovecot，肯定是最佳的选择，这个应该没有什么异议。</p><h3> WebMail RoundCube<br></h3><p> 对于邮件系统来说，webmail是必不可少，修改密码，自动回复这些工作，必须登录webmail来设置。开源的webmail，其实选择也很多。</p><ul><li> SquirrelMail</li><li> horde</li><li> Extmail</li><li> atmail</li><li> openwebmail</li><li> RoundCube</li></ul><p> RoundCube，算是webmail里后起之秀，从2005年开发发布。目前最新的版本0.51，已经支持插件的机制。现在开发的插件的社区很活跃。如果把所有的插件都装起来，那肯定是无敌。</p><p> 对于开源的webmail，有一个很困惑国人的需求，当你在写邮件的时候，希望选择从通讯录里选择联系人。这个以前在任何的开源webmail里都是无法实现，甚至google的gmail也是最近才实现这个功能。</p><p> RoundCube 通过插件，已经完美实现了这个功能。</p><h3> Policyd<br></h3><p> 灰名单，是对付垃圾邮件的一个有效的手段，很多文档介绍使用PostGrey来实现灰名单的功能。</p><p> Policyd，不但有灰名单的功能，还提供很多别的功能，可以大大提高反垃圾邮件的效果。有一点要注意的，目前iRedMail 使用的是policyd1.8的版本。大家可以参考 <a href="http://policyd.sourceforge.net/readme.html">http://policyd.sourceforge.net/readme.html</a></p><h3> &nbsp;OS Ubuntu<br></h3><p> iRedMail 有一个重要的设计原则，尽可能使用发行版提供的包，尤其是官方提供技术支持和安全更新的包，这样做的好处是很明显。</p><ul><li> 升级方便</li><li> 安全更新有保证</li></ul><p> <br>
 
iRedMail目前支持RedHat，Debian，Ubuntu和Freebsd几个发行版，Ubuntu软件包的支持是最好的，从
Ubuntu9.04开始，iRedmail，就基本全部采用Ubuntu官方提供支持和更新的软件包来构建整个邮件系统，除了几个web管理程序以外
（web管理程序，你可以不使用）。</p><p> 已经有用户，顺利从9.04升级到9.10，邮件系统，没有任何影响。在未来的10.04，也是不会受到任何的影响，这就是iRedMail 和Ubuntu结合强大的地方。</p><p> 可以这样理解，使用Ubuntu提供的邮件相关的软件包，装完后，用iRedMail 的安装脚本，快速帮助你按照那些几十页的技术文档，1分钟内完成全部的配置。</p><p> 很多用户经常问一个问题：如果iRedMail项目停止，我怎么办，以后升级怎么办？其实如果你使用任何的邮件系统，都可能会有这样的风险。</p><p> 不过使用iredmail，就会例外，因为只有一种情况，Ubuntu停止开发，你才会受影响。只要Ubuntu，继续发展，你的邮件系统，就可以继续更新。因为你的所有的软件包，都是Ubuntu官方的提供的，他们是会保证持续更新和安全漏洞的修复。</p><p></p><h3> 内容过滤 SpamAssassin<br></h3><p> 防垃圾邮件，是邮件系统的基本功能，SpamAssassin，是最有名的，尤其是和Amavisd ClamAV结合起来，这是一个经得起考虑的组合。</p><p> 对于内容过滤，其实还有一个选择：dspam，我没有使用过dspam，无法具体评价。</p><p> 目前从iRedMail的客户部署情况，基本没有用户反映垃圾邮件过滤有问题。</p><p> SpamAssassin怎么管理，有后台可以登录吗？</p><h3> &nbsp;amavisd-new<br></h3><p> amavisd-new，可以理解成一个代理，Postfix把邮件交给他，他负责联系杀毒和反垃圾。</p><p> amavisd-new 在这里的作用主要是：</p><p>* 负责调用 ClamAV 对邮件进行病毒扫描 * 负责调用 SpamAssassin 对邮件内容进行过滤</p><p> 如果大家看文档，还会发现有人使用maildrop，通过maildrop，maildrop也可以调用spamassassin和clamav，实现类似amavisd-new的功能。</p><p> 大家可以阅读下面的文档，这是老外使用amavisd-new，ClamAV SpamAssassin的技术文档，那么就会明白为什么iredmail会选择这amavisd-new。 <a href="http://www200.pair.com/mecham/spam/">http://www200.pair.com/mecham/spam/</a></p><h2> &nbsp;iRedMail 简介<br></h2><p>
 iRedMail 是一套基于 GPL 发布的 Shell 
脚本，目的是全自动安装和配置邮件服务所需要的组件，以减轻系统管理员的负担。它提供了一个基本的命令行下的用户交互界面（使用 dialog 
程序实现），用户只需要简单地选择他所希望使用的组件，就可以在几分钟内（少于 3 分钟）部署好一台功能强大的邮件服务器。</p><p> iRedmail 使用到的邮件相关的软件包，都是采用发行版提供的软件包。</p><ul><li> iRedMail 官方中文支持论坛 <a href="http://www.iredmail.org/bbs">http://www.iredmail.org/bbs</a></li></ul><ul><li> 代码下载 <a href="http://code.google.com/iredmail">http://code.google.com/iredmail</a></li></ul><h2> 安装需求<br></h2><p> iRedMail 目前支持以下Ubuntu版本：</p><table border="1"><tbody><tr><td> OS</td><td> Version</td><td> Platform</td><td> iRedMail Version</td></tr><tr><td> Ubuntu （oneiric, 11.10)</td><td> 11.10</td><td> i386, amd64</td><td> &gt;= 0.7.4</td></tr><tr><td> Ubuntu (Luicd,11.04)</td><td> 10.04</td><td> i386, amd64</td><td> &gt;= 0.6.1</td></tr><tr><td> Ubuntu (Karmic, 9.10)</td><td> 9.10</td><td> i386, amd64</td><td> &gt;= 0.5.0</td></tr><tr><td> Ubuntu (Jaunty, 9.04)</td><td> 9.04</td><td> i386, amd64</td><td> &gt;= 0.5.0</td></tr><tr><td> Ubuntu (Hardy, 8.04 LTS)</td><td> 8.04 TLS</td><td> i386, amd64</td><td> &gt;= 0.5.0</td></tr></tbody></table><ul><li> 生产中部署至少需要512MB 内存.</li></ul><p> <a href="http://www.debian.org/CD/http-ftp/">Downloading Ubuntu CD/DVD images via HTTP/FTP</a></p><h2> &nbsp;准备<br></h2><h3> Hostname<br></h3><p> 这里说的 hostname 是指使用 'hostname -f' 命令打印出来的系统主机名，例如：</p><p></p><p>$ hostname -f mail.example.com</p><p> <br> 不管您的 Linux 系统是否作为公网服务器，我们都强烈建议您设置一个合适的主机名。</p><p> 在 Ubuntu 系统中，主机名的设置涉及到两个文件：</p><ol><li> /etc/hostname: hostname 设置</li><li> /etc/hosts: hostname &lt;=&gt; IP 地址对应</li></ol><p> 用你熟悉的编辑器编辑 /etc/hostname 文件</p><p>$cat /etc/hostname mail</p><p> 编辑 / /etc/hosts 文件</p><p>$cat /etc/hosts 127.0.0.1 mail.example.com mail localhost.localdomain localhost</p><p> 检查FQDN Name设置，</p><p> 让hostname修改马上生效</p><p>#hostname -F /etc/hostname # hostname -f mail.example.com</p><h3> 设置源<br></h3><p> 只需要相应的发行版的'main' 和 'universe' , 使用安装系统的时候ubuntu缺省的源，就可以了。</p><h2> 开始安装iredmail<br></h2><ul><li> 切换到root用户</li></ul><p># sudo su -</p><ul><li> 下载最新版本的iredmail，解压</li></ul><p>#wget
 http://iredmail.googlecode.com/files/iRedMail-0.7.0.tar.bz2 #tar jxvf 
iRedMail-0.7.0.tar.bz2 #cd iRedMail-07.0 #bash iRedMail.sh</p><p></p><ul><li> 可以开始执行主脚本，它会调用 'dialog' 程序引导用户配置邮件服务器</li><li> iRedMail 安装进程的欢迎页面</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail01.html" width="610" height="324"></p><li> 选择用于存储所有邮件的目录（注意：由于所有邮件都将存储在这个目录，所以这个目录需要占用较多的磁盘空间）</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail02.html" width="612" height="323"></p></ul><p><a></a></p><h3> LDAP<br></h3><p> <a href="http://www.361way.com/index.php?title=Ldap%E5%9B%BE%E8%A7%A3&amp;variant=zh-cn">ldap图解</a></p><h3> MYSQL<br></h3><p> <a href="http://www.361way.com/index.php?title=Mysql%E5%AE%89%E8%A3%85%E5%9B%BE%E8%A7%A3&amp;action=edit&amp;redlink=1">mysql安装图解</a></p><h2> 使用iredmail<br></h2><p> 安装完成后，一定要仔细阅读iredmail.tip，里面包括设置信息和帐号，下面各个应用的访问路径。这个是本安装的范例 （<a href="http://code.google.com/p/iredmail/source/browse/extra/iRedMail.tips">http://code.google.com/p/iredmail/source/browse/extra/iRedMail.tips</a> ）</p><ul><li> mysql 存储虚拟用户和domain 我们通过iRedAdmin 进行邮件domain，用户管理</li><li> mysql 管理，可以通过phpmyadmin管理</li><li> LDAP 存储虚拟用户和domain，我们通过iRedAdmin进行邮件domain，用户管理</li><li> LDAP 的管理，可以通过phpldapadmin管理</li></ul><p></p><h3> webmail RoundCube<br></h3><ul><li> 可以使用<a href="http://your_server/mail/">http://your_server/mail/</a> (or /webmail, /roundcube)访问webmail （注意，postmaster不是邮箱用户，不能登陆）</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail18.html" width="413" height="170"></p><li> 由于www@example.com是root的alias，所以会受到系统发的邮件，请细心阅读这两封邮件，iredmail.tip 包含所有的邮件设置的相关信息。</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail19.html" width="369" height="142"></p><li> 设置假期外出，需要新建过滤器</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail20.html" width="787" height="491"></p><li> 全局地址簿 （LDAP）</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail21.html" width="665" height="208"></p></ul><h3> &nbsp;iRedAdmin<br></h3><p> iRedAdmin开源版本是iredmail官方开发邮件后台管理，目前可以同时管理ldap和mysql。</p><p> 大家也可以通过iredmail官方提供的demo （<a href="http://www.iredmail.org/admin_demo.html">http://www.iredmail.org/admin_demo.html</a> ） 深入了解iredadmin</p><ul><li> 登录iRedAdmin</li></ul><p> 可以使用<a href="https://your_server/iredadmin">https://your_server/iredadmin</a> 访问iredadmin （注意是 https ）</p><p> <a href="http://www.361way.com/index.php?title=File:Iredadmin18.png&amp;variant=zh-cn"><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin18.html" width="550" height="343"></a>&nbsp;</p><ul><li> 修改语言</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin28.html" width="550" height="480"></p><li> 控制台</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin19.html" width="550" height="302"></p><li> 域名管理</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin24.html" width="550" height="292"></p><li> 添加domain</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin29.html" width="550" height="284"></p><li> 用户管理，添加用户</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin27.html" width="550" height="484"></p><li> 管理员管理 添加管理员</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredadmin30.html" width="550" height="475"></p></ul><h3> &nbsp;phpLDAPAdmin<br></h3><p> 可以使用<a href="https://your_server/ldap">https://your_server/ldap</a> 访问iredadmin （注意是 https ）</p><ul><li> 登录phpLDAPAdmin</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail29.html" width="433" height="272"></p></ul><p></p><ul><li> 查看ldap</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail30.html" width="340" height="486"></p></ul><h3> &nbsp;Awstats<br></h3><p> 可以使用<a href="https://your_server/awstats/awstats.pl">https://your_server/awstats/awstats.pl</a> 访问Awstats （注意是 https ）</p><p></p><ul><li> 登录Awstats</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail31.html" width="416" height="153"></p><li> 如果希望查看邮件的流量，你需要修改你的链接，（<a href="https://your_server/awstats/awstats.pl?config=mail">https://your_server/awstats/awstats.pl?config=mail</a> ） 在上面链接加上&nbsp;?config=mail</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail32.html" width="689" height="305"></p></ul><p><a></a></p><h3> phpMyAdmin<br></h3><p> 可以使用<a href="https://your_server/phpmyadmin">https://your_server/phpmyadmin</a> 访问phpMyAdmin （注意是 https ）</p><h2> DNS<br></h2><p> DNS记录，需要你到你的域名托管商那里进行设置或者你自己管理DNS服务器。不少域名托管商不支持txt记录或者不支持DKIM记录，所以你就无法使用SPF和DKIM的功能。</p><p> DNS的修改，需要48小时以上才能生效。</p><p> 国内的万网是不支持DKIM，目前新网是支持SPF和DKIM</p><p></p><h3> &nbsp;MX记录<br></h3><p> 邮件的MX记录最好是指向机器A记录，尽量不要直接指向IP地址（不符合规范）。</p><ul><li> 添加A记录</li></ul><p> mail.example.com 192.168.1.100</p><ul><li> 添加MX记录</li></ul><p> example.com mail.example.com</p><h3> SPF记录<br></h3><ul><li> SPF 记录指向A主机记录</li></ul><p>example.com. 3600 IN TXT "v=spf1 mx mx:mail.example.com -all"</p><ul><li> SPF 记录指向IP地址</li></ul><p>example.com. 3600 IN TXT "v=spf1 ip4:192.168.1.100 -all"</p><h3> &nbsp;DKIM记录<br></h3><p> 可以通过iredmail.tips 获得域名的DKIM，也可以在命令行下输入</p><p>#
 amavisd-new showkeys ; key#1, domain example.com, 
/var/lib/dkim/example.com.pem dkim._domainkey.example.com. 3600 TXT ( 
"v=DKIM1; p=" 
"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDGNVMuQRKqYeySIzqTGTm3xRzF" 
"/ZzhmMnpZkEcVVjFAk+t7E388oFGu/knyh6KBKwpZxHUN5HoOYVjMudqaR2FcSvK" 
"z+joFj8Vh3rXoTLa1zHDyfD7hICzxdEgmQZ8MJM5rjPPrRGZXnPowNYDsd6nDJ86" 
"N38iFYU+jALBYDLBwQIDAQAB")</p><p> 把上面记录添加到ISP的DNS记录</p><p>dkim._domainkey.example.com. v=DKIM1; p=MIGfMA0....（省略）DLBwQIDAQAB</p><p> <br> <img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail35.html" width="681" height="86">&nbsp;</p><p> 添加完DNS记录后，如果记录生效，可以通过运行命令检测</p><p># amavisd-new testkeys TESTING: dkim._domainkey.example.com =&gt; pass</p><p></p><h2> 检查DNS设置<br></h2><p> 下面有几种方法，可以帮助你检测DNS是否设置生效和正常工作</p><h3> windows nslookup<br></h3><p>C:&gt;nslookup
 Default Server: unknown Address: 192.168.1.1 &gt; server 4.2.2.1 
Default Server: vnsc-pri.sys.gtei.net Address: 4.2.2.1 &gt; set type=mx 
&gt; example.com Server: vnsc-pri.sys.gtei.net Address: 4.2.2.1 
Non-authoritative answer: example.com MX preference = 20, mail exchanger
 = mail.example.com &gt; set type=txt &gt; example.com Server: 
vnsc-pri.sys.gtei.net Address: 4.2.2.1 Non-authoritative answer: 
example.com text = "v=spf1 ip4:192.168.1.100 -all" &gt; 
dkim._domainkey.example.com Server: vnsc-pri.sys.gtei.net Address: 
4.2.2.1 Non-authoritative answer: dkim._domainkey.example.com text = 
"v=DKIM1; p= MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCsgZaIvYHAos2jbp3CHW0
 
AwrTnAEwV1p4EaZP/JuF8t1BETBVg6WJr3YWN5ijCpi9vnw96nmf/u5MgtbLwZ+AzDBkbOY7Jbb/hIO+
 
mpmmfdJAY3w8KoXLCuQKDysXOys45YtfJEj66s51EHH3W+iXPYw3I/NWHjY3a5/mXnk4XJQIDAQAB"</p><h3> linux dig<br></h3><p> 如果你的机器没有dig命令，你需要安装</p><p>apt-get install dnsutils</p><p> 这个时候，就可以使用dig命令</p><ul><li> MX记录</li></ul><p># host exmple.com example.com has address 192.168.1.100 example.com mail is handled by 10 mail.example.com.</p><p></p><ul><li> SPF记录</li></ul><p>#
 dig txt hotmail.com ; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; 
txt hotmail.com ;; global options: printcmd ;; Got answer: ;; 
-&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 43130 ;; 
flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0 ;; 
QUESTION SECTION: ;hotmail.com. IN TXT ;; ANSWER SECTION: hotmail.com. 
3600 IN TXT "v=spf1 include:spf-a.hotmail.com include:spf-b.hotmail.com 
include:spf-c.hotmail.com include:spf-d.hotmail.com ~all" ;; Query time:
 176 msec ;; SERVER: 64.71.161.8#53(64.71.161.8) ;; WHEN: Sat Dec 5 
08:43:51 2009 ;; MSG SIZE rcvd: 157</p><ul><li> DKIM记录</li></ul><p>#dig txt dkim._domainkey.example.com</p><h3> web工具<br></h3><ul><li> 黑名单检查</li></ul><p> <a href="http://www.mxtoolbox.com/">http://www.mxtoolbox.com/</a></p><p> 通过这个不但可以检查各种DNS设置，还可以检测到你的IP地址，是否已经给列入黑名单。</p><ul><li> 检测MX记录</li></ul><p> <a href="http://zmailer.org/mxverify.html">http://zmailer.org/mxverify.html</a></p><ul><li> 检测SPF记录</li></ul><p> <a href="http://www.openspf.org/">http://www.openspf.org/</a></p><ul><li> 测试spf和dkim记录</li></ul><p> <a href="http://www.brandonchecketts.com/emailtest.php">http://www.brandonchecketts.com/emailtest.php</a></p><p> 网页里有一个邮箱地址，你可以通过安装过程中创建的第一个用户www，发送邮件给这个测试邮箱，你就可以马上看到结果</p><ul><li> 发邮件到gmail</li></ul><p> 查看发送过去的邮件的源码, 如果显示 dkim=pass 和 SPF: pass 就表示正常</p><p>Received-SPF:
 pass (google.com: domain of www@example.com designates 66.160.197.199 
as permitted sender) client-ip=66.160.197.199; Authentication-Results: 
mx.google.com; spf=pass (google.com: domain of www@example.com 
designates 66.160.197.199 as permitted sender) 
smtp.mail=www@example.com; dkim=pass header.i=@example.com</p><h2> 查看LOG<br></h2><p> Linux下，如果出现问题，那么排错最佳的方式就是查看log，不过为了性能，有些应用，缺省下没有开启错误log，我们需要启用。</p><h3> &nbsp;APACHE<br></h3><p># tail /var/log/apache2/error.log #查看log # tail -0f /var/log/apache2/error.log #实时查看log</p><p></p><h3> OPENLDAP<br></h3><p> 当你采用ldap来验证用户，当用户登录出现问题的时候，你就需要查看ldap的log，看那个地方出错。</p><ul><li> 缺省的情况下，openldap的log没有启用，我们需要修改配置文件 /etc/ldap/slapd.conf</li></ul><p>loglevel 256 # &lt;-- change form 0 to 256</p><ul><li> 重新启动LDAP服务</li></ul><p>/etc/init.d/slapd restart</p><ul><li> 查看log</li></ul><p>tail /var/log/openldap.log</p><h3> dovecot<br></h3><p> 当接收邮件有问题的时候，我们需要查看dovecot的log，</p><ul><li> 编辑/etc/dovecot/dovecot.conf</li></ul><p>mail_debug = yes #把注释去掉</p><ul><li> 从新启动dovecot服务</li></ul><p># /etc/init.d/dovecot restart</p><ul><li> 查看log</li></ul><p># tail /var/log/dovecot.log</p><h3> Sieve<br></h3><p> 当RoundCube里过滤器不工作或者有问题的情况下，你就需要查看sieve的log</p><p># tail /var/log/sieve.log</p><h3> Postfix<br></h3><p> 查看邮件发送的问题，就需要查看posfix Log</p><p>#tail /var/log/mail.log</p><p> Postfix 排错，还可以通过Postfix提供邮件队例队列管理工具：</p><p></p><p>postqueue
 -p 列出队列里的所有邮件 postsuper -d ID 删除一封邮件 postsuper -d ALL 删除所有邮件 postsuper 
–h ID 保留邮件 postsuper -r ALL 重新排例 postcat -q ID 显示邮件内容 postqueue -f 清空邮件</p><p></p><h2> 邮件客户端<br></h2><p> iRedmail提供pop，imap和pops，imaps的连接，可以根据需要选择采用哪种方式</p><p></p><table border="1"><tbody><tr><td> Protocol</td><td> Unencrypted port</td><td> TLS Port</td><td> SSL Port</td></tr><tr><td> SMTP</td><td> 25</td><td> 587</td><td> 465</td></tr><tr><td> POP3</td><td> 110</td><td> 110</td><td> 995</td></tr><tr><td> IMAP</td><td> 143</td><td> 143</td><td> 993</td></tr></tbody></table><h3> Outlook2007<br></h3><p> <a href="http://www.361way.com/index.php?title=Outlook2007%E8%AE%BE%E7%BD%AE%E5%9B%BE%E8%A7%A3&amp;variant=zh-cn">Outlook2007设置图解</a></p><h3> Outlook 2003<br></h3><ul><li> pop3 非加密</li></ul><p> 这个设置和outlook 2007是一样，参考上面设置就可以, pop使用110，smtp是25</p><ul><li> pop3 加密</li></ul><p> 注意端口，这是和outlook2007不同的地方，outlook2003 只支持SSL，导入证书，可以参考上面设置</p><p> <a href="http://www.361way.com/index.php?title=File:Iredmail51.gif&amp;variant=zh-cn"><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail51.html" width="377" height="460"></a>&nbsp;</p><ul><li> imap 非加密</li></ul><p> 这个和2007设置是一样，imap是143，smtp是25</p><ul><li> imap 加密</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail55.html" width="367" height="450"></p></ul><h2> FAQ<br></h2><p> 这个faq会不定期更新，最新的FAQ，大家可以直接访问 <a href="http://www.iredmail.org/faq.html">http://www.iredmail.org/faq.html</a></p><h3> 邮件服务器同步备份，切换，群集，冗余<br></h3><p> 邮件系统的备份，可以考虑采用rsync, unison，如果数据量大，可以参考文章 <a href="http://blog.daviesliu.net/2008/04/24/sync/">http://blog.daviesliu.net/2008/04/24/sync/</a></p><p> 实现邮件的群集，有很多方案，一般可以分为</p><p> 采用共享存储 （多台服务器）负载均衡，每台服务器都在工作。通过这种方式，可以实现支撑更多的用户。</p><p> 没有共享存储 （两台服务器）实现冗余，一台机器是闲着。</p><p> 你可以把iredmail部署到这两种方案上，iRedMail官方网站提供这两种方案的技术支持。</p><ul><li> 采用共享存储，一般都是利用lvs</li><p><img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail_lvs.html" width="742" height="665"></p><li> 不采用共享存储，就可以采用DRBD+heardbeat 的方案</li></ul><p> DRBD，简单理解，就是网络的raid1，实现两台服务器的镜像。具体的配置过程，大家可以参考 <a href="http://www.iredmail.org/bbs/topic1298-view.html">http://www.iredmail.org/bbs/topic1298-view.html</a></p><p> <br> <img alt="" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/Iredmail_drbd.html" width="541" height="477">&nbsp;</p><h3> 停用灰名单<br></h3><p> 灰名单，是有效阻止垃圾邮件的手段，原理是当一个新的邮箱地址发邮件过来，都会先拒绝2次，然后第三次才会接收下来。一般发垃圾邮件的人，因为队列太长，就不会再尝试投递。</p><p> 灰名单会导致第一次发送延迟，不过第二次以后就没有问题。如果希望停止灰名单</p><p> 编辑/etc/postfix-policyd.conf</p><p># 1=on 0=off GREYLISTING=0 #把1改成0</p><p> 重新启动policy服务</p><p># /etc/init.d/postfix-policyd restart</p><h3> 修改root的alias<br></h3><p> iRedmail的安装过程，我们设置了root的alias，如果我们希望修改邮箱地址。</p><p> 编辑/etc/postfix/aliases 改成你需要的邮箱地址。以后系统的警告邮件就会发送到新的邮箱。</p><p># See man 5 aliases for format postmaster: root clamav: root root: www@18demo.com policyd: www@18demo.com amavis: root</p><p> 修改后，需要运行下面命令才可以生效。</p><p># postalias /etc/postfix/aliases</p><p> 这个时候可以测试一下，给root发一封邮件，是否生效</p><p>cd iRedMail-0.5.1 mail -s "test" root &lt; iRedMail.tips</p><h3> 添加免责声明<br></h3><p>
 iRedmail 是通过Amavisd-new + alterMIME 
实现出站的邮件都添加免责声明。alterMIME支持Per-domain，Sub-domain，Per-user添加免责声明，同时支持txt和
html格式。缺省情况下，iRedMail没有启用。</p><ul><li> 编辑 /etc/amavis/conf.d/50-user 把注释去掉。启用免责声明的功能</li></ul><p>#
 ------------ Disclaimer Setting --------------- # Uncomment this line 
to enable singing disclaimer in outgoing mails. 
$defang_maps_by_ccat{+CC_CATCHALL} = [ 'disclaimer' ]; #把注释去掉</p><ul><li> 创建一个test免责声明，这个声明会添加到所有的邮件里。如果希望每个domain或者每个用户不同声明，那么可以单独添加免责声明。存放的路径是/etc/postfix/disclaimer/</li></ul><p>#echo 'Testing disclaimer.' &gt; /etc/postfix/disclaimer/default.txt</p><ul><li> 重启amavisd服务</li></ul><p># /etc/init.d/amavis restart</p><p> 这个时候，所有往外发送的邮件，都会在底部加上 'Testing disclaimer.'</p><p></p><h3> 集成Razor2和Pyzor<br></h3><ul><li> 打开防火墙端口</li></ul><p> Razor2：必须打开防火墙端口 2307/TCP</p><p> pyzor： 必须打开防火墙端口 24441/UDP</p><p> 编辑/etc/default/iptables 文件</p><p>#
 http/https, smtp/smtps, pop3/pop3s, imap/imaps, ssh -A INPUT -p tcp -m 
multiport --dport 80,443,25,465,110,995,143,993,587, 465,22,2307,24441 
-j ACCEPT # &lt;-- Add 2307 24441</p><p> 重启iptables服务</p><p># /etc/init.d/iptables restart</p><ul><li> 安装Razor2</li></ul><p>root@mail:~#
 apt-get install razor Reading package lists... Done Building dependency
 tree Reading state information... Done The following NEW packages will 
be installed: razor 0 upgraded, 1 newly installed, 0 to remove and 24 
not upgraded. Need to get 125kB of archives. After this operation, 549kB
 of additional disk space will be used. Get:1 http://archive.ubuntu.com 
jaunty/universe razor 1:2.85-1 [125kB] Fetched 125kB in 1s (99.4kB/s) 
Selecting previously deselected package razor. (Reading database ... 
23030 files and directories currently installed.) Unpacking razor (from 
.../razor_1%3a2.85-1_amd64.deb) ... Setting up razor (1:2.85-1) ...</p><ul><li> 设置Razor2</li></ul><p>root@mail:~#
 mkdir /var/lib/amavis/.razor; chown -Rf amavis:amavis 
/var/lib/amavis/.razor root@mail:~# root@mail:~# su amavis $ razor-admin
 -home=/var/lib/amavis/.razor -create $ razor-admin 
-home=/var/lib/amavis/.razor -discover $ razor-admin 
-home=/var/lib/amavis/.razor -register Register successful. Identity 
stored in /var/lib/amavis/.razor/identity-rupCWQ7Auy $ exit</p><ul><li> 安装Pyzor</li></ul><p>#
 apt-get install pyzor Reading package lists... Done Building dependency
 tree Reading state information... Done The following extra packages 
will be installed: python-gdbm Suggested packages: python-gdbm-dbg The 
following NEW packages will be installed: python-gdbm pyzor 0 upgraded, 2
 newly installed, 0 to remove and 24 not upgraded. Need to get 56.3kB of
 archives. After this operation, 336kB of additional disk space will be 
used. Do you want to continue [Y/n]? y Get:1 http://archive.ubuntu.com 
jaunty/main python-gdbm 2.6.2-0ubuntu1 [18.5kB] Get:2 
http://archive.ubuntu.com jaunty/universe pyzor 1:0.4.0+cvs20030201-8 
[37.8kB] Fetched 56.3kB in 0s (57.4kB/s) Selecting previously deselected
 package python-gdbm. (Reading database ... 23094 files and directories 
currently installed.) Unpacking python-gdbm (from 
.../python-gdbm_2.6.2-0ubuntu1_amd64.deb) ... Selecting previously 
deselected package pyzor. Unpacking pyzor (from 
.../pyzor_1%3a0.4.0+cvs20030201-8_all.deb) ... Setting up python-gdbm 
(2.6.2-0ubuntu1) ... Setting up pyzor (1:0.4.0+cvs20030201-8) ...</p><ul><li> 设置pyzor</li></ul><p>#
 mkdir /var/lib/amavis/.pyzor; chown amavis:amavis 
/var/lib/amavis/.pyzor # su amavis $ pyzor --homedir 
/var/lib/amavis/.pyzor discover 
/var/lib/python-support/python2.6/pyzor/__init__.py:11: 
DeprecationWarning: the sha module is deprecated; use the hashlib module
 instead import sha 
/var/lib/python-support/python2.6/pyzor/client.py:10: 
DeprecationWarning: the multifile module has been deprecated since 
Python 2.5 import multifile downloading servers from 
http://pyzor.sourceforge.net/cgi-bin/inform-servers-0-3-x $ exit</p><ul><li> 编辑/etc/spamassassin/local.cf 在最末尾添加下面内容</li></ul><p>use_razor2 1 score RAZOR2_CHECK 2.500 score PYZOR_CHECK 2.500</p><ul><li> 重启amavis服务</li></ul><p># /etc/init.d/amavis restart</p><h3> 卸载iRedMail<br></h3><p> 当你希望卸载或者重新安装iredmail，那么可以利用iRedMail提供的工具，快速卸载iredmail各个组件，进行重新安装</p><p># cd iRedMail-0.5.1/tools/ # bash clear_iredmail.sh</p><p> 按照提示进行就可以，当你重新安装的时候，你还是需要运行下载脚本，再运行安装脚本。</p><h3> 批量创建用户<br></h3><p> iRedMail提供脚本，可以让用户快速添加用户</p><ul><li> MYSQL</li></ul><p> 你可以编辑create_mail_user_MySQL.sh，修改默认值，如果你安装的时候修改的邮件的存储路径，那么你必须修改脚本的 STORAGE_BASE_DIRECTORY</p><p> 创建邮箱用户的缺省密码是和用户名相同</p><p></p><p># cd iRedMail-0.5.1/tools/ # bash create_mail_user_MySQL.sh exmple.com user1 user2 user3</p><p> 这个时候，会创建output.sql 文件</p><p># mysql -uroot -p mysql&gt; USE vmail; mysql&gt; SOURCE /path/to/output.sql;</p><p></p><ul><li> LDAP</li></ul><p> 使用create_mail_user_OpenLDAP.sh脚本，可以快速创建ldap的邮件用户，我们需要修改脚本</p><p> 创建邮箱用户的缺省密码是和用户名相同</p><p>STORAGE_BASE_DIRECTORY="/var/vmail/vmail01"
 #如果你安装的时候修改的邮件的存储路径 LDAP_SUFFIX="dc=iredmail,dc=org" #你的ldap SUFFIX 
BINDPW='passwd' #ldap管理员cn=manager 密码</p><p> 运行脚本，创建用户</p><p># bash create_mail_user_OpenLDAP.sh example.com user1 user2</p><p></p><h3> 支持大附件<br></h3><p> 要注意的是：下面的设置，是可以让你的服务器是可以发送大附件，也需要对方的服务器能够接收大附件，否则还是无法发送出去。</p><ul><li> 客户端发送大附件</li></ul><p> 如果你是希望邮件客户端发送大附件，那么你只需要运行</p><p></p><p># postconf -e message_size_limit='104857600' #把附件增加到100m</p><p> 重启postfix服务</p><p># /etc/init.d/postfix restart</p><ul><li> webmail</li></ul><p> 如果希望webmail，发送大附件，那么你还需要多修改2个地方</p><p> 1：编辑/etc/php5/apache2/php.ini 文件</p><p>upload_max_filesize = 100M; post_max_size = 100M;</p><p> 2：修改/usr/share/apache2/roundcube/.htaccess 文件</p><p></p><p>php_value upload_max_filesize 100M php_value post_max_size 100M</p><p> 重启apache服务</p><p># /etc/init.d/apache2 restart</p><h3> 集成DNSBL<br></h3><p> 编辑/etc/postfix/main.cf 文件，在smtpd_recipient_restrictions 下添加下面内容</p><p></p><p>smtpd_recipient_restrictions
 = reject_unknown_sender_domain, reject_unknown_recipient_domain, 
reject_non_fqdn_sender, reject_non_fqdn_recipient, 
reject_unlisted_recipient, permit_mynetworks, permit_sasl_authenticated,
 reject_unauth_destination, reject_non_fqdn_helo_hostname, 
reject_invalid_helo_hostname, check_policy_service inet:127.0.0.1:10031 
##添加下面内容 reject_rhsbl_sender dsn.rfc-ignorant.org, reject_rbl_client 
dnsbl.njabl.org, reject_rbl_client dnsbl.ahbl.org, reject_rbl_client 
bl.spamcop.net, reject_rbl_client zen.spamhaus.org,</p><p> 重启postfix服务</p><p># /etc/init.d/postfix reload</p><p></p><h3> 停用Amavisd + ClamAV + SpamAssassin<br></h3><p> 如果希望停用杀毒和发垃圾的功能，编辑/etc/postfix/main.cf 文件，到把最底下的这行注释掉</p><p>content_filter = smtp-amavis:[127.0.0.1]:10024</p><p> 这个时候，postfix接收到的邮件，就不会再交给amavis处理，就可以把amavisd, clamd, freshclam服务停止。不过要注意的是这个时候DKIM的功能，也是无法使用，因为iredmail的DKIM是通过amavis来实现的。</p><p> rolaod postifx服务</p><p>#update-rc.d amavis purge #update-rc.d clamav purge # /etc/init.d/postfix reload</p><h3> Fetchmail<br></h3><p> 目前iRedMail还没有集成fetchmail的功能，如果你需要使用fetchmail，你可以自己集成</p><ul><li> 安装fetchmail</li></ul><p>apt-get install fetchmail</p><ul><li> 设置fetchmail daemon运行修改/etc/default/fetchmail 文件</li></ul><p>START_DAEMON=yes #把no改为yes</p><ul><li> 创建/etc/fetchmailrc 文件，添加下面的内容</li></ul><p>set
 daemon 300 #5分钟取一次邮件 set syslog set postmaster root set no bouncemail 
defaults: timeout 300 antispam -1 batchlimit 100 #用户：shakechen 也可以是 
shakechen@126.com 密码是：12345678 本地的邮箱：www@18demo.com poll pop3.126.com 
protocol POP3 user shakechen there with password 12345678 is 
www@18demo.com here</p><p> 最后一行意思是把126邮箱里的用户的邮件，投递到本地的邮箱帐号 www@18demo.com</p><ul><li> 设置/etc/fetchmailrc 文件权限</li></ul><p>chmod 600 /etc/fetchmailrc chown fetchmail /etc/fetchmailrc</p><ul><li> 重启服务</li></ul><p>/etc/init.d/fetchmail start</p><ul><li> 查看log</li></ul><p>#
 tail /var/log/syslog Dec 7 16:01:36 mail fetchmail[4179]: 723 messages 
(723 seen) for shakechen at pop3.126.com (36923210 octets). Dec 7 
16:01:37 mail fetchmail[4179]: sleeping at Mon Dec 7 16:01:37 2009 for 
30 seconds Dec 7 16:02:07 mail fetchmail[4179]: awakened at Mon Dec 7 
16:02:07 2009 Dec 7 16:02:08 mail fetchmail[4179]: 723 messages (723 
seen) for shakechen at pop3.126.com (36923210 octets). Dec 7 16:02:09 
mail fetchmail[4179]: sleeping at Mon Dec 7 16:02:09 2009 for 30 seconds</p><p></p><h3> 创建新的SSL key<br></h3><p> 如果你修改了计算机名字或者希望使用自己的信息创建自己的ssl key。</p><ul><li> 下载iredmail提供的脚本</li></ul><p># wget http://iredmail.googlecode.com/hg/iRedMail/tools/generate_ssl_keys.sh</p><ul><li> 编辑脚本里的你希望修改的相关信息</li></ul><p>#
 SSL key. export SSL_CERT_FILE="${ROOTDIR}/certs/iRedMail_CA.pem" export
 SSL_KEY_FILE="${ROOTDIR}/private/iRedMail.key" export TLS_COUNTRY='CN' 
export TLS_STATE='GuangDong' export TLS_CITY='ShenZhen' export 
TLS_COMPANY="${HOSTNAME}" export TLS_DEPARTMENT='IT' export 
TLS_HOSTNAME="${HOSTNAME}" export TLS_ADMIN="root@${HOSTNAME}"</p><ul><li> 执行脚本</li></ul><p># bash generate_ssl_keys.sh SSL keys were generated: - /root/certs/iRedMail_CA.pem - /root/private/iRedMail.key</p><ul><li> 把以前的证书备份一下，把新证书复制到下面两个目录下。</li></ul><p>/etc/ssl/private/iRedMail.key /etc/ssl/certs/iRedMail_CA.pem</p><h3> SPAM邮件进入垃圾箱<br></h3><p> 如果用户是使用邮件客户端，是无法收取到junk的邮件，所以iredmail缺省是让spam的邮件进入收件箱。如果我们希望让spam的邮件，不进入收件箱，直接存在垃圾邮箱的文件夹里。</p><p># cd /var/vmail/sieve # cp dovecot.sieve.sample dovecot.sieve</p><ul><li> 重启dovecot 服务</li></ul><p># /etc/init.d/dovecot restart</p><h3> 如何修改hostname<br></h3><p> 如果我们装完iremdail后，希望修改hostname（FQDN），那么我们需要修改下面相关的内容。</p><ol><li> 修改hostname in /etc/hostname and /etc/hosts</li><li> 产生新的证书 参考上面的faq</li><li> 修改 hostname in amavis.conf</li><li> 修改 hostname in dovecot-quota-warning.sh</li><li> 修改 hostname in posfix/main.cf</li><li> cp -Rf /etc /var/spool/postfix</li></ol><h3> 检测系统的反垃圾和病毒能力<br></h3><p> 装好系统后，如何评估系统的发垃圾和病毒能力？总不能自己给自己发垃圾邮件和病毒邮件吧。</p><p> <a href="http://www.gfi.com/emailsecuritytest/">http://www.gfi.com/emailsecuritytest/</a></p><p> 我们可以通过GFI来测试我们邮件系统的发垃圾和病毒能力。</p><p> 当你的邮箱验证通过后，他会发送垃圾邮件和病毒邮件到你的邮箱，你就可以检测到邮件系统的反垃圾和病毒查杀能力。</p><p> <a href="http://www.antispam-ufrj.pads.ufrj.br/">http://www.antispam-ufrj.pads.ufrj.br/</a></p><p> 测试邮件服务器是否被设成公开转发站</p><p> <a href="http://www.abuse.net/relay.html">http://www.abuse.net/relay.html</a></p><h3> 命令行管理postfix队列<br></h3><ul><li> 查看队列</li></ul><p>postqueue -p</p><ul><li> 删除队列邮件根据ID</li></ul><p>postsuper -d MessageID</p><ul><li> 根据发送者来删除队列邮件，替换 “info@otherdomain.com”就可以</li></ul><p>mailq
 | tail +2 | awk ‘BEGIN { RS = “” } # $7=sender, $8=recipient1, 
$9=recipient2 { if ($7 == “info@otherdomain.com” &amp;&amp; $9 == “”) 
print $1 } ‘ | tr -d ‘*!’ | postsuper -d -</p><ul><li> 根据收件人删除，替换you@yourdomain.com 就可以</li></ul><p>mailq
 | tail +2 | awk ‘BEGIN { RS = “” } # $7=sender, $8=recipient1, 
$9=recipient2 { if ($8 == “you@yourdomain.com” &amp;&amp; $9 == “”) 
print $1 } ‘ | tr -d ‘*!’ | postsuper -d -</p><ul><li> 根据发生服务器的hostname来删除，替换掉 senderhostname</li></ul><p>mailq | grep senderhostname | awk ‘{ print $1′} | postsuper -d -</p><ul><li> 如果当前的系统队列很长，负担很重，我们可以把队列里的邮件先hold</li></ul><p>postsuper -h ALL</p><p> 当处理完后，再把队列移回来</p><p>postsuper -r ALL</p><p> 参考文章 <a href="http://www.faqforge.com/linux/server/manage-the-postfix-mailqueue-with-postsuper-postqueue-und-mailq/">http://www.faqforge.com/linux/server/manage-the-postfix-mailqueue-with-postsuper-postqueue-und-mailq/</a></p><p></p><h3> 命令行测试邮件<br></h3><p> 测试邮件,可以用客户端, 也可以使用命令行测试,这样更加直接.</p><ul><li> BASE64编码的用户名密码</li></ul><p> 我们需要把我们的登录帐号和密码一起编码<br> user：www@example.com<br> pass: iredmail</p><p>#
 perl -MMIME::Base64 -e 'print 
encode_base64("www@example.comwww@example.comiredmail")'; 
d3d3QGV4YW1wbGUuY29tAHd3d0BleGFtcGxlLmNvbQBpcmVkbWFpbA==</p><ul><li> SMTP 登录并发送邮件</li></ul><p> # telnet localhost 25</p><p>
 #在服务器上telnet到本地，下面的是正常输出 Trying&nbsp;::1... Trying 127.0.0.1... 
Connected to localhost. Escape character is '^]'. 220 u910.example.com 
ESMTP iRedMail (Ubuntu) ehlo example.com</p><p> #握手 250-u910.example.com
 250-PIPELINING 250-SIZE 15728640 250-ETRN 250-STARTTLS 250-AUTH PLAIN 
LOGIN 250-AUTH=PLAIN LOGIN 250-ENHANCEDSTATUSCODES 250-8BITMIME 250 DSN 
auth plain d3d3QGV4YW1wbGUuY29tAHd3d0BleGFtcGxlLmNvbQBpcmVkbWFpbA==</p><p> # 输入base 64后的用户名和密码 235 2.7.0 Authentication successful mail from:<a href="mailto:www@example.com">www@example.com</a></p><p>
 #使用 www@example.com 帐号对外发送邮件 250 2.1.0 Ok rcpt 
to:&lt;shake.chen@gmail.com&gt; #发送邮件到 shake.chen@gmail.com 这个邮箱 250 
2.1.5 Ok data</p><p> #输入data命令后，下面就是邮件的内容 354 End data with 
&lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt; to:shake.chen@gmail.com 
#这是邮件里显示的发送给谁。 from:www@example.com</p><p> #那个帐号发送过来的 subject: test by telnet smtp #邮件的主题 test , just a test ,check the subject whetehr working. .</p><p> #写完邮件后，输入一个点，回车，就表示邮件完成。 250 2.0.0 Ok: queued as B6B4820EC9 quit #退出 221 2.0.0 Bye Connection closed by foreign host.</p><p></p><ul><li> pop3连接</li></ul><p> 可以在远程使用命令行或者本地来测试pop3</p><p>
 # telnet localhost 110 #登录110端口 Trying&nbsp;::1... Trying 127.0.0.1... 
Connected to localhost. Escape character is '^]'. +OK Dovecot ready. 
user <a href="mailto:www@example.com">www@example.com</a></p><p> #输入登录的邮件帐号 +OK pass iredmail #帐号的密码，这里直接输入密码就可以 +OK Logged in. list</p><p> #查看邮箱里的邮件 +OK 4 messages: 1 1182 2 6195 3 1588 4 878 . retr 1</p><p> #显示第一封邮件内容 quit</p><p> #退出 +OK Logging out. Connection closed by foreign host.</p><p> 注：以上内容摘自Ubuntu 中文站点！</p><div style="float:left"><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["tsina","weixin","mail","copy","qzone","sqq","bdhome","evernotecn","tqq","youdao","linkedin","fbook","twi","bdysc"],"bdPic":"","bdStyle":"1","bdSize":"16"},"slide":{"type":"slide","bdImg":"0","bdPos":"left","bdTop":"213.5"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div><br><br><div class="fixed"></div></div><div align="center"><a href="http://www.361way.com/wp-content/uploads/juanzheng/weixin.png"><img class="alignnone" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/weixin130.jpg" alt="weixin_pay" width="130" height="130"></a> <a href="http://www.361way.com/wp-content/uploads/juanzheng/zhifu.png"> <img class="alignnoe" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/zhifubao130.jpg" alt="zhifubao_pay" width="130" height="130"></a></div> <br><div style="text-align: center;"><strong><span style="color: #337fe5;">本站的发展离不开您的资助，</span><span style="color: #ff6600;">金额随意,欢迎来赏！</span><br><br><span style="color: #006666;">You can donate through PayPal.<br>My paypal id: itybku@139.com<br>Paypal page: https://www.paypal.me/361way</span></strong></div> <br><div class="under"> <span class="categories">分类: </span><span><a href="http://www.361way.com/category/http-html-web" rel="category tag">http/html/web</a>, <a href="http://www.361way.com/category/open-source-software" rel="category tag">开源软件</a></span> <span class="tags">标签: </span><span><a href="http://www.361way.com/tag/iredmail" rel="tag">iredmail</a></span></div></div><div id="comments"><div id="cmtswitcher"> <a id="commenttab" class="curtab" href="javascript:void(0);">评论 (0)</a> <span class="addcomment"><a href="#respond">发表评论</a></span><div class="fixed"></div></div><div id="commentlist"><ol id="thecomments"><li class="messagebox"> 本文目前尚无任何评论.</li></ol><div class="fixed"></div></div></div><form action="http://www.361way.com/wp-comments-post.php" method="post" id="commentform"><div id="respond"><div id="author_info"><div class="row"> <input type="text" name="author" id="author" class="textfield" size="24" tabindex="1"> <label for="author" class="small">昵称 (必填)</label></div><div class="row"> <input type="text" name="email" id="email" class="textfield" size="24" tabindex="2"> <label for="email" class="small">电子邮箱 (我们会为您保密) (必填)</label></div><div class="row"> <input type="text" name="url" id="url" class="textfield" size="24" tabindex="3"> <label for="url" class="small">网址</label></div><div class="row"><label for="math">请输入 <i>7 + 3 = ?</i> 的计算结果：</label> <input type="text" name="sum" class="text" size="25" tabindex="4"> <input type="hidden" name="num1" value="7"> <input type="hidden" name="num2" value="3"></div></div><div class="row"><textarea name="comment" id="comment" tabindex="4" rows="8" cols="50"></textarea></div><div id="submitbox"> <a class="feed" href="http://www.361way.com/comments/feed">订阅评论</a><div class="submitbutton"> <input name="submit" type="submit" id="submit" class="button" tabindex="5" value="提交评论"></div> <input type="hidden" name="comment_post_ID" value="1301"><div class="fixed"></div></div></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="577de62319"></p><p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1557649461718"></form><div id="postnavi"> <span class="prev"><a href="http://www.361way.com/designofdeath/1309.html" rel="next">杀生下载</a></span> <span class="next"><a href="http://www.361way.com/nginx-404/1299.html" rel="prev">nginx404错误页面指向</a></span><div class="fixed"></div></div><div id="related_posts"><h3>您可能也喜欢</h3><ul></ul></div></div><div id="sidebar"><div id="northsidebar" class="sidebar"><div class="widget widget_feeds"><div class="content"><div id="subscribe"><a rel="external nofollow" id="feedrss" title="Subscribe to this blog..." href="http://www.361way.com/feed"><abbr title="Really Simple Syndication">RSS</abbr></a><ul id="feed_readers" style="visibility: hidden; display: block;"><li id="google_reader"><a rel="external nofollow" class="reader" title="Subscribe with Google" href="http://fusion.google.com/add?feedurl=http://www.361way.com/feed"><span>Google</span></a></li><li id="youdao_reader"><a rel="external nofollow" class="reader" title="Subscribe with Youdao" href="http://reader.youdao.com/#url=http://www.361way.com/feed"><span>Youdao</span></a></li><li id="xianguo_reader"><a rel="external nofollow" class="reader" title="Subscribe with Xian Guo" href="http://www.xianguo.com/subscribe.php?url=http://www.361way.com/feed"><span>Xian Guo</span></a></li><li id="zhuaxia_reader"><a rel="external nofollow" class="reader" title="Subscribe with Zhua Xia" href="http://www.zhuaxia.com/add_channel.php?url=http://www.361way.com/feed"><span>Zhua Xia</span></a></li><li id="yahoo_reader"><a rel="external nofollow" class="reader" title="Subscribe with My Yahoo!" href="http://add.my.yahoo.com/rss?url=http://www.361way.com/feed"><span>My Yahoo!</span></a></li><li id="newsgator_reader"><a rel="external nofollow" class="reader" title="Subscribe with newsgator" href="http://www.newsgator.com/ngs/subscriber/subfext.aspx?url=http://www.361way.com/feed"><span>newsgator</span></a></li><li id="bloglines_reader"><a rel="external nofollow" class="reader" title="Subscribe with Bloglines" href="http://www.bloglines.com/sub/http://www.361way.com/feed"><span>Bloglines</span></a></li><li id="inezha_reader"><a rel="external nofollow" class="reader last" title="Subscribe with iNezha" href="http://inezha.com/add?url=http://www.361way.com/feed"><span>iNezha</span></a></li></ul></div><div class="fixed"></div></div></div><div id="text-3" class="widget widget_text"><h3>捐助本站</h3><div class="textwidget"><p></p><div align="center"><a href="http://www.361way.com/wp-content/uploads/juanzheng/donation.png"><img class="alignnone" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/donation-mini.png" alt="weixin_pay"></a></div> 如您感觉本博客有用，可扫码捐赠本站！<p></p></div></div><div id="recent-posts-2" class="widget widget_recent_entries"><h3>近期文章</h3><ul><li> <a href="http://www.361way.com/golang-rw-xlsx/6068.html">golang读写excel</a></li><li> <a href="http://www.361way.com/gin-mvc-api/6075.html">gin mvc restful api构建</a></li><li> <a href="http://www.361way.com/gorm-sql/6061.html">golang gorm处理SQL数据</a></li><li> <a href="http://www.361way.com/gin-mysql-restful-api/6052.html">golang+gin+mysql构建RESTful API</a></li><li> <a href="http://www.361way.com/go-restful-json-api/6049.html">golang创建RESTful JSON API</a></li></ul></div><div id="archives-2" class="widget widget_archive"><h3>文章归档</h3> <label class="screen-reader-text" for="archives-dropdown-2">文章归档</label> <select id="archives-dropdown-2" name="archive-dropdown" onchange="document.location.href=this.options[this.selectedIndex].value;"><option value="" selected="selected">选择月份</option><option value="http://www.361way.com/date/2019/04"> 2019年四月 &nbsp;(1)</option><option value="http://www.361way.com/date/2019/03"> 2019年三月 &nbsp;(6)</option><option value="http://www.361way.com/date/2019/02"> 2019年二月 &nbsp;(6)</option><option value="http://www.361way.com/date/2019/01"> 2019年一月 &nbsp;(7)</option><option value="http://www.361way.com/date/2018/12"> 2018年十二月 &nbsp;(13)</option><option value="http://www.361way.com/date/2018/11"> 2018年十一月 &nbsp;(10)</option><option value="http://www.361way.com/date/2018/10"> 2018年十月 &nbsp;(6)</option><option value="http://www.361way.com/date/2018/09"> 2018年九月 &nbsp;(6)</option><option value="http://www.361way.com/date/2018/08"> 2018年八月 &nbsp;(10)</option><option value="http://www.361way.com/date/2018/07"> 2018年七月 &nbsp;(3)</option><option value="http://www.361way.com/date/2018/06"> 2018年六月 &nbsp;(4)</option><option value="http://www.361way.com/date/2018/05"> 2018年五月 &nbsp;(4)</option><option value="http://www.361way.com/date/2018/04"> 2018年四月 &nbsp;(5)</option><option value="http://www.361way.com/date/2018/03"> 2018年三月 &nbsp;(4)</option><option value="http://www.361way.com/date/2018/02"> 2018年二月 &nbsp;(7)</option><option value="http://www.361way.com/date/2018/01"> 2018年一月 &nbsp;(7)</option><option value="http://www.361way.com/date/2017/12"> 2017年十二月 &nbsp;(3)</option><option value="http://www.361way.com/date/2017/11"> 2017年十一月 &nbsp;(3)</option><option value="http://www.361way.com/date/2017/10"> 2017年十月 &nbsp;(4)</option><option value="http://www.361way.com/date/2017/09"> 2017年九月 &nbsp;(5)</option><option value="http://www.361way.com/date/2017/08"> 2017年八月 &nbsp;(8)</option><option value="http://www.361way.com/date/2017/07"> 2017年七月 &nbsp;(6)</option><option value="http://www.361way.com/date/2017/06"> 2017年六月 &nbsp;(4)</option><option value="http://www.361way.com/date/2017/05"> 2017年五月 &nbsp;(5)</option><option value="http://www.361way.com/date/2017/03"> 2017年三月 &nbsp;(5)</option><option value="http://www.361way.com/date/2017/02"> 2017年二月 &nbsp;(7)</option><option value="http://www.361way.com/date/2017/01"> 2017年一月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/12"> 2016年十二月 &nbsp;(4)</option><option value="http://www.361way.com/date/2016/11"> 2016年十一月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/10"> 2016年十月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/09"> 2016年九月 &nbsp;(6)</option><option value="http://www.361way.com/date/2016/08"> 2016年八月 &nbsp;(9)</option><option value="http://www.361way.com/date/2016/07"> 2016年七月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/06"> 2016年六月 &nbsp;(11)</option><option value="http://www.361way.com/date/2016/05"> 2016年五月 &nbsp;(18)</option><option value="http://www.361way.com/date/2016/04"> 2016年四月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/03"> 2016年三月 &nbsp;(7)</option><option value="http://www.361way.com/date/2016/02"> 2016年二月 &nbsp;(9)</option><option value="http://www.361way.com/date/2016/01"> 2016年一月 &nbsp;(9)</option><option value="http://www.361way.com/date/2015/12"> 2015年十二月 &nbsp;(9)</option><option value="http://www.361way.com/date/2015/11"> 2015年十一月 &nbsp;(10)</option><option value="http://www.361way.com/date/2015/10"> 2015年十月 &nbsp;(17)</option><option value="http://www.361way.com/date/2015/09"> 2015年九月 &nbsp;(11)</option><option value="http://www.361way.com/date/2015/08"> 2015年八月 &nbsp;(25)</option><option value="http://www.361way.com/date/2015/07"> 2015年七月 &nbsp;(14)</option><option value="http://www.361way.com/date/2015/06"> 2015年六月 &nbsp;(15)</option><option value="http://www.361way.com/date/2015/05"> 2015年五月 &nbsp;(23)</option><option value="http://www.361way.com/date/2015/04"> 2015年四月 &nbsp;(14)</option><option value="http://www.361way.com/date/2015/03"> 2015年三月 &nbsp;(22)</option><option value="http://www.361way.com/date/2015/02"> 2015年二月 &nbsp;(15)</option><option value="http://www.361way.com/date/2015/01"> 2015年一月 &nbsp;(24)</option><option value="http://www.361way.com/date/2014/12"> 2014年十二月 &nbsp;(15)</option><option value="http://www.361way.com/date/2014/11"> 2014年十一月 &nbsp;(16)</option><option value="http://www.361way.com/date/2014/10"> 2014年十月 &nbsp;(19)</option><option value="http://www.361way.com/date/2014/09"> 2014年九月 &nbsp;(19)</option><option value="http://www.361way.com/date/2014/08"> 2014年八月 &nbsp;(18)</option><option value="http://www.361way.com/date/2014/07"> 2014年七月 &nbsp;(20)</option><option value="http://www.361way.com/date/2014/06"> 2014年六月 &nbsp;(21)</option><option value="http://www.361way.com/date/2014/05"> 2014年五月 &nbsp;(24)</option><option value="http://www.361way.com/date/2014/04"> 2014年四月 &nbsp;(18)</option><option value="http://www.361way.com/date/2014/03"> 2014年三月 &nbsp;(29)</option><option value="http://www.361way.com/date/2014/02"> 2014年二月 &nbsp;(22)</option><option value="http://www.361way.com/date/2014/01"> 2014年一月 &nbsp;(22)</option><option value="http://www.361way.com/date/2013/12"> 2013年十二月 &nbsp;(24)</option><option value="http://www.361way.com/date/2013/11"> 2013年十一月 &nbsp;(20)</option><option value="http://www.361way.com/date/2013/10"> 2013年十月 &nbsp;(19)</option><option value="http://www.361way.com/date/2013/09"> 2013年九月 &nbsp;(16)</option><option value="http://www.361way.com/date/2013/08"> 2013年八月 &nbsp;(17)</option><option value="http://www.361way.com/date/2013/07"> 2013年七月 &nbsp;(21)</option><option value="http://www.361way.com/date/2013/06"> 2013年六月 &nbsp;(21)</option><option value="http://www.361way.com/date/2013/05"> 2013年五月 &nbsp;(19)</option><option value="http://www.361way.com/date/2013/04"> 2013年四月 &nbsp;(18)</option><option value="http://www.361way.com/date/2013/03"> 2013年三月 &nbsp;(24)</option><option value="http://www.361way.com/date/2013/02"> 2013年二月 &nbsp;(21)</option><option value="http://www.361way.com/date/2013/01"> 2013年一月 &nbsp;(18)</option><option value="http://www.361way.com/date/2012/12"> 2012年十二月 &nbsp;(24)</option><option value="http://www.361way.com/date/2012/11"> 2012年十一月 &nbsp;(18)</option><option value="http://www.361way.com/date/2012/10"> 2012年十月 &nbsp;(17)</option><option value="http://www.361way.com/date/2012/09"> 2012年九月 &nbsp;(18)</option><option value="http://www.361way.com/date/2012/08"> 2012年八月 &nbsp;(18)</option><option value="http://www.361way.com/date/2012/07"> 2012年七月 &nbsp;(26)</option><option value="http://www.361way.com/date/2012/06"> 2012年六月 &nbsp;(36)</option><option value="http://www.361way.com/date/2012/05"> 2012年五月 &nbsp;(36)</option><option value="http://www.361way.com/date/2012/04"> 2012年四月 &nbsp;(28)</option><option value="http://www.361way.com/date/2012/03"> 2012年三月 &nbsp;(46)</option><option value="http://www.361way.com/date/2012/02"> 2012年二月 &nbsp;(23)</option><option value="http://www.361way.com/date/2012/01"> 2012年一月 &nbsp;(16)</option><option value="http://www.361way.com/date/2011/12"> 2011年十二月 &nbsp;(27)</option><option value="http://www.361way.com/date/2011/11"> 2011年十一月 &nbsp;(59)</option><option value="http://www.361way.com/date/2011/10"> 2011年十月 &nbsp;(19)</option><option value="http://www.361way.com/date/2011/09"> 2011年九月 &nbsp;(16)</option><option value="http://www.361way.com/date/2011/08"> 2011年八月 &nbsp;(46)</option> </select></div><div id="recent-comments-2" class="widget widget_recent_comments"><h3>近期评论</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="http://www.361way.com/gin-mvc-api/6075.html" rel="external nofollow" class="url">gin mvc restful api构建 - 运维之路</a></span>发表在《<a href="http://www.361way.com/gin-mysql-restful-api/6052.html#comment-77680">golang+gin+mysql构建RESTful API</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.qinfukai.com/?p=91" rel="external nofollow" class="url">Nginx代理缓存服务 - 架构师养成记~</a></span>发表在《<a href="http://www.361way.com/nginx-cache/2665.html#comment-77626">nginx cache查看命中率</a>》</li><li class="recentcomments"><span class="comment-author-link">admin</span>发表在《<a href="http://www.361way.com/prometheus-grafana/5948.html#comment-77582">Prometheus+grafana监控配置</a>》</li><li class="recentcomments"><span class="comment-author-link">heyc</span>发表在《<a href="http://www.361way.com/prometheus-grafana/5948.html#comment-77580">Prometheus+grafana监控配置</a>》</li><li class="recentcomments"><span class="comment-author-link">admin</span>发表在《<a href="http://www.361way.com/wordpress-link/98.html#comment-77514">wordpress使用固定链接</a>》</li></ul></div></div><div id="southsidebar" class="sidebar"><div id="categories-2" class="widget widget_categories"><h3>分类目录</h3><ul><li class="cat-item cat-item-2"><a href="http://www.361way.com/category/programming-anguage">C/C++/Java/Delphi</a></li><li class="cat-item cat-item-407"><a href="http://www.361way.com/category/docker-paas" title="docker、k8s、etcd、openshift、paas等">Docker/k8s/etcd</a></li><li class="cat-item cat-item-3"><a href="http://www.361way.com/category/network-services" title="ftp、dhcp、nfs、samba、mail、vpn等网络服务的搭建及学习">ftp/dhcp/nfs/samba/mail/vpn</a></li><li class="cat-item cat-item-4"><a href="http://www.361way.com/category/http-html-web">http/html/web</a></li><li class="cat-item cat-item-5"><a href="http://www.361way.com/category/itnews">IT动态</a></li><li class="cat-item cat-item-6"><a href="http://www.361way.com/category/linux-unix-mac" title="linux/unix/mac系统学习……">Linux/unix/mac</a></li><li class="cat-item cat-item-8"><a href="http://www.361way.com/category/perlgawksedpython" title="脚本语言学习……">perl/php/python/gawk/sed</a></li><li class="cat-item cat-item-9"><a href="http://www.361way.com/category/shell" title="简单的工具不简单，shell无所不能……">shell脚本学习</a></li><li class="cat-item cat-item-10"><a href="http://www.361way.com/category/windows">windows</a></li><li class="cat-item cat-item-11"><a href="http://www.361way.com/category/collaborative-automation" title="atlassian、testlink等">协同敏捷自动化</a></li><li class="cat-item cat-item-340"><a href="http://www.361way.com/category/big-data">大数据</a></li><li class="cat-item cat-item-12"><a href="http://www.361way.com/category/security">安全/漏洞</a></li><li class="cat-item cat-item-13"><a href="http://www.361way.com/category/platform-architecture">平台架构</a></li><li class="cat-item cat-item-14"><a href="http://www.361way.com/category/open-source-software" title="开源软件一箩筐">开源软件</a></li><li class="cat-item cat-item-7"><a href="http://www.361way.com/category/databases" title="oracle、mysql、mongodb、redis、sqlserver等数据库操作命令、配置、优化及问题总结">数据库</a></li><li class="cat-item cat-item-1"><a href="http://www.361way.com/category/uncategorized">未分类</a></li><li class="cat-item cat-item-15"><a href="http://www.361way.com/category/%e6%9d%82%e4%b8%83%e6%9d%82%e5%85%ab">杂七杂八</a></li><li class="cat-item cat-item-16"><a href="http://www.361way.com/category/%e6%9d%82%e4%b8%83%e6%9d%82%e5%85%ab/%e7%94%9f%e6%b4%bb%e5%a0%86%e7%a0%8c">生活堆砌</a></li><li class="cat-item cat-item-17"><a href="http://www.361way.com/category/virtualization-cloud-automation">虚拟化云和自动化</a></li><li class="cat-item cat-item-18"><a href="http://www.361way.com/category/%e6%9d%82%e4%b8%83%e6%9d%82%e5%85%ab/%e8%af%bb%e5%8f%b2%e7%9f%a5%e6%85%a7">读史知慧</a></li></ul></div></div></div><div class="fixed"></div></div><div id="footer"> <a id="gotop" href="#" onclick="MGJS.goTop();return false;">回到顶部</a><div id="copyright">版权所有 © 2010 运维之路 361way.com <script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?3960c5dc42bb990481818f2b4cfc04f5";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();</script> <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010802007315" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/beian.png" style="float:left;">浙公网安备 33010802007315号</a> |<b><a href="http://www.361way.com/about-me" target="_blank" title="广告合作">广告合作</a></b></div></div></div></div><script type="text/javascript" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/wp-embed.js"></script>
<script async="async" type="text/javascript" src="iredmail%E8%AF%A6%E8%A7%A3%20-%20%E8%BF%90%E7%BB%B4%E4%B9%8B%E8%B7%AF_files/form.js"></script>
<script language="javascript">
function toggle(id){
	var divobj;
	var tgobj;
	divobjid = 'div_'+id;
	tgobjid = 'toggle_'+id;
	divobj=document.getElementById(divobjid);
	tgobj=document.getElementById(tgobjid);
	if(divobj.style.display=="none"){
		divobj.style.display="";
		tgobj.className="expend";
	}else{
		divobj.style.display="none";
		tgobj.className="toggle";
	}
}
</script>






<div class="bdshare-slide-button-box bdshare-slide-style-l0" style="top: 213px; width: 0px; z-index: 99999; left: 0px;" data-bd-bind="1557649463098"><a href="#" onclick="return false;" class="bdshare-slide-button" style="right: -24px;"></a><div class="bdshare-slide-list-box" style="width: 0px; display: none;"><div class="bdshare-slide-top">分享到</div><div class="bdshare-slide-list"><ul class="bdshare-slide-list-ul" style="width: 226px;"></ul></div><div class="bdshare-slide-bottom" style="width: 226px;"><a href="#" onclick="return false;" class="slide-more" data-cmd="more">更多...</a></div></div></div></body></html>
<!-- Dynamic page generated in 0.052 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2019-05-12 16:24:19 -->
<!-- super cache -->