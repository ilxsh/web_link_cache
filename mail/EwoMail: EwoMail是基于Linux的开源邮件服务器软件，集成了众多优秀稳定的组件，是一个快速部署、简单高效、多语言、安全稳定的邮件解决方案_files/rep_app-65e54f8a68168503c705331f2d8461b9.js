function RadarFactory(t,e){function n(t){var e=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,n=e/i;return n}function o(){var t=W.value?W.value.length:0;w.n=t,w.dataRadiusOfPercent=[],w.dataRadius=[],w.angleArr=[],w.tooltipsContentArr=[];for(var e=Math.PI*2/w.n,i=0;t>i;i++)w.dataRadiusOfPercent[i]=W.value[i]/W.maxValue[i],w.dataRadius[i]=w.dataRadiusOfPercent[i]*b.radius,w.angleArr[i]=i*e,b.showTooltip&&(w.tooltipsContentArr[i]=typeof W.tooltipsString=="function"?W.tooltipsString(W.description[i],W.value[i],W.maxValue[i]):typeof W.tooltipsString=="String"?W.tooltipsString:W.description[i]+": <br>"+"最大值: "+W.maxValue[i]+"<br>"+"当前值："+W.value[i])}function a(){var t=0,e=null;(function i(){e=window.requestAnimationFrame(i,x),t+=.05,t>=1&&window.cancelAnimationFrame(e);var n=w.dataRadius.map(function(e){return e*t}),o=l(w.n,b.radius,n,w.angleArr);k.clearRect(0,0,x.width,x.height),u({n:w.n,r:b.radius,data:W.description,mathData:W.value,percent:W.percent,origin:b.origin,fontStyle:b.font.fontStyle,fontColor:b.font.fontColor,mathColor:b.font.mathColor}),g({layer:b.bg.layer,n:w.n,r:b.radius,origin:b.origin,evenFillStyle:b.bg.evenFillStyle,oddFillStyle:b.bg.oddFillStyle,evenStrokeStyle:b.bg.evenStrokeStyle,oddStrokeStyle:b.bg.oddStrokeStyle});var a={dataPoints:o,strokeStyle:b.dataLine.strokeStyle,lineWidth:b.dataLine.lineWidth},r={dataPoints:o,fillStyle:b.dataFill.fillStyle},d={dataPoints:o,r:b.dataCircle.r,strokeStyle:b.dataCircle.strokeStyle,fillStyle:b.dataCircle.fillStyle,lineWidth:b.dataCircle.lineWidth};s({dataLineOptions:a,dataFillOptions:r,dataCircleOptions:d})})()}function r(t,e){var i={};for(var n in t)i[n]=t[n];for(var n in e)i[n]=e[n];return i}function l(t,e,i,n){for(var t=t?t:6,i=i?i:[],n=n?n:[],o=[],a=0;t>a;a++){var r={};r.x=i[a]*Math.sin(n[a]),r.y=-i[a]*Math.cos(n[a]),o.push(r)}return o}function s(t){var e=t.dataLineOptions||{},i=t.dataFillOptions||{},n=t.dataCircleOptions||{};d(e),f(i),y(n)}function d(t){var e=t.strokeStyle?t.strokeStyle:"red",i=t.lineWidth?t.lineWidth:2,n=t.dataPoints?t.dataPoints:[];dataPointsPosArrayLen=n.length,dataPointsPosArrayLen=n.length,k.save(),k.beginPath(),k.translate(b.origin[0],b.origin[1]),k.moveTo(n[0].x,n[0].y);for(var o=1;dataPointsPosArrayLen>o;o++)k.lineTo(n[o].x,n[o].y);k.closePath(),k.strokeStyle=e,k.lineWidth=i,k.lineJoin="round",k.stroke(),k.restore()}function f(t){var e=t.fillStyle?t.fillStyle:"transparent",i=t.dataPoints?t.dataPoints:[];dataPointsPosArrayLen=i.length,k.save(),k.beginPath(),k.translate(b.origin[0],b.origin[1]),k.moveTo(i[0].x,i[0].y);for(var n=1;dataPointsPosArrayLen>n;n++)k.lineTo(i[n].x,i[n].y);k.closePath(),k.fillStyle=e,k.fill(),k.restore()}function y(t){var e=t.r?t.r*F:1*F,i=t.strokeStyle?t.strokeStyle:"#000",n=t.lineWidth?t.lineWidth*F:1*F,o=t.fillStyle?t.fillStyle:"#222",a=t.dataPoints?t.dataPoints:[];dataPointsPosArrayLen=a.length;for(var r=0;dataPointsPosArrayLen>r;r++)c({x:a[r].x,y:a[r].y,r:e,originX:b.origin[0],originY:b.origin[1],strokeStyle:i,lineWidth:n,fillStyle:o})}function c(t){var e=t.x?t.x:0,i=t.y?t.y:0,n=t.r?t.r:10,o=t.originX?t.originX:0,a=t.originY?t.originY:0,r=t.strokeStyle?t.strokeStyle:"#000",l=t.lineWidth?t.lineWidth:2,s=t.fillStyle?t.fillStyle:"#fff";k.save(),k.beginPath(),k.translate(o,a),k.arc(e,i,n,0,Math.PI*2),k.closePath(),k.strokeStyle=r,k.lineWidth=l,k.lineJoin="round",k.fillStyle=s,k.stroke(),k.fill(),k.restore()}function p(e){var i=e.tooltipEle?e.tooltipEle:null,n=e.tootipContentArray?e.tootipContentArray:[],o=e.tooltipOffsetX?e.tooltipOffsetX:0,a=e.tooltipOffsetY?e.tooltipOffsetY:0,r=e.dataCircleRadius?e.dataCircleRadius:10,s=l(w.n,b.radius,w.dataRadius,w.angleArr);if(dataPointsPosArrayLen=s.length,i){var d=!1,f=i;t.addEventListener("mousemove",function(t){for(var e=0;dataPointsPosArrayLen>e;e++){d=!1;var i=0;if(s[e]&&(i=Math.pow(t.pageX-C-s[e].x-b.origin[0],2)+Math.pow(t.pageY-P-s[e].y-b.origin[1],2),i<=Math.pow(r,2))){f.style.left=t.pageX-C+o+"px",f.style.top=t.pageY-P+a+"px",f.innerHTML=n[e],d=!0;break}}f.style.display=d?"block":"none"})}}function h(t,e,n){var t=t?t:5,e=e?e:30,o=[],a=Math.PI*2/t;for(i=0;t>i;i++){var r={};r.x=e*Math.sin(i*a)+n[0],r.y=-e*Math.cos(i*a)+n[1],o.push(r)}return o}function S(t){var e=t.n?t.n:5,n=t.r?t.r:30,o=t.origin?t.origin:[0,0],a=t.fillStyle?t.fillStyle:"transparent",r=t.strokeStyle?t.strokeStyle:"#000",l=t.lineWidth?t.lineWidth*F:1*F,s=t.lineCap?t.lineCap:"butt";k.save(),k.beginPath();var d=Math.PI*2/e;for(k.translate(o[0],o[1]),k.moveTo(0,-n),i=0;e>i;i++)k.rotate(d),k.lineTo(0,-n);k.closePath(),t.strokeStyle&&(k.strokeStyle=r,k.lineWidth=l,k.lineCap=s,k.stroke()),t.fillStyle&&(k.fillStyle=a,k.fill()),k.restore()}function u(t){var e=t.data?t.data:[],i=t.mathData?t.mathData:[],n=t.percent?t.percent:[],o=t.n?t.n:5,a=t.r?t.r:30,r=t.origin?t.origin:[0,0],l=t.limit?t.limit:10,s=t.fontStyle?t.fontStyle:"",d=t.fontColor?t.fontColor:"#000",f=t.mathColor?t.mathColor:"#000",y=h(o,a,r);k.save(),k.font=s;for(var c=0;c<e.length;c++){var p=y[c].x,S=y[c].y;Math.abs(y[c].x-r[0])>=l?y[c].x-r[0]>0?(k.textAlign="left",p+=16):y[c].x-r[0]<0&&(k.textAlign="right",p-=16):k.textAlign="center",Math.abs(y[c].y-r[1])>=a-l&&(y[c].y-r[1]<0?S-=13*F+12:y[c].y-r[1]>0&&(S+=28)),k.fillStyle=d,k.fillText(e[c],p,S),k.fillStyle=f,IsN=isNaN(n[c])?"":" (>"+n[c]+"%)",k.fillText((i[c]*100).toFixed(0)+IsN,p,S+13*F)}k.restore()}function g(t){for(var e=t.layer?t.layer:5,i=t.n?t.n:5,n=t.r?t.r:50,o=t.origin?t.origin:[0,0],a=t.evenStrokeStyle?t.evenStrokeStyle:"#ccc",r=t.oddStrokeStyle?t.oddStrokeStyle:"#ccc",l=t.evenFillStyle?t.evenFillStyle:"#eee",s=t.oddFillStyle?t.oddFillStyle:"transparent",d=[],f=n/e,y=0;e>y;y++)d[y]=f*(y+1);d=d.reverse();for(var y=0;e>y;y++)0!=y%2?S({n:i,r:d[y],origin:o,fillStyle:l,strokeStyle:a,lineWidth:1}):S({n:i,r:d[y],origin:o,fillStyle:s,strokeStyle:r,lineWidth:1});k.save(),k.beginPath();for(var c=h(i,n,o),y=0;i>y;y++)k.moveTo(o[0],o[1]),k.lineTo(c[y].x,c[y].y);k.strokeStyle=a,k.lineWidth=1,k.stroke(),k.restore()}if(this.init=function(){},t){var v=t.offsetWidth,m=t.offsetHeight,C=t.offsetLeft,P=t.offsetTop,x=document.createElement("canvas");t.appendChild(x),x=t.getElementsByTagName("canvas")[0];var k=x.getContext("2d"),F=n(k)||1;x.width=v*F,x.height=m*F,x.style.width=v+"px",x.style.height=m+"px";var b=r({scale:1,origin:[x.width/2,x.height/2],showTooltip:!1},e.config),A=Math.min(x.width,x.height)*.5*.6*b.scale;b.radius=b.radius?b.radius:A,b.bg=r({layer:7,evenFillStyle:"#fff",oddFillStyle:"#eee",evenStrokeStyle:"#ddd",oddStrokeStyle:"#ddd"},b.bg),b.dataFill=r({fillStyle:"transparent"},b.dataFill),b.dataLine=r({strokeStyle:"red",lineWidth:2*F},b.dataLine),b.dataCircle=r({r:2*F,strokeStyle:"red",lineWidth:2*F,fillStyle:"#fff"},b.dataCircle),b.tooltip=r({r:b.dataCircle.r,offsetX:0,offsetY:0},b.tooltip),b.font=r({fontStyle:12*F+"px Pingfang SC,STHeiti,Lantinghei SC,Open Sans,Arial,Hiragino Sans GB,Microsoft YaHei,WenQuanYi Micro Hei,SimSun,sans-serif",fontColor:"#000",mathColor:"#000"},b.font);var W=r({description:[],tooltipsString:[],maxValue:[],value:[],percent:[]},e.data),w={};this.init=function(){o(),t.style.position="relative",a(),b.showTooltip&&(w.tooltipEle=document.createElement("div"),w.tooltipEle.className="radar-tooltips",w.tooltipEle.style.position="absolute",w.tooltipEle.style.display="none",t.appendChild(w.tooltipEle),p({tooltipEle:t.getElementsByClassName("radar-tooltips")[0],tootipContentArray:w.tooltipsContentArr,tooltipOffsetX:b.tooltip.offsetX,tooltipOffsetY:b.tooltip.offsetY,dataCircleRadius:b.tooltip.r}))},this.getPolygonPos=function(){h(w.n,b.radius,b.origin)}}}var radarChart={};radarChart.init=function(t,e){new RadarFactory(t,e).init()},$(function(){var t,e=gon.locale||"zh-CN",i={"zh-CN":{property:["代码活跃度","社区活跃度","团队健康","流行趋势","影响力"],transcend:{header:"超过 ",end:" 项目",exponent:" 码云指数为"},nodata:"预计24小时后提供码云指数",updatetime:"上次更新于 "},"zh-TW":{property:["代碼活躍度","社區活躍度","團隊健康","流行趨勢","影響力"],transcend:{header:"超過 ",end:" 項目",exponent:" 碼雲指數為"},nodata:"預計24小時後提供碼雲指數",updatetime:"上次更新於 "},en:{property:["Activity","Community","Health","Trend","Influence"],transcend:{header:"surpass ",end:" projects",exponent:" gitee score is"},nodata:"Gitee score is expected to be provided in 24 hours",updatetime:"Last update on "}},n=[.15,.2,.1,.25,.3],o=i[e],a=$(".metrics-radar"),r=$("#metrics-radar"),l=$(".total-percent"),s=r.find(".wrap"),d=l.find(".percent-score"),f=l.find(".percent-header"),y=l.find(".percent-end"),c=r.data("url"),p=$(".finaltime"),h=$(".exponent-total-sorce"),S=$(".gitee-exponent"),u=S.find(".text"),g=S.find(".exponent-score");c&&$.getJSON(c).success(function(e){var i=e;if(null===i)return r.removeClass("hide"),r.css({width:"auto","padding-bottom":"10px"}),r.html(o.nodata),void 0;var l=[i.vitality,i.community,i.health,i.trend,i.influence],c=[i.vitality_percent,i.community_percent,i.health_percent,i.trend_percent,i.influence_percent],S=0,v=[],m=o.property,C=[],P={data:{maxValue:C,value:l,description:m,percent:v},config:{bg:{layer:3,evenFillStyle:"#F2F4F6",oddFillStyle:"#F8F9FA",evenStrokeStyle:"#DCE3E8",oddStrokeStyle:"#DCE3E8"},dataFill:{fillStyle:"RGBA(254,115,0,0.2)"},dataLine:{strokeStyle:"RGBA(254,115,0,0.5)",lineWidth:2},dataCircle:{r:3,strokeStyle:"#FE7300",fillStyle:"#FE7300",lineWidth:2},font:{fontColor:"#537C8D",mathColor:"#9b9b9b"}}};for(t=0;t<c.length;++t)v.push(parseInt(c[t]*100,0)),C.push(1),S+=Number(l[t]*100)*n[t];s.height(240),r.removeClass("hide"),radarChart.init(s[0],P),a.one("click",function(){var t=s.find("canvas");t.first().height()===0&&(t.remove(),radarChart.init(s[0],P))}),p.html(o.updatetime+i.updated_at.substring(0,10)),d.html(parseInt(i.all_percent*100,0)+"%"),f.html(o.transcend.header),y.html(o.transcend.end),h.html(S.toFixed(0)),u.html(o.transcend.exponent),g.html(S.toFixed(0))})});