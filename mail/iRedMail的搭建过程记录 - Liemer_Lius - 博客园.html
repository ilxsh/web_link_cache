<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="origin" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <title>iRedMail的搭建过程记录 - Liemer_Lius - 博客园</title>
    <meta property="og:description" content="iRedMail的搭建和注意事项" />
    <link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=KOZafwuaDasEedEenI5aTy8aXH0epbm6VUJ0v3vsT_Q1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/summerGarden/bundle-summerGarden.css?v=R6EW1cwbYc7SqZ5y0CMKPNjYaFnIdEGDIwRo4NL-lHw1"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/summerGarden/bundle-summerGarden-mobile.css?v=0rD5dztz_pRczoCFf4jzWyb4-oTf_yCZ8ttZxIagC2s1"/>
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/llius/rss"/>
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/llius/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/llius/wlwmanifest.xml"/>
    <script src="//common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script>var currentBlogId=257838;var currentBlogApp='llius',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="/bundles/blog-common.js?v=smtcUT5dhdu_5eEO8CKHYoVc7DPLgEBGzp6zKkstlzg1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>


<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="https://www.cnblogs.com/llius/"><img id="blogLogo" src="/Skins/custom/images/logo.gif" alt="返回主页" /></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/llius/">Liemer_Lius</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
	<li></li>
	<li><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/llius/">首页</a></li>
	<li><a href="http://news.cnblogs.com/">新闻</a></li>
	<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
	<li></li>
	<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
	<li>
	</li>
</ul>


		<div class="blogStats">
			
			<div id="blog_stats">
<!--done-->
随笔- 33&nbsp;
文章- 0&nbsp;
评论- 0&nbsp;
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/llius/p/5076235.html">iRedMail的搭建过程记录</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p style="text-align: center;"><span style="font-size: 18px; font-family: verdana,geneva;">iRedMail的搭建和<span style="font-size: 18px; font-family: verdana,geneva;">注意事项</span></span></p>
<p><span style="font-family: verdana,geneva;">经过一段时间的折腾，终于将iRedMail搭建起来了，下面介绍一下搭建的过程，以及注意事项。</span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: verdana,geneva;">注意事项：&nbsp;</span></strong></p>
<p><span style="font-family: verdana,geneva;">　　1. iRedMail不支持重复安装，如果安装错误，请重置环境；开始安装时候，尽量选择一个干净的环境。这也是选择云服务器的原因，小巧、经济。<br /></span></p>
<p><span style="font-family: verdana,geneva;">　　2. epel源是安装的必要条件。<br /></span></p>
<p><span style="font-family: verdana,geneva;">　　3. 修改/etc/hosts, <span style="font-family: verdana,geneva;">127.0.0.1</span>增加mail.lius.space（邮箱域名，因人而异）并切换到这个hostname，以及<span style="font-family: verdana,geneva;">修改</span>安装脚本iredmail.org为镜像ip的操作是必须的。<br /></span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: verdana,geneva; font-size: 18px;">1. 前期准备</span></strong></p>
<p>&nbsp;</p>
<p><span style="font-family: verdana,geneva;">　　【1】hostname的设定和iredmail.org的hosts指定<br /></span></p>
<div class="cnblogs_code">
<pre># vim /etc/<span style="color: #000000;">hosts
在127.</span><span style="color: #800080;">0.0</span>.1的后面添加mail.lius.space     <span style="color: #008000;">//</span><span style="color: #008000;">设定的邮箱域名</span>
在最下面添加一段：<span style="color: #800080;">106.187</span>.<span style="color: #800080;">51.47</span><span style="color: #000000;"> www.iredmail.org iredmail.org，保存退出。
# </span><span style="color: #0000ff;">hostname</span><span style="color: #000000;"> mail.lius.space
# bash
# </span><span style="color: #0000ff;">hostname</span> -f   <span style="color: #008000;">//</span><span style="color: #008000;">看一下输出结果是不是mail.lius.space</span></pre>
</div>
<p>　　【2】MX记录的添加，下面以阿里云的万网域名的MX记录添加为例：</p>
<p>　　需要购买一个域名，还要有个带公网ip的服务器（虚拟机因为没有公网ip，只能发邮件，而不能收），云服务器既轻巧又实惠，是最佳选择。比如我们购买的域名是lius.space，公网ip是115.23.56.232，开始下面的配置：</p>
<p>&nbsp;</p>
<p>　　打开阿里云的页面 --&gt; 登录 --&gt; 点击左上角自己的账户名称 --&gt; 点击菜单选项中的&ldquo;云解析&rdquo; --&gt; 点击自己的域名</p>
<p>&nbsp;</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225145133656-181797068.png" alt="" width="1016" height="230" /></p>
<p>+</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225145217171-970986857.png" alt="" width="1018" height="87" /></p>
<p>&nbsp;</p>
<p>　　添加MX记录：</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225145757312-9696700.png" alt="" width="1011" height="160" /></p>
<p>&nbsp;</p>
<p>　点击添加解析，共增加两行记录，分两次添加；标题和对应的值如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">主机记录    记录类型    线路类型    记录值                MX优先级
mail         A        默认       </span><span style="color: #000000;">115.23.56.232
@　　　　　　　MX       默认       mail.lius.space.        </span><span style="color: #800080;">5</span></pre>
</div>
<p>　　一个记录指向服务器的域名，注意后面有个&ldquo;.&rdquo;，不过即使不加，系统也会自动添加，优先级5或者10都可以；</p>
<p>　　一个指向公网ip，也就是服务器的ip地址；</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 18px;">2. 下载iRedMail和相应参数调整</span></strong></p>
<p>&nbsp;</p>
<p>　　在一个合适的目录，下载和安装iRedMail，推荐下载地址：https://bitbucket.org/zhb/iredmail/downloads，选择0.9.2的版本就好。（官网只找到了最新版0.9.3的下载地址，参数有调整，修改方法还没查资料）</p>
<div class="cnblogs_code">
<pre># cd /usr/local/src/<br /># wget https://bitbucket.org/zhb/iredmail/downloads/iRedMail-0.9.2.tar.bz2<br /># tar jxvf iRedMail-0.9.2.tar.bz2<br /># cd iRedMail-<span style="color: #800080;">0.9</span>.<span style="color: #800080;">0</span>/pkgs/<span style="color: #000000;">
# vim get_all.</span><span style="color: #0000ff;">sh</span><span style="color: #000000;">
用搜索的功能，修改https </span>--&gt; http；下载地址相关的iredmail.org --&gt; <span style="color: #800080;">106.187</span>.<span style="color: #800080;">51.47<br /></span><span style="color: #000000;">修改的原因：国内已经将iredmail.org屏蔽，以上ip是日本镜像地址。
用命令也可以完成修改<br /># </span><span style="color: #0000ff;">sed</span> -i <span style="color: #800000;">'</span><span style="color: #800000;">s/iredmail.org/106.187.51.47/g</span><span style="color: #800000;">'</span> get_all.<span style="color: #0000ff;">sh</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>3. yum源扩展和执行下载脚本</strong></span></p>
<p>&nbsp;</p>
<p>　　在/etc/yum.repo.d/目录下面，确定要有epel的扩展源（epel.repo &amp;&amp; epel-testing.repo），如果没有，yum install -y epel-release</p>
<div class="cnblogs_code">
<pre># cd /usr/local/src/iRedMail-<span style="color: #800080;">0.9</span>.<span style="color: #800080;">0</span>/<span style="color: #000000;">
# </span><span style="color: #0000ff;">sh</span> iRedMail.<span style="color: #0000ff;">sh</span></pre>
</div>
<p>　　</p>
<p>　　经过漫长的等待，会出现一个类图形界面：</p>
<p>&nbsp;</p>
<p>　　第一步，点击Yes；（用键盘操作方法：Tab键&ldquo;切换&rdquo;，空格键&ldquo;选择&rdquo;或&ldquo;取消选择&rdquo;，Enter键&ldquo;确定&rdquo;）</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225151939468-252364000.gif" alt="" />　</p>
<p>&nbsp;</p>
<p>　　第二步，填写邮件的存放目录，默认即可，但确保磁盘空间足够大。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152202671-949004148.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　第三步，选择数据库，我们选的是MySQL。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152444046-232173081.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　第四步，给MySQL数据库的root用户设定一个密码。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152524140-1269494753.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　第五步，给邮箱添加域，这个域不能与mail.lius.space相同，可以是lius.com一类，不一定非要以space结尾；安装完成后，可以在浏览器登录邮箱管理员，增加域。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152604843-1087010902.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　第六步，给iRedMail邮箱管理员添加一个密码。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152805718-458999020.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　第七步，选择安装的组件，默认即可。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225152849577-955428914.gif" alt="" /></p>
<p>&nbsp;</p>
<p>　　以后的步骤按部就班即可；跳出如&ldquo;[Y|n]n&rdquo;的选项，除与22端口相关的为&ldquo;n&rdquo;以外，其余全部&ldquo;y&rdquo;。</p>
<div class="cnblogs_code">
<pre>Would you like to use firewall rules provided by iRedMail now? <br />&lt; Question &gt; File: /etc/sysconfig/iptables, with SSHD port: <span style="color: #800080;">22</span>. [Y|n]n</pre>
</div>
<p>　　</p>
<p>　　安装结束，会有如下提示：</p>
<div class="cnblogs_code">
<pre>********************************************************************
*<span style="color: #000000;"> URLs of installed web applications:
</span>*
* -<span style="color: #000000;"> Webmail:
</span>*   o Roundcube webmail: httpS:<span style="color: #008000;">//</span><span style="color: #008000;">mail.lius.space/mail/</span>
*
* - Web admin panel (iRedAdmin): httpS:<span style="color: #008000;">//</span><span style="color: #008000;">mail.lius.space/iredadmin/</span>
*
* You can <span style="color: #0000ff;">login</span><span style="color: #000000;"> to above links with same credential:
</span>*
*<span style="color: #000000;">   o Username: postmaster@lius.space
</span>*<span style="color: #000000;">   o Password: root
</span>*
*
********************************************************************
*<span style="color: #000000;"> Congratulations, mail server setup completed successfully. Please
</span>* read below <span style="color: #0000ff;">file</span> <span style="color: #0000ff;">for</span> <span style="color: #0000ff;">more</span><span style="color: #000000;"> information:
</span>*
*   - /usr/local/src/iRedMail-<span style="color: #800080;">0.9</span>.<span style="color: #800080;">2</span>/<span style="color: #000000;">iRedMail.tips
</span>*
* And it<span style="color: #800000;">'</span><span style="color: #800000;">s sent to your mail account postmaster@lius.space.</span>
*
********************* WARNING **************************************
*
*<span style="color: #000000;"> Rebooting your system is required to enable mail services.
</span>*
********************************************************************</pre>
</div>
<p>&nbsp;</p>
<p>　　第八步，启动所有相关的服务；</p>
<div class="cnblogs_code">
<pre># <span style="color: #0000ff;">for</span> s <span style="color: #0000ff;">in</span> httpd iredapd amavisd clamd postfix dovecot cbpolicyd spamassassin clamd.amavisd saslauthd fail2ban; <span style="color: #0000ff;">do</span> /etc/init.d/$s restart; <span style="color: #0000ff;">done</span></pre>
</div>
<p>　　如果很多提示关闭失败的提示，不用管，原因是服务以前就是关闭的。</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 18px;">4. 账户的登录和管理</span></strong></p>
<p>&nbsp;</p>
<p>　　根据上面安装结束时的提示：</p>
<div class="cnblogs_code">
<pre>Roundcube webmail: httpS:<span style="color: #008000;">//</span><span style="color: #008000;">mail.lius.space/mail/   </span><span style="color: #008000;">//</span><span style="color: #008000;">登录邮箱</span>
<span style="color: #000000;">
Web admin panel (iRedAdmin): httpS:</span><span style="color: #008000;">//</span><span style="color: #008000;">mail.lius.space/iredadmin/    </span><span style="color: #008000;">//</span><span style="color: #008000;">登录管理后台</span>
<span style="color: #000000;">
Username: postmaster@lius.space   </span><span style="color: #008000;">//</span><span style="color: #008000;">管理员邮箱地址，即账号</span>
<span style="color: #000000;">
Password: root   </span><span style="color: #008000;">//</span><span style="color: #008000;">管理员登录密码，类图形界面操作时设定的。</span></pre>
</div>
<p>　　注意的是，https地址由于没有购买认证，浏览器会提示危险，直接访问即可；</p>
<p>&nbsp;</p>
<p>　　【1】邮箱管理页面：</p>
<p>　　　　登录界面：</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225153934171-510900310.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　　　添加域，可以丰富邮箱的尾缀。</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154002015-1579700940.png" alt="" /></p>
<p>+</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154029296-453093634.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　　　添加iRedMail邮箱账号：</p>
<p><span style="font-family: verdana,geneva;"><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154113437-444407168.png" alt="" /></span></p>
<p>&nbsp;</p>
<p>　　（可选择自己定义的域）</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154128234-2096192025.png" alt="" width="631" height="285" /></p>
<p>&nbsp;</p>
<p><span style="font-family: verdana,geneva;">　　【2】iRedMail邮箱用户登录和邮件操作<br /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: verdana,geneva;">　　<span style="font-family: verdana,geneva;">邮箱登录界面：</span></span></p>
<p><span style="font-family: verdana,geneva;"><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154401999-1561695366.png" alt="" /></span></p>
<p>&nbsp;</p>
<p>　　（熟悉的功能和操作界面）</p>
<p><img src="https://images2015.cnblogs.com/blog/853829/201512/853829-20151225154428859-301672999.png" alt="" /></p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


		</div>
		<div class = "postDesc">posted @ <span id="post-date">2015-12-25 16:11</span> <a href='https://www.cnblogs.com/llius/'>Liemer_Lius</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="https://i.cnblogs.com/EditPosts.aspx?postid=5076235" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(5076235);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=257838,cb_entryId=5076235,cb_blogApp=currentBlogApp,cb_blogUserGuid='e227e4d9-959d-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2015/12/25 16:11:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id='cnblogs_c1' class='c_ad_block'>
    <div id='div-gpt-ad-1546353474406-0' style='height:250px; width:300px;'></div>
</div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'>
    <div id='div-gpt-ad-1539008685004-0' style='height:60px; width:468px;'></div>
</div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="calendar"><div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
			
			<DIV id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
			</DIV>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2019 Liemer_Lius
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->

</body>
</html>
