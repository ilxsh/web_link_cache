/*
 * edit by linan
 * 2015.1.17
 *
 */
//ä¿®æ”¹blockUIé»˜è®¤æ ·å¼
$.blockUI.defaults.css = {
		padding:	0,
		margin:		0,
		width:		"30%",
		top:		"30%",
		left:		"50%",
		color:		"#000",
		border:		0,
		borderRadius:"3px",
		backgroundColor : "#fff",
		cursor:		"default"
};
$.blockUI.defaults.overlayCSS = {
		backgroundColor: "#000",
		opacity:	  	 0.3
};

// è·¯éšœå¹¿å‘Š***************************************/
$(function(){
	// æ˜¾ç¤ºè·¯éšœå¹¿å‘Š
	var showTdkAd = function(ad_url) {
		var docHeight = $(document).height(),docWidth = $(document).width();
		var setStyle=
				'<style type="text/css">'+
				'/*2015-07-20 tdkå¼¹çª—å¹¿å‘Š*/'+
				'#fix-tdkad{position: fixed;z-index: 99999;width: 640px;height: 480px;top: 50%;left: 50%;margin:-240px 0 0 -320px;}'+
				'#tdk-close{ background: url(http://www.elecfans.com/images2013/close.png) no-repeat 0 0; cursor: pointer; width: 24px; height: 24px; position: absolute; display: block; right: -12px; top: -12px; z-index: 101;}'+
				'#road-block-bg { background: #999; display: block; position: absolute; left: 0; top: 0; z-index: 99; opacity: 0.5; }'+
				'</style>'
			;
		$('body').append(setStyle+'<div id="fix-tdkad"><iframe width="640" height="480" frameborder="0" src="'+ad_url+'" scrolling="no"></iframe><span id="tdk-close" title="ç‚¹å‡»å…³é—­"></span></div><div id="road-block-bg"></div>');
		$(document).on("click", "#tdk-close", function(){
			closeTdkAd();
		});

	}
	// å…³é—­è·¯éšœå¹¿å‘Š
	var closeTdkAd = function(){
		if($('#fix-tdkad').length){
			$('#fix-tdkad').animate({
				"opacity" : 0
			}, 500, function(){
				$('#fix-tdkad').remove();
				$('#road-block-bg').hide();
			});
		}
	}
	// cookie è®¾ç½®å‡½æ•°
	$.extend({
		cookieHelper: function(name, value, options) {
			if (typeof value != 'undefined') { // name and value given, set cookie
				options = options || {};
				if (value === null) {
					value = '';
					options.expires = -1;
				}
				var expires = '';
				if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
					var date;
					if (typeof options.expires == 'number') {
						date = new Date();
						date.setTime(date.getTime() + (options.expires * 60 * 60 * 1000));
					} else {
						date = options.expires;
					}
					expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE
				}
				var path = options.path ? '; path=' + options.path : '';
				var domain = options.domain ? '; domain=' + options.domain : '';
				var secure = options.secure ? '; secure' : '';
				document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');
			} else { // only name given, get cookie
				var cookieValue = null;
				if (document.cookie && document.cookie != '') {
					var cookies = document.cookie.split(';');
					for (var i = 0; i < cookies.length; i++) {
						var cookie = jQuery.trim(cookies[i]);
						// Does this cookie string begin with the name we want?
						if (cookie.substring(0, name.length + 1) == (name + '=')) {
							cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
							break;
						}
					}
				}
				return cookieValue;
			}
		}
	});
	// è·å–å½“å‰æ ç›®ID
	var get_current_typeid = function() {
		var ad_id = 0;
		if( $('#adChannel').length > 0 ) {
			ad_id = $('#adChannel').val();
		}
		return ad_id;
	}

	if($.cookieHelper("roadblockad") !== "yes"){
		var ad_id = get_current_typeid();
		// æ ç›®IDä¸º0çš„é¡µé¢æ²¡æœ‰å¯¹åº”çš„è·¯éšœå¹¿å‘Š
		if (ad_id == 0 && window.location.href.indexOf('/tags/')>0) {
            ad_id = "homepage"
		}
		$.ajax({
			type:'GET',
			url:'/webapi/advertisement/roadblock',
			data: {site_name:'www', typeid: ad_id},
			dataType:'json',
			success: function(response) {
				if (response.error_code != 0) {
					return false;
				}
				var data = response.data;
				$.cookieHelper("roadblockad", "yes", {expires:data['frequency'], path:"/"});
				showTdkAd(data['ad_url']);
				if(window.location.href.indexOf('d/article/write/')>0){
					closeTdkAd();
				}
				setTimeout(function(){closeTdkAd();}, 30000);
			}
		});
	}







  // æ˜¾ç¤ºè§†é¢‘è·¯éšœå¹¿å‘Š
  var showTdkVideoAd = function(ad_url) {
    var setStyle=
        '<style type="text/css">'+
        '/*2015-07-20 tdkå¼¹çª—å¹¿å‘Š*/'+
        '#isShowVideo{cursor: pointer;background: #000;color: #fff;width: 161px;text-align: left;font-size: 14px;padding: 10px 0 10px 10px;box-sizing:border-box;display: none;}'+
        '.closeOpenxBtn{background: #fff;border: 1px solid #999999;padding: 3px 15px;margin: 8px;color: #999999; cursor: pointer;}'+
        '.goTargetUrl{text-decoration: none;display: block;line-height: 45px;margin-left: 80px;font-size: 15px;}'+
        '</style>'
      ;
    var content = '<div id="isShowVideo">ADI â€œé­”æœ¯æ‰‹â€ä¸Šçº¿<br /> ç‚¹å‡»äº†è§£<br />ADIå¦‚ä½•è¶…è¶Šä¸€åˆ‡å¯èƒ½ï¼</div>'+
                  '<div style="display: flex; display: -ms-flexbox;display: -ms-flexbox;display: -moz-box">'+
                  '<button class="closeOpenxBtn">å…³é—­</button>'+
                  '<a class="goTargetUrl" target="_blank">ADI â€œé­”æœ¯æ‰‹â€ä¸Šçº¿ç‚¹å‡»äº†è§£ADIå¦‚ä½•è¶…è¶Šä¸€åˆ‡å¯èƒ½ï¼&gt;&gt;&gt;</a>'+
                  '</div>'
    var script = "<SCRIPT language='JavaScript1.1' SRC='https://ad.doubleclick.net/ddm/trackimpj/N7384.1821876ELECFANS.COM/B21679777.228535550;dc_trk_aid=426716634;dc_trk_cid=105808177;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=?'></SCRIPT>"
    $('body').append(setStyle+'<div style="position: fixed; right: 0; bottom: 0; z-index: 1001;border: 1px solid #999999;background: #fff;">'+content+'<div id="video-fix-tdkad"><iframe width="640" height="480" frameborder="0" src="'+ad_url+'" scrolling="no"></iframe></div></div>' + script);
    //å…³é—­è§†é¢‘è·¯éšœå¹¿å‘Š
    closeTdkVideoAd()
  }


  function sendGA(){
    //åˆ¤æ–­æµè§ˆå™¨
    //å‘è°·æ­Œå‘é€æ•°æ®
    if(typeof(ga)!="undefined"){
      ga('send', 'event', 'ADI_video_banner', 'click', '[ADI_video_banner]');
    }
    //å‘ç™¾åº¦å‘é€æ•°æ®
    if(typeof(_hmt)!="undefined"){
      _hmt.push(['_trackEvent', 'ADI_video_banner', 'click', '[ADI_video_banner]']);
    }
  }

  var closeTdkVideoAd = function(){
     $('#isShowVideo').click(function(){
      $(this).hide()
      $(".closeOpenxBtn").parent().show()
      $('#video-fix-tdkad').css("display", 'block')
    });
    $('.closeOpenxBtn').click(function(){
        $('#video-fix-tdkad').hide();
        $(this).parent().hide()
        $('#isShowVideo').css("display", 'block')
      })
    $(".goTargetUrl").click(function(){
        sendGA()
        window.open('https://ad.doubleclick.net/ddm/trackclk/N7384.1821876ELECFANS.COM/B21679777.228535550;dc_trk_aid=426716634;dc_trk_cid=105808177;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=')
    })
  }

  //è·å–è§†é¢‘è·¯éšœå¹¿å‘Šåœ°å€
  function getVideoAdUrl(){
    var ad_id = get_current_typeid();
    // æ ç›®IDä¸º0çš„é¡µé¢æ²¡æœ‰å¯¹åº”çš„è·¯éšœå¹¿å‘Š
    if (ad_id == 0 && window.location.href.indexOf('/tags/')>0) {
        ad_id = "homepage"
    }
    $.ajax({
      type:'GET',
      url:'/webapi/advertisement/roadblock',
      data: {site_name:'www', typeid: ad_id, ad_type: 5},
      dataType:'json',
      success: function(response) {
        if (response.error_code != 0) {
          return false;
        }
        var data = response.data;
        $.cookieHelper("videoRoadblockad", "yes", {expires:data['frequency'], path:"/"});
        showTdkVideoAd(data["ad_url"]);
        if(window.location.href.indexOf('d/article/write/')>0){
          $('#isShowVideo').hide();
          $('#video-fix-tdkad').hide();
          $(".closeOpenxBtn").parent().hide()
        }
      }
    });
  }

  //è§†é¢‘è·¯éšœå¹¿å‘Š
  if($.cookieHelper("videoRoadblockad") !== "yes"){
    getVideoAdUrl()
  } else {
    var setStyle=
        '<style type="text/css">'+
        '#isShowVideoNext{cursor:pointer;background: #000;color: #fff;width: 161px;text-align: left;font-size: 14px;padding: 10px 0 10px 10px;; box-sizing: border-box; display: block;}'+
        '</style>'
      ;
    var content = '<div id="isShowVideoNext">ADI â€œé­”æœ¯æ‰‹â€ä¸Šçº¿<br /> ç‚¹å‡»äº†è§£<br />ADIå¦‚ä½•è¶…è¶Šä¸€åˆ‡å¯èƒ½ï¼</div>';
    if(window.location.href.indexOf('d/article/write/') < 0){
      $('body').append(setStyle+'<div style="position: fixed; right: 0; bottom: 0; z-index: 100;border: 1px solid #999999;background: #fff;">'+content+'</div>');
    }
    $("#isShowVideoNext").click(function(){
      $(this).hide()
      getVideoAdUrl()
    })
  }
});

// æ’å…¥å•ç‚¹ç™»å½•JS
;$(function(){
	if ( !$.tActivityLogin ) {
		var setHost ='https://passport.elecfans.com'; //è®¾ç½®åŸŸå
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = setHost + '/public/pc/js/t.passport.js';
        script.setAttribute("id", "sso_script");
        script.setAttribute("data-ssoSite", setHost);
        script.setAttribute("data-ssoReferer", encodeURIComponent(location.href));
        script.setAttribute("data-ssoSiteid", "11");
        var body = document.getElementsByTagName("body").item(0);
        body.appendChild(script);
    }
});

// è·¯éšœå¹¿å‘Š end***************************************/
$(function(){
		$.ajaxSetup ({
			cache: false
		});

        //å¯¼èˆª
        /*
        $("#zhuda").mouseDelay(200).hover(function(){
            $("#subNav").slideDown(100);
        },function(){
            $("#subNav").fadeOut(100);
        });
        */

        //æˆ‘çš„èœå•
        var win_width = $(window).width();
        if(win_width > 1000){
            $("#mine").mouseDelay(200).hover(function(){
                $("#mymenu").show();
            },function(){
                $("#mymenu").hide();
            });
        }else{
            /*
            $("#mine a").on('click',function(){

                $("#mymenu").toggle();
                return false;
            });
            */
        }

		//è¿”å›é¡¶éƒ¨ ----------------
		var back_to_top = $("#backToTop");
		function backToTop(){
				$(window).on('scroll', function() {
						var scroll_top = $(document).scrollTop();
						if( scroll_top > 400 ) {
								back_to_top.fadeIn(400);
						}else {
								back_to_top.fadeOut(400);
						}
				})
		}
		backToTop();
		back_to_top.on('click', function() {
				$(window).off('scroll');
				back_to_top.fadeOut(400);
				$("html, body").animate({ scrollTop: 0 }, 600 ,function(){
						backToTop();
						//$(".fixed").removeClass("fixed");
						setTimeout(function(){
								//fixed( $("#sideFix") );
						},400);
				});
				//return false;
		});

        //åˆ†é¡µè¿”å›é¡¶éƒ¨
        $("#pagnBacktotop").on('click', function() {
				$("html, body").animate({ scrollTop: 0 }, 600 ,function(){
				});
				return false;
		});

        //ä¸“è¾‘åˆ—è¡¨é¼ æ ‡ç»è¿‡å°é¢æ•ˆæœ
        /*
        var list= $("#albumList");
        if(list.length>0){
                var easing = "cubic-bezier(0.165, 0.840, 0.440, 1.000)";
                var time = 400;

                list.find(".cover").mouseDelay(200).hover(function () {

                    list.find(".uploader").transition({
                        x: '-30px',

                        opacity: 0,
                        duration: time,
                        easing: easing
                    });

                    var _this = $(this);
                    var info = _this.find(".uploader");

                    info.stop().css({
                        x: '-20%',
                        y: 0,
                        opacity: 1,
                        display: "block"
                    }).transition({
                        x: 0,
                        duration: time,
                        easing: easing
                    });

                    //å›¾ç‰‡

                    _this.find(".img").stop().transition({
                        x: '10px',
                        opacity: .5,
                        duration: time,
                        easing: easing
                    }).transition({
                        x: 0,
                        duration: time*0.5,
                        easing: easing
                    }).css({opacity: 1});

                }, function () {

                    var info = $(this).find(".uploader");
                    info.stop(false,true).transition({
                        x: '-30px',
                        opacity: 0,
                        duration: time*1.5,
                        easing: easing
                    })
                });
        }
        */

        //æ˜¾ç¤ºé€‰æ‹©èœå•
        $(".choosebox").mouseDelay(150).hover(function(){
            $(".choose-menu").hide();
            $(this).find(".choose-menu").show();
        },function(){
            $(".choose-menu").hide();
        });


        //éŸ³ä¹é£æ ¼æ•°æ®äº¤äº’
        $("#musicStyleList").on('click','li',function(){
            var _this = $(this);
            //è·å–è¢«ç‚¹å‡»çš„éŸ³ä¹é£æ ¼ID
            var music_style = _this.html();
            var music_style_id = _this.attr("id");
            //å°†è·å–çš„æ•°æ®èµ‹å€¼ç»™éšè—çš„input
            $("#musicStyle").val(music_style_id);

            //äº¤äº’æ•ˆæœ
            $("#chooseMusicStyle").html(music_style).removeClass("default");
            $(".choose-menu").hide();
        })
	/*å±•ç¤ºæœç´¢æ¡†*/
	$(document).on("click", "#searchToggle", function (e) {
		e.stopPropagation();
		$("#bdcs").toggle();
	});

})// End Document.Ready



//æ»šåŠ¨åˆ°é¡µé¢ä½ç½®
function windowScroll(o,target){
		o.live('click',function(){
				var target_top = target.offset().top;
				$("html,body").animate({ scrollTop : target_top },600);
				return false;
		});
};


//å®šä¹‰Dialogå¼¹å‡ºæ¡†å¯¹è±¡ 2013.01.22 by linan
function LnDialog(options) {
		var options = options ? options : {};
		this.style   = options.style || "";
		this.title   = options.title || "æç¤º";
		this.content = options.content || "";
		//this.footer  = options.footer || "";
		this.top 	 = options.top || "25%";
		this.left 	 = options.left || "50%";
		this.width   = options.width || 500;
		this.height  = options.height || "";
		this.timeOut = options.timeOut || null;//å®šä¹‰å¯¹è¯æ¡†ä»å‡ºç°åˆ°æ¶ˆå¤±çš„æ—¶é—´
		this.overlay = options.overlay || true;//æ˜¯å¦æ˜¾ç¤ºé®ç½©å±‚
}
LnDialog.prototype = {
		createDialogHtml:function(html,width){
				var width = width ? width : this.width;


				var dialog_html = '';
					dialog_html += '	<div class="ln-dialog '+ this.style +'" id="lnDialog">';
					dialog_html += '		 	'+html+'';
					dialog_html += '	</div>';

					$("body").append( dialog_html );//å…ˆå°†DOMæ’å…¥åˆ°bodyï¼Œ$.blockUIæ‰èƒ½æ•æ‰DOMé‡Œçš„äº‹ä»¶


					//å¼¹å‡ºå¯¹è¯æ¡†
					$.blockUI({
							message : $('#lnDialog'),//å¯¹è¯æ¡†DOM
							css : {
									top: this.top,
									left: this.left,
									width: width + "px",
									height: this.height + "px",
									marginLeft: "-"+ width/2+"px",
									backgroundColor: 'none',
									border: 0
							},
							overlayCSS:  {
								backgroundColor: '#000',
								opacity:         0.3
							},
							timeout : this.timeOut,
							showOverlay: this.overlay,
							fadeOut:  600,
							onBlock: function() {
									//å»¶æ—¶400ç»™ é®ç½©å±‚ã€å…³é—­æŒ‰é’®æ·»åŠ titleå±æ€§ï¼Œä»¥åŠclickå…³é—­å¯¹è¯æ¡†äº‹ä»¶ã€‚
									setTimeout(function(){
											$(".blockOverlay,.ln-dialog-close").attr('title','ç‚¹å‡»å…³é—­').on('click',$.unblockUI);
									},400);
							},
							onUnblock:function(){
									$("#lnDialog").remove();
							}
					});
		},
		createContentHtml: function( html,title,width){
				var html = html ? html : this.content
				var title = title ? title : this.title;//å¦‚æœæ²¡æœ‰ä¼ æ ‡é¢˜ï¼Œä½¿ç”¨é»˜è®¤çš„æ ‡é¢˜
				var width = width ? width : this.width;
				var content_html = '';
				    content_html += '<div class="ln-dialog-hd">';
					content_html += '		<h2 class="dialog-title">'+title+'</h2>';
					content_html += '		<div class="ln-dialog-close">X</div>';
					content_html += '</div>';
					content_html += '<div class="ln-dialog-bd clearfix">';
					content_html += '		'+html+'';
					content_html += '</div>';
					//content_html += '<div class="ln-dialog-ft clearfix">'+this.footer+'</div>';
					//å°†å†…å®¹åŠ å…¥åˆ°å¯¹è¯æ¡†DOMä¸­
					this.createDialogHtml( content_html ,width);
		},
		deleteDialogHtml: function(){
				$("#lnDialog").html("");
		},
		showLogin: function(title){
				var html = '';
					html += '<div class="connection login-dialog">';
					html += '		<h2>ä½¿ç”¨æ–°æµªå¾®åšè´¦å·ç™»å½•</h2>';
					html += '		<a class="weibo" href="/Home/Login/login/type/sina.html">æ–°æµªå¾®åš</a>';
					html += '</div>';

				var title = title ? title : "ç™»å½•";//å¦‚æœæ²¡æœ‰ä¼ æ ‡é¢˜ï¼Œä½¿ç”¨é»˜è®¤çš„æ ‡é¢˜

				this.createContentHtml(html,title,350);

		},
		startLoading: function( content ){
				var content = content ? content : 'æ­£åœ¨è½½å…¥ï¼Œè¯·ç¨å';
				var html = '<div class="ln-dialog-loading"id="lnDialogLoading"><img src="http://skin.shaoerduo.com/images/loading.gif" alt="" /> <span class="fn-ml5">'+content+'</span>...</div>';
				this.createDialogHtml( html , 300);
		},
		stopLoading: function(){
				//this.deleteDialogHtml();
				$("#lnDialogLoading").remove();

		},
		showContent: function( content ,title,width ){

				this.createContentHtml(content,title,width);
		},
		showTrueOperation: function(title,callback){
				var true_dom = '';
				true_dom += '<div class="trueOpetation-box">';
				//true_dom += '		<div class="tip-msg">';
				true_dom += '				<h2 class="title">'+title+'</h2>';
				true_dom += '				<p class="opetation"><a href="#" id="opetationQueren" class="btn color">ç¡® è®¤</a> <a href="#" id="opetationCancel" class="btn false">å– æ¶ˆ</a></p>';
				//true_dom += '		</div>';
				//true_dom += '		<div class="tip-icon '+tip_type+'"></div>';
				true_dom += '</div>';

				$(document).on('click',"#opetationQueren",function(){
						if(callback){ callback();}
						$.unblockUI({ fadeOut: 0 });
						return false;
				});
				$(document).on('click',"#opetationCancel",function(){
						$.unblockUI({ fadeOut: 0 });
						return false;
				});
				this.createDialogHtml(true_dom);
		},
		showTip : function(tip_title,tip_content,tip_type){
				var tip_type = tip_type ? tip_type : "";
				var tip_content = tip_content ? tip_content : "";
				var use_ico = tip_type ? "use-ico" : "";
				var tip_dom = '';
					tip_dom += '<div class="tip-box '+use_ico+'">';
					tip_dom += '		<div class="tip-msg">';
					tip_dom += '				<h2 class="tip-title">'+tip_title+'</h2>';
					tip_dom += '				<p class="tip-content">'+tip_content+'</p>';
					tip_dom += '		</div>';
					tip_dom += '		<div class="tip-icon '+tip_type+'"></div>';
					tip_dom += '</div>';

					this.createDialogHtml(tip_dom);
		},
		close : function(){
				$.unblockUI({ fadeOut: 0 });
		}
}

//2014.06.25 by house
function fixed(obj){
	var target_top = obj.offset().top;
	$(window).on('scroll', function() {
			var scroll_top = $(document).scrollTop();
			if( scroll_top > target_top ) {
					obj.addClass("fixed");

			}else {
					obj.removeClass("fixed");
			}
	})
}

//ä»¿å¾®åšå‘ä¸‹æ»šåŠ¨

function weiboScroll(obj,num,height){
		var $obj = $(obj);
		var oNum = num ? num : 5;
		var oHeight = height ? height : "295px";


		$obj.each(function(){
				var $ul = $(this).find("ul");
				var liNum = $ul.find("li").length;
				$(this).hover(function(){
						clearInterval(scrtime);
				},function(){
						scrtime = setInterval(function(){
								if( liNum > oNum ){
										//éµÑ†î”‘å©Šæ°¬å§©
										var liHeight = $ul.find("li:last").height();
										$ul.animate({ marginTop : liHeight + 20 +"px"},1000,function(){
												$ul.find("li:last").prependTo($ul);
												$ul.find("li:first").hide();
												$ul.css({marginTop:0});
												$ul.find("li:first").fadeIn(1000);
										});
								}
						},3000);
				}).trigger("mouseleave");
		});

}

function searchKyeCode(){
		var keyCode_array = [9,12,13,17,18,19,20,27,33,34,35,36,37,38,39,40,41,42,43,44,45,47,61]//Backspance ,Shift,ç»Œçƒ˜ç‰¸æ¶“å¶…æ¹ªé’ï¿½
		for(var i=105; i < 255; i++){
			keyCode_array.push(i)
		}
		//array[28] = 109;çå¿›æ•­é©æ©€æ‘¼éºãƒ§åš
		keyCode_array.splice(28,1);
		//array[91] = 173;å®¸ï¹‚æ‘¼éºãƒ§åš
		keyCode_array.splice(91,1);
		return keyCode_array
}

//æç¤ºä¿®æ”¹é‚®ç®±åœ°å€ 20114å¹´9æœˆ13æ—¥-16æ—¥ by é™ˆå·§æ•
function CheckEmailInfo(data) {
	$("#log-tip").remove();
	var info = $.parseJSON(data);
	var emailTip = '<div id="content_tips">'
			// +	'<p id="email_tip"class="emailTip" >äº²çˆ±çš„<span class="username"></span>ï¼Œä¸ºäº†ä¿è¯èƒ½åŠæ—¶è·å–æˆ‘ä»¬æœ€æ–°çš„èµ„è®¯å’ŒæœåŠ¡ã€ä»¥åŠå‚ä¸æ´»åŠ¨ï¼Œè¯·å°½å¿«éªŒè¯æ‚¨çš„é‚®ç®±ã€‚<a id="resend">é‡å‘éªŒè¯é‚®ä»¶</a> æˆ– <a class="email_add">ä¿®æ”¹é‚®ç®±åœ°å€ã€‚</a></p>'
		+ '<p id="email_tip" class="emailTip" >äº²çˆ±çš„<span class="username"></span>ï¼Œä¸ºäº†ä¿è¯èƒ½åŠæ—¶è·å–æˆ‘ä»¬æœ€æ–°çš„èµ„è®¯å’ŒæœåŠ¡ã€ä»¥åŠå‚ä¸æ´»åŠ¨ï¼Œè¯·å°½å¿«éªŒè¯æ‚¨çš„é‚®ç®±ã€‚<a id="resend">é‡å‘éªŒè¯é‚®ä»¶</a><a class="email_add" style="display:none;"></a></p>'
			// +	'<p id="send" class="emailTip" style="display:none">é‚®ä»¶å·²å‘é€ï¼Œæ‚¨å°†å¾ˆå¿«èƒ½æ”¶åˆ°ï¼Œè¯·å°½å¿«ç™»å½•é‚®ç®±è¿›è¡ŒéªŒè¯ï¼å¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œè¯·æ£€æŸ¥åƒåœ¾é‚®ç®±ã€<a href="http://bbs.elecfans.com/jishu_503095_1_1.html" target="_blank">è®¾ç½®elecfans.netä¸ºç™½åå•</a> æˆ– <a class="email_add">ä¿®æ”¹é‚®ç®±åœ°å€ã€‚</a></p>'
		+ '<p id="send" class="emailTip" style="display:none">é‚®ä»¶å·²å‘é€ï¼Œæ‚¨å°†å¾ˆå¿«èƒ½æ”¶åˆ°ï¼Œè¯·å°½å¿«ç™»å½•é‚®ç®±è¿›è¡ŒéªŒè¯ï¼å¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œè¯·æ£€æŸ¥åƒåœ¾é‚®ç®±ã€<a href="http://bbs.elecfans.com/jishu_503095_1_1.html" target="_blank">è®¾ç½®elecfans.netä¸ºç™½åå•</a><a class="email_add" style="display:none;"></a></p>' + '<p id="mod" class="emailTip" style="display:none">é‚®ç®±åœ°å€ä¿®æ”¹æˆåŠŸï¼æˆ‘ä»¬å·²å‘ä½ çš„é‚®ç®± <span class="now_email"></span> å‘é€äº†ä¸€å°éªŒè¯é‚®ä»¶ã€‚è¯·å°½å¿«ç™»å½•é‚®ç®±è¿›è¡ŒéªŒè¯ï¼å¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œè¯·æ£€æŸ¥åƒåœ¾é‚®ç®±ã€‚</a></p>' + '<p id="email_send" class="email_notice" style="display:none">æ‚¨å·²å‘é€è¿‡éªŒè¯é‚®ä»¶ï¼Œè¯·äº”åˆ†é’Ÿä¹‹åé‡å‘éªŒè¯é‚®ä»¶æˆ–ä¿®æ”¹æ‚¨çš„é‚®ç®±</p>' + '</div>' + '<div id="sendmail" style="display:none"></div>';

	var emailModTip = '<div id="email_mod" style="display:none">' + '<p class="mod_title">ä¿®æ”¹é‚®ç®±åœ°å€</p>' + '<form method="post" name="email-form" id="email-form" action="' + ElecfansApi_checkemail + '" autocomplete="off">' + '<ul>' + '<li>å½“å‰é‚®ç®±åœ°å€ï¼š<span class="now_email"></span></li>' + '<li class="error" id="email-error"></li>' + '<li>' + '<label for="article-email-mod">&nbsp;&nbsp;æ–°é‚®ç®±åœ°å€ï¼š</label><input class="email-input" type="text" id="article-email-mod" placeholder="è¯·å°½é‡ä½¿ç”¨å…¬å¸é‚®ç®±" name="newemail">' + '</li>' + '<li class="clearfix">' + '<input class="sub" id="email_sub" name="email_sub" value="ç¡®å®š" type="submit"/>' + '<input class="res eclose" id="email_res" name="email_res" value="å–æ¶ˆ" type="reset"/>' + '</li>' + '</ul>' + '</form>' + '<div class="email_close eclose"></div>' + '<div class="suc" style="display:none">' + '<p class="suc_title">é‚®ä»¶åœ°å€ä¿®æ”¹æˆåŠŸ</p>' + '<p class="suc-tip">æˆ‘ä»¬å·²å‘ä½ çš„é‚®ç®± <span class="now_email"></span>å‘é€äº†ä¸€å°éªŒè¯é‚®ä»¶ã€‚</p>' + '<p class="suc-tip">è¯·å°½å¿«ç™»å½•é‚®ç®±è¿›è¡ŒéªŒè¯ï¼</p>' + '</div>' + '</div>' + '<div class="blackTip" style="display:none"></div>';
	var s_email = getCookie('s_email');
	var nowexp = new Date();
	var nowtime = nowexp.getTime();
	var settime = 5 * 60 * 1000;
	var send_cookie = false;
	if (s_email) {
		var timec = nowtime - s_email;
		if (timec < settime) {
			send_cookie = true;
		}
	}



	// åˆ¤æ–­é‚®ç®±æ˜¯å¦å·²ç»éªŒè¯
	$.ajax({
		type: 'GET',
		url: 'http://passport.' + ELECFANS_DOMAIN + '/user/retriveEmailStatus/format/jsonp',
		dataType: 'jsonp',
		success: function(response) {
			if (response.error_code == 0) {
				var data = response.data;
				if (data['emailstatus'] != 1) {
					$("#top").after(emailTip);
					$("body").append(emailModTip);
					$('#email_tip').show();
					$('.username').html(info.username);
					$('.now_email').html(info.email);
					//åˆ¤æ–­æœ‰èƒŒæ™¯å¹¿å‘Šï¼Œå°±å‘ä¸‹ç§»
					if ($("#AD-background").length > 0) {
						$("#AD-background").css("top", "40px");
					}

					var sendemail = true;
					$('#resend').click(function() {
						if (send_cookie) {
							$('#email_send').show();
							$('#email_tip').hide();
						} else {
							if (sendemail === false) return;
							sendemail = false;
							$.ajax({
								type: 'GET',
								url: 'http://passport.' + ELECFANS_DOMAIN + '/user/resendRegValidateEmail/siteid/11/format/jsonp',
								dataType: 'jsonp',
								success: function(response) {
									if (response.error_code == 0) {
										$('#send').show().siblings().hide();
										setCookie('s_email', nowtime, 1, 'www.' + ELECFANS_DOMAIN);
									} else {
										alert(response.msg);
									}
								}
							});
						}
					});
					$('.email_add').click(function() {
						if (send_cookie) {
							$('#email_send').show();
							$('#email_tip').hide();
						} else {
							$('#email_mod').show();
							$('.blackTip').show();
						}
					});
					//å…³é—­å¯¹ä¿®æ”¹æ¡†
					$('.eclose').click(function() {
						$('#email_mod').hide();
						$('.blackTip').hide();
					});

					var modErr = function(obj, text, display) {
						var display = display ? display : "block";
						$('#email-error').html(text).css({
							"display": display,
							"color": "#c00"
						});
					}

					var emailmod = $('#article-email-mod');
					var email_empty = 'æ–°é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º';
					var email_err = 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€ï¼Œå¦‚ï¼šqiuliang@elecfans.com';
					var email_exist = 'è¾“å…¥çš„é‚®ç®±åœ°å€å·²æ³¨å†Œ';
					//æ–°é‚®ç®±åœ°å€æ ¡éªŒ
					var emailRequest = function(formData, jqForm, options) {
						var emailmodVal = emailmod.val();
						if (emailmodVal.length > 0) {
							if (!emailmodVal.match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) {
								modErr(emailmod, email_err);
								emailmod.focus().addClass('red-input');
								return false;
							} else if (emailmodVal == info.email) {
								modErr(emailmod, 'å’ŒåŸé‚®ç®±ç›¸åŒï¼Œè¯·é‡æ–°è¾“å…¥');
								emailmod.focus().addClass('red-input');
								return false;
							} else {
								$('#email_sub').val('å‘é€ä¸­...').attr('disabled', 'disabled');
								//var queryString = $.param(formData);
								emailmod.removeClass('red-input');
								return true;
							}
						} else {
							modErr(emailmod, email_empty);
							emailmod.focus().addClass('red-input');
							return false;
						}
					}

					/*ajaxä¿®æ”¹åå‘é€*/
					$("#email-form").ajaxForm({
						beforeSubmit: emailRequest,
						success: function(responseText, statusText) {
							$('#email_sub').val('ç¡®å®š').removeAttr('disabled');
							var r_msg = $.parseJSON(responseText);
							if (r_msg.status == 2) {
								modErr(emailmod, email_exist);
								emailmod.focus().addClass('red-input');
								return false;
							} else {
								var emailmodVal = emailmod.val();
								$('.now_email').html(emailmodVal);
								emailmod.removeClass('red-input');
								//@TODO å‘é€é‚®ä»¶
								$('#send').show().siblings().hide();
								setCookie('s_email', nowtime, 1, 'www.' + ELECFANS_DOMAIN);

								$('#mod').show().siblings().hide();
								$('.suc').show().siblings('#email-form').hide(); //å‘é€æˆåŠŸä¹‹åå¼¹å‡ºæç¤º

								//å‘é€é‚®ä»¶
								return true;
							}
						}
					}); //end ajaxForm

				}
			}
		}
	});
}
/**
 * JS å®ç°ç±»ä¼¼PHPçš„ in_arrayå‡½æ•°
 * @author liuping
 * @param  {[type]} needle    [description]
 * @param  {[type]} haystack  [description]
 * @param  {[type]} argStrict [description]
 * @return {[type]}           [description]
 */
function in_array(needle, haystack, argStrict) {
	var key = '',
		strict = !!argStrict;
	if (strict) {
		for (key in haystack) {
			if (haystack[key] === needle) {
				return true;
			}
		}
	} else {
		for (key in haystack) {
			if (haystack[key] == needle) {
				return true;
			}
		}
	}
	return false;
}
var ELECFANS_HOST = window.location.host;
var ELECFANS_DOMAIN_ARR = ELECFANS_HOST.split('.');
var ELECFANS_DOMAIN_LEN = ELECFANS_DOMAIN_ARR.length;
var ELECFANS_DOMAIN = ELECFANS_DOMAIN_ARR[(ELECFANS_DOMAIN_LEN - 2)] + '.' + ELECFANS_DOMAIN_ARR[(ELECFANS_DOMAIN_LEN - 1)];
var ELECFANS_BBS = 'http://bbs.' + ELECFANS_DOMAIN;
var ELECFANS_HOME = 'http://home.' + ELECFANS_DOMAIN;
//é¡¶éƒ¨å¼¹å‡ºç™»å½•æ¡†-------
$("#btnLogin").on('click', function() {
	$.tActivityLogin();
	return false;
});
$(".notice").click(function () {
	$(this).find('span').hide();
});
//æ˜¾ç¤ºç™»å½•åä¿¡æ¯
sLoginUid = 0;
sLoginUsername = '';
flagBindingQQ = false;
flagBindingWeibo = false;
if ($("#header .btn").length == 0) {
	$("#header .header").append('<a class="btn write_btn absolute-write">å‘æ–‡ç« </a>')
	setUserOpera();
}
function EchoLoginInfo(data) {
	var info = $.parseJSON(data),
		top_loginHtm = '',
		interflow = '.interflow';
	var msgTxt = '';
	if (info.msgnum > 0) {
		msgTxt = '<span class="grey9"  class="notice-num">' + info.msgnum + '</span>'

	}

	sLoginUid = info.uid;

	top_loginHtm += '<a id="searchToggle" class="pd8"><img style="width: 16px;" src="/d/public/images/u222.png" /> </a>' +
		'<a  class="pd8 write_btn "><img style="width: 16px;" src="/d/public/images/u225.png" title="å†™æ–‡ç« " /> å†™æ–‡ç« </a> <div class="top-dropdown my-info clearfix">' + ' <div class="top-dropdown-toggle">'
		+ '<a href="' + ELECFANS_HOME + '" class="u-info"><img src="' + info.avatar + '" width="20" height="20"><strong class="u-name">' + info.username + '</strong></a>'
		+ '<span class="drop-icon"></span>' + '</div>' + '<ul class="top-dropdown-menu yahei">'
		+ '<li><a href="' + ELECFANS_HOME + '">æˆ‘çš„ä¸­å¿ƒ</a></li>'
		+ '<li><a href="' + ELECFANS_BBS + '/user/' + sLoginUid + '/">æˆ‘çš„ä¸»é¡µ</a></li>'
		+ '<li id="topMyColumn"><a href="/d/mp/mediatype">ç”³è¯·ä¸“æ </a></li>'
		+ '<li><a href="' + ELECFANS_BBS + '/user/' + sLoginUid + '/articles/' + '">æˆ‘çš„æ–‡ç« </a></li>'
		+ '<li><a href="/member/mydata/">æˆ‘çš„èµ„æ–™</a></li>'
		+ ( info.vip == 0 ? '<li><a href="http://www.elecfans.com/vip/#choose">å¼€é€šVIP</a></li>':'<li><a href="http://bbs.elecfans.com/home.php?mod=spacecp&ac=vip">æˆ‘çš„VIP</a></li>')
		+ '<li><a href="' + ELECFANS_BBS + '/home.php?mod=spacecp">è´¦å·è®¾ç½®</a></li>' +
		' <li><a  target="_self" href="' + ELECFANS_BBS + '/member.php?mod=logging&action=logout&refer=front">é€€å‡º</a></li></ul>' + ' </div>' + ' <a class="notice" href="' + ELECFANS_BBS + '/home.php?mod=space&do=pm" >' + msgTxt + ' </a>';
	$(".apply-gzh").show();
	setTimeout(function(){
			$.ajax({
				url: check_allow,
				type: 'get',
				dataType: 'json',
				success: function (re) {
					if (re.error_code == 0) {
						var checkMpTime = setInterval(function () {
							if (mpStatus >= 0 || mpStatus == 'failed') {
								clearInterval(checkMpTime);
								if (mpStatus == 'failed' || mpStatus == '2' || mpStatus == '0') {
									if (mpStatus == '2') {
										$("#myColumn").show().find('.myGzh').attr('href', '/d/mp/message/status/2.html').html('ç”³è¯·ä¸“æ ');
									} else {
										$("#myColumn").show().find('.myGzh').attr('href', '/d/mp/apply').html('ç”³è¯·ä¸“æ ');
									}
								} else {
									$("#myColumn").show().find('.myGzh').attr('href', '/d/user/' + sLoginUid);
								}
							}
						}, 500)

						// window.open(add_url);
					}
				}
			});

			$("#myColumn").show().find('.myArt').attr('href', 'http://bbs.elecfans.com/user/' + sLoginUid + '/articles/');
		/*å®¡æ ¸çŠ¶æ€åˆ¤è¯»è·³è½¬*/
		mpStatus = -1;
		$.ajax({
			url:'/d/mp/checkStatus',
			type:'post',
			success:function(res){
				mpStatus = res.status;
				if(res.status==2){
					$("#topMyColumn a").attr('href', '/d/mp/message/status/2.html')
					$(".linkApply,.column-apply").attr('href', '/d/mp/message/status/2.html')
				} else if (res.status == 1) {
					$("#topMyColumn").html('<a href="/d/user/' + sLoginUid + '">æˆ‘çš„ä¸“æ </a>')
					$(".HomeTop-requestBtn").remove();
				}
				/*å¦‚æœæ²¡ç”³è¯·ä¸“æ æ˜¾ç¤ºå…¥å£*/
				$(".column-apply").unbind('click');
				if (res.status == 1) {
					$(".column-apply").hide();
				}
			}
		});
	},100);


	sLoginUsername = info.username;
	aUnionLogin = info['unionlogin'];
	flagBindingQQ = false;
	flagBindingWeibo = false;
	userinfo = info;
	if (in_array(1, aUnionLogin)) flagBindingQQ = true;
	if (in_array(2, aUnionLogin)) flagBindingWeibo = true;

	//é¡¶éƒ¨ç™»å½•åä¿¡æ¯
	$("#login-info").html(top_loginHtm).show();
	$("#bdcs").css('right', $("#login-info").width() + 'px');


	//åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºVIPç”¨æˆ·
	//if(info.vip==0){
	//	var vipStr = '<div class="fr"><a class="vip-icon" href="http://vip.elecfans.com/" target="_blank" title="æ¯å¤©åªéœ€1å—é’±ï¼Œç©è½¬ç”µå­ç•Œäººè„‰åœˆï¼" alt="æ¯å¤©åªéœ€1å—é’±ï¼Œç©è½¬ç”µå­ç•Œäººè„‰åœˆï¼"></a></div>';
	//	$(vipStr).insertBefore('.my-info');
	//}else if(info.vip==1){
	//	var vStr = '<span class="v-icon" alt="VIPä¼šå‘˜" title="VIPä¼šå‘˜"></span>';
	//	$(vStr).insertBefore('.drop-icon');
	//}

	//é¡¶éƒ¨ä¸‹æ‹‰èœå•
	$(".top-dropdown").mouseDelay().hover(function() {
		$(".top-dropdown-menu").css("top", "23px");
	}, function() {
		$(".top-dropdown-menu").css("top", "-9999px");
	});
	//è¯„è®ºå¤„ç™»å½•ä¿¡æ¯
	if (typeof(article_detail_avatar)=="function" && $("#comment").length > 0) {
		var avatarUrl = article_detail_avatar(sLoginUid, 'middle');
		$('#comment-c-avatar').attr('src', avatarUrl);
		$('#comment-c-username').text(sLoginUsername);

		if (flagBindingWeibo) $('#share-weibo').prop('checked', true);
		if (flagBindingQQ) $('#share-qq').prop('checked', true);
	}
	$.unblockUI();
}

var isArticlePage = $("body").is(".article-page");
if (!isArticlePage) {
	CheckLogin();
}
/*
 *ç”¨äºé¡¶éƒ¨ä¸‹æ‹‰å¯¼èˆªï¼
 */
(function(){
	var add_url = '/d/article/write/';
	/*å‘æ–‡ç« æŒ‰é’®è·³è½¬åˆ¤æ–­è·³è½¬*/

	// æœ‰äº›é¡µé¢å¼•ç”¨äº†electag.jsï¼Œä¹Ÿç»‘å®šäº†å†™æ–‡ç« åˆ¤æ–­ç™»å½•äº‹ä»¶ï¼Œå¦‚æœå·²ç»å­˜åœ¨å¼¹çª—è¿™é‡Œå°±ä¸è¦å†å¼¹å‡ºç™»å½•
	var notBindEvent = true;
	var bindList = $._data(document,"events");
	if ( bindList && bindList.click ) {
		bindList = bindList.click;
	} else {
		bindList = [];
	}
	$.each(bindList,function(i,d){
		if ( d.namespace === "electag_write_art" ) {
			notBindEvent = false;
			return false;
		}
	});
	if ( notBindEvent ) {
		$(document).on('click.common_write_art', '.write_btn', function () {
			if ($("#btnLogin").length > 0) {
				$.tActivityLogin();
				return false;
			}
			if ($("#header .logo img").attr('src') == '/skin-2012/base2012/images/logo.png') {
				window.location.href = add_url + '/?article';
			} else {
				window.location.href = add_url;
			}
		});
	}

	$(".column-apply").click(function (e) {
		e.stopPropagation();
		$.tActivityLogin();
		return false;
	});
	var setHTML='\
<div class="sub_dis_wrap">\
    <h3 class="disTitle"><a href="http://www.elecfans.com/" target="_blank">ç”µå­å‘çƒ§å‹</a></h3>\
    <ul class="disList">\
        <li><a href="http://www.elecfans.com/news/hangye/" target="_blank">ç”µå­æ–°é—»</a></li>\
        <li><a href="http://www.elecfans.com/soft/" target="_blank">èµ„æ–™ä¸‹è½½</a></li>\
        <li><a href="http://www.elecfans.com/dianlutu/" target="_blank">ç”µå­ç”µè·¯</a></li>\
        <li><a href="http://www.elecfans.com/article/interview/" target="_blank">é«˜ç«¯è®¿è°ˆ</a></li>\
    </ul>\
    <ul class="disList">\
        <li><a href="http://www.elecfans.com/technical/all/" target="_blank">è®¾è®¡æŠ€æœ¯</a></li>\
        <li><a href="http://www.elecfans.com/application/" target="_blank">è¡Œä¸šåº”ç”¨</a></li>\
        <li><a href="http://www.elecfans.com/tags/" target="_blank">ç”µå­æ ‡ç­¾</a></li>\
        <li><a href="http://www.elecfans.com/tekan/" target="_blank">ç”µå­ç‰¹åˆŠ</a></li>\
    </ul>\
    <ul class="disList" style="margin-right: 0;">\
        <li><a href="http://bbs.elecfans.com/forum.php" target="_blank">å·¥ç¨‹å¸ˆç¤¾åŒº</a></li>\
        <li><a href="http://event.elecfans.com/index/seminar.html" target="_blank">æŠ€æœ¯ç ”è®¨ä¼š</a></li>\
        <li><a href="http://webinar.elecfans.com/" target="_blank">åœ¨çº¿ç ”è®¨ä¼š</a></li>\
        <li><a href="http://www.elecfans.com/yuanqijian/" target="_blank">ç”µå­å…ƒå™¨ä»¶</a></li>\
    </ul>\
</div>\
<div class="sub_dis_wrap">\
    <h3 class="disTitle"><a>ç‰¹è‰²æœåŠ¡</a></h3>\
    <ul class="disList">\
        <li><a href="http://bbs.elecfans.com/try.html" target="_blank">å¼€å‘æ¿è¯•ç”¨</a></li>\
        <li><a href="http://z.elecfans.com/" target="_blank">åç§‹ä¼—ç­¹</a></li>\
        <li><a href="http://www.elecfans.com/d" target="_blank">ç”µå­è¯´</a></li>\
        <li><a href="http://www.elecfans.com/tools/" target="_blank">åœ¨çº¿å·¥å…·</a></li>\
    </ul>\
    <ul class="disList" style="margin-right: 0;">\
        <li><a href="http://t.elecfans.com/" target="_blank">å‘çƒ§å‹å­¦é™¢</a></li>\
        <li><a href="http://www.elecfans.com/d/column" target="_blank">ä¸“æ </a></li>\
        <li><a href="http://pdf.elecfans.com/" target="_blank">DatasheetæŸ¥è¯¢</a></li>\
        <li><a href="http://bbs.elecfans.com/" target="_blank">ç”µå­é—®ç­”</a></li>\
    </ul>\
</div>\
<div class="sub_dis_wrap">\
    <h3 class="disTitle"><a href="http://www.hqpcb.com/" target="_blank">åç§‹PCB</a></h3>\
    <ul class="disList" style="margin-right: 0;">\
        <li><a href="http://www.hqpcb.com/online.html" target="_blank">åœ¨çº¿ç®—ä»·</a></li>\
        <li><a href="http://www.hqpcb.com/pay.html" target="_blank">ä»˜æ¬¾æ–¹å¼</a></li>\
        <li><a href="http://www.hqpcb.com/orderstep.html" target="_blank">ä¸‹å•æµç¨‹</a></li>\
        <li><a href="http://www.hqpcb.com/product.html" target="_blank">äº§å“å±•ç¤º</a></li>\
    </ul>\
</div>\
<div class="sub_dis_wrap" style="border-right: 0;">\
    <h3 class="disTitle"><a href="http://www.hqchip.com/" target="_blank">åç§‹èŠ¯åŸ</a></h3>\
    <ul class="disList">\
        <li><a href="http://www.hqchip.com/" target="_blank">å…ƒå™¨ä»¶æœç´¢</a></li>\
        <li><a href="http://www.hqchip.com/fangan/" target="_blank">æ–¹æ¡ˆä¸­å¿ƒ</a></li>\
        <li><a href="http://www.hqchip.com/mozu/" target="_blank">æ¨¡ç»„ä¸“åŒº</a></li>\
        <li><a href="http://www.hqchip.com/promote/" target="_blank">ç°è´§åº“å­˜</a></li>\
    </ul>\
    <ul class="disList" style="margin-right: 0;">\
        <li><a href="http://www.hqchip.com/glist/all_cate.html" target="_blank">å…ƒå™¨ä»¶åˆ†ç±»</a></li>\
        <li><a href="http://www.hqchip.com/kaifaban/" target="_blank">å¼€å‘æ¿ä¸“åŒº</a></li>\
        <li><a href="http://www.hqchip.com/bom/" target="_blank">BOMæœåŠ¡</a></li>\
        <li><a href="http://bbs.elecfans.com/forum.php?gid=263" target="_blank">åŸå‚ä¸“åŒº</a></li>\
    </ul>\
</div>\
';


	try{
		document.querySelector("#website_nav").innerHTML=setHTML;
	}catch(e){
		try {
			document.getElementById("website_nav").innerHTML=setHTML;
		} catch(e) {

		}
	}

})();
/*è®¾ç½®å¯¼èˆªæŒ‰é’®ä½ç½®*/
function setUserOpera() {
	var getWinWid = $(window).width() > 1000 ? $(window).width() : 1000;
	if (getWinWid > 1250) {
		$("#myColumn").css('left', (getWinWid - 1000) / 2 + 1000 - 86 - 28 - 115 + 'px').show();
		$(".apply-gzh").css('left', (getWinWid - 1000) / 2 + 1000 - 86 - 36 + 'px').width(65).show();
		$(".absolute-write").css('left', 1000 - 336 + $(".header .logo").width() + 'px').show();
	}

}
(function ($) {
	$.fn.switchBanner = function () {
		var setTime = 5000; //è®¾ç½®å»¶æ—¶
		// banneråˆ‡æ¢åˆå§‹åŒ–
		var Banner = $(this);
		var length = Banner.find('li').length;
		var control = '';
		control += '<p><span class="now"></span>';
		for (var i = 1; i < length; i++) {
			control += '<span></span>';
		}
		control += '</p>';
		control = $(control);
		Banner = Banner.append(control);
		Banner.find('li').eq(0).addClass('nowImg').css('z-index', '2');
		// è‡ªåŠ¨æ»šåŠ¨
		timer = setInterval(slideBanner, setTime);
		// è®¾ç½®æ‰‹åŠ¨æ»šåŠ¨æ ‡å¿—
		handSlide = false;
		// é¼ æ ‡åˆ‡æ¢æ»šåŠ¨
		Banner.on('mouseover', 'span', function () {
			var self = $(this);
			var index = self.index();
			var parent = self.parent();
			handSlide = true;
			parent.find('span').removeClass('now').eq(index).addClass('now');
			slideBanner();
		});
		// hover åœæ­¢ç»§ç»­æ»šåŠ¨
		Banner.hover(function () {
			clearInterval(timer);
			handSlide = true;
		}, function () {
			clearInterval(timer);
			timer = setInterval(slideBanner, setTime);
			handSlide = false;
		});

		// banneråˆ‡æ¢å‡½æ•°
		function slideBanner() {
			var span = control.find('span');
			var li = Banner.find('li');
			var index = control.find('.now').index();
			var next = (index + 1) >= li.length ? 0 : index + 1;
			var nowli = Banner.find('.nowImg');

			if (handSlide) {
				li.children('a').removeClass('active');
				li.eq(index).children('a').addClass('active');
			} else {
				span.removeClass('now').eq(next).addClass('now');
				li.children('a').removeClass('active');
				li.eq(next).children('a').addClass('active');
			}

			li.css('z-index', 0);
			nowli.css('z-index', 2);
			if (handSlide) {
				li.eq(index).css('z-index', 1);
			} else {
				li.eq(next).css('z-index', 1);
			}

			nowli.stop(true, false).animate({
				'opacity': 0
			}, 300, function () {
				nowli.css({
					'z-index': 0,
					'opacity': 1
				});
				if (handSlide) {
					li.removeClass('nowImg').eq(index).addClass('nowImg');
				} else {
					li.removeClass('nowImg').eq(next).addClass('nowImg');
				}
			});
		}
	}
})(jQuery);
$("#indexBanner").switchBanner();
$(window).resize(function () {
	setUserOpera();
});
/*ç‚¹å‡»ä»»æ„åœ°æ–¹ éšè—æœç´¢æ¡†*/
$(document).on('click', function () {
	$("#bdcs").hide();
});
/*æœç´¢æ¡†æäº¤  å†…å®¹æ¸…ç©º*/
// $("#bdcs-search-form").submit(function () {
	// $("#bdcs-search-form-input").val("");
// });
$("#bdcs").click(function (e) {
	e.stopPropagation();
});
/*æœç´¢æ¡†ä¸ºç©º ç‚¹å‡»ä¸æäº¤*/
$("#bdcs-search-form-submit").click(function (e) {
	if ($.trim($("#bdcs-search-form-input").val()) == "") {
		e.stopPropagation();
		e.preventDefault();
	}
});
// æ­£æ–‡å›¾ç‰‡æ”¾å¤§
$.getScript('http://skin.elecfans.com/js/plugins/jquery.lightbox.min-0.5.js', function () {
	$('head').append('<link rel="stylesheet" href="http://skin.elecfans.com/js/plugins/jquery.lightbox-0.5.css"></link>')
	$('.article-content img').each(function () {

		var $t = $(this);
		// è¿‡æ»¤æ‰æœ‰è¶…é“¾çš„å›¾ç‰‡
		if (!$t.parent().is('a')) {
			$t.wrap('<a href="' + $t.attr('src') + '" rel="lightbox-img"></a>');
		}
	});
	$('.article-content [rel="lightbox-img"]').lightBox({});
});
function openX_ad(posterid, htmlid, width, height) {
	if ($(htmlid).length > 0) {
		var randomnumber = Math.random();
		var now_url = encodeURIComponent(window.location.href);
		var ga = document.createElement('iframe');
		ga.src = 'http://www1.elecfans.com/www/delivery/myafr.php?target=_blank&cb=' + randomnumber + '&zoneid=' + posterid+'&prefer='+now_url;

        // ICèŠ¯åŸå¹¿å‘Šç‰¹æ®Šå¤„ç†
        if (posterid === 903) {
          ga.src += '&referrer=' + encodeURIComponent(location.href);
        }
        ga.width = width;
		ga.height = height;
		ga.frameBorder = 0;
		ga.scrolling = 'no';
		var s = $(htmlid).append(ga);
	}
}

// //åœ¨pIdé¡µé¢æ–°å¢iotå¹¿å‘Š
// $('#new-ic-berry, #new-adsm-berry').before(
//     '<div style="position: relative;width: 300px;margin-bottom: 0px;padding: 0">'+
//         '<a style="display: inline-block;" href="http://www.elecfans.com/topic/iot2018/agenda.html?hp300-150"  target="_blank">'+
//             '<img style="vertical-align: bottom;" src="/skin-2012/images/u120.png">'+
//         '</a>'+
//         '<div style="position: absolute;bottom: 20px;margin-left: 25px;cursor: pointer">'+
//             '<a target="_blank" class="iot_btn" href="http://www.elecfans.com/topic/iot2018/awards_i_h.html?hp300-150" style="box-shadow: 0px 4px 8px 0px rgba(0, 0, 153, 0.349019607843137) inset;margin-right: 10px;text-decoration:none;display:inline-block;border-radius:5px;color: #fff; font-size: 14px;text-align: center;width: 120px;height: 35px;background: rgba(0, 183, 238, 1);line-height: 35px">'+
//             '<img style="width: 20px;margin-right:5px;vertical-align: sub;" src="/skin-2012/images/u10.png" />åˆ›æ–°å¥–æŠ•ç¥¨</a>'+
//             '<a target="_blank" class="iot_btn" href="http://www.elecfans.com/topic/iot2018/apply_choose.html?hp300-150" style="box-shadow: 0px 4px 8px 0px rgba(153, 0, 0, 0.349019607843137) inset;text-decoration:none;display:inline-block;border-radius:5px;color: #fff; font-size: 14px;text-align: center;width: 120px;height: 35px;background: rgba(235, 51, 115, 1);line-height: 35px">'+
//             '<img style="width: 20px;margin-right:5px;vertical-align: sub;" src="/skin-2012/images/u12.png" />æŠ¥åå‚ä¼š</a>'+
//         '</div>'+
//     '</div>'
// )
// $('.iot_btn').hover(function(){
//   this.style.textDecoration = 'underline'
// }, function(){
//   this.style.textDecoration = 'none'
// })

/* æ·»åŠ 20181212 å¹¿å‘Š */
// $(".simditor-body").after('<div style="margin: 10px 0;"><a href="http://www.hqchip.com/app"><img src="/skin-2012/images/20181212ad_d.png?v2"/></a></div>')
//


//æ–°å¢ä¸¤æ¡å¹¿å‘Šæ–‡å­—é“¾

$(".article-content").before('<iframe frameborder="0" scrolling="no" style="width: 100%; height: 40px;" src="http://www1.elecfans.com/www/delivery/myafr.php?target=_blank&zoneid=902"></iframe>');

//20190410 é™æ€æ–‡å­—æ¨å¹¿ä½çš„é“¾æ¥å†…å®¹
var html = '<div style="width: 960px;height: 40px;line-height: 40px;background: linear-gradient(to right, #5ec1aa, #508ca8);margin: 0 auto 12px;font-size: 16px;padding: 0 20px;">'+
        '<a href="http://bbs.elecfans.com/jishu_1801214_1_1.html?elecfans_trackid=elecfans_articletop" target="_blank" style="display: inline-block;width: 95%;text-align:center;color: #fff;">å®æˆ˜å¤šé€šé“é«˜é€Ÿç²¾å¯†æµ‹æ¸©ä»ªçš„å…¨ç³»åˆ—è®¾è®¡æ•™ç¨‹ï¼Œæ•™ä½ æŒæ¡åŸºäºé¡¹ç›®çš„å…¨ç³»åˆ—è®¾è®¡æŠ€æœ¯ï¼<span style="margin-left:2em;">ğŸ‘‰æˆ³æ­¤ç«‹å³å‚ä¸ğŸ‘ˆ</span></a>'+
    '</div>';
if($('.hot-main').parent().find('.now-posi').length > 0){
	if( location.href.indexOf('kongzhijishu') != -1 || location.href.indexOf('chukongjishu') != -1 || location.href.indexOf('jiqiren') != -1 || location.href.indexOf('iot') != -1 ){
 		$('.hot-main').parent().find('.now-posi').before(html);
	}
}

// æ·»åŠ åº•éƒ¨bannerå¹¿å‘Š
var banner_ad_htm = '<div class="banner_ad201905">'+
    '<style type="text/css">'+
        '.banner_ad201905{position: fixed;bottom: 15px;left: 0;right: 0;margin: auto;z-index: 10;display: none;}'+
        '.banner_ad201905 .close_banner_ad201905 {position: absolute;z-index: 1;right: 328px;top: 3px;padding: 8px;line-height: 1;cursor: pointer;background: url(/static/main/img/close-icons.png) no-repeat;}'+
        '.banner_ad201905 .close_banner_ad201905:hover {background-position: 0 -16px;}'+
    '</style>'+
    '<div style="width: 1000px;margin: 0 auto;position: relative;">'+
        '<a href="http://www.hqpcb.com/quote?btnid=2&layer=4&count=5&height=1.6&invoice=%E4%B8%8D%E9%9C%80%E8%A6%81&tid=DZS" target="_blank">'+
            '<img src="/skin-2012/images/banner_ad201910.png?20191211" style="width:675px;height: 90px;"/>'+
        '</a>'+
        '<span class="close_banner_ad201905" title="ç‚¹å‡»å…³é—­"></span>'+
    '</div>'+
'</div>'
$('body').append(banner_ad_htm)

// document.write('<script src="/d/public/js/footer_pcb.js"></script>')


$(window).scroll(function(event) {
    if($(document).scrollTop() > 100){
        if($.cookieHelper('footer_banner_ad201905') === "yes"){
            $('.banner_ad201905').hide()
        } else {
            $('.banner_ad201905').show()
        }
    } else {
        $('.banner_ad201905').hide()
    }
});
$(document).on('click', '.close_banner_ad201905', function(){
    $.cookieHelper('footer_banner_ad201905', 'yes', {expires: 12/24, path: "/"})
    $(".banner_ad201905").fadeOut()
})
// æ·»åŠ åº•éƒ¨bannerå¹¿å‘Š


// æ’å…¥å­¦é™¢è½®æ’­å¹¿å‘Š
function trim(str){                 //å»é™¤å­—ç¬¦ç®—ä¸­çš„ç©ºæ ¼
    return str.replace(/[ ]/g,"");
}
var tags = [];
$('.hot-main li .hot-des .detail .title').each(function(i, ele){
    tags.push(trim($(this).find('a').text()))
});
$('.code-content').before("<iframe id='iframe_tags' data-elecfans_trackid='wwwpd_ Article_detail' data-tag='"+ tags.join(",") +"' src='/static/iframe/course.html' width='675' height='170' style='border: none;margin: 20px 0 0 0;'></iframe>")
// æ’å…¥å­¦é™¢è½®æ’­å¹¿å‘Š



//æ’å…¥é¢‘é“é¡µå’Œç”µå­è¯´æŠ•è¯‰å£°æ˜
var webID = $('#webID').val();
$.ajax({
    url: '/webapi/arcinfo/isOriginal?aid='+ webID,
    type: 'get',
    success: function(res){
        var res = JSON.parse(res);
        if(res.status === "successed" && res.data.is_original === 0){
            $('.hudong').before("<p style='font-size: 14px !important;color: #a9a9a9 !important;line-height: 21px !important;'>å£°æ˜ï¼šæœ¬æ–‡ç”±å…¥é©»ç”µå­è¯´ä¸“æ çš„ä½œè€…æ’°å†™æˆ–è€…ç½‘ä¸Šè½¬è½½ï¼Œè§‚ç‚¹ä»…ä»£è¡¨ä½œè€…æœ¬äººï¼Œä¸ä»£è¡¨ç”µå­å‘çƒ§å‹ç½‘ç«‹åœºã€‚å¦‚æœ‰ä¾µæƒæˆ–è€…å…¶ä»–é—®é¢˜ï¼Œè¯·è”ç³»ä¸¾æŠ¥ã€‚<a href='http://www.elecfans.com/about/tousu.html' target='_blank'  style='color: #2897c5 !important;'>ä¾µæƒæŠ•è¯‰</a></p>")
        }
    }
})



// åˆ¤æ–­éåŸåˆ›æ–‡ç« ä¸‹æ˜¯å¦å±•ç¤ºæ–‡ç« ä½œè€…å’Œæ¥æº
$.ajax({
    url : '/webapi/arcinfo/arcinfo' + '?aid=' + webID,
    type : 'get',
    dataType : 'json',
    async : false,
    success : function(m){
        // åˆ¤æ–­éåŸåˆ›æ–‡ç« ä¸‹æ˜¯å¦å±•ç¤ºæ–‡ç« ä½œè€…å’Œæ¥æº
        if(m.showAuthor === 1){
            if($('.article-info').children("a").length > 0){
                if(m.writer){
                    $('.article-info').children("a").after("<span class='sp'>â€¢</span><span>ä½œè€…ï¼š"+ m.writer +"</span>")
                }
                if(m.source){
                    $('.article-info').children("a").after("<span class='sp'>â€¢</span><span>æ¥æºï¼š"+ m.source +"</span>")
                }
            } else {
                if(m.writer){
                    $('.article-info').prepend("<span>ä½œè€…ï¼š"+ m.writer +"</span><span class='sp'>â€¢</span>")
                }
                if(m.source){
                    $('.article-info').prepend("<span>æ¥æºï¼š"+ m.source +"</span><span class='sp'>â€¢</span>")
                }
            }
        }
    }
})