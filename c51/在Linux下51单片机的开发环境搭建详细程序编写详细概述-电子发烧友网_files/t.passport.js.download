!function(e){var o,i,s,n,t=1,a=this,r=a.postMessage&&!/opera/.test(navigator.userAgent.toLowerCase());e.postMessage=function(o,i,s){i&&(o="string"==typeof o?o:e.param(o),s=s||parent,r?s.postMessage(o,i.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):i&&(s.location=i.replace(/#.*$/,"")+"#"+ +new Date+t++ +"&"+o))},e.receiveMessage=n=function(t,d,c){r?(t&&(s&&n(),s=function(o){return!("string"==typeof d&&o.origin!==d||e.isFunction(d)&&!1===d(o.origin))&&void t(o)}),a.addEventListener?a[t?"addEventListener":"removeEventListener"]("message",s,!1):a[t?"attachEvent":"detachEvent"]("onmessage",s)):(o&&clearInterval(o),o=null,t&&(o=setInterval(function(){var e=document.location.hash,o=/^#?\d+&/;e!==i&&o.test(e)&&(i=e,t({data:e.replace(o,"")}))},"number"==typeof d?d:"number"==typeof c?c:100)))}}(jQuery),function(e){e.getUrlParam=function(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(o);return null!=i?unescape(i[2]):null}}(jQuery),function(e){var o=e("#sso_script"),i=o.attr("data-ssoSite"),s=o.attr("data-ssoReferer"),n=o.attr("data-ssoScene"),t=o.attr("data-ssoSiteid");s=void 0!=s?s:"",n=void 0!=n?n:"";var a=e.getUrlParam("tid");a=a?a:"";var r=i+"/login?referer="+s+"&siteid="+t+"&scene="+n+"#"+encodeURIComponent(location.href),d=i+"/register?tid="+a+"&referer="+s+"&siteid="+t+"&scene="+n+"#"+encodeURIComponent(location.href),c=i+"/password/changepwd?siteid="+t+"#"+encodeURIComponent(location.href);if("activity"==e.getUrlParam("special")&&(d=i+"/register?tid="+a+"&referer="+e.getUrlParam("referer")+"&special=activity&siteid="+t+"&scene="+n+"#"+encodeURIComponent(location.href)),0==e("iframe[name^='sso-']").length){var l=i+"/public/pc/css/sso.dialogPassport.css";e("head").append('<link rel="stylesheet" href="'+l+'"/>')}e.extend({ssoDialogLogin:function(o){var s=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">登录</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" onload=""></iframe></div></div>');s.appendTo("body").find("iframe").attr("src",r),s.on("click",".sso_dialog_close",function(){s.remove()}),e.receiveMessage(function(i){var n=s.find("iframe");if(e.isNumeric(i.data)){n.css("height",i.data+"px");var t=s.find(".sso_dialog_header").height(),a=s.find(".sso_dialog_content").outerHeight(),d=t+a;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==i.data?window.location.reload():"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(s,t,a){function d(){if(!d.called){if(d.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(i);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():void e.postMessage(s,r,n.get(0).contentWindow)}}var c=a.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},d):d(),setTimeout(d,3e3)}})},i)},ssoDialogRegist:function(o){var n=(new Date).valueOf(),t=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">注册</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" onload=""></iframe></div></div>');t.appendTo("body").find("iframe").attr("src",d),t.on("click",".sso_dialog_close",function(){t.remove()}),"sensors"in window&&sensors.track("eClickRegister",{current_url:location.href,current_title:document.title,site_domain:document.domain}),e.receiveMessage(function(i){var a=t.find("iframe");if(e.isNumeric(i.data)){a.css("height",i.data+"px");var d=t.find(".sso_dialog_header").height(),c=t.find(".sso_dialog_content").outerHeight(),l=d+c;t.find(".sso_dialog").css({height:l+"px","margin-top":0-l/2+"px"})}else"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(t,d,c){function l(){if(!l.called){if(l.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(i);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():""==s?void window.location.reload():void e.postMessage(t,r,a.get(0).contentWindow)}}var g=c.getResponseHeader("union_id");if(g&&window.sensors&&sensors.login(g),"sensors"in window){var f=(new Date).valueOf();sensors.track("signUp",{event_duration:(f-n)/60,register_source:location.href},l)}else l();setTimeout(l,3e3)}})},i)},scrollLogin:function(o){var r=i+"/register?tid="+a+"&special=wwwquick&referer="+s+"&siteid="+t+"&scene="+n+"#"+encodeURIComponent(location.href),d=r,c=e("#ssoScrollLog");c.append("<iframe></iframe>"),c.find("iframe").attr("src",d),e.receiveMessage(function(i){var s=c.find("iframe");if(e.isNumeric(i.data)){s.css("height",i.data+"px");c.find(".sso_dialog_header").height(),c.find(".sso_dialog_content").outerHeight();e("#ssoScrollLog iframe").css({height:"350px","margin-top":"45px"})}else"reload"==i.data?window.location.reload():"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(n,t,a){function r(){if(!r.called){if(r.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(i);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():void e.postMessage(n,d,s.get(0).contentWindow)}}var c=a.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},r):r(),setTimeout(r,3e3)}})},i)},ssoPageLogin:function(){var o=e("iframe[name='sso-LoginIframe']");o.attr("src",r),e.receiveMessage(function(i){e.isNumeric(i.data)?o.css("height",i.data+"px"):"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(i,n,t){function a(){a.called||(a.called=!0,""==s?window.location.href="/":e.postMessage(i,r,o.get(0).contentWindow))}var d=t.getResponseHeader("union_id");d&&window.sensors&&sensors.login(d),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},a):a(),setTimeout(a,3e3)}})},i)},ssoPageRegist:function(){var o=(new Date).valueOf(),n=e("iframe[name='sso-RegistIframe']");n.attr("src",d),"sensors"in window&&sensors.track("eClickRegister",{current_url:e.getUrlParam("referer")||document.referrer,current_title:document.title,site_domain:document.domain}),e.receiveMessage(function(i){e.isNumeric(i.data)?n.css("height",i.data+"px"):"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(i,t,a){function r(){r.called||(r.called=!0,""==s?window.location.href="/":e.postMessage(i,d,n.get(0).contentWindow))}var c=a.getResponseHeader("union_id");if(c&&window.sensors&&sensors.login(c),"sensors"in window){var l=(new Date).valueOf();sensors.track("signUp",{event_duration:(l-o)/60,register_source:location.href},r)}else r();setTimeout(r,3e3)}})},i)},ssoPageChangepwd:function(){var o=e("iframe[name='sso-ChangepwdIframe']");o.attr("src",c),e.receiveMessage(function(i){e.isNumeric(i.data)?o.css("height",i.data+"px"):"string"==typeof i.data&&e.postMessage("success",c,o.get(0).contentWindow)},i)},tActivityLogin:function(o){var n=i+"/login?special=t&referer="+s+"&siteid="+t+"#"+encodeURIComponent(location.href),a=e('<div class="sso_layer"></div><div class="sso_dialog" id="activity_login"><div class="sso_dialog_header"><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" ></iframe></div></div>');a.appendTo("body").find("iframe").attr("src",n),a.on("click",".sso_dialog_close",function(){a.remove()}),e.receiveMessage(function(i){var s=a.find("iframe");if(e.isNumeric(i.data)){s.css("height",i.data+"px");var t=a.find(".sso_dialog_header").height(),r=a.find(".sso_dialog_content").outerHeight(),d=t+r;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==i.data?window.location.reload():"string"==typeof i.data&&e.ajax({type:"get",url:decodeURIComponent(i.data),success:function(t,a,r){function d(){if(!d.called){if(d.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(i);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():void e.postMessage(t,n,s.get(0).contentWindow)}}var c=r.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},d):d(),setTimeout(d,3e3)}})},i)}})}(jQuery),0!=$("iframe[name='sso-LoginIframe']").length?$.ssoPageLogin():0!=$("iframe[name='sso-RegistIframe']").length?$.ssoPageRegist():0!=$("iframe[name='sso-ChangepwdIframe']").length&&$.ssoPageChangepwd();