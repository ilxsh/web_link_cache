<!DOCTYPE html>
<html>
<head itemscope itemtype="http://schema.org/WebSite">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="theme-color" content="#ffffff" />
    <meta name="csrf-param" content="_csrf-frontend">
    <meta name="csrf-token" content="5rvDvmq2uP6WEOHSE5Rw5EVw9NwB09AM3ai6z9aFSyrL3K76Po7UhPVRsr5G8j6FCSW1q3G6ime_7feO5dYAew==">
    <title>为什么我的RAID / dev / md1显示为/ dev / md126？ mdadm.conf被忽略了吗？ - ChUbuntu</title>
    <link href="/assets/49d3cefc/css/bootstrap.css" rel="stylesheet">
<link href="/assets/a6874236/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/prettify.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">    <script>
        window.__gcse = {
            callback: function() {
                $('#___gcse_0 .gsc-clear-button').remove();
                $('#___gcse_0 .gsc-search-button').remove();
                $('#___gcse_0 .gsib_b').remove();
                $('#___gcse_0 .gsc-input input').attr('placeholder', '正在搜索......');
            }
        };
        (function() {
            var cx = '016639304537431400788:ontqwakqapm';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
        })();
    </script>
</head>
<body onload="prettyPrint()">

<div class="wrap">
    <nav id="w0" class="navbar navbar-default"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w0-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button></div><div id="w0-collapse" class="collapse navbar-collapse"><a class="navbar-brand" href="/"><div class="name"><img src="/logo.png"/>Ch<span class="cl-orange">Ubuntu</span></div></a><ul id="w1" class="navbar-nav navbar-right nav"><li><a href="/">主</a></li>
<li class="active"><a href="/questions">你的问题</a></li>
<li><a href="/tags">标签</a></li></ul><div class="search">
                <gcse:searchbox-only resultsUrl="/s.html" filter="0" sort_by=""></gcse:searchbox-only>
          </div></div></div></nav>
    <div class="container">
                        
<div class="m-t-10" itemscope="" itemtype="http://schema.org/Question">
    <div class="question-header">
        <h1 itemprop="name">为什么我的RAID / dev / md1显示为/ dev / md126？ mdadm.conf被忽略了吗？</h1>
    </div>

    <div class="col-sm-9" style="padding-bottom:10px">
    <div class="row">
        <a data-toggle="collapse" data-target="#navig" href="#">导航你的答案</a> 

        <div id="navig" class="collapse">

                                                <a href="#209750">#1 - mmorris (25 票)</a> <br>                            <a href="#582815">#2 - ajaaskel (4 票)</a> <br>                            <a href="#701510">#3 - Angelos Vassiliou (0 票)</a> <br>                            <a href="#505618">#4 - Marc (0 票)</a> <br>             
         
        </div>
    </div>
    </div>

    <div class="col-sm-3 pull-right">
        <div class="row hidden-xs right-col sidebar">
            <!-- Сайдбар -->
            <div class="awrap" style="top: 16px; opacity: 1;">
                <ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px;margin-top: -5px;" data-ad-client="" data-ad-slot="">
                </ins>
            </div>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                document.addEventListener('DOMContentLoaded', function(){
                    var awrap = $('.awrap');
                    setTimeout(function(){
                        awrap.fadeIn();
                        awrap.animate({opacity: 1}, 200);
                    }, 1000);
                    $(window).on('scroll', function () {
                        if ($(window).scrollTop() >= 109) {
                            awrap.css({position : 'fixed'});
                        } else {
                            awrap.css({position : 'initial'});
                        }
                    });
                });
            </script>
            <!-- Сайдбар -->
        </div>
    </div>

    <div class="col-sm-9 main-col">
        <div class="row question">
            <div class="left-row">
                <div class="votes">
                    <i class="fa fa-caret-up vote"></i>
                    <div class="vote-count" itemprop="upvoteCount">23</div>
                    <i class="fa fa-caret-down vote"></i>
                    <i class="fa fa-star star"></i>
                </div>
            </div>
            <div class="question-row">
                <div class="question-text">
                    <div class="description" itemprop="text">
                        <div class ="post-text"itemprop ="text">

<p>我创建了一个RAID：</p>

 <pre><code>sudo mdadm --create --verbose /dev/md1 --level=mirror --raid-devices=2 /dev/sdb1 /dev/sdc1
sudo mdadm --create --verbose /dev/md2 --level=mirror --raid-devices=2 /dev/sdb2 /dev/sdc2
</code></pre> 

<p> <code>sudo mdadm --detail --scan</code> 返回：</p>

 <pre><code>ARRAY /dev/md1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p>我将其附加到 <code>/etc/mdadm/mdadm.conf</code> ，见下文：</p>

 <pre><code># mdadm.conf
#
# Please refer to mdadm.conf(5) for information about this file.
#

# by default (built-in), scan all partitions (/proc/partitions) and all
# containers for MD superblocks. alternatively, specify devices to scan, using
# wildcards if desired.
#DEVICE partitions containers

# auto-create devices with Debian standard permissions
CREATE owner=root group=disk mode=0660 auto=yes

# automatically tag new arrays as belonging to the local system
HOMEHOST &lt;system&gt;

# instruct the monitoring daemon where to send mail alerts
MAILADDR root

# definitions of existing MD arrays

# This file was auto-generated on Mon, 29 Oct 2012 16:06:12 -0500
# by mkconf $Id$
ARRAY /dev/md1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p> <code>cat /proc/mdstat</code> 返回：</p>

 <pre><code>Personalities : [raid1] [linear] [multipath] [raid0] [raid6] [raid5] [raid4] [raid10] 
md2 : active raid1 sdb2[0] sdc2[1]
      208629632 blocks super 1.2 [2/2] [UU]

md1 : active raid1 sdb1[0] sdc1[1]
      767868736 blocks super 1.2 [2/2] [UU]

unused devices: &lt;none&gt;
</code></pre> 

<p> <code>ls -la /dev | grep md</code> 返回：</p>

 <pre><code>brw-rw----   1 root disk      9,   1 Oct 30 11:06 md1
brw-rw----   1 root disk      9,   2 Oct 30 11:06 md2
</code></pre> 

<p>所以我觉得一切都很好，我重启了。 </p>


<p>重新启动后，/ dev / md1现在是<strong> / dev / md126 </strong>，而/ dev / md2现在是<strong> / dev / md127 </strong> ????? </p >

<p> <code>sudo mdadm --detail --scan</code> 返回：</p>

 <pre><code>ARRAY /dev/md/ion:1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md/ion:2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p> <code>cat /proc/mdstat</code> 返回：</p>

 <pre><code>Personalities : [raid1] [linear] [multipath] [raid0] [raid6] [raid5] [raid4] [raid10] 
md126 : active raid1 sdc2[1] sdb2[0]
      208629632 blocks super 1.2 [2/2] [UU]

md127 : active (auto-read-only) raid1 sdb1[0] sdc1[1]
      767868736 blocks super 1.2 [2/2] [UU]

unused devices: &lt;none&gt;
</code></pre> 

<p> <code>ls -la /dev | grep md</code> 返回：</p>

 <pre><code>drwxr-xr-x   2 root root          80 Oct 30 11:18 md
brw-rw----   1 root disk      9, 126 Oct 30 11:18 md126
brw-rw----   1 root disk      9, 127 Oct 30 11:18 md127
</code></pre> 


<p>一切都没有丢失，我：</p>

 <pre><code>sudo mdadm --stop /dev/md126
sudo mdadm --stop /dev/md127
sudo mdadm --assemble --verbose /dev/md1 /dev/sdb1 /dev/sdc1
sudo mdadm --assemble --verbose /dev/md2 /dev/sdb2 /dev/sdc2
</code></pre> 

<p>并验证一切：</p>

<p> <code>sudo mdadm --detail --scan</code> 返回：</p>

 <pre><code>ARRAY /dev/md1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p> <code>cat /proc/mdstat</code> 返回：</p>

 <pre><code>Personalities : [raid1] [linear] [multipath] [raid0] [raid6] [raid5] [raid4] [raid10] 
md2 : active raid1 sdb2[0] sdc2[1]
      208629632 blocks super 1.2 [2/2] [UU]

md1 : active raid1 sdb1[0] sdc1[1]
      767868736 blocks super 1.2 [2/2] [UU]

unused devices: &lt;none&gt;
</code></pre> 

<p> <code>ls -la /dev | grep md</code> 返回：</p>

 <pre><code>brw-rw----   1 root disk      9,   1 Oct 30 11:26 md1
brw-rw----   1 root disk      9,   2 Oct 30 11:26 md2
</code></pre> 

<p>所以再一次，我认为一切都很好，我重新启动。</p>


<p>同样，重启后，/ dev / md1为<strong> / dev / md126 </strong>，而/ dev / md2为<strong> / dev / md127 </strong> ????? </p >

<p> <code>sudo mdadm --detail --scan</code> 返回：</p>

 <pre><code>ARRAY /dev/md/ion:1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md/ion:2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p> <code>cat /proc/mdstat</code> 返回：</p>

 <pre><code>Personalities : [raid1] [linear] [multipath] [raid0] [raid6] [raid5] [raid4] [raid10] 
md126 : active raid1 sdc2[1] sdb2[0]
      208629632 blocks super 1.2 [2/2] [UU]

md127 : active (auto-read-only) raid1 sdb1[0] sdc1[1]
      767868736 blocks super 1.2 [2/2] [UU]

unused devices: &lt;none&gt;
</code></pre> 

<p> <code>ls -la /dev | grep md</code> 返回：</p>

 <pre><code>drwxr-xr-x   2 root root          80 Oct 30 11:42 md
brw-rw----   1 root disk      9, 126 Oct 30 11:42 md126
brw-rw----   1 root disk      9, 127 Oct 30 11:42 md127
</code></pre> 

<p>我在这里缺少什么？</p>
    </DIV>                    </div>
                                            <div class="tags">
                                                            <a href="/tags/tag/mdadm" class="tag" title="用标记显示问题 'mdadm'" rel="tag">mdadm</a>
                                                    </div>
                                        <div class="clearfix"></div>
                    <div class="action-time">
                        集 <a href="https://askubuntu.com/users/100957/mmorris" rel="noopener" target="_blank">mmorris</a>
                        <span class="relativetime"> 30.10.2012 - 17:56</span>
                    </div>
                    <a class="a-link" href="https://askubuntu.com/questions/209702/why-is-my-raid-dev-md1-showing-up-as-dev-md126-is-mdadm-conf-being-ignored.html" target="_blank" rel="noopener">源</a>
                </div>
            </div>
        </div>

        <div class="row answers" id="answers">
            <div class="answers-header">
                <h2 class="pull-left"><span itemprop="answerCount">4</span> 答案</h2>
                <div class="clearfix"></div>
            </div>
            <div class="answer-pager">
                            </div>

                                                                        <div class="answer" id="209750" itemscope="" itemtype="http://schema.org/Answer" itemprop="acceptedAnswer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">25</div>
                                    <i class="fa fa-caret-down vote"></i>
                                    <i class="fa fa-check accepted"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
<p>我在这里找到了答案，<a href="https://ubuntuforums.org/showthread.php?t=1764861%29%3a"> RAID从md127而不是md0开始</a>。简而言之，我从/ </p>中删除了我的/etc/mdadm/mdadm.conf定义

 <pre><code>ARRAY /dev/md1 metadata=1.2 name=ion:1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md2 metadata=1.2 name=ion:2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<P>为：</p>

 <pre><code>ARRAY /dev/md1 UUID=aa1f85b0:a2391657:cfd38029:772c560e
ARRAY /dev/md2 UUID=528e5385:e61eaa4c:1db2dba7:44b556fb
</code></pre> 

<p>并跑了：</p>

 <pre><code>sudo update-initramfs -u
</code></pre> 

<p>我<strong>远</strong>来自专家，但我的理解是...... </p>

<p>内核在正常时间之前组装阵列以组装阵列。当内核组装数组时，它不使用mdadm.conf。由于分区已经由内核组装，因此跳过了使用mdadm.conf的普通数组程序集。</p>

<p>调用 <code>sudo update-initramfs -u</code> 告诉内核再次查看系统以了解如何启动。 </p>

<p>我相信知识渊博的人会纠正我/详细说明。</p>

<p>使用以下行更新系统中存在的每个相应内核的initrd：</p>

 <pre><code>sudo update-initramfs -k all -u
</code></pre> 
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案 <a href="https://askubuntu.com/users/100957/mmorris" rel="noopener" target="_blank">mmorris</a>
                                        <span title="209750" class="relativetime"> 30.10.2012 - 20:05</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/209702/why-is-my-raid-dev-md1-showing-up-as-dev-md126-is-mdadm-conf-being-ignored.html/209750#209750" target="_blank" rel="noopener">源</a>
                                    <!--<a class="share-link" href="/questions/53/why-does-html-think-chucknorris-is-a-color/1216#1216" title="分享">分享</a>-->
                                </div>
                            </div>
                        </div>
                                                                                                                                                            
                                                                                                            <div class="answer" id="582815" itemscope="" itemtype="http://schema.org/Answer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">4</div>
                                    <i class="fa fa-caret-down vote"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
 <pre><code>sudo update-initramfs -u
</code></pre> 

<p>是我需要解决的问题。
我没有在/etc/mdadm/mdadm.conf中编辑任何内容。 </p>
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案
                                                                                    <a href="https://askubuntu.com/users/341868/ajaaskel" rel="noopener" target="_blank">
                                                                                    ajaaskel                                                                                    </a>
                                                                                <span title="582815" class="relativetime"> 07.02.2015 - 18:16</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/209702/why-is-my-raid-dev-md1-showing-up-as-dev-md126-is-mdadm-conf-being-ignored.html/582815#582815" target="_blank" rel="noopener">源</a>
                                </div>
                            </div>
                        </div>
                                                                                <div class="answer" id="701510" itemscope="" itemtype="http://schema.org/Answer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">0</div>
                                    <i class="fa fa-caret-down vote"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
<p>我设法以下列方式复制了这个问题：</p>

<p>当"软件更新程序"询问我是否想要更新软件包（包括Ubuntu base和内核）时，我说：好的。
新安装的内核使用当前内核的/系统设置。
然后我创建了数组。
只有当前运行的内核使用新的RAID设置进行了更新。
一旦我重新启动，新内核对raid一无所知，并给它一个md127名称！</p>
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案
                                                                                    <a href="https://askubuntu.com/users/475175/angelos-vassiliou" rel="noopener" target="_blank">
                                                                                    Angelos Vassiliou                                                                                    </a>
                                                                                <span title="701510" class="relativetime"> 23.11.2015 - 14:44</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/209702/why-is-my-raid-dev-md1-showing-up-as-dev-md126-is-mdadm-conf-being-ignored.html/701510#701510" target="_blank" rel="noopener">源</a>
                                </div>
                            </div>
                        </div>
                                                                                <div class="answer" id="505618" itemscope="" itemtype="http://schema.org/Answer">
                            <div class="left-row">
                                <div class="votes">
                                    <i class="fa fa-caret-up vote"></i>
                                    <div class="vote-count" itemprop="upvoteCount">0</div>
                                    <i class="fa fa-caret-down vote"></i>
                                </div>
                            </div>
                            <div class="answer-row">
                                <div class="answer-text">
                                    <div class="description" itemprop="text">
                                        <div class ="post-text"itemprop ="text">
<p>我有同样的问题。</p>

<p>此解决方案解决了我的问题：
<a href="https://aubreykloppers.wordpress.com/2012/07/06/mdadm-devmd127/">链接</a> </p>
    </DIV>                                    </div>
                                    <div class="action-time">
                                        给出答案
                                                                                    <a href="https://askubuntu.com/users/311406/marc" rel="noopener" target="_blank">
                                                                                    Marc                                                                                    </a>
                                                                                <span title="505618" class="relativetime"> 01.08.2014 - 23:22</span>
                                    </div>
                                    <a class="a-link" href="https://askubuntu.com/questions/209702/why-is-my-raid-dev-md1-showing-up-as-dev-md126-is-mdadm-conf-being-ignored.html/505618#505618" target="_blank" rel="noopener">源</a>
                                </div>
                            </div>
                        </div>
                                                            <div class="answer-pager">
                            </div>
        </div>

                    <div class="row bottom-notice">
                <p>阅读有关标签的其他问题
                                            <a href="/tags/tag/mdadm" class="tag" title="用标记显示问题 'mdadm'" rel="tag">mdadm</a>
                                    </p>
            </div>
        

         <div class="row">
                            <a href="/questions/6297/what-is-apt-fast-and-should-i-use-it.html">什么是apt-fast，我应该使用它吗？</a>
                                        <a href="/questions/6299/remote-login-with-graphical-display-manager-gdm-lightdm.html">使用图形显示管理器（GDM，LightDM）进行远程登录</a>
                    </div>

        
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <div class="container">
        <div class="pull-left">
            <div class="license">
                用户贡献许可 <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="nofollow license">cc by-sa 3.0</a>
                需要归属。
            </div>
        </div>

        <div class="pull-right logo">
            <a href="#">
                <!-- <img src="/img/logo-dark.svg"> -->
                <div class="name">Ch<span class="cl-orange">Ubuntu</span></div>
            </a>
        </div>
    </div>
</footer>



<script src="/assets/c052535f/jquery.js"></script>
<script src="/assets/f2670525/yii.js"></script>
<script src="/js/code-prettify/prettify.js"></script>
<script src="/js/site.js"></script>
<script src="/assets/49d3cefc/js/bootstrap.js"></script></body>
</html>
<!-- 0.057655096054077 -->